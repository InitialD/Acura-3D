/**
 * Blend4Web CE 17.02_rc
 * Copyright (C) 2014-2017 Triumph LLC
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
var b4w="object"===typeof b4w?b4w:function(a){var q={};a.module=q;var d={};a.cleanup=function(a,b){var c=q[a];c&&(c.Zl=null);d[b||"__b4w_default"]=null};a.register=function(a,b){q[a]||(q[a]=b)};a.require=function(a,b){if(!q[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";d[b]||(d[b]=function(a){return function(b){var c=q[b];if(!c)throw Error('Module "'+b+'" not found');c.Zl||(c.Zl={});c.Zl[a]||(c.Zl[a]={},c(c.Zl[a],d[a]));return c.Zl[a]}}(b));return d[b](a)};a.module_check=function(a){return q[a]?
!0:!1};a.get_namespace=function(a){for(var b in d)if(d[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});b4w.module.__version=function(a){var q=new Date(2017,1,22,18,5,13),d=[17,2];a.version=function(){return d};a.version_str=function(){for(var a="",b=0;b<d.length;b++)a=1==b?a+(10>d[b]?"0"+d[b]:d[b]):a+d[b],b!=d.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return q};a.date_str=function(){var a=q.getDate(),a=10>a?"0"+String(a):String(a),b=q.getMonth()+1,b=10>b?"0"+String(b):String(b),d=String(q.getFullYear()),n=q.getHours(),n=10>n?"0"+String(n):String(n),B=q.getMinutes(),
B=10>B?"0"+String(B):String(B),e=q.getSeconds(),e=10>e?"0"+String(e):String(e);return a+"."+b+"."+d+" "+n+":"+B+":"+e};a.timestamp=function(){return"?v=_b4w_ver_17_02_"}};b4w.module.__config=function(a,q){function d(){return b4w.module_check(a.ge.qr)}function c(){for(var c=a.ge,d=null,g=document.getElementsByTagName("script"),v=0;v<g.length;v++){for(var w=g[v].src,h=0;h<c.OC.length;h++)if(0<=w.indexOf(c.OC[h])){d=w;break}if(null!==d)break}d||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),d=document.location.href);c=d.indexOf("?");0<=c&&(d=d.substring(0,c));return d.substring(0,d.lastIndexOf("/"))}var b=q("__print"),
g=q("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.P_AUTO=5;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.gB=g.S(a.context);a.H={alpha_sort:!0,alpha_sort_threshold:.1,jl:[6,2],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,LB:1,uM:5,background_color:[0,0,0,0],canvas_resolution_factor:1,El:3,allow_cors:!1,KB:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,IT:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,
motion_blur:!0,compositing:!0,antialiasing:!0,smaa:!1,debug_view:!1,$F:!1,sm:!0,rt:!0,yc:!0,water_dynamic:!0,shore_smoothing:!0,an:!0,GF:!0,precision:"highp",quality:a.P_HIGH,cr:!0,QO:!1,py:!1,Zv:!1,TF:!1,is_mobile_device:!1,Qw:!1,zv:!1,ZU:!1,cq:!1,allow_hidpi:!1,AE:!1,sx:!1,enable_selectable:!0,enable_outlining:!0,hi:!0,Uk:!1,IB:!1,gx:[0,0],Yo:!1,KD:!0,Nt:!1,url_params:null,Rb:!0,uc:4,Go:!1,$D:!1,aE:!1,by:!1,VA:!1,yC:!1,media_auto_activation:!0,eD:4,Us:!1,gl_debug:!1,PA:!1,bA:!1,Zu:!1,Ho:"dds",shadow_blur_samples:"",
reflection_quality:"",srgb_type:"SRGB_SIMPLE",Es:!1,gT:!1};a.wB=g.S(a.H);a.nk={bs:-1,MB:!1,Pk:1};a.controls={LO:1/120};a.rd={path:"",bP:"B4W_ASSETS_PATH=__JS__/../../assets/",rP:"B4W_PROJ_ASSETS_PATH=__JS__/../../../projects/__NAME__/assets/",FO:15,prevent_caching:!0,rx:!1,Uv:!1,Bt:!1};a.hA=g.S(a.rd);a.ge={shaders_path:"",IQ:"../shaders/",yE:"include/",WU:"postprocessing/",qr:"built_in_data",OC:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js B4W_MAIN_MODULE".split(" "),
smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"};a.wC={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{AB:.8,Kf:.064,Yg:.035,$p:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],hk:.11,qh:.062,Zg:.004}};a.J={enabled:!0,max_fps:60,yq:"",eS:"B4W_URANIUM_PATH=uranium.js",qv:!1,ping:!1,yn:!0};a.BD=g.S(a.J);a.$m={np:1024,Gr:256,pB:32,BL:128,AL:256,DD:.25,jP:.5,iP:1};a.dE=g.S(a.$m);a.Y={nz:!0,
at:!1,mA:!1,WA:!1,zB:!1};a.wE=g.S(a.Y);a.Ic={outlining_overview_mode:!1,vi:[1,.4,.05],Gj:.2,Hj:3.8,Ij:1};a.Jk={enabled:!1,pq:0,iR:0,LQ:"COLOR"};a.uB=g.S(a.Jk);a.pg={EO:8,kx:64,ox:8,Ws:8,px:15,gD:0,Xs:128,pi:1024,lx:4096,tc:4096,qx:[4096,4096],ej:24};a.fB=g.S(a.pg);a.apply_quality=function(){var b=a.H,c=a.J,d=a.$m;switch(b.quality){case a.P_ULTRA:b.shadows=!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.sm=!0;b.rt=!0;b.yc=!0;d.np=2048;d.Gr=512;
b.El=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.an=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.hi=!0;b.uc=16;b.srgb_type="SRGB_PROPER";c.max_fps=120;break;case a.P_HIGH:b.shadows=!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.sm=!0;b.rt=!0;b.yc=!0;d.np=1024;d.Gr=256;b.El=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=
!0;b.an=!0;b.antialiasing=!0;b.smaa=!1;b.compositing=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.hi=!0;b.srgb_type="SRGB_SIMPLE";b.uc=4;c.max_fps=60;break;case a.P_LOW:b.shadows=!1;b.shore_smoothing=!1;b.ssao=!1;b.dof=!1;b.god_rays=!1;b.bloom=!1;b.reflections=!1;b.refractions=!1;b.sm=!1;b.rt=!1;b.yc=!1;d.np=512;d.Gr=256;b.El=2;b.anisotropic_filtering=!1;b.use_min50=!0;b.precision="mediump";b.water_dynamic=!1;b.an=!1;b.antialiasing=!1;b.smaa=!1;b.compositing=!1;b.motion_blur=!1;b.allow_hidpi=
!1;b.enable_outlining=!1;b.hi=!1;b.srgb_type="SRGB_SIMPLE";b.uc=1;c.max_fps=60;break;case a.P_AUTO:g.D("Direct AUTO quality profile setting is forbidden")}};a.set=function(c,d){switch(c){case "allow_cors":a.H.allow_cors=d;break;case "allow_hidpi":a.H.allow_hidpi=d;break;case "alpha":a.context.alpha=d;break;case "alpha_sort":a.H.alpha_sort=d;break;case "alpha_sort_threshold":a.H.alpha_sort_threshold=d;break;case "anaglyph_use":b.ZL();a.H.stereo=d?"ANAGLYPH":a.H.stereo;break;case "animation_framerate":a.nk.bs=
d;break;case "anisotropic_filtering":a.H.anisotropic_filtering=d;break;case "antialiasing":a.H.antialiasing=d;break;case "assets_dir":case "assets_path":a.rd.path=d;break;case "assets_dds_available":a.rd.Uv=d;break;case "assets_pvr_available":a.rd.Bt=d;break;case "assets_min50_available":a.rd.rx=d;break;case "audio":a.Y.nz=d;break;case "background_color":a.H.background_color=d;break;case "bloom":a.H.bloom=d;break;case "built_in_module_name":a.ge.qr=d;break;case "canvas_resolution_factor":a.H.canvas_resolution_factor=
d;break;case "console_verbose":a.H.console_verbose=d;break;case "compositing":a.H.compositing=d;break;case "dof":a.H.dof=d;break;case "do_not_load_resources":a.H.do_not_load_resources=d;break;case "god_rays":a.H.god_rays=d;break;case "stereo":a.H.stereo=d;break;case "max_fps":a.H.max_fps=d;break;case "max_fps_physics":a.J.max_fps=d;break;case "media_auto_activation":a.H.media_auto_activation=d;break;case "motion_blur":a.H.motion_blur=d;break;case "physics_enabled":a.J.enabled=d;break;case "physics_uranium_path":a.J.yq=
d;break;case "physics_calc_fps":a.J.qv=d;break;case "physics_use_workers":a.J.yn=d;break;case "precision":a.H.precision=d;break;case "prevent_caching":a.rd.prevent_caching=d;break;case "quality":a.H.quality=d;break;case "reflections":a.H.reflections=d;break;case "refractions":a.H.refractions=d;break;case "sfx_mix_mode":a.Y.at=d;break;case "shaders_dir":case "shaders_path":a.ge.shaders_path=d;break;case "shadows":a.H.shadows=d;break;case "show_hud_debug_info":a.H.show_hud_debug_info=d;break;case "smaa":a.H.smaa=
d;break;case "smaa_search_texture_path":a.ge.smaa_search_texture_path=d;break;case "smaa_area_texture_path":a.ge.smaa_area_texture_path=d;break;case "ssao":a.H.ssao=d;break;case "debug_view":a.H.debug_view=d;break;case "enable_selectable":a.H.enable_selectable=d;break;case "enable_outlining":a.H.enable_outlining=d;break;case "outlining_overview_mode":a.Ic.outlining_overview_mode=d;break;case "glow_materials":a.H.hi=d;break;case "url_params":a.H.url_params=d;break;case "use_min50":a.H.use_min50=d;
break;case "gl_debug":a.H.gl_debug=d;break;case "srgb_type":a.H.srgb_type=d;break;case "shadow_blur_samples":a.H.shadow_blur_samples=d;break;case "reflection_quality":a.H.reflection_quality=d;break;default:b.error("Unknown config property: "+c)}};a.get=function(d){switch(d){case "allow_cors":return a.H.allow_cors;case "allow_hidpi":return a.H.allow_hidpi;case "alpha":return a.context.alpha;case "alpha_sort":return a.H.alpha_sort;case "alpha_sort_threshold":return a.H.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==
a.H.stereo;case "animation_framerate":return a.nk.bs;case "anisotropic_filtering":return a.H.anisotropic_filtering;case "antialiasing":return a.H.antialiasing;case "assets_dir":case "assets_path":return a.rd.path;case "assets_dds_available":return a.rd.Uv;case "assets_pvr_available":return a.rd.Bt;case "assets_min50_available":return a.rd.rx;case "audio":return a.Y.nz;case "background_color":return a.H.background_color;case "bloom":return a.H.bloom;case "built_in_module_name":return a.ge.qr;case "canvas_resolution_factor":return a.H.canvas_resolution_factor;
case "console_verbose":return a.H.console_verbose;case "compositing":return a.H.compositing;case "dof":return a.H.dof;case "do_not_load_resources":return a.H.do_not_load_resources;case "is_mobile_device":return a.H.is_mobile_device;case "god_rays":return a.H.god_rays;case "stereo":return a.H.stereo;case "max_fps":return a.H.max_fps;case "max_fps_physics":return a.J.max_fps;case "media_auto_activation":return a.H.media_auto_activation;case "motion_blur":return a.H.motion_blur;case "physics_enabled":return a.J.enabled;
case "physics_uranium_path":return a.J.yq;case "physics_calc_fps":return a.J.qv;case "physics_use_workers":return a.J.yn;case "precision":return a.H.precision;case "prevent_caching":return a.rd.prevent_caching;case "quality":return a.H.quality;case "reflections":return a.H.reflections;case "refractions":return a.H.refractions;case "sfx_mix_mode":return a.Y.at;case "shaders_dir":case "shaders_path":return a.ge.shaders_path;case "shadows":return a.H.shadows;case "show_hud_debug_info":return a.H.show_hud_debug_info;
case "smaa":return a.H.smaa;case "smaa_search_texture_path":return a.ge.smaa_search_texture_path;case "smaa_area_texture_path":return a.ge.smaa_area_texture_path;case "ssao":return a.H.ssao;case "debug_view":return a.H.debug_view;case "enable_selectable":return a.H.enable_selectable;case "enable_outlining":return a.H.enable_outlining;case "outlining_overview_mode":return a.Ic.outlining_overview_mode;case "glow_materials":return a.H.hi;case "url_params":return a.H.url_params;case "use_min50":return a.H.use_min50;
case "gl_debug":return a.H.gl_debug;case "srgb_type":return a.H.srgb_type;case "shadow_blur_samples":return a.H.shadow_blur_samples;case "reflection_quality":return a.H.reflection_quality;default:b.error("Unknown config property: "+d)}};a.reset=function(){for(var b in a.gB)a.context[b]=a.gB[b];for(b in a.wB)a.H[b]=a.wB[b];for(b in a.hA)a.rd[b]=a.hA[b];for(b in a.BD)a.J[b]=a.BD[b];for(b in a.dE)a.$m[b]=a.dE[b];for(b in a.wE)a.Y[b]=a.wE[b];for(b in a.uB)a.Jk[b]=a.uB[b]};a.reset_limits=function(){var b=
a.pg.ej,d;for(d in a.fB)a.pg[d]=a.fB[d];a.pg.ej=b};a.EC=d;a.tQ=function(){var b=a.ge,g=a.J;d()||""!=b.shaders_path||(b.shaders_path=c()+"/"+b.IQ);g.enabled&&""==g.yq&&(g.yq=c()+"/"+g.eS.replace("B4W_URANIUM_PATH=",""))};a.get_assets_path=function(b){var d=a.rd;if(d.path)return d.path;var g=d.bP,n="B4W_ASSETS_PATH=";b&&(g=d.rP,n="B4W_PROJ_ASSETS_PATH=",g=g.replace("__NAME__",b));g=g.replace(n,"");return g=g.replace("__JS__",c())}};b4w.module.__anchors=function(a,q){function d(){if(!y&&!I){var a=p;if(a)if("visible"==a.lastElementChild.style.visibility)c(),p=null;else if(1==a.style.opacity){var b=a.lastElementChild,a=a.firstElementChild,d=b.firstElementChild,f=Math.ceil(b.getBoundingClientRect().width),E=Math.ceil(b.getBoundingClientRect().height),h=Math.ceil(a.getBoundingClientRect().width),m=Math.ceil(a.getBoundingClientRect().height);b.style.position="absolute";b.style.visibility="visible";var t=!0,k=!0;a.style.display="none";
y=!0;h!=f?D.animate(h,f,200,function(a){a==f&&(t=!1,k||(y=!1,d.style.visibility="visible"));b.style.width=a+"px"}):(t=!1,k||(y=!1));m!=E?D.animate(m,E,200,function(a){a==E&&(k=!1,t||(y=!1,d.style.visibility="visible"));b.style.height=a+"px"}):(k=!1,t||(y=!1))}}}function c(){var a=p.lastElementChild;p.firstElementChild.style.display="";a.style.visibility="hidden";a.style.position="relative";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 1.25;"}
function g(a,d,f){var K=document.createElement("div"),E=document.createElement("span");f&&(K.style.maxWidth=f+"px");K.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);left:               0;box-sizing:         border-box;opacity:            1.0;padding:            6px 12px 6px 12px;position:           relative;z-index:            2;";b(E);E.innerHTML=
a;K.style.visibility="hidden";E.style.visibility="hidden";K.appendChild(E);d.appendChild(K);k.add_click_listener(d,function(){y||d==p||1!=d.style.opacity||I||(p&&"visible"==p.lastElementChild.style.visibility&&c(),p=d)})}function n(){for(var a=0,b=0;b<A.length;b++)A[b].im&&a++;Y=new Float32Array(3*a)}function B(a,b){return b.depth-a.depth}function e(a,b,p){a=a.element;m.yC&&(b=Math.floor(b),p=Math.floor(p));"transform"in a.style?a.style.transform="translate3d("+b+"px, "+p+"px, 0px)":"webkitTransform"in
a.style?a.style.webkitTransform="translate3d("+b+"px, "+p+"px, 0px)":(a.style.left=b+"px",a.style.top=p+"px")}function v(a){for(var b=0;b<A.length;b++)if(A[b].obj==a)return!0;return!1}var w=q("__batch"),h=q("__camera"),l=q("__config"),x=q("__container"),k=q("__input"),f=q("__objects"),F=q("__obj_util"),u=q("__print"),r=q("__renderer"),z=q("__scenes"),J=q("__subscene"),D=q("__time"),H=q("__transform"),C=q("__tsr"),t=q("__vec3"),m=l.H,A=[],I=!1,p=null,Q=!1,y=!1,Y=new Float32Array(0),R=new Uint8Array(16),
G=new Float32Array(2),E=new Float32Array(3),W=new Float32Array(3);a.append=function(a){if(!v(a)){var p=a.anchor.im&&!!z.Aa(z.nh(),J.Rl),p={type:a.anchor.type,obj:a,x:0,y:0,depth:0,pk:"out",im:p,element:null,Lm:null,BI:a.anchor.GO,gj:a.anchor.gj};switch(p.type){case "ANNOTATION":var y=p.obj;a=x.get_container();var c=f.get_meta_tags(y),y=y.name,E="",h=document.createElement("div"),m=h.cloneNode(!1),t=document.createElement("span");h.style.cssText+="position:        absolute;height:          0;transform-style: preserve-3d;";
m.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);opacity:            1.0;box-sizing:         border-box;bottom:             0;left:               0;padding:            6px 12px 6px 12px;position:           absolute;";h.style.visibility="hidden";c&&(E=c.description||E,y=c.title||y);t.innerHTML=y;t.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(t);t.style.whiteSpace="nowrap";m.appendChild(t);h.appendChild(m);E&&g(E,h,p.BI);a.appendChild(h);p.element=h;break;case "ELEMENT":if(p.element=document.getElementById(a.anchor.gj),p.element)for(c=0;c<A.length;c++)"ELEMENT"==A[c].type&&A[c].gj==a.anchor.gj&&(u.warn("Anchor with the id '"+a.anchor.gj+"' already exists, making the new anchor generic."),p.type="GENERIC");else u.warn("Anchor HTML element with the id '"+a.anchor.gj+"' was not found, making it generic."),p.type="GENERIC"}A.push(p);n();
Q||(Q=!0,x.get_container().addEventListener("mouseup",d))}};a.remove=function(a){for(var b=0;b<A.length;b++){var p=A[b];if(p.obj==a){"ANNOTATION"==p.type&&(a=p,x.get_container().removeChild(a.element));A.splice(b,1);n();break}}};a.update=function(a){for(var b=0,d=A.length;d--;){var y=A[d];if(y.im){var c=C.get_trans_view(y.obj.o.v);Y.set(c,3*b++)}var f;f=y;var c=E,m=z.mj(z.nh());f=C.get_trans_view(f.obj.o.v);h.project_point(m,f,c);f=c;c=f[0];m=f[1];f=f[2];if(a||c!=y.x||m!=y.y||f!=y.depth){switch(y.type){case "ANNOTATION":var t=
c,k=m;e(y,t,k);break;case "ELEMENT":k=y.element.getBoundingClientRect(),t=c-k.width/2,k=m-k.height/2,e(y,t,k)}y.x=c;y.y=m;y.depth=f;y.Lm&&y.Lm(c,m,y.pk,y.obj,y.element)}}A.sort(B);for(d=0;d<A.length;d++)y=A[d],"GENERIC"!=y.type&&(y.element.style.zIndex=p==y.element?A.length:d);0<b&&(a=z.Aa(z.nh(),J.Rl),b=a.Qa[0].ra[0],w.xR(b.qa,Y),J.Ec(a,b))};a.EF=function(){for(var a=x.get_container(),b=z.get_active(),b=z.Aa(b,J.uf),b=!(!b||!b.enable_hmd_stereo),d=A.length;d--;){var y=A[d],f=y.obj,m=f.o,h=y.x,k=
y.y,g=y.depth,Q=z.mj(z.nh()),e=H.get_translation(f,E),Q=H.get_translation(Q,W),e=t.dist(e,Q);(g=0>h||0>k||0>g||1<g||z.is_hidden(f)||h>=a.clientWidth||k>=a.clientHeight)||(g=m.De,g=!(e<m.Dg?0:g==F.Mn||e<g));m=g?"out":"visible";y.im&&"out"!=m&&(m=y,g=z.Aa(z.nh(),J.Rl).B,e=x.po(m.x,m.y,G,g),r.Et(g.ee,e[0],g.height-e[1],2,2,R),m=1020==R[5]+R[6]+R[9]+R[10]?"visible":"out"!=m.pk&&R[5]+R[6]+R[9]+R[10]?m.pk:"covered");b&&(m="out");if(m!=y.pk){switch(y.type){case "ANNOTATION":case "ELEMENT":var l=y.element;
l&&("out"==m?(l.style.visibility="hidden",l.children.length&&(l.children[0].style.visibility="hidden")):"visible"==m?(l.style.visibility="visible",l.children.length&&(l.children[0].style.visibility="visible"),l.style.opacity=1):(l.style.visibility="visible",l.style.opacity=.1,l.children.length&&(l.children[0].style.visibility="visible"),"ANNOTATION"==y.type&&1<l.children.length&&"visible"==l.lastElementChild.style.visibility&&(c(),l==p&&(p=null))))}y.pk=m;y.Lm&&y.Lm(h,k,y.pk,f,l)}}};a.attach_move_cb=
function(a,b){for(var p=0;p<A.length;p++)A[p].obj==a&&(A[p].Lm=b)};a.detach_move_cb=function(a){for(var b=0;b<A.length;b++)A[b].obj==a&&(A[b].Lm=null)};a.cleanup=function(){for(var a=0;a<A.length;a++){var b=A[a];"ANNOTATION"==b.type&&x.get_container().removeChild(b.element)}A.length=0};a.is_anchor=v;a.get_element_id=function(a){for(var b=0;b<A.length;b++)if(A[b].obj==a)return A[b].gj;return!1};a.pause=function(){I=!0};a.resume=function(){I=!1};a.cP=function(a,b){for(var p=-1,d=0;d<A.length;d++){var y;
if(y="visible"==A[d].pk){var c=A[d];if(c.element){y=Math.round(c.element.offsetWidth)||0;var f=Math.round(c.element.offsetHeight)||0}else f=y=0;var E=c.x,c=c.y;y=a>=E&&a<=E+y&&b<c&&b>=c-f?!0:!1}if(y)if(0>p)var K=A[d].depth,p=d;else A[d].depth<K&&(p=d,K=A[d].depth)}return 0>p?null:A[p].obj}};b4w.module.__armature=function(a,q){function d(a){a=a.o;for(var b=a.dn,d=a.Ys,c=0;c<b.length;c++){for(var h=b[c],k=d[c],g=0;g<k.length;g+=2)for(var e=k[g],l=k[g+1],n=0;4>n;n++)h.Pd[e+n]=a.Pd[l+n],h.he[e+n]=a.he[l+n],h.Td[e+n]=a.Td[l+n],h.ke[e+n]=a.ke[l+n];h.Be=a.Be}}function c(a,b,d,h){var f=a.Yy,k=a.Mi,e=a.sq,l=a.Jp;l?(l=l.sq,b?g.multiply(l,f,e):(b=w,g.invert(l,b),g.multiply(b,e,f))):b?g.copy(f,e):g.copy(e,f);f=v;g.invert(k,f);g.multiply(e,f,f);k=a.Uh;d[4*k]=f[0];d[4*k+1]=f[1];d[4*k+2]=f[2];d[4*
k+3]=f[3];h[4*k]=f[4];h[4*k+1]=f[5];h[4*k+2]=f[6];h[4*k+3]=f[7];a=a.Xv;for(k=0;k<a.length;k++)e=a[k],e.cc||c(e,!0,d,h)}var b=q("__util"),g=q("__tsr"),n=q("__quat"),B=q("__mat4"),e=q("__vec3"),v=g.create(),w=g.create(),h=new Float32Array(4),l=new Float32Array(4),x=new Float32Array(4);a.bk=function(a,d){for(var c=a.data.bones,f=a.pose.bones,h={},k=0;k<f.length;k++){var l=f[k],n=l.bone,w=n.name,x=h[w]={Uh:0,UF:-1,Jp:null,Xv:[],sr:[],cc:null,sn:g.create(),Yy:g.create(),Mi:g.create(),$y:g.create(),sq:g.create(),
tF:g.create(),sF:g.create(),rq:g.create(),Zy:g.create(),hu:!1,cF:new Float32Array(3)},w=new Float32Array(n.matrix_local),t=new Float32Array(16);B.invert(w,t);var l=new Float32Array(l.matrix_basis),m=x.cF;e.subtract(b.f32(n.tail_local),b.f32(n.head_local),m);b.nS(m,t,m);g.from_mat4(w,x.Mi);g.from_mat4(l,x.rq);g.copy(x.Mi,x.sq);g.invert(x.Mi,x.$y)}for(k=0;k<c.length;k++){w=c[k].name;l=b.keysearch("name",w,f);x=h[w];n=l.parent_recursive;x.sr.push(x);for(t=0;t<n.length;t++)l=n[t],l=l.name,l=h[l],x.sr.push(l);
n.length?(l=n[0],l=l.name,l=h[l],x.Jp=l,g.invert(l.Mi,v),g.multiply(v,x.Mi,x.sn),l.Xv.push(x)):g.copy(x.Mi,x.sn);x.Uh=k;x.name=w;g.multiply(x.sn,x.rq,x.Yy)}d.o.zf=h};a.get_bone_tsr=function(a,b,d,c,r){var f=a.o,k=f.Be;b=f.zf[b];var e=b.Uh;a=b.Mi;var u=f.Td,C=f.ke,t=f.Pd,f=f.he,m=u[4*e+1],A=u[4*e+2],F=u[4*e+3],p=C[4*e+1],Q=C[4*e+2],y=C[4*e+3];h[0]=(1-k)*u[4*e]+k*C[4*e];h[1]=(1-k)*m+k*p;h[2]=(1-k)*A+k*Q;h[3]=(1-k)*F+k*y;l[0]=t[4*e];l[1]=t[4*e+1];l[2]=t[4*e+2];l[3]=t[4*e+3];x[0]=f[4*e];x[1]=f[4*e+1];
x[2]=f[4*e+2];x[3]=f[4*e+3];n.slerp(l,x,k,l);k=v;g.set_transcale(h,k);g.set_quat(l,k);d?(d=w,g.translate(a,b.cF,d),g.multiply(k,d,k)):g.multiply(k,a,k);if(c){if(c=b.Jp)d=w,g.invert(c.sq,d),g.multiply(d,k,k);c=w;g.invert(b.sn,c);g.multiply(c,k,k)}g.copy(k,r)};a.set_bone_tsr=function(a,b,h,e){var f=a.o;b=f.zf[b];var k=f.Td,l=f.Pd;e?g.multiply(b.sn,h,b.Yy):g.copy(h,b.sq);c(b,e,k,l);f.Be=0;d(a)};a.WR=d;a.ER=c;a.vr=function(a,b){return b in a.o.zf}};b4w.module.__boundings=function(a,q){function d(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function c(){return{M:new Float32Array(3),Ea:new Float32Array(3),Fa:new Float32Array(3),Ga:new Float32Array(3)}}function b(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function g(a,b){for(var d=a[0],p=a[1],c=a[2],f=a[0],E=a[1],h=a[2],m=3;m<a.length;m+=3)var K=a[m],k=a[m+1],t=a[m+2],d=Math.max(d,K),p=Math.max(p,k),c=Math.max(c,t),
f=Math.min(f,K),E=Math.min(E,k),h=Math.min(h,t);b.max_x=d;b.max_y=p;b.max_z=c;b.min_x=f;b.min_y=E;b.min_z=h;return b}function n(a,b){b||(b=new Float32Array(24));var d=a.max_x,p=a.max_y,c=a.max_z,f=a.min_x,E=a.min_y,h=a.min_z;b[0]=f;b[1]=E;b[2]=h;b[3]=d;b[4]=E;b[5]=h;b[6]=d;b[7]=p;b[8]=h;b[9]=f;b[10]=p;b[11]=h;b[12]=f;b[13]=E;b[14]=c;b[15]=d;b[16]=E;b[17]=c;b[18]=d;b[19]=p;b[20]=c;b[21]=f;b[22]=p;b[23]=c;return b}function B(){return{M:new Float32Array(3),Wa:0}}function e(a,b){b.M[0]=a.M[0];b.M[1]=
a.M[1];b.M[2]=a.M[2];b.Wa=a.Wa}function v(){return{Ea:new Float32Array(3),Fa:new Float32Array(3),Ga:new Float32Array(3),M:new Float32Array(3)}}function w(a,b){u.copy(a.Ea,b.Ea);u.copy(a.Fa,b.Fa);u.copy(a.Ga,b.Ga);u.copy(a.M,b.M);return b}function h(a){var b=v();w(a,b);return b}function l(a,b,d,c){return{Ea:new Float32Array(a),Fa:new Float32Array(b),Ga:new Float32Array(d),M:new Float32Array([c[0],c[1],c[2]])}}function x(a,b){var d=r.IJ(a,t),d=b?r.DJ(a,d,A):z.identity(A),d=r.mM(d,m);u.copy(a,D);u.transformMat3(D,
d,D);for(var c=D[0],p=c,f=D[1],E=f,h=D[2],k=h,K,g,e,Q,n=3;n<a.length;n+=3)D[0]=a[n],D[1]=a[n+1],D[2]=a[n+2],u.transformMat3(D,d,D),K=D[0],g=D[1],e=D[2],K>c&&(c=K),K<p&&(p=K),g>f&&(f=g),g<E&&(E=g),e>h&&(h=e),e<k&&(k=e);c=Math.max(c-p,1E-9);f=Math.max(f-E,1E-9);h=Math.max(h-k,1E-9);k=z.identity(A);k[0]=c?1/c:1E8;k[4]=f?1/f:1E8;k[8]=h?1/h:1E8;z.transpose(d,I);D[0]=a[0];D[1]=a[1];D[2]=a[2];u.transformMat3(D,d,D);u.transformMat3(D,k,D);u.transformMat3(D,I,D);E=D[0];p=D[0];K=D[1];g=D[1];e=D[2];Q=D[2];for(n=
3;n<a.length;n+=3)D[0]=a[n],D[1]=a[n+1],D[2]=a[n+2],u.transformMat3(D,d,D),u.transformMat3(D,k,D),u.transformMat3(D,I,D),E=Math.max(E,D[0]),p=Math.min(p,D[0]),K=Math.max(K,D[1]),g=Math.min(g,D[1]),e=Math.max(e,D[2]),Q=Math.min(Q,D[2]);n=Math.sqrt((E-p)*(E-p)+(K-g)*(K-g)+(e-Q)*(e-Q))/2;n=Math.min(n,1);C[0]=(E+p)/2;C[1]=(K+g)/2;C[2]=(e+Q)/2;E=C;k=z.identity(A);k[0]=c;k[4]=f;k[8]=h;u.transformMat3(E,d,E);u.transformMat3(E,k,E);u.transformMat3(E,I,E);k=[d[0],d[3],d[6]];p=[d[1],d[4],d[7]];d=[d[2],d[5],
d[8]];u.scale(k,c*n,k);u.scale(p,f*n,p);u.scale(d,h*n,d);return l(k,p,d,E)}function k(a,b,d){u.add(b,d,a.M);u.scale(a.M,.5,a.M);a.Wa=u.distance(a.M,b);return a}var f=q("__tsr"),F=q("__util"),u=q("__vec3"),r=q("__math"),z=q("__mat3"),J=new Float32Array(24),D=new Float32Array(3),H=new Float32Array(3),C=new Float32Array(3),t=new Float32Array(3),m=new Float32Array(9),A=new Float32Array(9),I=new Float32Array(9);a.sd=d;a.Dr=c;a.cm=b;a.oT=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,
min_z:-1E12}};a.BS=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.yk=function(a){var c=d();b(a,c);return c};a.EJ=function(a){var b=a.max_x-a.min_x,d=a.max_y-a.min_y;d<b&&(b=d);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.gw=function(a,b){var d=a.max_y,c=a.max_z,p=a.min_x,f=a.min_y,h=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,d);a.max_z=Math.max(b.max_z,c);a.min_x=Math.min(b.min_x,p);a.min_y=Math.min(b.min_y,f);a.min_z=Math.min(b.min_z,h)};a.pA=g;a.wk=
function(a,b,c){c||(c=d());a=n(a,J);f.transform_vectors(a,b,a);return g(a,c)};a.GB=n;a.YU=function(a,b,c){c||(c=d());var p=b.min_x,y=b.max_x,f=b.min_y,h=b.max_y,k=b.min_z;b=b.max_z;if(p>=a.max_x||y<=a.min_x||f>=a.max_y||h<=a.min_y||k>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,p);c.max_x=Math.min(a.max_x,y);c.min_y=Math.max(a.min_y,f);c.max_y=Math.min(a.max_y,h);c.min_z=Math.max(a.min_z,k);c.max_z=Math.min(a.max_z,b);
return c};a.cV=function(a,b,c){c||(c=d());var p=a.max_x-a.min_x,y=a.max_y-a.min_y,f=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-1)*p;c.max_x=a.max_x+.5*(b-1)*p;c.min_y=a.min_y-.5*(b-1)*y;c.max_y=a.max_y+.5*(b-1)*y;c.min_z=a.min_z-.5*(b-1)*f;c.max_z=a.max_z+.5*(b-1)*f;return c};a.lo=function(a,b,d){d||(d=B());f.transform_vec3(a.M,b,d.M);b=f.get_scale(b);d.Wa=a.Wa*(0>b?-b:b);return d};a.ko=function(a,b,d){d||(d=v());f.transform_vec3(a.M,b,d.M);u.copy(a.Ea,d.Ea);u.copy(a.Fa,d.Fa);u.copy(a.Ga,d.Ga);f.transform_dir_vec3(d.Ea,
b,d.Ea);f.transform_dir_vec3(d.Fa,b,d.Fa);f.transform_dir_vec3(d.Ga,b,d.Ga);return d};a.mv=function(a,b,d){d||(d=c());f.transform_vec3(a.M,b,d.M);u.copy(a.Ea,d.Ea);u.copy(a.Fa,d.Fa);u.copy(a.Ga,d.Ga);f.transform_dir_vec3(d.Ea,b,d.Ea);f.transform_dir_vec3(d.Fa,b,d.Fa);f.transform_dir_vec3(d.Ga,b,d.Ga);return d};a.pv=function(a,b){var d=B();u.copy(b,d.M);d.Wa=a;return d};a.OP=function(a,b,d,f,h){var p=c();u.copy(a,p.M);u.copy(b,p.Ea);u.copy(d,p.Fa);u.copy(f,p.Ga);u.scale(p.Ea,h[0],p.Ea);u.scale(p.Fa,
h[1],p.Fa);u.scale(p.Ga,h[2],p.Ga);return p};a.fh=B;a.Hv=e;a.qg=v;a.Gv=w;a.yo=h;a.zk=function(a){var b=B();e(a,b);return b};a.fo=l;a.oJ=function(){var a;a||(a=B());u.set(0,0,0,a.M);a.Wa=1E12;return a};a.aM=function(a,b){var d=u.subtract(b.M,a.M,u.create());0==u.length(d)&&u.set(1,0,0,d);var c=u.normalize(d,u.create()),d=u.scale(c,a.Wa,u.create());u.add(d,a.M,d);var f=u.scale(c,-a.Wa,u.create());u.add(f,a.M,f);var p=u.scale(c,b.Wa,u.create());u.add(p,b.M,p);var h=u.scale(c,-b.Wa,u.create());u.add(h,
b.M,h);d=[d,f,p,h];c=u.normalize(c,u.create());f=d[0];p=d[0];for(h=1;h<d.length;h++){var k=u.dot(d[h],c);k<u.dot(f,c)&&(f=d[h]);k>u.dot(p,c)&&(p=d[h])}c=[f,p];d=c[0];c=c[1];a.M=u.scale(u.add(d,c,u.create()),.5,u.create());a.Wa=u.length(u.subtract(c,d,u.create()))/2};a.jw=function(a,b){u.add(a.M,a.Fa,D);u.add(D,a.Ea,D);u.add(D,a.Ga,D);b.push(D[0],D[1],D[2]);u.add(a.M,a.Fa,D);u.add(D,a.Ea,D);u.subtract(D,a.Ga,D);b.push(D[0],D[1],D[2]);u.add(a.M,a.Fa,D);u.subtract(D,a.Ea,D);u.add(D,a.Ga,D);b.push(D[0],
D[1],D[2]);u.add(a.M,a.Fa,D);u.subtract(D,a.Ea,D);u.subtract(D,a.Ga,D);b.push(D[0],D[1],D[2]);u.subtract(a.M,a.Fa,D);u.add(D,a.Ea,D);u.add(D,a.Ga,D);b.push(D[0],D[1],D[2]);u.subtract(a.M,a.Fa,D);u.add(D,a.Ea,D);u.subtract(D,a.Ga,D);b.push(D[0],D[1],D[2]);u.subtract(a.M,a.Fa,D);u.subtract(D,a.Ea,D);u.add(D,a.Ga,D);b.push(D[0],D[1],D[2]);u.subtract(a.M,a.Fa,D);u.subtract(D,a.Ea,D);u.subtract(D,a.Ga,D);b.push(D[0],D[1],D[2])};a.Br=x;a.yK=function(a){var b=c();u.copy(a.Ea,b.Ea);u.copy(a.Fa,b.Fa);u.copy(a.Ga,
b.Ga);u.copy(a.M,b.M);return b};a.Lo=function(a){var b=B(),d;d=u.length(a.Ea);var c=u.length(a.Fa),f=u.length(a.Ga);d=d>c?d:c;b.M=a.M;b.Wa=f>d?f:d;return b};a.BJ=function(a,b){var d=h(a),c=f.ec(b,t);u.subtract(d.M,c,d.M);return d};a.Gs=function(a,b){var d=u.length(a.Ea),c=u.length(a.Fa),f=u.length(a.Ga);return.75*b.Wa*b.Wa*b.Wa>d*c*f};a.rA=function(a,b){var d=b.max_z,c=b.min_z;return{Wa:a,height:Math.max(0,d-c-2*a),M:new Float32Array([0,0,(d+c)/2])}};a.tA=function(a,b){var d=b.max_z,c=b.min_z;return{Wa:a,
height:Math.max(0,d-c),M:new Float32Array([0,0,(d+c)/2])}};a.sA=function(a,b){var d=b.max_z,c=b.min_z;return{Wa:a,height:Math.max(0,d-c),M:new Float32Array([0,0,(d+c)/2])}};a.sT=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.tP=function(a){for(var b=0,d=0,c=0,f=0,h=0,k=0,m,p,K,t,g,e,A=0,r=0,l=0;l<a.submeshes.length;l++){var n=a.submeshes[l];if(n.position.length){b=f=n.position[0];d=h=n.position[1];c=k=n.position[2];
break}}for(l=0;l<a.submeshes.length;l++){var n=a.submeshes[l],L=n.position;m=t=n.position[0];p=g=n.position[1];K=e=n.position[2];for(var u=0;u<L.length/3;u++){var w=L[3*u],v=L[3*u+1],z=L[3*u+2],b=Math.max(w,b),d=Math.max(v,d),c=Math.max(z,c),f=Math.min(w,f),h=Math.min(v,h),k=Math.min(z,k);m=Math.max(w,m);p=Math.max(v,p);K=Math.max(z,K);t=Math.min(w,t);g=Math.min(v,g);e=Math.min(z,e);A=Math.max(Math.sqrt(w*w+v*v+z*z),A);r=Math.max(Math.sqrt(w*w+v*v),r)}L=n.boundings.bb;L.max_x=m;L.min_x=t;L.max_y=
p;L.min_y=g;L.max_z=K;L.min_z=e;L=J;L[0]=t;L[1]=g;L[2]=e;L[3]=m;L[4]=g;L[5]=e;L[6]=m;L[7]=p;L[8]=e;L[9]=t;L[10]=p;L[11]=e;L[12]=t;L[13]=g;L[14]=K;L[15]=m;L[16]=g;L[17]=K;L[18]=m;L[19]=p;L[20]=K;L[21]=t;L[22]=p;L[23]=K;m=x(L,!1);n.boundings.be_cen=m.M;n.boundings.be_ax=[m.Ea[0],m.Fa[1],m.Ga[2]]}l=a.b4w_boundings.bb;l.max_x=b;l.min_x=f;l.max_y=d;l.min_y=h;l.max_z=c;l.min_z=k;l=a.b4w_boundings.bb_src;l.max_x=b;l.min_x=f;l.max_y=d;l.min_y=h;l.max_z=c;l.min_z=k;a.b4w_boundings.bs_rad=A;a.b4w_boundings.bc_rad=
r;L=J;L[0]=f;L[1]=h;L[2]=k;L[3]=b;L[4]=h;L[5]=k;L[6]=b;L[7]=d;L[8]=k;L[9]=f;L[10]=d;L[11]=k;L[12]=f;L[13]=h;L[14]=c;L[15]=b;L[16]=h;L[17]=c;L[18]=b;L[19]=d;L[20]=c;L[21]=f;L[22]=d;L[23]=c;m=x(L,!1);a.b4w_boundings.be_cen=m.M;a.b4w_boundings.be_ax=[m.Ea[0],m.Fa[1],m.Ga[2]]};a.hN=function(a){var b=a.subarray(0,3),d=a.subarray(6,9),c=a.subarray(12,15),f=a.subarray(18,21);a=u.subtract(d,b,D);u.normalize(a,a);var h=F.rN(b,d,c,H),h=u.cross(h,a,h);u.normalize(h,h);var m=u.create(),p=u.create();u.subtract(d,
b,C);p[0]=u.dot(C,a);p[1]=u.dot(C,h);d=u.create();u.subtract(c,b,C);d[0]=u.dot(C,a);d[1]=u.dot(C,h);c=u.create();u.subtract(f,b,C);c[0]=u.dot(C,a);c[1]=u.dot(C,h);f=B();c=[m,p,d,c];m=k(f,c[0],c[1]);for(f=2;f<c.length;f++)if(u.distance(m.M,c[f])>m.Wa){for(var t=m,m=c,p=c[f],d=f-1,t=k(t,p,m[0]),K=1;K<=d;K++)if(u.distance(t.M,m[K])>t.Wa){for(var g=t,t=m,e=p,l=m[K],A=K-1,g=k(g,e,l),r=0;r<=A;r++)if(u.distance(g.M,t[r])>g.Wa){var n=e,w=l,L=t[r],v=u.subtract(w,L,C),v=u.squaredLength(v),aa=u.subtract(n,L,
C),x=u.squaredLength(aa),aa=u.subtract(n,w,C),z=u.squaredLength(aa),aa=v*(x+z-v),I=x*(z+v-x),v=z*(v+x-z),x=aa+I+v;u.copy(n,g.M);u.scale(g.M,aa/x,g.M);u.scaleAndAdd(g.M,w,I/x,g.M);u.scaleAndAdd(g.M,L,v/x,g.M);g.Wa=u.distance(g.M,n)}t=g}m=t}f=m;a=u.scale(a,f.M[0],C);u.scaleAndAdd(a,h,f.M[1],a);u.add(a,b,f.M);return f}};b4w.module.__compat=function(a,q){function d(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function c(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var g=q("__config"),n=q("__debug"),B=q("__extensions"),
e=q("__print"),v=q("__renderer"),w="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.Oz=256;var h=g.nk,l=g.H,x=g.Jk,k=g.context,f=g.pg,F=g.Y,u=g.J,r=g.rd;a.IL=function(a){a.getError()==a.INVALID_ENUM&&e.warn("Possible Tegra invalid enum issue detected, ignoring")};a.lE=function(z,J){function D(a){J&&e.warn(a)}f.EO=z.getParameter(z.MAX_COMBINED_TEXTURE_IMAGE_UNITS);
f.kx=z.getParameter(z.MAX_FRAGMENT_UNIFORM_VECTORS);f.ox=z.getParameter(z.MAX_TEXTURE_IMAGE_UNITS);f.Ws=z.getParameter(z.MAX_VARYING_VECTORS);f.px=z.getParameter(z.MAX_VERTEX_ATTRIBS);f.gD=z.getParameter(z.MAX_VERTEX_TEXTURE_IMAGE_UNITS);f.Xs=z.getParameter(z.MAX_VERTEX_UNIFORM_VECTORS);f.pi=z.getParameter(z.MAX_CUBE_MAP_TEXTURE_SIZE);f.lx=z.getParameter(z.MAX_RENDERBUFFER_SIZE);f.tc=z.getParameter(z.MAX_TEXTURE_SIZE);f.qx=z.getParameter(z.MAX_VIEWPORT_DIMS);f.ej=l.Rb?24:16;d("Macintosh")&&(D("macOS detected, applying depth hack"),
f.ej=24);l.Rb&&!x.enabled&&(l.Go=!0);l.Rb?(l.uc=Math.min(l.uc,z.getParameter(z.MAX_SAMPLES)),d("Firefox")&&(D("Firefox and WebGL 2 detected, applying framebuffer hack."),l.PA=!0),d("Windows")&&d("Chrome")&&(D("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),l.uc=1)):l.uc=1;d("Firefox")&&"NONE"!==l.stereo&&(D("Firefox and Stereo rendering detected, disable texture reusage"),l.IB=!0);if(l.Rb&&n.aK()||d("Firefox"))D("Firefox detected, disabling multisample"),l.uc=1;
v.gQ();var H=!!B.ZM();d("Firefox/28.0")&&(d("Linux")||d("Macintosh"))&&(D("Firefox 28 detected, applying depth hack"),H=!1);d("Windows Phone")||(d("iPad")||d("iPhone")?(D("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),k.alpha||(l.background_color[3]=1),l.aE=!0,l.Es=!0,l.TF=!0,l.smaa=!1,l.ssao=!1,l.precision="highp",l.Qw=!0,B.iC()&&r.Bt&&(l.Ho="pvr")):d("Mac OS X")&&
d("Safari")&&!d("Chrome")&&(D("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),l.$D=!0,F.mA=!0,F.WA=!0));d("Windows")&&(d("Chrome/40")||d("Firefox/33")||d("Firefox/34")||d("Firefox/35")||d("Firefox/36"))&&(D("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),l.zv=!0);d("Chrome")&&!c()&&g.EC()&&(D('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),
l.VA=!0);d("Mac OS X")&&(l.Us=!0,D("OS X detected, applying shadows hack."));c()&&(D("Mobile detected, applying various hacks for video textures."),l.is_mobile_device=!0,d("iPad")||d("iPhone")||d("Windows Phone")||(D("Mobile (not iOS) detected, disable playback rate for video textures."),F.zB=!0));(d("Firefox/35.0")||d("Firefox/36.0"))&&d("Windows")&&(D("Windows/Firefox 35/36 detected, applying shadows slink hack"),l.AE=!0);if(d("iPhone")||b()||d("Edge"))D("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),
l.cq=!0;10>f.Ws&&(D("Not enough varyings, disable shadows on blend objects"),l.Zv=!0);d("Windows Phone")&&(D("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),l.debug_view=!1,l.precision="highp",l.hi=!1,l.ssao=!1,l.smaa=!1,l.shadows=!1,l.reflections=!1,l.refractions=!1,l.KD=!1);if(d("UCBrowser")||d("Chrome")&&d("Nexus")&&l.is_mobile_device)D("Mobile Nexus Chrome or UCBrowser detected, disable workers."),u.yn=!1;d("Firefox")&&d("Linux")&&
(D("Firefox and Linux detected, disable workers."),u.yn=!1);var C=B.get_renderer_info();if(C){var t=z.getParameter(C.UNMASKED_VENDOR_WEBGL),C=z.getParameter(C.UNMASKED_RENDERER_WEBGL),m=/\b4\d{2}\b/;-1<C.indexOf("AMD")&&d("Windows")&&d("Chrome")&&(D("AMD, Windows and Chrome detected, applying depth hack"),H=!1);-1<t.indexOf("ARM")&&m.test(C)&&(D("ARM Mali-400 series detected, applying depth and frames blending hacks"),H=!1,h.MB=!0);-1<t.indexOf("ARM")&&-1<C.indexOf("Mali-T604")&&(D('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),
l.precision="highp",l.shadows=!1);-1<t.indexOf("ARM")&&-1<C.indexOf("Mali-T760")&&(D('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),l.precision="highp",l.ssao=!1,l.Nt=!0,l.Rb&&(l.uc=1,D("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));-1<t.indexOf("Qualcomm")&&-1<C.indexOf("Adreno")&&(D("Qualcomm Adreno detected, applying shader constants hack."),l.py=!0,-1<C.indexOf("305")&&(D('Qualcomm Adreno305 detected, set "highp" precision.'),l.precision="highp"),-1<C.indexOf("330")&&
(D('Qualcomm Adreno330 detected, set "highp" precision.'),l.precision="highp"),-1<C.indexOf("420")&&(D("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),f.tc=4096,f.pi=4096));-1<t.indexOf("NVIDIA")&&-1<C.indexOf("Tegra 3")&&(D("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),l.KB=!0);d("Windows")&&d("Chrome")&&!d("Edge")&&(C.match(/NVIDIA GeForce 8..0/)||C.match(/NVIDIA GeForce 9..0/)||C.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&
(D("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),f.pi=a.Oz,l.by=!0);-1<C.indexOf("PowerVR")&&(D("PowerVR series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),l.by=!0,l.Nt=!0,l.shadows=!1);t="";for(m=0;m<w.length;m++)if(-1<C.indexOf(w[m])){t=w[m];break}t&&(D("Architecture "+t+" detected. Blending between frames and shadows on blend objects will be disabled."),
l.Nt=!0,l.Zv=!0)}0==f.gD&&(D("Vertex textures are not allowed. Disabling vertex textures"),l.cr=!1);H||(l.sm=!1,l.yc=!1,l.water_dynamic=!1,l.shore_smoothing=!1,l.an=!1,l.smaa=!1);l.GF=!!B.jC()||"pvr"==l.Ho;l.Mr=H;if(z.getShaderPrecisionFormat)var A=z.getShaderPrecisionFormat(z.FRAGMENT_SHADER,z.HIGH_FLOAT);z.getShaderPrecisionFormat&&0!==A.precision||(l.precision="mediump");if(b()&&d("Touch")||d("Edge"))D("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),
l.Uk=!0;if(b()||d("Edge"))l.yC=!0;c()&&d("Firefox")&&(e.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),l.sx=!0,f.tc=4096,f.pi=4096);d("Edge")&&(D("Microsoft Edge detected, set up new minimal texture size."),l.Yo=!0)};a.xv=d;a.detect_mobile=c;a.ZI=function(){d("Firefox/35.0")&&d("Windows")&&(e.warn("Windows/Firefox 35 detected, forcing context's alpha"),g.context.alpha=!0)};a.is_ie11=b};b4w.module.__constraints=function(a,q){function d(a){var b={};b.type=a;return b}function c(a,d){a.cc&&a.cc.Ca&&b(a.cc.Ca,a);if(d.Ca){var c=d.Ca;-1==c.ve.indexOf(a)?c.ve.push(a):f.D("Descendant object override is forbidden")}a.cc=d}function b(a,b){var d=a.ve.indexOf(b);-1!=d?a.ve.splice(d,1):f.D("No descendant object")}function g(a,b,d){switch(b.type){case 1:var c=k.get_quat_view(a.o.v),p=b.Ca.o.v;d=k.get_quat_view(b.Ca.o.v);b.Fd?(x.copy(b.Fd,c),x.multiply(d,c,c)):x.copy(d,c);var g=k.transform_vec3(b.offset,
p,z);k.set_trans(g,a.o.v);g=k.get_scale(b.Ca.o.v);k.set_scale(b.Zp*g,a.o.v);break;case 9:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);p=b.Ca.o.v;d=k.get_quat_view(b.Ca.o.v);x.multiply(x.invert(b.sl,b.sl),c,c);x.multiply(d,c,c);k.transform_vec3(b.offset,p,g);x.copy(d,b.sl);break;case 10:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);p=b.Ca.o.v;d=k.get_quat_view(b.Ca.o.v);x.multiply(x.invert(b.sl,b.sl),c,c);x.multiply(d,c,c);k.transform_vec3(b.offset,p,g);x.copy(d,b.sl);g=k.get_quat_view(a.o.v);
c=k.get_quat_view(b.Ca.o.v);c=x.multiply(c,b.Fd,C);c=w.rw(c,u);g=w.rw(g,r);w.ey(a,f.xk(g[0],c[0]+b.fK,c[0]+b.eK),f.xk(g[1],c[1]+b.dK,c[1]+b.gK));break;case 13:var g=k.get_trans_view(a.o.v),c=k.get_quat_view(a.o.v),p=b.Ca.o.v,E=k.get_trans_view(p),y=b.PQ,l=z,K=C;k.transform_vec3(b.offset,p,l);f.smooth_v(l,g,d,y,g);p=z;F.sub(E,g,p);F.normalize(p,p);var n=c,g=t,E=g.subarray(0,3),l=g.subarray(3,6),Q=g.subarray(6,9);F.copy(p,Q);F.negate(Q,Q);F.normalize(Q,Q);.999999<Math.abs(F.dot(p,f.AXIS_Z))?(p=h.fromQuat(x.normalize(n,
K),m),F.copy(p.subarray(0,3),E)):F.cross(f.AXIS_Z,Q,E);F.normalize(E,E);F.cross(Q,E,l);F.normalize(l,l);x.fromMat3(g,K);x.normalize(K,K);f.JE(K,c,d,.16*y,c);break;case 2:c=k.get_quat_view(a.o.v);d=A;v.get_bone_tsr(b.Ca,b.vk,!0,!1,d);k.multiply(b.Ca.o.v,d,d);c[0]=d[4];c[1]=d[5];c[2]=d[6];c[3]=d[7];b.Fd&&(x.copy(b.Fd,c),x.multiply(c,b.Fd,c));k.set_scale(b.Zp*d[3],a.o.v);g=k.get_trans_view(a.o.v);k.transform_vec3(b.offset,d,g);break;case 3:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);d=k.get_trans_view(b.Ca.o.v);
B(g,c,d);break;case 4:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);d=b.target;B(g,c,d);break;case 5:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);d=k.get_trans_view(b.Ca.o.v);B(g,c,d);c=F.dist(g,d);if(c=c>b.dist_max?c-b.dist_max:c<b.Uo?c-b.Uo:0)F.sub(d,g,z),F.normalize(z,z),F.scale(z,c,z),F.add(g,z,g);break;case 6:g=k.get_trans_view(a.o.v);c=k.get_quat_view(a.o.v);d=b.target;B(g,c,d);c=F.dist(g,d);if(c=c>b.dist_max?c-b.dist_max:c<b.Uo?c-b.Uo:0)F.sub(d,g,z),F.normalize(z,z),F.scale(z,c,
z),F.add(g,z,g);break;case 7:p=b.Ca.o.v;g=k.get_trans_view(a.o.v);k.transform_vec3(b.offset,p,g);break;case 8:E=k.get_trans_view(b.Ca.o.v);g=k.get_trans_view(a.o.v);F.add(E,b.offset,g);break;case 14:c=k.get_quat_view(a.o.v);p=b.Ca.o.v;d=k.get_quat_view(b.Ca.o.v);b.Fd?(x.copy(b.Fd,c),x.multiply(d,c,c)):x.copy(d,c);g=k.get_trans_view(a.o.v);k.transform_vec3(b.offset,p,g);break;case 11:k.multiply(b.Ca.o.v,b.iu,a.o.v);break;case 12:g=b.iu;d=A;v.get_bone_tsr(b.Ca,b.vk,!0,!1,d);k.multiply(b.Ca.o.v,d,d);
k.multiply(d,g,a.o.v);break;case 15:c=b.Ca,d=w.bN(c),g=k.get_trans_view(a.o.v),p=w.hs(d,"LEFT"),E=w.hs(d,"RIGHT"),y=w.hs(d,"TOP"),K=w.hs(d,"BOTTOM"),l="heights"==b.hor_units?y-K:E-p,g[0]=b.WC?p+l*b.bx:E-l*b.bx,p="heights"==b.vert_units?y-K:E-p,g[1]=b.lF?y-p*b.Oy:K+p*b.Oy,w.TN(d)?g[2]=-b.distance:(g[2]=-1,F.normalize(g,g),F.scale(g,b.distance/Math.abs(g[2]),g)),k.transform_dir_vec3(g,c.o.v,g),d=k.get_trans_view(c.o.v),F.add(d,g,g),g=k.get_quat_view(a.o.v),c=k.get_quat_view(c.o.v),b.Fd?(x.copy(b.Fd,
g),x.multiply(c,g,g)):x.copy(c,g)}"CAMERA"==a.o.type&&a.o.kb!=w.MS_STATIC&&(g=a.o.sf,10==b.type&&(d=k.get_quat_view(b.Ca.o.v),g=F.transformQuat(g,d,I)),w.bz(a),e(a,g))}function n(a,b){switch(b.type){case 1:var d=b.target.o.v,c=A;k.invert(a.o.v,c);k.multiply(c,d,c);v.set_bone_tsr(a,b.vk,c,!1)}a.Bx=!0}function B(a,b,d){var c=z;f.quat_to_dir(b,f.AXIS_MZ,c);F.normalize(c,c);var h=J;F.subtract(d,a,h);F.normalize(h,h);a=f.iy(c,h,H);x.multiply(a,b,b);x.normalize(b,b)}function e(a,b,d){var c=a.o,h=k.get_quat_view(c.v),
m=f.quat_to_dir(h,f.AXIS_Z,z);F.normalize(m,m);if(.999999<Math.abs(F.dot(b,m)))m=x.identity(C);else{var g=F.cross(b,m,J);F.normalize(g,g);c.kb==w.MS_TARGET_CONTROLS?c.Yj&&F.negate(g,g):(c=f.quat_to_dir(h,f.AXIS_MY,D),0<F.dot(c,b)&&F.negate(g,g));c=f.quat_to_dir(h,f.AXIS_X,D);F.normalize(c,c);var t=f.clamp(F.dot(c,g),-1,1),m=-.999999>=t?x.setAxisAngle(m,Math.acos(t),C):x.rotationTo(c,g,C);x.normalize(m,m)}x.multiply(m,h,h);d&&(d=f.quat_to_dir(h,f.AXIS_Y,z),0>F.dot(b,d)&&x.rotateZ(h,Math.PI,h));w.bz(a)}
var v=q("__armature"),w=q("__camera"),h=q("__mat3"),l=q("__print"),x=q("__quat"),k=q("__tsr"),f=q("__util"),F=q("__vec3");a.MS=1;a.LS=2;a.QS=3;a.RS=4;a.GS=5;a.HS=6;a.NS=7;a.FS=8;a.KS=9;a.JS=10;a.DS=11;a.ES=12;a.IS=13;a.OS=14;a.PS=15;a.CS=1;var u=new Float32Array(2),r=new Float32Array(2),z=new Float32Array(3),J=new Float32Array(3),D=new Float32Array(3),H=new Float32Array(4),C=new Float32Array(4),t=new Float32Array(9),m=new Float32Array(9),A=k.create(),I=new Float32Array(3);a.fA=function(a,b,f,h,m){var k=
d(1);k.Ca=b;k.offset=new Float32Array(f);k.Fd=h?new Float32Array(h):null;k.Zp=m;c(a,k);g(a,k,0)};a.RI=function(a,b,f,h,m,k){var t=d(2);t.Ca=b;t.vk=f;t.offset=new Float32Array(h);t.Fd=m?new Float32Array(m):null;t.Zp=k;c(a,t);g(a,t,0)};a.OI=function(a,b,f,h){var m=d(9),t=k.get_quat_view(a.o.v),E=k.get_quat_view(b.o.v);m.Ca=b;m.offset=new Float32Array(f);m.sl=new Float32Array(E);h&&(x.copy(h,t),x.multiply(E,t,t));c(a,m);g(a,m,0)};a.NI=function(a,b,h,m,t,e,E,l){var p=d(10),K=k.get_quat_view(a.o.v),y=
k.get_quat_view(b.o.v);p.Ca=b;p.offset=new Float32Array(h);p.sl=new Float32Array(y);p.eK=f.angle_wrap_0_2pi(t);p.fK=f.angle_wrap_0_2pi(e);p.gK=f.angle_wrap_periodic(E,-Math.PI,Math.PI);p.dK=f.angle_wrap_periodic(l,-Math.PI,Math.PI);m?(p.Fd=new Float32Array(m),x.copy(m,K),x.multiply(y,K,K)):p.Fd=x.create();c(a,p);g(a,p,0)};a.MI=function(a,b,f,h){var m=d(13);m.Ca=b;m.offset=new Float32Array(f);m.PQ=h;c(a,m);g(a,m,0)};a.UI=function(a,b,f,h){var m=d(14);m.Ca=b;m.offset=new Float32Array(f);m.Zp=1;m.Fd=
h?new Float32Array(h):null;c(a,m);g(a,m,0)};a.NU=b;a.VI=function(a,b){var f=d(3);f.Ca=b;c(a,f);g(a,f,0)};a.WI=function(a,b){var f=d(4);f.target=new Float32Array(b);c(a,f);g(a,f,0)};a.II=function(a,b,f,h){var m=d(5);m.Ca=b;m.Uo=f;m.dist_max=h;c(a,m);g(a,m,0)};a.JI=function(a,b,f,h){var m=d(6);m.target=new Float32Array(b);m.Uo=f;m.dist_max=h;c(a,m);g(a,m,0)};a.TI=function(a,b,f){var h=d(7);h.Ca=b;h.offset=new Float32Array(f);c(a,h);g(a,h,0)};a.FI=function(a,b,f){var h=d(8);h.Ca=b;h.offset=new Float32Array(f);
c(a,h);g(a,h,0)};a.DI=function(a,b,f){var h=d(11);h.Ca=b;h.iu=new Float32Array(f);c(a,h);g(a,h,0)};a.EI=function(a,b,f,h){var m=d(12);m.Ca=b;m.vk=f;m.iu=new Float32Array(h);c(a,m);g(a,m,0)};a.append_stiff_viewport=function(a,b,h){var m=d(15);m.Ca=b;if(f.Lf(h.left))m.WC=!0,m.bx=h.left;else if(f.Lf(h.right))m.WC=!1,m.bx=h.right;else{l.error("append_stiff_viewport: Wrong positioning params");return}if(f.Lf(h.top))m.lF=!0,m.Oy=h.top;else if(f.Lf(h.bottom))m.lF=!1,m.Oy=h.bottom;else{l.error("append_stiff_viewport: Wrong positioning params");
return}f.Lf(h.distance)?(m.distance=h.distance,f.Lf(h.rotation)?m.Fd=new Float32Array(h.rotation):m.Fd=null,f.Lf(h.hor_units)?m.hor_units=h.hor_units:m.hor_units="widths",f.Lf(h.vert_units)?m.vert_units=h.vert_units:m.vert_units="heights",c(a,m),g(a,m,0)):l.error("append_stiff_viewport: Wrong positioning params")};a.IR=function(a,b){a.cc&&g(a,a.cc,b)};a.SI=function(a,b,c,f,h){var m=d(1);m.vk=c;m.target=b;m.offset=new Float32Array(f);m.Fd=h?new Float32Array(h):null;m.Zp=1;b=m.target;c=m.vk;f=a.o.zf[c];
h=b.Fv;for(var k=0;k<h;k++){var g=h[k];if(g[0]==a&&g[1]==c){h.splice(k,1);break}}b.Fv.push([a,c]);f.cc=m;n(a,m)};a.DR=function(a,b){var d=a.o.zf[b];d.cc&&n(a,d.cc)};a.QP=B;a.correct_up=e;a.VJ=function(a){return a.cc?!0:!1};a.remove=function(a){a.cc.Ca&&b(a.cc.Ca,a);a.cc=null};a.iU=function(a){return a.cc?a.cc.type:null};a.Hf=function(a){a=a.cc;return!a||11!=a.type&&12!=a.type?!1:!0};a.gs=function(a){if((a=a.cc)&&11==a.type)return a.Ca.o.v;if(a&&12==a.type){var b=A;v.get_bone_tsr(a.Ca,a.vk,!0,!1,b);
k.multiply(a.Ca.o.v,b,b);return b}return null};a.Gf=function(a){a=a.cc;return!a||11!=a.type&&12!=a.type?null:a.iu}};b4w.module.__container=function(a,q){var d,c,b;function g(){C.getBoundingClientRect()}function n(a,b,d,c){J.Uk?(c[0]=a,c[1]=b):(A.clientX=a,A.clientY=b,a=new MouseEvent("b4w_convert",A),d.dispatchEvent(a),c[0]=a.offsetX,c[1]=a.offsetY);return c}function B(){return J.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function e(a,b,d,c){a.style.width=d+"px";a.style.height=c+"px";b&&(b.style.width=d+"px",b.style.height=c+"px")}function v(b,d,c){if(!b||!d){b=a.Iu;d=a.Hu;var h=m;h.style.width=a.Iu+"px";h.style.height=
a.Hu+"px"}var h=C,g=t;c&&e(h,g,b,d);g&&(g.width=b,g.height=d,x.uq());c=Math.floor(b*J.canvas_resolution_factor);d=Math.floor(d*J.canvas_resolution_factor);B()&&(c*=window.devicePixelRatio,d*=window.devicePixelRatio);if(g=f.nh())g=g.F,c=Math.floor(c*g.Xm),d=Math.floor(d*g.Xm);h.width=c;h.height=d;var g=Math.min(H.drawingBufferWidth,D.lx,D.qx[0]),A=Math.min(H.drawingBufferHeight,D.lx,D.qx[1]);if(c>g||d>A)k.warn("Canvas size exceeds platform limits, downscaling"),g=Math.min(g/c,A/d),c*=g,d*=g,h.width=
c,h.height=d;f.sE(c,d,c/b);f.xa()&&r.L(f.get_active().Ui);l.MR(h.width,h.height);l.is_primary_loaded()&&(w.update(),f.update(u.get_timeline(),0),w.EF())}var w=q("__anchors"),h=q("__config"),l=q("__data"),x=q("__hud"),k=q("__print"),f=q("__scenes"),F=q("__subscene"),u=q("__time"),r=q("__transform"),z=q("__util"),J=h.H,D=h.pg,H=null,C=null,t=null,m=null,A={clientX:0,clientY:0};c=d=0;b=1;a.Iu=320;a.Hu=240;a.mf=function(a){H=a};a.get_canvas=function(){return C};a.get_canvas_hud=function(){return t};a.get_container=
function(){return m};a.init=function(a,b){a&&a.parentNode?(C=a,t=b,m=a.parentNode):z.D("canvas container is not available")};a.insert_to_container=function(a,b){b=b||"LAST";switch(b){case "FIRST":m.insertBefore(a,m.firstElementChild);break;case "JUST_BEFORE_CANVAS":m.insertBefore(a,C);break;case "JUST_AFTER_CANVAS":C.nextElementSibling?m.insertBefore(a,C.nextElementSibling):m.appendChild(a,C);break;case "LAST":m.appendChild(a,C);break;default:k.error(b+" invalid stack order")}};a.oC=function(){return d};
a.nC=function(){return c};a.set_canvas_offsets=function(){};a.update_canvas_offsets=g;a.GQ=function(a,f,h){d=a;c=f;b=h;g()};a.force_offsets_updating=function(){};a.client_to_canvas_coords=function(a,b,d){return n(a,b,C,d)};a.client_to_element_coords=n;a.po=function(a,c,f,h){f||(f=new Float32Array(2));f[0]=a*b;f[1]=c*b;h&&(a=h.width/d,f[0]*=a,f[1]*=a);return f};a.rS=function(a,c,f,h){f||(f=new Float32Array(2));f[0]=a/b;f[1]=c/b;h&&(a=h.width/d,f[0]/=a,f[1]/=a)};a.FC=function(b){return b&&b.parentNode?
b.parentNode==m?!0:a.FC(b.parentNode):!1};a.PN=B;a.pM=function(a){var b=document.getElementsByTagName("script");a=z.yh(a);for(var d=0;d<b.length;d++)if(b[d].src==a)return b[d];return null};a.resize=v;a.resize_to_container=function(a){var b=m,d=C,c=b.clientWidth,b=b.clientHeight;if(a||c!=d.clientWidth||b!=d.clientHeight){a=d.width;d=d.height;e(C,t,c,b);if(f.xa()){var h=f.get_active();if((h=f.Aa(h,F.uf))&&h.enable_hmd_stereo){v(a,d,!1);return}}v(c,b,!1)}};a.reset=function(){m=t=C=H=null}};b4w.module.__controls=function(a,q){function d(a,b){b||(b=x.get_container());return{type:a,value:0,$:null,element:b,Ia:!1,key:0,Ub:"",ah:!1,Dv:null,Cv:function(){},Bv:null,$A:function(){},Eh:null,from:new Float32Array(3),to:new Float32Array(3),CC:!1,Bs:!1,Up:0,OD:function(){},axis:"",rf:0,rn:new Float32Array(3),Ct:new Float32Array(4),threshold:0,LD:new Float32Array(4),hr:0,gr:0,ZD:0,ir:0,kf:0,repeat:!1,DB:!1,gamepad_id:0,callback:function(){}}}function c(a){function b(){return{cj:new Float32Array(2),
cl:!0,obj:null,identifier:-1,Ls:!0}}a||(a=x.get_container());for(var d=0;d<Q.length;d++){var c=Q[d];if(a==c.element)return c}c={element:a,vp:!0,fe:0,Ms:!0,bt:0,dt:0,ll:0,ml:0,Op:0,Pp:0,Rg:new Float32Array(2),Sd:new Float32Array(2),Sg:new Float32Array(2),je:new Float32Array(2),gu:0,Wy:0,mF:0,ze:new Uint8Array(256),Au:0,Gw:null,wh:b(),Fl:Array(10),Ww:!1,rC:r.create(),ss:0,rs:0,qs:0,Jw:0,Iw:0,ps:Infinity,Hx:null,Gx:null,xx:null,tx:null,vx:null,Uy:null,Ty:null,wx:null,ux:null,Px:null,BU:null,Vy:null,
Sy:null,Ry:null,xi:{}};for(d=0;10>d;++d)c.Fl[d]=b();c.Hx=function(a){c.Ww||(k.AN(a,c.rC),c.Ww=!0)};c.Gx=function(a){a=H.copy(a,R);c.qs=a[0];c.rs=a[1];c.ss=a[2];Infinity==c.ps&&(c.ps=a[0],c.Iw=a[1],c.Jw=a[2])};c.xx=function(a){c.Au+=a*C.LO};c.tx=function(a){var b=k.get_device_by_type_element(k.DEVICE_MOUSE,c.element),b=k.get_vector_param(b,k.MOUSE_LOCATION,y);c.bt=b[0];c.dt=b[1];c.ll=b[0];c.ml=b[1];if(3==c.fe||0==c.fe)c.fe=1;c.which=a};c.vx=function(){var a=k.get_device_by_type_element(k.DEVICE_MOUSE,
c.element),a=k.get_vector_param(a,k.MOUSE_LOCATION,y),a=x.client_to_canvas_coords(a[0],a[1],y);c.wh.cl=!1;c.wh.cj[0]=a[0];c.wh.cj[1]=a[1]};c.Uy=function(a){for(var b=0;b<a.length;++b){for(var d=a[b],f=null,h=null,m=0;m<c.Fl.length;m++){var g=c.Fl[m];if(g.identifier==d.identifier){g.Ls&&(h=g);break}else!f&&g.Ls&&(f=g,f.identifier=d.identifier)}if(d=h||f)f=x.client_to_canvas_coords(a[b].clientX,a[b].clientY,y),d.cl=!1,d.Ls=!1,d.cj[0]=f[0],d.cj[1]=f[1]}};c.Ty=function(a){for(var b=0;b<c.Fl.length;++b){for(var d=
c.Fl[b],f=!1,h=0;h<a.length;++h)if(a[h].identifier==d.identifier){f=!0;break}f||(d.cl=!0,d.Ls=!0,d.obj=null)}};c.wx=function(a){var b=k.get_device_by_type_element(k.DEVICE_MOUSE,c.element),b=k.get_vector_param(b,k.MOUSE_LOCATION,y);c.bt=b[0];c.dt=b[1];c.ll=b[0];c.ml=b[1];0<c.fe&&(c.fe=3);c.which=a};c.ux=function(a){if(!t.Uk||c.fe)c.ll=a[0],c.ml=a[1]};c.Px=function(a){if(!t.Uk||c.fe)c.Op+=a[0],c.Pp+=a[1]};c.PC=function(a){2!=c.ze[a]&&(c.ze[a]=1,c.vp=!1)};c.RC=function(){for(var a=0;a<c.ze.length;a++)0!=
c.ze[a]&&(c.ze[a]=3,c.vp=!1)};c.SC=function(a){c.vp=!1;c.ze[a]=3};c.Vy=function(a){c.Ms=!1;if(1==a.length)c.Rg[0]=a[0].clientX,c.Rg[1]=-1,c.Sg[0]=a[0].clientY,c.Sg[1]=-1;else if(1<a.length){c.gu=c.Wy=w(a);c.Rg[0]=a[0].clientX;c.Rg[1]=a[1].clientX;c.Sg[0]=a[0].clientY;c.Sg[1]=a[1].clientY;var b=a[0];a=a[1];c.mF=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}c.Sd.set(c.Rg);c.je.set(c.Sg)};c.Sy=function(a){1===a.length?(c.Sd[0]=a[0].clientX,c.Sd[1]=-1,c.je[0]=a[0].clientY,c.je[1]=-1):1<a.length&&
(c.Sd[0]=a[0].clientX,c.Sd[1]=a[1].clientX,c.je[0]=a[0].clientY,c.je[1]=a[1].clientY,c.gu=w(a))};c.Ry=function(a){0==a.length&&(c.Ms=!0)};Q.push(c);return c}function b(a,b){if(b in a.xi&&0<a.xi[b])a.xi[b]+=1;else switch(a.xi[b]=1,b){case "orientation_quat":var c=k.get_device_by_type_element(k.DEVICE_GYRO);c&&k.attach_param_cb(c,k.GYRO_ORIENTATION_ANGLES,a.Hx);break;case "orientation_angles":(c=k.get_device_by_type_element(k.DEVICE_GYRO))&&k.attach_param_cb(c,k.GYRO_ORIENTATION_ANGLES,a.Gx);break;
case "mouse_wheel":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.MOUSE_WHEEL,a.xx);break;case "mouse_down_which":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.MOUSE_DOWN_WHICH,a.tx);break;case "mouse_select":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.MOUSE_DOWN_WHICH,a.vx);break;case "touch_select":if(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))k.attach_param_cb(c,k.TOUCH_START,
a.Uy),k.attach_param_cb(c,k.TOUCH_END,a.Ty);break;case "mouse_up_which":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.MOUSE_UP_WHICH,a.wx);break;case "mouse_location":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.MOUSE_LOCATION,a.ux);break;case "mouse_pointerlock":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.attach_param_cb(c,k.Hz,a.Px);break;case "keyboard_downed_keys":if(c=k.get_device_by_type_element(k.DEVICE_KEYBOARD,
a.element))k.attach_param_cb(c,k.KEYBOARD_DOWN,a.PC),k.attach_param_cb(c,k.Gz,a.RC),k.attach_param_cb(c,k.KEYBOARD_UP,a.SC);break;case "touch_start":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))&&k.attach_param_cb(c,k.TOUCH_START,a.Vy);break;case "touch_move":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))&&k.attach_param_cb(c,k.TOUCH_MOVE,a.Sy);break;case "touch_end":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))&&k.attach_param_cb(c,k.TOUCH_END,a.Ry)}}function g(a,
b){if(b in a.xi&&0<a.xi[b]&&(--a.xi[b],!a.xi[b]))switch(b){case "orientation_quat":var c=k.get_device_by_type_element(k.DEVICE_GYRO);c&&k.detach_param_cb(c,k.GYRO_ORIENTATION_QUAT,a.Hx);break;case "orientation_angles":(c=k.get_device_by_type_element(k.DEVICE_GYRO))&&k.detach_param_cb(c,k.GYRO_ORIENTATION_ANGLES,a.Gx);break;case "mouse_wheel":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.detach_param_cb(c,k.MOUSE_WHEEL,a.xx);break;case "mouse_down_which":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,
a.element))&&k.detach_param_cb(c,k.MOUSE_DOWN_WHICH,a.tx);break;case "mouse_select":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.detach_param_cb(c,k.MOUSE_DOWN_WHICH,a.vx);break;case "touch_select":if(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))k.detach_param_cb(c,k.TOUCH_START,a.Uy),k.detach_param_cb(c,k.TOUCH_END,a.Ty);break;case "mouse_up_which":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.detach_param_cb(c,k.MOUSE_UP_WHICH,a.wx);break;case "mouse_location":(c=
k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.detach_param_cb(c,k.MOUSE_LOCATION,a.ux);break;case "mouse_pointerlock":(c=k.get_device_by_type_element(k.DEVICE_MOUSE,a.element))&&k.detach_param_cb(c,k.Hz,a.Px);break;case "keyboard_downed_keys":if(c=k.get_device_by_type_element(k.DEVICE_KEYBOARD,a.element))k.detach_param_cb(c,k.KEYBOARD_DOWN,a.PC),k.detach_param_cb(c,k.Gz,a.RC),k.detach_param_cb(c,k.KEYBOARD_UP,a.SC);break;case "touch_start":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,
a.element))&&k.detach_param_cb(c,k.TOUCH_START,a.Vy);break;case "touch_move":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))&&k.detach_param_cb(c,k.TOUCH_MOVE,a.Sy);break;case "touch_end":(c=k.get_device_by_type_element(k.DEVICE_TOUCH,a.element))&&k.detach_param_cb(c,k.TOUCH_END,a.Ry)}}function n(a,b){a.value=Number(b)}function B(a){for(var b=a.zi,c=a.YP,d=0;d<b.length;d++)c[d]=b[d].value;return a.yO(c)}function e(a,b){a=a||A;var c=a.Og;if(c){var d=a.zl;if(b){var f=c[b];if(f){for(var h=
f.zi,g=0;g<h.length;g++){var k=h[g],t;t=I.indexOf(k);t=-1<t?p[t]:[];1==t.length?(v(k),k=I.indexOf(k),-1<k?(I.splice(k,1),p.splice(k,1)):D.D("Sensors cache is corrupted")):1<t.length&&t.splice(t.indexOf(f),1)}delete c[b];g=d.indexOf(f);-1<g?d.splice(g,1):D.D("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=m.indexOf(a),-1<c?m.splice(c,1):F.error("Wrong object"))}}else{d=[];for(g in c)d.push(g);for(g=0;g<d.length;g++)e(a,d[g])}E=!0}}function v(a){switch(a.type){case 90:u.remove_collision_test(a.Dv,
a.Ub,a.Cv);a.Ia=!0;break;case 100:u.clear_collision_impulse_test(a.Bv);a.Ia=!0;break;case 110:u.remove_ray_test(a.Up);a.Ia=!0;break;case 140:a.Ia=!0;break;case 20:var b=c(a.element);g(b,"keyboard_downed_keys");a.Ia=!0;break;case 30:b=c(a.element);g(b,"mouse_wheel");a.Ia=!0;break;case 40:b=c(a.element);g(b,"mouse_down_which");g(b,"mouse_up_which");g(b,"mouse_location");a.Ia=!0;break;case 260:b=c(a.element);g(b,"mouse_pointerlock");a.Ia=!0;break;case 50:b=c(a.element);g(b,"mouse_down_which");g(b,"mouse_up_which");
a.Ia=!0;break;case 60:b=c(a.element);g(b,"touch_start");g(b,"touch_move");g(b,"touch_end");a.Ia=!0;break;case 70:b=c(a.element);g(b,"touch_start");g(b,"touch_move");a.Ia=!0;break;case 75:b=c(a.element);g(b,"touch_start");g(b,"touch_move");a.Ia=!0;break;case 80:b=c(a.element);g(b,"touch_start");g(b,"touch_end");a.Ia=!0;break;case 170:b=c(a.element);g(b,"mouse_select");g(b,"touch_select");g(b,"touch_start");g(b,"touch_end");g(b,"mouse_down_which");g(b,"mouse_up_which");a.Ia=!0;break;case 180:case 190:b=
c(a.element);g(b,"orientation_angles");a.Ia=!0;break;case 200:b=c(a.element);g(b,"orientation_quat");a.Ia=!0;break;case 210:case 220:a.Ia=!0}}function w(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function h(a){return 0==a?k.get_device_by_type_element(k.Nq):1==a?k.get_device_by_type_element(k.Ju):2==a?k.get_device_by_type_element(k.Ku):k.get_device_by_type_element(k.Lu)}var l=q("__config"),x=q("__container"),k=q("__input"),f=q("__objects"),F=q("__print"),
u=q("__physics"),r=q("__quat"),z=q("__time"),J=q("__tsr"),D=q("__util"),H=q("__vec3"),C=l.controls,t=l.H,m=[],A={},I=[],p=[],Q=[],y=new Float32Array(2),Y=new Float32Array(2),R=H.create(),G=r.create(),E=!1,W=0;a.CT_POSITIVE=10;a.CT_CONTINUOUS=20;a.CT_TRIGGER=30;a.CT_SHOT=40;a.CT_LEVEL=50;a.CT_CHANGE=60;a.PL_SINGLE_TOUCH_MOVE=0;a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.PL_MULTITOUCH_MOVE_ROTATE=3;var V=1;a.update=function(b,d){for(var g=0;g<Q.length;g++){var e=Q[g];e.wh.cl||(e.wh.obj=
f.pick_object(e.wh.cj[0],e.wh.cj[1]),e.wh.cl=!0,e.Gw=e.wh.obj);for(var l=0;10>l;++l){var K=e.Fl[l];K.cl||(K.obj=f.pick_object(K.cj[0],K.cj[1]),K.cl=!0,e.Gw=K.obj)}}for(g=0;g<I.length;g++)if(e=I[g],K=b,l=d)switch(e.type){case 120:var p=e.Eh,u=J.ec(p.o.v,R),p=J.Qc(p.o.v,G),L=H.dist(e.rn,u),w=e.LD;r.invert(e.Ct,w);r.multiply(p,w,w);r.normalize(w,w);w=Math.abs(2*Math.acos(w[3]));L/=l;e.hr=D.smooth(L,e.hr,l,.3);e.$[0]=L;L=w/l;e.gr=D.smooth(L,e.gr,l,.3);e.$[1]=L;e.hr>=e.threshold||e.gr>=e.ZD?n(e,1):n(e,
0);H.copy(u,e.rn);r.copy(p,e.Ct);e.rf=K;break;case 130:p=e.Eh;u=J.ec(p.o.v,R);p=Math.abs(u[1]-e.rn[1])/l;e.ir=D.smooth(p,e.ir,l,.3);e.$=p;e.ir>=e.threshold?n(e,1):n(e,0);H.copy(u,e.rn);e.rf=K;break;case 140:!e.Ia&&0<=e.kf&&K-e.rf>=e.kf&&(n(e,1),e.repeat?e.rf=K:e.kf=-e.kf);break;case 150:e.rf||(e.rf=K);n(e,K-e.rf);e.rf=K;break;case 160:n(e,K);break;case 180:K=c(e.element);e.$[0]=K.ss-K.Jw;e.$[1]=K.rs-K.Iw;e.$[2]=K.qs-K.ps;break;case 190:K=c(e.element);e.$[0]=K.ss;e.$[1]=K.rs;e.$[2]=K.qs;break;case 200:K=
c(e.element);r.copy(K.rC,e.$);break;case 210:l=k.get_device_by_type_element(k.DEVICE_HMD);k.get_vector_param(l,k.HMD_ORIENTATION_QUAT,e.$);break;case 220:l=k.get_device_by_type_element(k.DEVICE_HMD);k.get_vector_param(l,k.HMD_POSITION,e.$);break;case 240:l=h(e.gamepad_id);e.value=k.jN(l,e.key);break;case 250:l=h(e.gamepad_id);e.value=k.iN(l,e.key);break;case 230:n(e,e.callback());break;case 30:K=c(e.element);n(e,K.Au);break;case 40:K=c(e.element);if(!t.Uk||1==K.fe||2==K.fe)switch(u=K.ll-K.bt,p=K.ml-
K.dt,e.$.coords[0]=K.ll,e.$.coords[1]=K.ml,e.axis){case "X":n(e,u);break;case "Y":n(e,p);break;case "XY":l=Math.sqrt(u*u+p*p),n(e,l)}break;case 260:K=c(e.element);t.Uk||(u=K.Op,p=K.Pp,L=D.smooth(u,0,l,.1*V),l=D.smooth(p,0,l,.1*V),.01<Math.abs(u)||.01<Math.abs(p)?(K.Op-=L,K.Pp-=l,e.$.coords[0]=L,e.$.coords[1]=l):(e.$.coords[0]=0,e.$.coords[1]=0),n(e,Math.sqrt(u*u+p*p)));break;case 50:K=c(e.element);n(e,0<K.fe|0);e.$.which=K.which;e.$.coords[0]=K.ll;e.$.coords[1]=K.ml;break;case 170:K=c(e.element);
n(e,0);if(e.DB)K.Gw==e.Eh&&n(e,1);else if(K.fe&&K.wh.obj==e.Eh)n(e,1);else if(!K.Ms)for(l=0;10>l;++l)if(K.Fl[l].obj==e.Eh){n(e,1);break}break;case 20:K=c(e.element);e.$=K.ze[e.key];1==e.$||K.ze[0]&&16==e.key?n(e,1):e.$||n(e,0);break;case 60:K=c(e.element);if(-1==K.Sd[1]&&-1==K.je[1]){u=K.Sd[0]-K.Rg[0];p=K.je[0]-K.Sg[0];l=Math.sqrt(u*u+p*p);if(-1!=K.Rg[1]&&-1!=K.Sg[1]){var L=K.Sd[0]-K.Rg[1],w=K.je[0]-K.Sg[1],v=Math.sqrt(L*L+w*w);v<l&&(u=L,p=w,l=v)}e.$.fs=a.PL_SINGLE_TOUCH_MOVE}else l=y,l[0]=(K.Sd[0]+
K.Sd[1])/2,l[1]=(K.je[0]+K.je[1])/2,p=Y,p[0]=(K.Rg[0]+K.Rg[1])/2,p[1]=(K.Sg[0]+K.Sg[1])/2,u=l[0]-p[0],p=l[1]-p[1],l=Math.sqrt(u*u+p*p),e.$.fs=a.PL_MULTITOUCH_MOVE_PAN;e.$.coords[0]=K.Sd[0];e.$.coords[1]=K.je[0];switch(e.axis){case "X":n(e,u);break;case "Y":n(e,p);break;case "XY":n(e,l)}break;case 70:K=c(e.element);l=K.gu-K.Wy;e.$=a.PL_MULTITOUCH_MOVE_ZOOM;n(e,l);break;case 75:K=c(e.element);-1!=K.Sd[1]&&(l=Math.atan2(K.je[0]-K.je[1],K.Sd[0]-K.Sd[1]),e.$=a.PL_MULTITOUCH_MOVE_ROTATE,n(e,l-K.mF));break;
case 80:K=c(e.element),e.$.coords[0]=K.Sd[0],e.$.coords[1]=K.je[0],K.Ms?n(e,0):n(e,1)}for(g=0;g<m.length;g++)for(K=m[g],e=K.zl,l=0;l<e.length;l++)if(u=e[l],u.ak!=W){u.ak=W;w=u;p=0;switch(w.type){case a.CT_POSITIVE:p=(L=B(w))?1:0;break;case a.CT_CONTINUOUS:p=w.ni;(L=B(w))?(p=1,w.ni=1):1==p?(p=-1,w.ni=-1):p=0;break;case a.CT_TRIGGER:p=w.ni;(L=B(w))&&-1==p?(p=1,w.ni=1):L||1!=p?p=0:(p=-1,w.ni=-1);break;case a.CT_SHOT:p=w.ni;(L=B(w))&&-1==p?(p=1,w.ni=1):L||1!=p?p=0:(p=0,w.ni=-1);break;case a.CT_LEVEL:L=
B(w);w.UC!=L?(p=1,w.UC=L):p=0;break;case a.CT_CHANGE:L=w.zi;w=w.bO;for(v=0;v<L.length;v++){var x=L[v].value;p||x==w[v]||(p=1);w[v]=x}break;default:D.D("Wrong sensor manifold type: "+w.type)}if(p&&(L=K==A?null:K,E=!1,u.callback(L,u.id,p,u.JJ),E)){g=-1;break}}for(g=0;g<m.length;g++)for(K=m[g],e=K.zl,l=0;l<e.length;l++)for(u=e[l],K=u.zi,u=0;u<K.length;u++)switch(p=K[u],p.type){case 30:n(p,0);break;case 40:n(p,0);break;case 60:n(p,0);break;case 70:n(p,0);break;case 75:n(p,0);break;case 80:n(p,0);break;
case 140:n(p,0)}for(g=0;g<Q.length;g++){e=Q[g];if(!e.vp){for(l=0;l<e.ze.length;l++)1==e.ze[l]?e.ze[l]=2:3==e.ze[l]&&(e.ze[l]=0);e.vp=!0}1==e.fe?e.fe=2:3==e.fe&&(e.fe=0);e.Au=0;e.bt=e.ll;e.dt=e.ml;e.ze[0]=0;e.Rg.set(e.Sd);e.Sg.set(e.je);e.Wy=e.gu;e.Jw=e.ss;e.Iw=e.rs;e.ps=e.qs;e.Ww=!1}W++};a.create_custom_sensor=function(a){var b=d(10);n(b,a);return b};a.create_keyboard_sensor=function(a){var b=d(20,document);b.key=a;b.Ia=!0;return b};a.create_gamepad_btn_sensor=function(a,b){var c=d(240,document);
b=b||k.dC();c.gamepad_id=b;c.key=a;c.Ia=!0;return c};a.create_gamepad_axis_sensor=function(a,b){var c=d(250,document);b=void 0==b?k.dC():b;c.gamepad_id=b;c.key=a;c.Ia=!0;return c};a.create_collision_sensor=function(a,b,c){if(!a||!u.ka(a))return F.error("Wrong collision object"),null;var f=d(90);f.Dv=a;f.Ub=b;f.ah=c;f.$={pK:null,qK:c?new Float32Array(3):null,dh:c?new Float32Array(3):null,bm:0};f.Cv=function(a,b,c,d,h){n(f,a);a=f.$;a.pK=b;f.ah&&(a.qK.set(c),a.dh.set(d),a.bm=h)};f.Ia=!0;return f};a.create_collision_impulse_sensor=
function(a){if(!a||!a.J)return F.error("Wrong collision impulse object"),null;var b=d(100);b.Bv=a;b.$A=function(a){n(b,a)};b.Ia=!0;return b};a.create_ray_sensor=function(a,b,c,f,h,m,g){var e=d(110);e.Eh=a;e.from=b;e.to=c;e.Ub=f;e.CC=h;e.ah=m;e.Bs=g;e.$={If:0,UO:null,ki:0,rh:new Float32Array(3),ji:new Float32Array(3),Up:0};e.OD=function(a,b,c,d,f,h){e.CC?n(e,-1==b?0:1):n(e,b);e.$.If=b;e.$.UO=c;e.$.ki=d;e.ah&&(e.$.rh.set(f),e.$.ji.set(h))};e.Ia=!0;return e};a.create_mouse_click_sensor=function(a){a=
d(50,a);a.Ia=!0;a.$={coords:new Float32Array(2),which:null};return a};a.create_mouse_wheel_sensor=function(a){a=d(30,a);a.Ia=!0;return a};a.create_mouse_move_sensor=function(a,b){var c=d(40,b);c.axis=a||"XY";c.$={coords:new Float32Array(2)};c.Ia=!0;return c};a.create_touch_move_sensor=function(a,b){var c=d(60,b);c.axis=a||"XY";c.$={coords:new Float32Array(2),fs:0};c.Ia=!0;return c};a.create_touch_zoom_sensor=function(a){a=d(70,a);a.$=0;a.Ia=!0;return a};a.create_touch_rotate_sensor=function(a){a=
d(75,a);a.$=0;a.Ia=!0;return a};a.create_touch_click_sensor=function(a){a=d(80,a);a.$={coords:new Float32Array(2)};a.Ia=!0;return a};a.create_motion_sensor=function(a,b,c){if(!a)return F.error("Wrong collision object"),null;var f=d(120);f.Eh=a;var h=J.get_trans_view(a.o.v);a=J.get_quat_view(a.o.v);f.LD=new Float32Array(4);f.rn=new Float32Array(h);f.Ct=new Float32Array(a);f.hr=0;f.gr=0;f.threshold=b||.1;f.ZD=c||.1;f.rf=0;f.$=new Float32Array([0,0]);return f};a.create_vertical_velocity_sensor=function(a,
b){if(!a)return F.error("Wrong collision object"),null;var c=d(130);c.Eh=a;var f=J.get_trans_view(a.o.v),h=J.get_quat_view(a.o.v);c.rn=new Float32Array(f);c.Ct=new Float32Array(h);c.ir=0;c.threshold=b||1;c.rf=0;c.$=0;return c};a.create_timer_sensor=function(a,b){var c=d(140);c.kf=a;c.repeat=b;c.Ia=!0;return c};a.reset_timer_sensor=function(a,b,c,d){a=a||A;a=a.Og;if(!a||!a[b])return F.error("reset_timer_sensor(): wrong object"),null;b=a[b].zi[c];if(!b)return F.error("reset_timer_sensor(): sensor not found"),
null;b.rf=z.get_timeline();b.kf=d};a.create_elapsed_sensor=function(){var a=d(150);a.rf=0;return a};a.create_gyro_delta_sensor=function(){var a=d(180,window);a.$=new Float32Array(3);k.get_device_by_type_element(k.DEVICE_GYRO)?n(a,1):n(a,0);a.Ia=!0;return a};a.create_gyro_angles_sensor=function(){var a=d(190,window);a.$=new Float32Array(3);k.get_device_by_type_element(k.DEVICE_GYRO)?n(a,1):n(a,0);a.Ia=!0;return a};a.create_gyro_quat_sensor=function(){var a=d(200,window);a.$=r.create();k.get_device_by_type_element(k.DEVICE_GYRO)?
n(a,1):n(a,0);a.Ia=!0;return a};a.create_hmd_quat_sensor=function(){var a=d(210,window);a.$=r.create();k.get_device_by_type_element(k.DEVICE_HMD)?n(a,1):n(a,0);a.Ia=!0;return a};a.create_hmd_position_sensor=function(){var a=d(220,window);a.$=H.create();k.get_device_by_type_element(k.DEVICE_HMD)?n(a,1):n(a,0);a.Ia=!0;return a};a.create_timeline_sensor=function(){return d(160)};a.create_selection_sensor=function(a,b){var c=d(170);c.Eh=a;c.DB=b;c.Ia=!0;return c};a.create_callback_sensor=function(a,b){var c=
d(230);c.callback=a;n(c,b);return c};a.create_plock_mouse_sensor=function(a){a=d(260,a);a.$={coords:new Float32Array(2)};a.Ia=!0;return a};a.create_plock_sensor=function(a){a=d(270,a);a.Ia=!0;return a};a.XP=n;a.get_sensor_value=function(a,b,c){a=a||A;a=a.Og;if(!a||!a[b])return F.error("get_sensor_value(): wrong object"),null;b=a[b].zi[c];return b?b.value:(F.error("get_sensor_value(): sensor not found"),null)};a.get_sensor_payload=function(a,b,c){a=a||A;a=a.Og;if(!a||!a[b])return F.error("get_sensor_payload(): wrong object"),
null;b=a[b].zi[c];return b?b.$:(F.error("get_sensor_payload(): sensor not found"),null)};a.cleanup=function(){m=[];A={};for(var a=0;a<I.length;a++)v(I[a]);I.length=0;p.length=0};a.check_sensor_manifold=function(a,b){a=a||A;if(!a.Og)return!1;if(b&&a.Og[b])return!0;if(!b)for(var c in a.Og)return!0;return!1};a.create_sensor_manifold=function(a,d,f,h,g,t,l){a=a||A;a.zl=a.zl||[];a.Og=a.Og||{};var r=a.Og,L=a.zl;r[d]&&e(a,d);f={id:d,type:f,zi:h.slice(0),yO:g,YP:Array(h.length),callback:t,JJ:l,ni:-1,UC:0,
bO:Array(h.length),ak:-1};r[d]=f;L.push(f);-1==m.indexOf(a)&&m.push(a);for(a=0;a<f.zi.length;a++){r=d=f.zi[a];if(r.Ia){switch(r.type){case 90:u.append_collision_test(r.Dv,r.Ub,r.Cv,r.ah);break;case 100:u.apply_collision_impulse_test(r.Bv,r.$A);break;case 110:r.Up=u.append_ray_test(r.Eh,r.from,r.to,r.Ub,r.OD,!1,!1,r.ah,r.Bs);r.$.Up=r.Up;break;case 140:r.rf=z.get_timeline();0>r.kf&&(r.kf=-r.kf);break;case 20:L=c(r.element);b(L,"keyboard_downed_keys");break;case 30:L=c(r.element);b(L,"mouse_wheel");
break;case 40:L=c(r.element);b(L,"mouse_down_which");b(L,"mouse_up_which");b(L,"mouse_location");break;case 260:L=c(r.element);b(L,"mouse_pointerlock");break;case 270:k.xI(r);break;case 50:L=c(r.element);b(L,"mouse_down_which");b(L,"mouse_up_which");break;case 60:L=c(r.element);b(L,"touch_start");b(L,"touch_move");b(L,"touch_end");break;case 70:L=c(r.element);b(L,"touch_start");b(L,"touch_move");break;case 75:L=c(r.element);b(L,"touch_start");b(L,"touch_move");break;case 80:L=c(r.element);b(L,"touch_start");
b(L,"touch_end");break;case 170:L=c(r.element);b(L,"mouse_select");b(L,"touch_select");b(L,"touch_start");b(L,"touch_end");b(L,"mouse_down_which");b(L,"mouse_up_which");break;case 180:case 190:L=c(r.element);b(L,"orientation_angles");break;case 200:L=c(r.element);b(L,"orientation_quat");break;case 240:0==r.gamepad_id?k.get_device_by_type_element(k.Nq):1==r.gamepad_id?k.get_device_by_type_element(k.Ju):2==r.gamepad_id?k.get_device_by_type_element(k.Ku):k.get_device_by_type_element(k.Lu)}r.Ia=!1}r=
I.indexOf(d);-1==r?(I.push(d),p.push([f])):p[r].push(f)}E=!0};a.default_AND_logic_fun=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.default_OR_logic_fun=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];return a[a.length-1]};a.remove_sensor_manifold=e;a.reset=function(){for(var a=0;a<m.length;a++){var b=m[a],c=b.Og,b=b.zl,d;for(d in c)delete c[d];b.length=0}for(a=0;a<I.length;a++)v(I[a]);m.length=0;I.length=0;p.length=0};a.debug=function(){F.log(String(m.length)+
" objects with manifolds",m);F.log(String(I.length)+" sensors",I);for(var a=[],b=[],c=0;c<I.length;c++){var d=I[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}F.log(String(a.length)+" collision sensors",a);F.log(String(b.length)+" ray sensors",b)};a.set_plock_smooth_factor=function(a){V=a}};b4w.module.__curve=function(a,q){function d(a,b,c,d,e){var h=d.length;e||(e=new Float32Array(h));for(var f=h+a,g=new Float32Array(f),l=1;l<=f-1;l++)g[l-1]=b>=c[l-1]&&b<c[l+1-1]?1:0;for(var r=2;r<=a;r++)for(l=1;l<=f-r;l++)g[l-1]=(g[l-1]?(b-c[l-1])*g[l-1]/(c[l+r-1-1]-c[l-1]):0)+(g[l+1-1]?(c[l+r-1]-b)*g[l+1-1]/(c[l+r-1]-c[l+1-1]):0);b==c[f-1]&&(g[h-1]=1);a=0;for(l=1;l<=h;l++)a+=g[l-1]*d[l-1];for(l=1;l<=h;l++)e[l-1]=a?g[l-1]*d[l-1]/a:0;return e}function c(a){a=a.Ps;return a[a.length-1]}function b(a){a=
a.qB;return a[a.length-1]}function g(a,b,c,d,e,k,f,F){var h=a+(b-a)/2,l=n(h,d,e,k,f)-c;F=F?F:.01;return Math.abs(l)<F?h:0<l?g(a,h,c,d,e,k,f,F):g(h,b,c,d,e,k,f,F)}function n(a,b,c,d,e){var h=1-a;return b*h*h*h+3*c*h*h*a+3*d*h*a*a+e*a*a*a}var B=q("__util"),e=q("__vec3");a.WK=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var e=a.order_u;b.order=e;a=a.points;var g=a.length/5,k=[],f=g+e,g=g+2;k[0]=0;for(var n=2;n<=f;n++)k[n-1]=n>e&&n<g?k[n-2]+1:k[n-
2];b.Ps=k;"2D"==c.dimensions?b.uj=!1:"3D"==c.dimensions?b.uj=!0:B.D("Wrong curve dimensions");e=[];k=[];for(c=0;c<a.length;c+=5)e.push(a[c]),e.push(a[c+1]),e.push(a[c+2]),b.uj&&e.push(a[c+3]),k.push(a[c+4]);b.Iv=e;b.oz=k;a=[];for(var c=b.Iv,e=b.uj?4:3,k=b.oz,f=b.Ps,g=b.order,n=c.length/e,u=n+g,r=0,v=f[u-1]/999,J=0;1E3>J;J++){5E-6>f[u-1]-r&&(r=f[u-1]);for(var D=d(g,r,f,k),H=0;H<e;H++)for(var C=a[e*J+H]=0;C<n;C++)a[e*J+H]+=D[C]*c[e*C+H];r+=v}e=b.uj?4:3;k=new Float32Array(1E3);k[0]=0;for(c=1;1E3>c;c+=
1)f=a[(c-1)*e],g=a[(c-1)*e+1],n=a[(c-1)*e+2],u=a[c*e],r=a[c*e+1],v=a[c*e+2],k[c]=k[c-1]+Math.sqrt((u-f)*(u-f)+(r-g)*(r-g)+(v-n)*(v-n));b.qB=k;return b};a.aR=function(a,b,h){h||(h=[]);b=Math.min(b,c(a));var e=a.Iv,g=a.uj?4:3,k=a.oz,f=a.Ps,n=a.order;a=e.length/g;var u=a+n;5E-6>f[u-1]-b&&(b=f[u-1]);u=new Float32Array(a);d(n,b,f,k,u);for(b=0;b<g;b++)for(k=h[b]=0;k<a;k++)h[b]+=u[k]*e[g*k+b]};a.YQ=function(a,b,c){c||(c=[]);var d=a.Iv,h=a.uj?4:3,e=a.oz,f=a.Ps,g=a.order;a=d.length/h;var n=a+g;5E-6>f[n-1]-
b&&(b=f[n-1]);var n=new Float32Array(a),r=b;b=n;var w=e.length;b||(b=new Float32Array(w));var v=new Float32Array(w),B=new Float32Array(w),H=v,C=B;H||(H=new Float32Array(w));C||(C=new Float32Array(w));for(var t=w+g,m=new Float32Array(t),A=new Float32Array(t),I=1;I<=t-1;I++)m[I-1]=r>=f[I-1]&&r<f[I+1-1]?1:0;r==f[t-1]&&(m[w-1]=1);for(var p=2;p<=g;p++)for(I=1;I<=t-p;I++){var Q=m[I-1]?m[I-1]/(f[I+p-1-1]-f[I-1]):0,y=m[I+1-1]?-m[I+1-1]/(f[I+p-1]-f[I+1-1]):0,q=A[I-1]?(r-f[I-1])*A[I-1]/(f[I+p-1-1]-f[I-1]):
0,R=A[I+1-1]?(f[I+p-1]-r)*A[I+1-1]/(f[I+p-1]-f[I+1-1]):0;m[I-1]=(m[I-1]?(r-f[I-1])*m[I-1]/(f[I+p-1-1]-f[I-1]):0)+(m[I+1-1]?(f[I+p-1]-r)*m[I+1-1]/(f[I+p-1]-f[I+1-1]):0);A[I-1]=Q+y+q+R}for(I=1;I<=w;I++)H[I-1]=m[I-1],C[I-1]=A[I-1];f=0;for(g=1;g<=w;g++)f+=v[g-1]*e[g-1];r=0;for(g=1;g<=w;g++)r+=B[g-1]*e[g-1];for(g=1;g<=w;g++)b[g-1]=f?B[g-1]*e[g-1]/f+v[g-1]*e[g-1]*r/(f*f):0;for(e=0;e<h;e++)for(f=c[e]=0;f<a;f++)c[e]+=n[f]*d[h*f+e]};a.$U=c;a.$Q=b;a.ZQ=function(a,d){if(0>=d)return 0;var h=c(a);if(d>=b(a))return h;
var e=a.qB,g=B.lr(e,d,0,e.length-1);return h*(g+(d-e[g])/(e[g+1]-e[g]))/1E3};a.Qs=function(a,b,c,d,e){return c+(e-d)*(a-c)/(b-d)};a.YC=function(a,b,c){var d=b[0];b=b[1];c=(c[1]-b)/(c[0]-d);return c*a+(b-c*d)};a.uA=function(a,b,c,d,e,k){return n(g(0,1,a,b[0],c[0],d[0],e[0],k),b[1],c[1],d[1],e[1])};a.sv=function(a,b,c,d,g){var h=new Float32Array(3),f=new Float32Array(3),l=new Float32Array(3),n=new Float32Array(3),r=new Float32Array(3),w=new Float32Array(3);e.copy(a[1],f);null==b?(e.copy(c[1],l),h[0]=
2*f[0]-l[0],h[1]=2*f[1]-l[1]):e.copy(b[1],h);null==c?(e.copy(b[1],h),l[0]=2*f[0]-h[0],l[1]=2*f[1]-h[1]):e.copy(c[1],l);e.subtract(f,h,n);e.subtract(l,f,r);b=e.length(n);c=e.length(r);0==b&&(b=1);0==c&&(c=1);if("AUTO"==d||"AUTO"==g)if(w[0]=r[0]/c+n[0]/b,w[1]=r[1]/c+n[1]/b,h=2.5614*e.length(w))"AUTO"==d&&e.scaleAndAdd(f,w,-(b/h),a[0]),"AUTO"==g&&e.scaleAndAdd(f,w,c/h,a[2]);"VECTOR"==d&&e.scaleAndAdd(f,n,-1/3,a[0]);"VECTOR"==g&&e.scaleAndAdd(f,r,1/3,a[2])};a.tK=function(a,b,c,d){var e=[],g=[],f,h,l;
e[0]=a[0]-b[0];e[1]=a[1]-b[1];g[0]=d[0]-c[0];g[1]=d[1]-c[1];l=d[0]-a[0];f=Math.abs(e[0]);h=Math.abs(g[0]);f+h&&f+h>l&&(f=l/(f+h),b[0]=a[0]-f*e[0],b[1]=a[1]-f*e[1],c[0]=d[0]-f*g[0],c[1]=d[1]-f*g[1])}};b4w.module.__debug=function(a,q){function d(a,b,d){var f=[],e;for(e in a)1<D.gi(a[e])&&f.push([e,a[e]]);f.sort(function(a,b){var c=D.gi(a[1]),d=D.gi(b[1]);return d!=c?d-c:a<b?-1:b<a?1:0});if(f.length){F.groupCollapsed(b+" "+d);F.dd("Property different variants (>1) | Property name");for(a=0;a<f.length;a++)F.groupCollapsed(D.gi(f[a][1]),f[a][0]),c(f[a][1]);F.groupEnd()}}function c(a){F.dd("Batches count for this property value | Property value");var b=[],c;for(c in a)b.push([c,a[c]]);b.sort(function(a,
b){return b[1]!=a[1]?b[1]-a[1]:a[0]<b[0]?-1:b[0]<a[0]?1:0});for(a=0;a<b.length;a++)F.dd(b[a][1],b[a][0]);F.groupEnd()}function b(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function g(){var a=x.uw();if(a){var b=a.createQuery();a.beginQuery(b)}else b=performance.now();return b}function n(){var b=Q;return b&&b.debug_view_mode==a.DV_RENDER_TIME}function B(a,b,c){var d=x.uw(),f=0;if(d)for(c&&d.endQuery(),c=0;c<a.length;c++){var e=a[c],g=d.XB(e),h=t.getParameter(d.WB());
g&&!h&&(f=d.YB(e)/1E6,b&&(f=D.smooth(f,b,1,10)),a.splice(c,1),c--)}else f=performance.now()-a.pop(),b&&(f=D.smooth(f,b,1,10));return f}function e(a,b){v(a)||D.D("Structure assertion failed: invalid first object value");v(b)||D.D("Structure assertion failed: invalid second object value");w(a,b)||D.D("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||D.Vw(a)||a instanceof Array)){for(var c in a)v(a[c])||D.D("Structure assertion failed: invalid value for key in the first object: "+
c),c in b||D.D("Structure assertion failed: missing key in the first object: "+c);for(c in b)v(b[c])||D.D("Structure assertion failed: invalid value for key in the second object: "+c),c in a||D.D("Structure assertion failed: missing key in the second object: "+c),w(a[c],b[c])||D.D("Structure assertion failed: incompatible types for key "+c)}}function v(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function w(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==
typeof a){var c=a instanceof Array,d=b instanceof Array;if(c&&!d||!c&&d)return!1;c=D.Vw(a);d=D.Vw(b);if(c&&!d||!c&&d)return!1}return!0}var h=q("__compat"),l=q("__config"),x=q("__extensions"),k=q("__graph"),f=q("__objects"),F=q("__print"),u=q("__scenes"),r=q("__subscene"),z=q("__textures"),J=q("__time"),D=q("__util"),H=l.H,C={},t=null,m={},A=[],I=-1,p=-1,Q=null,y=null,Y=!1,R={};a.DV_NONE=0;a.DV_OPAQUE_WIREFRAME=1;a.DV_TRANSPARENT_WIREFRAME=2;a.DV_FRONT_BACK_VIEW=3;a.DV_BOUNDINGS=4;a.DV_CLUSTERS_VIEW=
5;a.DV_BATCHES_VIEW=6;a.DV_RENDER_TIME=7;a.mf=function(a){for(var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c=0;c<b.length;c++){var d=b[c];d in a&&(C[a[d]]=d)}t=a};a.dQ=function(a){Q=a};a.aU=function(){return Q};a.lM=function(a,b,c,d,f){R[a]||(R[a]={HQ:b,se:{}});c in R[a].se||(R[a].se[c]=d);f&&(R[a].se[c]=0)};a.calc_vbo_garbage_byte_size=function(){var a=0,b;for(b in R)for(var c in R[b].se)a+=R[b].se[c];return a};a.show_vbo_garbage_info=
function(){var a={},b;for(b in R)for(var c in R[b].se){var d=R[b].se[c];if(d){var f=R[b].HQ;f in a||(a[f]={Qy:0,se:{}});c in a[f].se||(a[f].se[c]=0);a[f].se[c]+=d;a[f].Qy+=d}}for(f in a){F.groupCollapsed(f,a[f].Qy);for(c in a[f].se)F.dd(c,a[f].se[c]);F.groupEnd()}};a.print_batches_stat=function(){for(var a={},b="bb_local bb_world be_local be_world bs_local bs_world bufs_data id attribute_setters num_vertices num_triangles material_names shader bpy_tex_names".split(" "),c=0,e=0,g=f.Ib(u.nh(),"MESH",
f.DATA_ID_ALL),h=0;h<g.length;h++)for(var m=0;m<g[h].K.length;m++)for(var t=0;t<g[h].K[m].R.length;t++){var k=D.bh(g[h].K[m].R[t]),l=k.ab.bg+"/"+k.ab.Ae;k["shaders_info.directives"]=k.ab.di;k["shaders_info.node_elements"]=k.ab.Rf;delete k.ab;for(var r=0;r<b.length;r++)delete k[b[r]];if(g[h].is_dynamic)e++;else{c++;k.type in a||(a[k.type]={});l in a[k.type]||(a[k.type][l]={});for(var p in k)p in a[k.type][l]||(a[k.type][l][p]={}),r=JSON.stringify(k[p]),r in a[k.type][l][p]||(a[k.type][l][p][r]=0),
a[k.type][l][p][r]++}}F.group("Batches statistics:");F.dd("STATIC/DYNAMIC count:",c+"/"+e);F.group("STATIC batches diversity:");for(var n in a)for(l in a[n])d(a[n][l],n,l);F.groupEnd();F.groupEnd()};a.wv=function(a){if(H.gl_debug){var b=t.getError();b!=t.NO_ERROR&&(b in C?D.D("GL Error: "+b+", gl."+C[b]+" ("+a+")"):D.D("Unknown GL error: "+b+" ("+a+")"))}};a.SJ=function(){if(H.gl_debug||H.PA)switch(t.checkFramebufferStatus(t.FRAMEBUFFER)){case t.FRAMEBUFFER_COMPLETE:break;case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:F.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:F.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:F.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case t.FRAMEBUFFER_UNSUPPORTED:F.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:F.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");break;default:F.error("FRAMEBUFFER CHECK FAILED")}};
a.WJ=function(){if(-1!=I)return I;t.bindFramebuffer(t.FRAMEBUFFER,t.createFramebuffer());var a=z.Gk(z.ik,!1);z.resize(a,1,1);t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,a.qb,a.Cb,0);t.checkFramebufferStatus(t.FRAMEBUFFER)!=t.FRAMEBUFFER_COMPLETE?(I=!0,F.warn("depth-only issue was found")):I=!1;t.bindFramebuffer(t.FRAMEBUFFER,null);return I};a.aK=function(){if(1==H.uc)return!1;if(-1!=p)return p;t.bindRenderbuffer(t.RENDERBUFFER,t.createRenderbuffer());t.renderbufferStorageMultisample(t.RENDERBUFFER,
H.uc,t.RGBA8,1,1);var a=t.getRenderbufferParameter(t.RENDERBUFFER,t.RENDERBUFFER_SAMPLES);a!=H.uc?(p=!0,F.warn("multisample issue was found: requested "+H.uc+", got "+a),t.getError()==t.INVALID_OPERATION&&F.warn("the error from multisample issue detected, ignoring")):p=!1;t.bindRenderbuffer(t.RENDERBUFFER,null);return p};a.YJ=function(){return h.xv("Firefox")&&t.getError()==t.OUT_OF_MEMORY?(F.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};a.UD=function(a,c,d){H.gl_debug&&(d=b(d),F.error("shader compilation failed:\n"+
d+"\n"+t.getShaderInfoLog(a)+" ("+c+")"))};a.HP=function(a,c,d,f){H.gl_debug&&(d=b(d),f=b(f),F.error("shader linking failed:\n"+d+"\n\n\n"+f+"\n"+t.getProgramInfoLog(a)+" ("+c+")"))};a.Yx=function(a){if(H.show_hud_debug_info||a.type==r.On)a.aw||a.Ik.push(g())};a.CP=function(a){"MAIN"==a.type&&n()&&a.Ik.push(g())};a.Zx=function(a){if((H.show_hud_debug_info||a.type==r.On)&&!a.aw){var b=B(a.Ik,a.Xe,!0);b&&(a.Xe=b)}};a.DP=function(a){if("MAIN"==a.type&&n()){var b=B(a.Ik,a.Xe,!0);b&&(a.Xe=b)}};a.IC=n;
a.qP=function(a){var b=B(a.Ik,a.Xe,!1);b&&(a.Xe=b)};a.KT=function(a){m[a]=a in m?m[a]+1:1};a.update=function(){for(var a in m)F.log(a,m[a]),m[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(D.is_vector(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}A.push(a)};a.msg=function(){for(var a=1,b=0;b<A.length;b++){var c=A[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],D.is_vector(a))for(var d=
0;d<a.length;d++)c.push(a[d]);else c.push(arguments[b]);A.push(c)};var G=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),f=0;f<A.length;f++){var e=A[f];a=e[0];if(!(a<d)){var g=String(e[1]);c[g]||(c[g]=G[b++%G.length]);a=["%c"+(a/1E3).toFixed(6),c[g],g];for(g=2;g<e.length;g++)a.push(e[g]);F.log.apply(this,a)}}A.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b=
{},c=Math.max(0,performance.now()-1E3*a),d=0;d<A.length;d++){var f=A[d];a=f[0];if(!(a<c))for(var e=2;e<f.length;e++){var g=String(f[1]);3<f.length&&(g+="_"+String(e-2));b[g]||(b[g]=g+"\n");b[g]+=String(a)+" "+f[e]+"\n"}}a="";for(g in b)a+=b[g]+"\n\n";F.log(a);A.splice(0)};a.tT=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&
b("firefox");case "msie":return b("mozilla")&&b("trident")&&b("msie");case "opera":return b("opera")&&b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(D.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return!!a.length}return isFinite(a)?!0:!1};a.jT=function(a,b){a.constructor!=b&&D.D("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.kT=e;a.lT=function(a){Y?
e(a,y):Y=!0;y=null!=a&&"object"==typeof a?D.zo(a):a};a.fake_load=function(a,b,c,d,f){(a=a||null)||D.D("Stage load callback is undefined");b=b||5E3;c=c||0;d=d||100;100<d&&D.D("Max percentage must be less than 100");0>c&&D.D("Min percentage must be greater than 0");c>d&&D.D("Max percentage must be greater than min percentage");var e=J.animate(c,d,b,function(b){b=b.toFixed();a(b);100==b&&(J.clear_animation(e),f&&f())})};a.TO=function(a){return k.DL(a,function(a,b){var c=b.type+"("+b.name+")",d=b.inputs,
c=c+"\n\nINPUTS:";if(d.length)for(var f=0;f<d.length;f++)c+="\n"+d[f].identifier+": ",c=d[f].Ka?c+"linked":c+d[f].ya;else c+="\n---";d=b.outputs;c+="\n\nOUTPUTS:";if(d.length)for(f=0;f<d.length;f++)c+="\n"+d[f].identifier+": ",c=d[f].Ka?c+("linked(default "+d[f].ya+")"):c+"not used";else c+="\n---";f="";switch(b.type){case "GEOMETRY_UV":f="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":f="\ntexture: "+b.data.value.name+"\n("+b.data.value.ym+")"}""==f&&(f="\n---");return c+
"\n\nDATA:"+f},function(b,c,d){b=k.Ra(a,b);c=k.Ra(a,c);return b.outputs[d[0]].identifier+"\n==>\n"+c.inputs[d[1]].identifier})};a.ks=function(){return t};a.cleanup=function(){Q=null;R={}};a.reset=function(){t=null}};b4w.module.__extensions=function(a,q){function d(a){if(a in e)return e[a];var b=B.getExtension(a)||null;e[a]=b;g.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function c(a){if(a in e)return e[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=B;break;case "EXT_disjoint_timer_query":(b=B.getExtension("EXT_disjoint_timer_query")||null)||(b=B.getExtension("EXT_disjoint_timer_query_webgl2")||
null)}e[a]=b;g.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=q("__config"),g=q("__print"),n=b.H,B=null,e={};a.mf=function(a){B=a};a.jC=function(){return d("WEBGL_compressed_texture_s3tc")||d("WEBKIT_WEBGL_compressed_texture_s3tc")};a.iC=function(){return d("WEBKIT_WEBGL_compressed_texture_pvrtc")||d("WEBGL_compressed_texture_pvrtc")};a.ZM=function(){return n.Rb?c("WEBGL_depth_texture"):d("WEBGL_depth_texture")||d("WEBKIT_WEBGL_depth_texture")};a.qw=function(){return d("EXT_texture_filter_anisotropic")||
d("WEBKIT_EXT_texture_filter_anisotropic")};a.YM=function(){return d("WEBGL_debug_shaders")};a.get_renderer_info=function(){return d("WEBGL_debug_renderer_info")};a.cC=function(){return n.Rb?c("OES_element_index_uint"):d("OES_element_index_uint")};a.Bw=function(){return n.Rb?c("OES_standard_derivatives"):d("OES_standard_derivatives")};a.uw=function(){var a=n.Rb?c("EXT_disjoint_timer_query"):d("EXT_disjoint_timer_query");return null==a?a:a.createQueryEXT?{createQuery:function(){return a.createQueryEXT()},
beginQuery:function(b){a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)},endQuery:function(){a.endQueryEXT(a.TIME_ELAPSED_EXT)},XB:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_AVAILABLE_EXT)},YB:function(b){return a.getQueryObjectEXT(b,a.QUERY_RESULT_EXT)},WB:function(){return a.GPU_DISJOINT_EXT}}:{createQuery:function(){return B.createQuery()},beginQuery:function(b){B.beginQuery(a.TIME_ELAPSED_EXT,b)},endQuery:function(){B.endQuery(a.TIME_ELAPSED_EXT)},XB:function(a){return B.getQueryParameter(a,
B.QUERY_RESULT_AVAILABLE)},YB:function(a){return B.getQueryParameter(a,B.QUERY_RESULT)},WB:function(){return a.GPU_DISJOINT_EXT}}};a.nN=function(){if(n.Rb)return c("ANGLE_instanced_arrays");var a=d("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,c,d,e,g){a.drawElementsInstancedANGLE(b,c,d,e,g)},vertexAttribDivisor:function(b,c){a.vertexAttribDivisorANGLE(b,c)},drawArraysInstanced:function(b,c,d,e){a.drawArraysInstancedANGLE(b,c,d,e)}}};a.Ew=function(){if(n.Rb)return c("OES_vertex_array_object");
var a=d("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.cleanup=function(){e={}};a.reset=function(){B=null}};b4w.module.__graph=function(a,q){function d(a,b,d){d||(d=null);c(a,b)?Q.D("Graph already has node with given ID"):a.V.push(b,d)}function c(a,b){for(var c=a.V,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function b(a,b,d,f){f||(f=null);c(a,b)&&c(a,d)?a.za.push(b,d,f):Q.D("Wrong node IDs")}function g(a,b){c(a,b)||Q.D("Node not found");for(var d=a.V,f=0;f<d.length;f+=2)d[f]==b&&(d.splice(f,2),f-=2)}function n(a,b,c,d){m(a,b,c)||Q.D("Edge not found");a=a.za;for(var f=0,e=0;e<a.length;e+=3)if(a[e]==
b&&a[e+1]==c){if(-1==d)a.splice(e,3);else{if(d==f){a.splice(e,3);break}f++}e-=3}}function B(a){a=a.V;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function e(a,b){for(var c=a.V,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function v(a){var b=[],c={};w(a,c);for(var d=a.V,f=0;f<d.length;f+=2)0==H(a,d[f])&&h(a,d[f],c,b);return{V:b,za:a.za.slice(0)}}function w(a,b){for(var c=a.V,d=0;d<c.length;d+=2)b[c[d]]=!1}function h(a,b,c,d){if(!c[b]){c[b]=!0;for(var f=0;f<D(a,b);f++)h(a,
C(a,b,f),c,d);d.unshift(b,J(a,b))}}function l(a,b,c,d){if(!c[b]){c[b]=!0;if(10==d||30==d)for(var f=0;f<D(a,b);f++){var e=C(a,b,f);l(a,e,c,d)}if(20==d||30==d)for(f=0;f<H(a,b);f++)e=t(a,b,f),l(a,e,c,d)}}function x(a){for(var b=a.za,d=0;d<b.length;d+=3){var f=b[d+1];c(a,b[d])&&c(a,f)||(b.splice(d,3),d-=3)}}function k(a){for(var b=[],c=a.V,d=0;d<c.length;d+=2){var f=c[d];D(a,f)||b.push(f)}return b}function f(a){var b=a.V;a=a.za;for(var c=[],d=[],f=[],e=0;e<b.length;e++)f[b[2*e]]=e,c.push(e,b[2*e+1]);
for(e=0;e<a.length;e+=3)d.push(f[a[e]],f[a[e+1]],a[e+2]);return{V:c,za:d}}function F(a,b,c){if(c.eh==c.Bj){for(var d=0,f=0;d<c.Bj;d++)-1!=c.$h[d]&&(a[f]=d,b[f]=c.$h[d],f++);return!0}if(c.Bj>c.Mm||c.Wj>c.Xj||c.on>c.qn||c.nn>c.pn)return!1;for(var f=d=-1,e=!1;!e&&u(c,y,d,f);)if(d=y[0],f=y[1],r(c,d,f)){var g;g=c;e={};e.ip=g.ip;e.jp=g.jp;e.Cx=g.Cx;e.Qr=g.Qr;e.Bj=g.Bj;e.Mm=g.Mm;e.order=g.order;e.eh=e.mt=g.eh;e.nn=g.nn;e.on=g.on;e.Wj=g.Wj;e.pn=g.pn;e.qn=g.qn;e.Xj=g.Xj;e.Tn=-1;e.$h=g.$h;e.Dk=g.Dk;e.Wk=g.Wk;
e.Xk=g.Xk;e.pl=g.pl;e.ql=g.ql;e.Lt=g.Lt;g.Lt[0]+=1;var e=g=e,h=d,m=f,k=e.ip,l=e.jp,p=e.Bj,n=e.Mm,A=e.$h,L=e.Dk,w=e.Wk,aa=e.Xk,x=e.pl,v=e.ql;z(h<p);z(m<n);z(e.eh<p);z(e.eh<n);p=++e.eh;e.Tn=h;w[h]||(w[h]=p,e.nn++,x[h]&&e.Wj++);x[h]||(x[h]=p,e.on++,w[h]&&e.Wj++);aa[m]||(aa[m]=p,e.pn++,v[m]&&e.Xj++);v[m]||(v[m]=p,e.qn++,aa[m]&&e.Xj++);A[h]=m;L[m]=h;for(A=0;A<H(k,h);A++)L=t(k,h,A),w[L]||(w[L]=p,e.nn++,x[L]&&e.Wj++);for(A=0;A<D(k,h);A++)L=C(k,h,A),x[L]||(x[L]=p,e.on++,w[L]&&e.Wj++);for(A=0;A<H(l,m);A++)L=
t(l,m,A),aa[L]||(aa[L]=p,e.pn++,v[L]&&e.Xj++);for(A=0;A<D(l,m);A++)L=C(l,m,A),v[L]||(v[L]=p,e.qn++,aa[L]&&e.Xj++);e=F(a,b,g);z(1>=g.eh-g.mt);z(-1!=g.Tn);L=g.ip;h=g.jp;m=g.eh;k=g.Tn;l=g.$h;w=g.Dk;p=g.Wk;aa=g.Xk;n=g.pl;x=g.ql;if(g.mt<m){p[k]==m&&(p[k]=0);for(v=0;v<H(L,k);v++)A=t(L,k,v),p[A]==m&&(p[A]=0);n[k]==m&&(n[k]=0);for(v=0;v<D(L,k);v++)A=C(L,k,v),n[A]==m&&(n[A]=0);L=l[k];aa[L]==m&&(aa[L]=0);for(v=0;v<H(h,L);v++)A=t(h,L,v),aa[A]==m&&(aa[A]=0);x[L]==m&&(x[L]=0);for(v=0;v<D(h,L);v++)A=C(h,L,v),x[A]==
m&&(x[A]=0);l[k]=-1;w[L]=-1;g.eh=g.mt;g.Tn=-1}}return e}function u(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var f=a.Wj,e=a.Xj,g=a.on,h=a.qn,m=a.nn,k=a.pn,t=a.eh,l=a.Bj,p=a.Mm,r=a.$h,A=a.Dk,n=a.Wk,y=a.Xk,u=a.pl,E=a.ql;if(f>t&&e>t)for(;c<l&&(-1!=r[c]||0==u[c]||0==n[c]);)c++,d=0;else if(g>t&&h>t)for(;c<l&&(-1!=r[c]||0==u[c]);)c++,d=0;else if(m>t&&k>t)for(;c<l&&(-1!=r[c]||0==n[c]);)c++,d=0;else if(0==c&&0!=a.order){for(n=0;n<l&&-1!=r[c=a.order[n]];)n++;n==l&&(c=l)}else for(;c<l&&-1!=r[c];)c++,d=0;if(f>t&&
e>t)for(;d<p&&(-1!=A[d]||0==E[d]||0==y[d]);)d++;else if(g>t&&h>t)for(;d<p&&(-1!=A[d]||0==E[d]);)d++;else if(m>t&&k>t)for(;d<p&&(-1!=A[d]||0==y[d]);)d++;else for(;d<p&&-1!=A[d];)d++;return c<l&&d<p?(b[0]=c,b[1]=d,!0):!1}function r(a,b,c){var d=a.ip,f=a.jp,e=a.Mm,g=a.$h,h=a.Dk,k=a.Wk,l=a.Xk,p=a.pl,r=a.ql;z(b<a.Bj);z(c<e);z(-1==g[b]);z(-1==h[c]);if(!(0,a.Cx)(J(d,b),J(f,c)))return!1;for(var n=e=0,y=0,L=0,u=0,w=0,x=0;x<D(d,b);x++){var v=C(d,b,x);if(-1!=g[v]){var B=g[v];if(!m(f,c,B)||!A(a.Qr,d,b,v,f,c,
B))return!1}else k[v]&&y++,p[v]&&e++,k[v]||p[v]||u++}for(x=0;x<H(d,b);x++)if(v=t(d,b,x),-1!=g[v]){if(B=g[v],!m(f,B,c)||!A(a.Qr,d,v,b,f,B,c))return!1}else k[v]&&y++,p[v]&&e++,k[v]||p[v]||u++;for(x=0;x<D(f,c);x++)if(B=C(f,c,x),-1!=h[B]){if(v=h[B],!m(d,b,v))return!1}else l[B]&&L++,r[B]&&n++,l[B]||r[B]||w++;for(x=0;x<H(f,c);x++)if(B=t(f,c,x),-1!=h[B]){if(v=h[B],!m(d,v,b))return!1}else l[B]&&L++,r[B]&&n++,l[B]||r[B]||w++;return y<=L&&e<=n&&u<=w}function z(a){a||Q.D("Assertion failed")}function J(a,b){for(var c=
a.V,d=0;d<c.length;d+=2)if(c[d]==b)return c[d+1];return null}function D(a,b){for(var c=a.za,d=0,f=0;f<c.length;f+=3)c[f]==b&&d++;return d}function H(a,b){for(var c=a.za,d=0,f=0;f<c.length;f+=3)c[f+1]==b&&d++;return d}function C(a,b,c){a=a.za;for(var d=0,f=0;f<a.length;f+=3)if(a[f]==b){if(d==c)return a[f+1];d++}return-1}function t(a,b,c){a=a.za;for(var d=0,f=0;f<a.length;f+=3)if(a[f+1]==b){if(d==c)return a[f];d++}return-1}function m(a,b,c){a=a.za;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;
return!1}function A(a,b,c,d,f,e,g){for(var h=I(b,c,d),m=I(f,e,g),t=0;t<h;t++){for(var k=!1,l=0;l<m;l++)if(a(p(b,c,d,t),p(f,e,g,l))){k=!0;break}if(!k)return!1}return!0}function I(a,b,c){var d=0;a=a.za;for(var f=0;f<a.length;f+=3)a[f]==b&&a[f+1]==c&&d++;return d}function p(a,b,c,d){a=a.za;for(var f=0,e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c){if(f==d)return a[e+2];f++}return null}var Q=q("__util"),y=[-1,-1];a.Pu=-1;a.SS=10;a.Sl=20;a.$S=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<a.length;d++){var f=
a[d];switch(f.length){case 2:b.push(f[0],f[1]);break;case 3:c.push(f[0],f[1],f[2]);break;default:Q.D("Wrong graph constructor params")}}return{V:b,za:c}};a.clone=function(a,b,c){if(b)for(var d=Array(a.V.length),f=0;f<a.V.length;f+=2)d[f]=a.V[f],d[f+1]=b(a.V[f+1]);else d=Q.S(a.V);if(c)for(b=Array(a.za.length),f=0;f<a.za.length;f+=3)b[f]=a.za[f],b[f+1]=a.za[f+1],b[f+2]=c(a.za[f+2]);else b=Q.S(a.za);return a={V:d,za:b}};a.CT=function(a,b){for(var c=[],d=[],f=0;f<a.length;f++)c.push(a[f][0],a[f][1]);
for(f=0;f<b.length;f++)d.push(b[f][0],b[f][1],b[f][2]);return{V:c,za:d}};a.Xg=d;a.nU=c;a.Nc=b;a.Vf=g;a.Pj=n;a.Wm=function(a,b,c,d){m(a,b,c)||Q.D("Edge not found");a=a.za;for(var f=0;f<a.length;f+=3)if(a[f]==b&&a[f+1]==c&&a[f+2][0]==d[0]&&a[f+2][1]==d[1]){a.splice(f,3);break}};a.O=function(a,b){if(-1==e(a,b)){var c=B(a);d(a,c,b);return c}Q.D("Non-unique attribute")};a.FP=function(a,b,c,d,f){a=a.za;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&a[e+2]==d&&(a[e+2]=f)};a.gA=function(a,c,f,e){f=f||[];
e=e||[];for(var g={},h=0;h<a.V.length;h+=2){var m=a.V[h],t=B(c);d(c,t,a.V[h+1]);g[m]=t}for(h=0;h<a.za.length;h+=3){var t=g[a.za[h]],k=g[a.za[h+1]],m=a.za[h+2];b(c,t,k,m)}for(h=0;h<f.length;h+=3)t=g[f[h]],a=f[h+1],m=f[h+2],b(c,t,a,m);for(h=0;h<e.length;h+=3)f=e[h],k=g[e[h+1]],m=e[h+2],b(c,f,k,m)};a.lj=B;a.xh=e;a.C=function(a,c,d,f){c=e(a,c);d=e(a,d);-1!=c&&-1!=d?b(a,c,d,f):Q.D("Attributes not found")};a.ha=function(a,b){for(var c=a.V,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.ag=function(a,b){for(var c=
a.za,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.Hh=function(a,b,c){for(var d=a.za,f=0;f<d.length;f+=3)if(d[f+1]==b){var e=d[f];if(c(e,J(a,e),d[f+2]))break}};a.Zj=function(a,b,c){for(var d=a.za,f=0;f<d.length;f+=3)if(d[f]==b){var e=d[f+1];if(c(e,J(a,e),d[f+2]))break}};a.Py=v;a.mR=function(a){a=v(a).V;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.vU=function(){};a.mn=function(a,b,d){c(a,b)||Q.D("No such node");var f={};w(a,f);l(a,b,f,d);b=[];for(var e in f)f[e]&&(e=Number(e),b.push(e,
J(a,e)));a={V:b,za:a.za.slice(0)};x(a);return a};a.yv=x;a.sN=function(a){for(var b=[],c=a.V,d=0;d<c.length;d+=2){var f=c[d];H(a,f)||b.push(f)}return b};a.lp=k;a.match=function(a,b,c,d){var e={};e.ip=f(a);e.jp=f(b);e.Cx=c||function(a,b){return a==b};e.Qr=d||function(a,b){return a==b};d=a.V.length/2;var g=b.V.length/2;e.Bj=d;e.Mm=g;e.order=0;e.eh=e.mt=0;e.Wj=e.nn=e.on=0;e.Xj=e.pn=e.qn=0;e.Tn=-1;e.$h=Array(d);e.Dk=Array(g);e.Wk=Array(d);e.Xk=Array(g);e.pl=Array(d);e.ql=Array(g);e.Lt=[1];for(c=0;c<d;c++)e.$h[c]=
-1,e.Wk[c]=0,e.pl[c]=0;for(c=0;c<g;c++)e.Dk[c]=-1,e.Xk[c]=0,e.ql[c]=0;g=Array(d);d=Array(d);if(F(g,d,e)){for(c=0;c<g.length;c++)g[c]=a.V[2*g[c]],d[c]=b.V[2*d[c]];return[g,d]}return null};a.pN=function(a,b){for(var c=a.V,d=1;d<c.length;d+=2)if(c[d]==b)return c[d-1];return null};a.Ra=J;a.Ig=D;a.Yk=H;a.ph=C;a.mh=t;a.bU=I;a.yd=p;a.replace=function(a,b,c){for(var f=a.za,e=B(a),h=0;h<b.length;h++){var m=b[h];g(a,m);for(var t=0;t<f.length;t+=3)f[t]==m&&(f[t]=e),f[t+1]==m&&(f[t+1]=e),f[t]==f[t+1]&&(f.splice(t,
3),t-=3)}d(a,e,c)};a.uP=function(a,b,c,d,f){m(a,b,c)||Q.D("Edge not found");a=a.za;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&(a[e]=d,a[e+1]=f)};a.YL=function(a,b){function c(a,b){if(-1!=h.indexOf(a)){var d=h.slice(h.indexOf(a));if(-1!=f[d[d.length-1]].indexOf(d[0])){m.push([a,d[d.length-1]]);return}}h.push(a);for(d=0;d<b.length;d++)b[d]in f&&c(b[d],f[b[d]])}b||(b=k(a)[0]);var d=a.za;if(d.length&&-1!=d.indexOf(b)){for(var f={},e=0,g=0;g<d.length;g+=3)d[g+1]in f?f[d[g+1]].push(d[g]):f[d[g+1]]=
[d[g]],e++;var h=[],m=[];c(b,f[b]);for(g=0;g<m.length;g++)for(var t=e=0;t<d.length;t+=3)m[g][1]==d[t+1]&&m[g][0]==d[t]&&n(a,d[t],d[t+1],e),e++}};a.DL=function(a,b,c){var d=a.V;a=a.za;var f;f="digraph debug {\n    node [shape=box];\n";for(var e=0;e<d.length;e+=2){var g=d[e],h=d[e+1],h=b?b(g,h):String(g);f+="    ";f+=String(g)+' [label="'+h.replace(/\"/g,'\\"')+'"];\n'}for(e=0;e<a.length;e+=3)b=a[e],d=a[e+1],h=a[e+2],f+="    ",f+=String(b)+" -> "+String(d),c&&(f+=' [label="'+c(b,d,h)+'"]'),f+=";\n";
return f+"}"}};b4w.module.__ipc=function(a,q){function d(a,b,c){for(var d=0;d<x.length;d+=2)x[d+1]==a&&(l[d+Number(!b)]=c)}function c(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,f;for(f in c){var e=c[f];switch(e.constructor){case Float32Array:d+=e.length;break;case Number:d+=1}}--d;c.len=d}}var b=!0;a.xG=0;a.Bz=1;a.Cz=2;a.rG=3;a.tG=4;a.uG=5;a.vG=6;a.yG=7;a.Dz=8;a.Ou=9;a.Ez=10;a.AG=11;a.Fz=12;a.BG=13;a.zG=14;a.wG=15;a.sG=16;var g=a.Bz,n=a.Cz,B=a.Dz,e=a.Ou,v=a.Ez,w=a.Fz;a.NH=100;a.oH=101;a.pH=102;a.qH=103;a.rH=
104;a.tH=105;a.sH=106;a.uH=107;a.vH=108;a.wH=109;a.xH=110;a.yH=111;a.zH=112;a.BH=113;a.CH=114;a.QH=115;a.DH=116;a.EH=117;a.FH=118;a.HH=119;a.IH=120;a.JH=121;a.LH=122;a.MH=123;a.OH=124;a.AH=125;a.SH=126;a.GH=127;a.Qz=128;a.RH=129;a.TH=130;a.UH=131;a.VH=132;a.WH=133;a.XH=134;a.YH=135;a.ZH=136;a.$H=137;a.aI=138;a.bI=139;a.Rz=140;a.Nn=141;a.cI=142;a.Pz=143;a.dI=144;a.eI=145;a.PH=146;a.KH=147;a.fI=148;var h=a.Nn,l=b4w.worker_listeners,x=b4w.worker_namespaces,k={gf:w,ba:0,time:0,trans:new Float32Array(3),
quat:new Float32Array(4),th:new Float32Array(3),Wg:new Float32Array(3),len:0},f={gf:B,vv:0,Sx:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},F={gf:e,id:0,am:0,If:0,ki:0,len:0},u={gf:v,id:0,am:0,If:0,ki:0,rh:new Float32Array(3),ji:new Float32Array(3),len:0},r={gf:g,tk:0,uk:0,result:0,len:0},z={gf:n,tk:0,uk:0,result:0,Bk:new Float32Array(3),dh:new Float32Array(3),bm:0,len:0},J={gf:h,ba:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},D=[k,f,F,u,r,z,J];a.xL=function(a,c){var f=
{Ks:a?!0:!1,Si:null,$g:[],Cf:""};if(c){var e=q("__util"),g=q("__container");f.Si={addEventListener:function(a,b){"message"!=a&&e.D("Wrong web worker event");d(f.Cf,f.Ks,b)},removeEventListener:function(a){"message"!=a&&e.D("Wrong web worker event");d(f.Cf,f.Ks,null)},postMessage:function(a){var b;a:{for(b=0;b<x.length;b+=2)if(x[b+1]==f.Cf){b=l[b+Number(!!f.Ks)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<x.length;a+=2)if(x[a+1]==f.Cf){l.splice(a,2);x.splice(a,2);break}}};if(f.Ks){var h=
b4w.get_namespace(q),k=e.tq(h+"_worker");x.push(h);x.push(k);l.push(null);l.push(null);f.Cf=k;(g=g.pM(a))?b?g.addEventListener("load",function(){b4w.require("__bindings",f.Cf)},!1):(b4w.cleanup("__bindings",f.Cf),b4w.cleanup("__ipc",f.Cf),b4w.require("__bindings",f.Cf)):(g=document.createElement("script"),g.src=a,g.defer="defer",g.async="async",g.addEventListener("load",function(){b=!1;b4w.require("__bindings",f.Cf)},!1),document.head.appendChild(g))}else f.Cf=b4w.get_namespace(q)}else a?f.Si=new Worker(a):
f.Si=self;return f};a.hJ=function(a,b){function d(c){if(c.constructor==ArrayBuffer)c=new Float32Array(c);else if(c[0].constructor==ArrayBuffer){for(var m=0;m<c.length;m++)d(c[m]);return}m=c[0]|0;switch(m){case w:var t=k;t.ba=c[1]|0;t.time=c[2];t.trans[0]=c[3];t.trans[1]=c[4];t.trans[2]=c[5];t.quat[0]=c[6];t.quat[1]=c[7];t.quat[2]=c[8];t.quat[3]=c[9];t.th[0]=c[10];t.th[1]=c[11];t.th[2]=c[12];t.Wg[0]=c[13];t.Wg[1]=c[14];t.Wg[2]=c[15];break;case B:t=f;t.vv=c[1]|0;t.Sx=c[2]|0;t.trans[0]=c[3];t.trans[1]=
c[4];t.trans[2]=c[5];t.quat[0]=c[6];t.quat[1]=c[7];t.quat[2]=c[8];t.quat[3]=c[9];break;case e:t=F;t.id=c[1]|0;t.am=c[2]|0;t.If=c[3];t.ki=c[4];break;case v:t=u;t.id=c[1]|0;t.am=c[2]|0;t.If=c[3];t.ki=c[4];t.rh[0]=c[5];t.rh[1]=c[6];t.rh[2]=c[7];t.ji[0]=c[8];t.ji[1]=c[9];t.ji[2]=c[10];break;case g:t=r;t.tk=c[1]|0;t.uk=c[2]|0;t.result=!!c[3];break;case n:t=z;t.tk=c[1]|0;t.uk=c[2]|0;t.result=!!c[3];t.Bk[0]=c[4];t.Bk[1]=c[5];t.Bk[2]=c[6];t.dh[0]=c[7];t.dh[1]=c[8];t.dh[2]=c[9];t.bm=c[10];break;case h:t=J;
t.ba=c[1]|0;t.trans[0]=c[2];t.trans[1]=c[3];t.trans[2]=c[4];t.quat[0]=c[5];t.quat[1]=c[6];t.quat[2]=c[7];t.quat[3]=c[8];break;default:t=c}b(a,m,t)}c(D);a.Si.addEventListener("message",function(a){d(a.data)},!1)};a.cleanup=function(){};a.ga=function(a,b){if(a)switch(b){case w:var c=k,d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.ba;d[2]=c.time;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];d[10]=c.th[0];d[11]=c.th[1];d[12]=c.th[2];d[13]=c.Wg[0];
d[14]=c.Wg[1];d[15]=c.Wg[2];a.$g.push(d.buffer);break;case B:c=f;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.vv;d[2]=c.Sx;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];a.$g.push(d.buffer);break;case e:c=F;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.id;d[2]=c.am;d[3]=c.If;d[4]=c.ki;a.$g.push(d.buffer);break;case v:c=u;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.id;d[2]=c.am;d[3]=c.If;d[4]=c.ki;d[5]=c.rh[0];d[6]=c.rh[1];d[7]=c.rh[2];d[8]=c.ji[0];
d[9]=c.ji[1];d[10]=c.ji[2];a.$g.push(d.buffer);break;case g:c=r;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.tk;d[2]=c.uk;d[3]=c.result;a.$g.push(d.buffer);break;case n:c=z;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.tk;d[2]=c.uk;d[3]=c.result;d[4]=c.Bk[0];d[5]=c.Bk[1];d[6]=c.Bk[2];d[7]=c.dh[0];d[8]=c.dh[1];d[9]=c.dh[2];d[10]=c.bm;a.$g.push(d.buffer);break;case h:c=J;d=new Float32Array(c.len);d[0]=c.gf;d[1]=c.ba;d[2]=c.trans[0];d[3]=c.trans[1];d[4]=c.trans[2];d[5]=c.quat[0];d[6]=c.quat[1];d[7]=c.quat[2];
d[8]=c.quat[3];a.$g.push(d.buffer);break;default:d=[];for(c=1;c<arguments.length;c++)d.push(arguments[c]);a.Si.postMessage(d)}};a.mP=function(a){a&&a.$g.length&&(a.Si.postMessage(a.$g),a.$g.length=0)};a.gC=function(a){switch(a){case w:return k;case B:return f;case e:return F;case v:return u;case g:return r;case n:return z;case h:return J;default:return null}};a.terminate=function(a){a.Si.terminate();a.Si=null};a.Fs=function(a){return!!a.Si};a.JC=function(a){return!!a.Cf}};b4w.module.__hud=function(a,q){function d(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function c(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.F){var c=0,d=0,g=0;e.ha(a.F.Ja,function(a,f){if(f.type!=v.Xl){for(var e=Math.round(f.B.width)+"x"+Math.round(f.B.height),h=0,k=0;k<f.Qa.length;k++)h+=f.Qa[k].ra.length;k=f.Ro;if(f.type==v.Wc||f.type==v.qe)h*=6;var l=f.Vb&&!f.$r,r=l?f.Xe:0;f.enqueue||
(f.Xe=0);var t=l?" (\u2713)":" (\u2715)",m=v.Dy(f);b(t,m,f.kt,e,k,"of",h,"  ",r.toFixed(3));f.Ro=0;l&&(c+=h,d+=k,g+=r)}});return[c,d,g]}b("No INFO")}function b(){for(var a=80+20*l[0],b=arguments[0],c=1;c<arguments.length;c++){for(var d="",e=0;e<w[c]-String(arguments[c]).length;e++)d+=" ";b+=d+arguments[c]}l[0]++;h.fillText(b,30,a)}function g(a,b,c){b=a.ic*b;c.x=a.x+b;c.y=a.y;c.ic=a.ic-2*b;c.Ab=a.Ab}function n(a){return a.x+a.ic/2}function B(a){var b=h,c={x:0,y:0,ic:0,Ab:0},d=b.canvas.width,b=b.canvas.height;
c.x=0;c.y=0;c.ic=d;c.Ab=b;g(c,.01,c);d=.02*c.Ab;c.x=c.x;c.y+=d;c.ic=c.ic;c.Ab=c.Ab-2*d;d=c.ic/8;c.x+=d*a;c.y=c.y;c.ic=d;c.Ab=c.Ab;g(c,.02,c);return c}var e=q("__graph"),v=q("__subscene"),w=[5,30,4,10,5,3,5],h=null,l=[0,0];a.init=function(a){a=a.getContext("2d");d(a);return h=a};a.uq=function(){h&&d(h)};a.reset=function(){var a=h;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),l[0]=0,l[1]=0)};a.KQ=function(a,d){var f=
h;if(f){f.textAlign="left";f.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/d).toFixed(2));l[0]++;for(var e=f=0,g=0,k=0;k<a.length;k++){var n=c(a[k]),f=f+n[0],e=e+n[1],g=g+n[2];l[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",e,"of",f,"  ",g.toFixed(3))}};a.print=function(){var a=h;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.plot_array=function(a,b,c,d,e,g,l){var f=h;if(f){b=B(b);var k=b.Ab/5;b.x=b.x;b.y+=
4*k;b.ic=b.ic;b.Ab=k;f.textAlign="center";f.fillStyle="#00FF00";h.fillText(a,n(b),b.y-10);f.strokeStyle="#00FF00";f.lineWidth=.5;f.beginPath();f.moveTo(b.x,b.y);f.lineTo(b.x+b.ic,b.y);f.lineTo(b.x+b.ic,b.y+b.Ab);f.lineTo(b.x,b.y+b.Ab);f.closePath();f.stroke();if(!g&&!l)for(g=1E6,l=-1E6,a=0;a<c.length;a++)g=Math.min(g,c[a]),l=Math.max(l,c[a]);f.textAlign="right";h.fillText(String(g),b.x-10,b.y+b.Ab);h.fillText(String(l),b.x-10,b.y);f.textAlign="center";h.fillText(String(d),b.x,b.y+b.Ab+15);h.fillText(String(e),
b.x+b.ic,b.y+b.Ab+15);f.strokeStyle="#FF0000";f.lineWidth=1.5;f.beginPath();d=b.ic/(c.length-1);l=b.Ab/(l-g);for(a=0;a<c.length;a++)e=b.x+d*a,k=b.y+b.Ab-(c[a]-g)*l,a?f.lineTo(e,k):f.moveTo(e,k);f.stroke()}};a.draw_mixer_strip=function(a,b,c,d,e,g,l){var f=h;if(f)for(f.textAlign="center",f.fillStyle="#00FF00",f.font="bold 12px Courier",c=B(c),h.fillText(b?"["+a+"]":a,n(c),c.y),0<=g&&h.fillText(g?"[M]":"[ ]",n(c)-15,c.y+30),0<=l&&h.fillText(l?"[S]":"[ ]",n(c)+15,c.y+30),a={x:0,y:0,ic:0,Ab:0},b=0;b<
d.length;b++){g=d[b];var k="VOLUME"==g[0];if(k){l=c.y+350;var r=c.ic,u=a;u.x=c.x;u.y=l;u.ic=r;u.Ab=250}else{l=c.y+50+50*b;var r=c.ic,u=c.Ab,t=a;t.x=c.x;t.y=l;t.ic=r;t.Ab=u}l=f;var r=a,t=b==e,m=g[0],u=g[1],A=g[2],w=g[3],p=(w-A)/g[4],p=1>p?Math.floor(1/p-1E-5).toFixed(0).length:0;g=g[5]?Math.log(u/A)/Math.log(w/A):(u-A)/(w-A);l.textAlign="center";t?l.fillText("["+m+"]",n(r),r.y):l.fillText(m,n(r),r.y);l.strokeStyle="#00FF00";l.lineWidth=k?3:1;k?(l.textAlign="right",l.fillText(w.toFixed(p),n(r)-10,r.y+
15),l.textAlign="right",l.fillText(A.toFixed(p),n(r)-10,r.y+r.Ab-15)):(l.textAlign="right",l.fillText(A.toFixed(p),r.x+28,r.y+15),l.textAlign="left",l.fillText(w.toFixed(p),r.x+r.ic-28,r.y+15));l.beginPath();if(k){var v=r.y+15+(r.Ab-30)*(1-g);l.moveTo(n(r),r.y+15);l.lineTo(n(r),r.y+r.Ab-15);l.moveTo(n(r)-5,r.y+15);l.lineTo(n(r)+5,r.y+15);l.moveTo(n(r)-5,r.y+r.Ab-15);l.lineTo(n(r)+5,r.y+r.Ab-15);l.moveTo(n(r)-5,v);l.lineTo(n(r)+5,v)}else{var y=r.x+30+(r.ic-60)*g;l.moveTo(r.x+30,r.y+15);l.lineTo(r.x+
r.ic-30,r.y+15);l.moveTo(r.x+30,r.y+15-5);l.lineTo(r.x+30,r.y+15+5);l.moveTo(r.x+r.ic-30,r.y+15-5);l.lineTo(r.x+r.ic-30,r.y+15+5);l.moveTo(y,r.y+15-5);l.lineTo(y,r.y+15+5)}l.stroke();"EQ_Q"==m?(g=Math.log(1+1/(2*u*u)+Math.sqrt((2+1/(u*u))*(2+1/(u*u))/4-1))/Math.log(2),k?(l.textAlign="left",l.fillText(u.toFixed(p),n(r)+10,v),l.textAlign="left",l.fillText("("+g.toFixed(p+1)+")",n(r)+10,v+10)):(l.textAlign="right",l.fillText(u.toFixed(p),y,r.y+30),l.textAlign="left",l.fillText("("+g.toFixed(p+1)+")",
y,r.y+30))):k?(l.textAlign="left",l.fillText(u.toFixed(p),n(r)+10,v)):(l.textAlign="center",l.fillText(u.toFixed(p),y,r.y+30))}}};b4w.module.__renderer=function(a,q){function d(a){for(var c=a.B,d=a.Qa,f=null,e=F.ec(c.v,Y),g=0;g<d.length;g++){var h=d[g];if(h.Vb){var r=h.ib,h=h.ra;if(r.Ch!=f){m.useProgram(r.Ch);for(var f=a,p=c,A=r,L=A.qF,v=L.length;v--;){var aa=L[v];aa.vm(m,aa.Nd,f,p)}if(A.Om&&!A.jt)for(A.Mx.length||n(A),A=A.Mx,L=A.length;L--;)aa=A[L],aa.vm(m,aa.Nd,f,p);f=r.Ch}for(p=0;p<h.length;p++)if(v=h[p],v.Vb){L=v.Ee;aa=v.qa;w.CP(aa);w.IC()&&"DEBUG_VIEW"==aa.type&&(aa.Qo=u.smooth(B.kJ(aa.gm),aa.Qo,1,15));if(E.alpha_sort&&
aa.Pe){var A=L,v=v.Cs,x=e,C=aa.da;if(z.dist(x,v.gG)>E.alpha_sort_threshold*Math.min(v.nJ,1)||A.fp)l.FR(C,v,A.v,x),z.copy(x,v.gG),A.fp=!1}for(var A=a,x=aa,v=r,D=v.rF,H=D.length;H--;)C=D[H],C.vm(m,C.Nd,L,x);if(v.Om&&!v.jt){v.Lp.length||n(v);D=v.Lp;for(H=D.length;H--;)C=D[H],C.vm(m,C.Nd,L,x);v.Om=!1}m.depthMask(x.Va);x.Qb?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE);C=x.Sa;D=m;for(H=0;H<C.length;H++){var Q=C[H];D.activeTexture(D.TEXTURE0+H);D.bindTexture(Q.qb,Q.Cb)}if(A.type==k.gg){L=A;v=v.Gl;C=L.B.lc.Cb;
D=L.Hk;for(H=0;6>H;H++)if(Q=b(H),E.zv?(m.bindTexture(m.TEXTURE_CUBE_MAP,C),m.texImage2D(Q,0,m.RGBA,1,1,0,m.RGBA,m.UNSIGNED_BYTE,t)):(m.uniformMatrix4fv(v.u_cube_view_matrix,!1,D[H]),m.uniform4fv(v.u_sky_tex_fac,L.St),m.uniform3fv(v.u_sky_tex_color,L.Qt),m.uniform1f(v.u_sky_tex_dvar,L.Rt),m.uniform3fv(v.u_horizon_color,L.Md),m.uniform3fv(v.u_zenith_color,L.Vd),m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,Q,C,0),y(x,0)),L.gt&&3!=H){var Q=L,I=H,ra=G;E.zv?ra.set(t):(m.readPixels(191,191,1,
1,m.RGBA,m.UNSIGNED_BYTE,ra),255!=ra[0]&&255!=ra[1]&&255!=ra[2]||m.readPixels(191,220,1,1,m.RGBA,m.UNSIGNED_BYTE,ra));var J=ra[0],W=ra[1],ra=ra[2],J=J/255,W=W/255,ra=ra/255;2===I?(Q.$d[3]=J,Q.$d[7]=W,Q.$d[11]=ra):2>I?(Q.$d[4*I]=J,Q.$d[4*I+1]=W,Q.$d[4*I+2]=ra):(Q.$d[4*(I-2)]=J,Q.$d[4*(I-2)+1]=W,Q.$d[4*(I-2)+2]=ra)}A.Ro+=6}else y(x,L.mu),A.Ro++;w.DP(aa);w.IC()&&"MAIN"==aa.type&&B.lJ(aa.id,aa.Xe)}}}}function c(a){if(a){var b=(a.rb?m.COLOR_BUFFER_BIT:0)|(a.tb?m.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case k.Id:a=
C;break;case k.Xc:a=J;break;case k.Re:a=D;break;case k.Wd:case k.dg:case k.Rl:a=H;break;case k.fg:case k.Qn:case k.Sq:a=C;break;default:a=E.background_color}}else b=m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT,a=E.background_color;m.colorMask(!0,!0,!0,!0);m.depthMask(!0);m.clearColor(a[0],a[1],a[2],a[3]);m.clear(b)}function b(a){switch(a){case 0:return m.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return m.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return m.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return m.TEXTURE_CUBE_MAP_NEGATIVE_Y;
case 4:return m.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return m.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function g(a){var b=h.Ew(),c=a.ao,d=a.da,f=d.Fb;a.ne.length=0;var e=1,g;for(g in f)e=Math.max(e,f[g].frames);for(f=0;f<e;f++){g=b.createVertexArray();Q(g);d.Jf&&m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,d.Jf);for(var l=0;l<d.Sc.length;l++){m.bindBuffer(m.ARRAY_BUFFER,d.Sc[l].Qi);for(var t=0;t<c.length;t++){var k=c[t];k.ou==d.Sc[l].type&&(m.enableVertexAttribArray(k.Nd),m.vertexAttribPointer(k.Nd,k.Wb,k.xm,k.xm==m.FLOAT?
!1:!0,k.Fi,k.jr+k.as*f),I(k.Nd,k.Lk))}}Q(null);a.ne.push(g)}}function n(a){var b=a.Gl,c=a.rF,d=a.Lp,f=a.qF,e=a.Mx;c.length=0;d.length=0;f.length=0;e.length=0;for(var g in b){var h=!1,l=null,t=null;switch(g){case "u_proj_matrix":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.lb)};h=!0;break;case "u_view_refl_matrix":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.su)};h=!0;break;case "u_view_tsr":case "u_view_tsr_frag":l=function(a,b,c,d){d.hc?a.uniformMatrix3fv(b,!1,d.Vp):a.uniformMatrix3fv(b,!1,d.Me)};
h=!0;break;case "u_view_tsr_inverse":l=function(a,b,c,d){d.hc?a.uniformMatrix3fv(b,!1,d.Ft):a.uniformMatrix3fv(b,!1,d.tu)};h=!0;break;case "u_shadow_cast_billboard_view_tsr":l=function(a,b,c,d){a.uniformMatrix3fv(b,!1,d.gq)};h=!0;break;case "u_view_proj_prev":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Rx)};h=!0;break;case "u_view_proj_matrix":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Tc)};h=!0;break;case "u_view_proj_inverse":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.ru)};h=!0;break;case "u_sky_vp_inverse":l=
function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Wf)};h=!0;break;case "u_camera_eye":case "u_camera_eye_frag":l=function(a,b,c,d){a.uniform3fv(b,F.ec(d.v,Y))};h=!0;break;case "u_camera_quat":l=function(a,b,c,d){a.uniform4fv(b,F.Qc(d.v,R))};h=!0;break;case "u_view_max_depth":l=function(a,b,c,d){a.uniform1f(b,d.far)};h=!0;break;case "u_camera_range":l=function(a,b,c,d){a.uniform2f(b,d.near,d.far)};break;case "u_csm_center_dists":l=function(a,b,c,d){a.uniform4fv(b,d.Fr)};break;case "u_height":l=function(a,
b,c,d){a.uniform1f(b,d.height)};h=!0;break;case "u_pcf_blur_radii":l=function(a,b,c,d){a.uniform4fv(b,d.Sm)};break;case "u_dof_dist":l=function(a,b,c,d){d.dof_on?a.uniform1f(b,d.dof_distance):a.uniform1f(b,0)};h=!0;break;case "u_dof_front_start":l=function(a,b,c,d){a.uniform1f(b,d.dof_front_start)};h=!0;break;case "u_dof_front_end":l=function(a,b,c,d){a.uniform1f(b,d.dof_front_end)};h=!0;break;case "u_dof_rear_start":l=function(a,b,c,d){a.uniform1f(b,d.dof_rear_start)};h=!0;break;case "u_dof_rear_end":l=
function(a,b,c,d){a.uniform1f(b,d.dof_rear_end)};h=!0;break;case "u_dof_bokeh_intensity":l=function(a,b,c,d){a.uniform1f(b,d.dof_bokeh_intensity)};h=!0;break;case "u_camera_direction":l=function(a,b,c,d){a.uniform3fv(b,d.direction)};h=!0;break;case "u_cam_water_depth":l=function(a,b,c){a.uniform1f(b,c.uv)};h=!0;break;case "u_waves_height":l=function(a,b,c){a.uniform1f(b,c.lz)};break;case "u_waves_length":l=function(a,b,c){a.uniform1f(b,c.mz)};break;case "u_fog_color_density":l=function(a,b,c){a.uniform4fv(b,
c.ce)};break;case "u_fog_params":l=function(a,b,c){a.uniform4fv(b,c.Ef)};break;case "u_underwater_fog_color_density":l=function(a,b,c){a.uniform4fv(b,c.Lh)};break;case "u_bloom_key":l=function(a,b,c){a.uniform1f(b,c.nr)};break;case "u_bloom_edge_lum":l=function(a,b,c){a.uniform1f(b,c.mr)};break;case "u_time":l=function(a,b,c){a.uniform1f(b,c.time)};h=!0;break;case "u_wind":l=function(a,b,c){a.uniform3fv(b,c.Ti)};h=!0;break;case "u_sky_tex_dvar":l=function(a,b,c){a.uniform1f(b,c.Rt)};break;case "u_sky_tex_fac":l=
function(a,b,c){a.uniform4fv(b,c.St)};break;case "u_sky_tex_color":l=function(a,b,c){a.uniform3fv(b,c.Qt)};break;case "u_horizon_color":l=function(a,b,c){a.uniform3fv(b,c.Md)};break;case "u_zenith_color":l=function(a,b,c){a.uniform3fv(b,c.Vd)};break;case "u_environment_energy":l=function(a,b,c){a.uniform1f(b,c.wg)};break;case "u_sky_color":l=function(a,b,c){a.uniform3fv(b,c.en)};break;case "u_rayleigh_brightness":l=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};break;case "u_mie_brightness":l=
function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":l=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":l=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":l=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":l=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":l=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};break;case "u_mie_collection_power":l=
function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":l=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":l=function(a,b,c){a.uniform4fv(b,c.Cp)};break;case "u_light_directions":l=function(a,b,c){a.uniform3fv(b,c.dx)};break;case "u_light_color_intensities":l=function(a,b,c){a.uniform4fv(b,c.Ap)};break;case "u_sun_quaternion":l=function(a,b,c){a.uniform4fv(b,c.ZE)};break;case "u_sun_intensity":l=function(a,b,c){a.uniform3fv(b,c.YE)};
break;case "u_sun_direction":l=function(a,b,c){a.uniform3fv(b,c.Ey)};break;case "u_debug_view_mode":l=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":l=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":l=function(a,b,c){a.uniform1f(b,c.tB)};break;case "u_subpixel_jitter":l=function(a,b,c){a.uniform2fv(b,c.VN)};h=!0;break;case "u_subsample_indices":l=function(a,b,c){a.uniform4fv(b,c.WN)};h=!0;break;case "u_radial_blur_step":l=
function(a,b,c){a.uniform1f(b,c.Dt)};break;case "u_god_rays_intensity":l=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":l=function(a,b,c){a.uniform1f(b,c.$t)};break;case "u_ssao_blur_discard_value":l=function(a,b,c){a.uniform1f(b,c.Wt)};h=!0;break;case "u_ssao_influence":l=function(a,b,c){a.uniform1f(b,c.Zt)};break;case "u_ssao_dist_factor":l=function(a,b,c){a.uniform1f(b,c.Xt)};break;case "u_texel_size":l=function(a,b,c){a.uniform2fv(b,c.My)};h=!0;break;
case "u_normal_offset":l=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":l=function(a,b,c){a.uniform4fv(b,c.lu)};h=!0;break;case "u_v_light_r":l=function(a,b,c){a.uniform4fv(b,c.ku)};h=!0;break;case "u_v_light_tsr":l=function(a,b,c){a.uniformMatrix3fv(b,!1,c.hz)};h=!0;break;case "u_p_light_matrix0":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.rl[0])};h=!0;break;case "u_p_light_matrix1":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.rl[1])};h=!0;break;case "u_p_light_matrix2":l=
function(a,b,c){a.uniformMatrix4fv(b,!1,c.rl[2])};h=!0;break;case "u_p_light_matrix3":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.rl[3])};h=!0;break;case "u_outline_color":l=function(a,b,c){a.uniform3fv(b,c.vi)};break;case "u_draw_outline":l=function(a,b,c){a.uniform1f(b,c.dw)};h=!0;break;case "u_glow_mask_small_coeff":l=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};h=!0;break;case "u_glow_mask_large_coeff":l=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};h=!0;break;case "u_brightness":l=
function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":l=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":l=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":l=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":l=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":l=function(a,b,c){a.uniform4fv(b,c.Kk)};break;case "u_chromatic_aberration_coefs":l=function(a,b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};
break;case "u_motion_blur_exp":l=function(a,b,c){a.uniform1f(b,c.iD)};h=!0;break;case "u_motion_blur_decay_threshold":l=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};h=!0;break;case "u_model_tsr":t=function(a,b,c){a.uniformMatrix3fv(b,!1,c.v)};h=!0;break;case "u_model_tsr_inverse":t=function(a,b,c){a.uniformMatrix3fv(b,!1,c.Bu)};h=!0;break;case "u_transb":t=function(a,b,c){a.uniform4fv(b,c.Td)};h=!0;break;case "u_transa":t=function(a,b,c){a.uniform4fv(b,c.ke)};h=!0;break;case "u_arm_rel_trans":t=
function(a,b,c){a.uniform4fv(b,c.Zn)};h=!0;break;case "u_arm_rel_quat":t=function(a,b,c){a.uniform4fv(b,c.Yn)};h=!0;break;case "u_quat":t=function(a,b,c){a.uniform4fv(b,F.Qc(c.v,R))};h=!0;break;case "u_quatsb":t=function(a,b,c){a.uniform4fv(b,c.Pd)};h=!0;break;case "u_quatsa":t=function(a,b,c){a.uniform4fv(b,c.he)};h=!0;break;case "u_frame_factor":t=function(a,b,c){a.uniform1f(b,c.Be)};h=!0;break;case "au_center_pos":t=function(a,b,c){a.uniform3fv(b,c.so)};h=!0;break;case "au_wind_bending_amp":t=
function(a,b,c){a.uniform1f(b,c.Ne)};h=!0;break;case "au_wind_bending_freq":t=function(a,b,c){a.uniform1f(b,c.Oe)};h=!0;break;case "au_detail_bending_freq":t=function(a,b,c){a.uniform1f(b,c.ye)};h=!0;break;case "au_detail_bending_amp":t=function(a,b,c){a.uniform1f(b,c.xe)};h=!0;break;case "au_branch_bending_amp":t=function(a,b,c){a.uniform1f(b,c.te)};h=!0;break;case "u_node_values":t=function(a,b,c,d){a.uniform1fv(b,d.Gg)};h=!0;break;case "u_node_rgbs":t=function(a,b,c,d){a.uniform3fv(b,d.Bd)};h=
!0;break;case "u_diffuse_color":t=function(a,b,c,d){a.uniform4fv(b,d.xd)};h=!0;break;case "u_diffuse_intensity":t=function(a,b,c,d){a.uniform1f(b,d.ih)};h=!0;break;case "u_diffuse_params":t=function(a,b,c,d){a.uniform2fv(b,d.$c)};h=!0;break;case "u_emit":t=function(a,b,c,d){a.uniform1f(b,d.ug)};h=!0;break;case "u_ambient":t=function(a,b,c,d){a.uniform1f(b,d.lg)};h=!0;break;case "u_specular_color":t=function(a,b,c,d){a.uniform3fv(b,d.Yf)};h=!0;break;case "u_specular_alpha":t=function(a,b,c,d){a.uniform1f(b,
d.Cl)};h=!0;break;case "u_specular_params":t=function(a,b,c,d){a.uniform3fv(b,d.Rd)};h=!0;break;case "u_reflect_factor":t=function(a,b,c,d){a.uniform1f(b,d.reflect_factor)};h=!0;break;case "u_mirror_factor":t=function(a,b,c,d){a.uniform1f(b,d.kl)};h=!0;break;case "u_grass_map_dim":t=function(a,b,c,d){a.uniform3fv(b,d.hd)};h=!0;break;case "u_grass_size":t=function(a,b,c,d){a.uniform1f(b,d.ii)};h=!0;break;case "u_scale_threshold":t=function(a,b,c,d){a.uniform1f(b,d.os)};h=!0;break;case "u_cube_fog":t=
function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.$d)};break;case "u_jitter_amp":t=function(a,b,c,d){a.uniform1f(b,d.Ns)};h=!0;break;case "u_jitter_freq":t=function(a,b,c,d){a.uniform1f(b,d.Os)};h=!0;break;case "u_wireframe_edge_color":t=function(a,b,c,d){a.uniform3fv(b,d.wireframe_edge_color)};break;case "u_cluster_id":t=function(a,b,c,d){a.uniform1f(b,d.Ao)};h=!0;break;case "u_batch_debug_id_color":t=function(a,b,c,d){a.uniform1f(b,d.Jr)};h=!0;break;case "u_batch_debug_main_render_time":t=function(a,
b,c,d){a.uniform1f(b,d.Qo)};h=!0;break;case "u_refr_bump":t=function(a,b,c,d){a.uniform1f(b,d.Vm)};h=!0;break;case "u_line_width":t=function(a,b,c,d){a.uniform1f(b,d.Hm)};h=!0;break;case "u_lamp_light_positions":t=function(a,b,c,d){a.uniform3fv(b,d.Fm)};break;case "u_lamp_light_directions":t=function(a,b,c,d){a.uniform3fv(b,d.yp)};break;case "u_lamp_light_color_intensities":t=function(a,b,c,d){a.uniform3fv(b,d.xp)};break;case "u_halo_size":t=function(a,b,c,d){a.uniform1f(b,d.xs)};h=!0;break;case "u_halo_hardness":t=
function(a,b,c,d){a.uniform1f(b,d.us)};h=!0;break;case "u_halo_rings_color":t=function(a,b,c,d){a.uniform3fv(b,d.ws)};h=!0;break;case "u_halo_lines_color":t=function(a,b,c,d){a.uniform3fv(b,d.vs)};h=!0;break;case "u_halo_stars_blend":t=function(a,b,c,d){a.uniform1f(b,d.ys)};h=!0;break;case "u_halo_stars_height":t=function(a,b,c,d){a.uniform1f(b,d.zs)};h=!0;break;case "u_fresnel_params":t=function(a,b,c,d){a.uniform4fv(b,d.bf)};h=!0;break;case "u_texture_scale":t=function(a,b,c,d){a.uniform3fv(b,d.$f)};
h=!0;break;case "u_parallax_scale":t=function(a,b,c,d){a.uniform1f(b,d.parallax_scale)};h=!0;break;case "u_color_id":t=function(a,b,c){a.uniform3fv(b,c.aj)};h=!0;break;case "u_diffuse_color_factor":t=function(a,b,c,d){a.uniform1f(b,d.hh)};h=!0;break;case "u_alpha_factor":t=function(a,b,c,d){a.uniform1f(b,d.xf)};h=!0;break;case "u_specular_color_factor":t=function(a,b,c,d){a.uniform1f(b,d.Di)};h=!0;break;case "u_normal_factor":t=function(a,b,c,d){a.uniform1f(b,d.Pm)};h=!0;break;case "u_normalmap0_scale":t=
function(a,b,c,d){a.uniform2fv(b,d.ui[0])};h=!0;break;case "u_normalmap1_scale":t=function(a,b,c,d){a.uniform2fv(b,d.ui[1])};h=!0;break;case "u_normalmap2_scale":t=function(a,b,c,d){a.uniform2fv(b,d.ui[2])};h=!0;break;case "u_normalmap3_scale":t=function(a,b,c,d){a.uniform2fv(b,d.ui[3])};h=!0;break;case "u_foam_factor":t=function(a,b,c,d){a.uniform1f(b,d.foam_factor)};h=!0;break;case "u_foam_uv_freq":t=function(a,b,c,d){a.uniform2fv(b,d.Zr)};h=!0;break;case "u_foam_mag":t=function(a,b,c,d){a.uniform2fv(b,
d.Yr)};h=!0;break;case "u_foam_scale":t=function(a,b,c,d){a.uniform2fv(b,d.bp)};h=!0;break;case "u_water_norm_uv_velocity":t=function(a,b,c,d){a.uniform1f(b,d.gk)};h=!0;break;case "u_shallow_water_col":t=function(a,b,c,d){a.uniform3fv(b,d.shallow_water_col)};h=!0;break;case "u_shore_water_col":t=function(a,b,c,d){a.uniform3fv(b,d.shore_water_col)};h=!0;break;case "u_water_shallow_col_fac":t=function(a,b,c,d){a.uniform1f(b,d.shallow_water_col_fac)};h=!0;break;case "u_water_shore_col_fac":t=function(a,
b,c,d){a.uniform1f(b,d.shore_water_col_fac)};h=!0;break;case "u_p_length":t=function(a,b,c,d){a.uniform1f(b,d.wa.jF)};h=!0;break;case "u_p_cyclic":t=function(a,b,c,d){a.uniform1i(b,d.wa.cyclic)};h=!0;break;case "u_p_max_lifetime":t=function(a,b,c,d){a.uniform1f(b,d.wa.XC)};h=!0;break;case "u_p_fade_in":t=function(a,b,c,d){a.uniform1f(b,d.wa.Nk)};h=!0;break;case "u_p_fade_out":t=function(a,b,c,d){a.uniform1f(b,d.wa.$e)};h=!0;break;case "u_p_size":t=function(a,b,c,d){a.uniform1f(b,d.wa.size)};h=!0;
break;case "u_p_alpha_start":t=function(a,b,c,d){a.uniform1f(b,d.wa.dA)};h=!0;break;case "u_p_alpha_end":t=function(a,b,c,d){a.uniform1f(b,d.wa.cA)};h=!0;break;case "u_p_nfactor":t=function(a,b,c,d){a.uniform1f(b,d.wa.it)};h=!0;break;case "u_p_gravity":t=function(a,b,c,d){a.uniform1f(b,d.wa.qC)};h=!0;break;case "u_p_mass":t=function(a,b,c,d){a.uniform1f(b,d.wa.vh)};h=!0;break;case "u_p_color_ramp":t=function(a,b,c,d){a.uniform4fv(b,d.wa.aB)};h=!0;break;case "u_p_wind_fac":t=function(a,b,c,d){a.uniform1f(b,
d.wa.bG)};h=!0;break;case "u_p_time":t=function(a,b,c,d){a.uniform1f(b,d.wa.time)};h=!0;break;case "u_p_tilt":t=function(a,b,c,d){a.uniform1f(b,d.wa.hF)};h=!0;break;case "u_p_tilt_rand":t=function(a,b,c,d){a.uniform1f(b,d.wa.iF)};h=!0;break;case "u_position":t=function(a,b,c,d){a.uniform3fv(b,d.lk)};h=!0;break;case "u_va_frame_factor":t=function(a,b,c){a.uniform1f(b,c.nu)};h=!0;break;case "u_refl_plane":t=function(a,b,c){a.uniform4fv(b,c.hc)};h=!0;break;case "u_outline_intensity":t=function(a,b,c){a.uniform1f(b,
c.Jg)};h=!0;break;case "u_obj_info":t=function(a,b,c,d){a.uniform3fv(b,d.Qm)},h=!0}t&&(t={name:g,vm:t,Nd:b[g]},h?c.push(t):d.push(t));l&&(t={name:g,vm:l,Nd:b[g]},h?f.push(t):e.push(t))}if(d.length||e.length){a=a.Nx;for(var k in a)delete a[k];for(k=0;k<d.length;k++)t=d[k],a[t.name]=t;for(k=0;k<e.length;k++)t=e[k],a[t.name]=t}else a.jt=!0}var B=q("__batch"),e=q("__camera"),v=q("__config"),w=q("__debug"),h=q("__extensions"),l=q("__geometry"),x=q("__quat"),k=q("__subscene"),f=q("__textures"),F=q("__tsr"),
u=q("__util"),r=q("__version"),z=q("__vec3"),J=[1,1,1,1],D=[1,1,1,1],H=[0,0,0,1],C=[0,0,0,0],t=new Uint8Array([91.8,142.8,.96*255,255]),m=null,A=null,I=null,p=null,Q=null,y=null,Y=new Float32Array(3),R=x.create(),G=new Uint8Array(4),E=v.H;a.mf=function(a){var b=E.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);m=a};a.lm=
function(a){if(a.Vb&&!a.$r)if(a.type==k.Rq){w.Yx(a);var f=a.B;m.bindFramebuffer(m.READ_FRAMEBUFFER,f.gp);m.bindFramebuffer(m.DRAW_FRAMEBUFFER,f.ee);var h=0;f.lc&&(h|=m.COLOR_BUFFER_BIT);f.we&&(h|=m.DEPTH_BUFFER_BIT);m.blitFramebuffer(0,0,f.width,f.height,0,0,f.width,f.height,h,m.NEAREST);w.Zx(a);w.wv("draw resolve")}else if(a.type==k.Gu)w.Yx(a),f=a.B,m.bindFramebuffer(m.FRAMEBUFFER,f.gp),m.bindTexture(m.TEXTURE_2D,f.lc.Cb),m.copyTexSubImage2D(m.TEXTURE_2D,0,0,0,0,0,f.width,f.height,0),w.Zx(a),w.wv("draw copy");
else{w.Yx(a);f=a.B;m.bindFramebuffer(m.FRAMEBUFFER,f.ee);a.dv&&(h=f.lc,m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,h.qb,h.Cb,0));m.viewport(0,0,f.width,f.height);a.type!=k.Wc&&a.type!=k.qe&&c(a);a.yb?m.enable(m.BLEND):m.disable(m.BLEND);a.wd?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST);switch(a.type){case k.Xc:m.enable(m.POLYGON_OFFSET_FILL);m.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);m.cullFace(m.BACK);break;case k.qd:case k.Qe:m.disable(m.POLYGON_OFFSET_FILL);
m.cullFace(m.FRONT);break;case k.eg:m.enable(m.POLYGON_OFFSET_FILL);m.polygonOffset(-4,-4);m.cullFace(m.BACK);break;case k.Id:if(1<E.uc||E.aE){m.enable(m.POLYGON_OFFSET_FILL);m.polygonOffset(-2,-2);break}default:m.disable(m.POLYGON_OFFSET_FILL),m.cullFace(m.BACK)}if(a.type==k.Wc||a.type==k.qe)for(var f=a.B,h=f.lc.Cb,g=0;6>g;g++){var t=b(g);f.Hb=a.Hk[g];F.from_mat4(f.Hb,f.Me);e.rv(f);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,t,h,0);c(a);for(var t=a.Qa,l=0;l<t.length;l++)for(var r=0;r<
t[l].ra.length;r++){var p=t[l].ra[r];p.Vb=p.cw[g]}d(a)}else d(a);w.Zx(a);w.wv("draw subscene: "+k.Dy(a))}};a.clear=function(a){m.bindFramebuffer(m.FRAMEBUFFER,a.B.ee);c(a)};a.cv=function(a){var b=a.ao;b.length=0;var c=a.da,d=c.Fb,f=a.ib.attributes,e;for(e in f){var h=d[e],t=l.nj(e),k=l.kN(e),m=l.mC(e);b.push({ou:t,xm:k,Nd:f[e],jr:h.offset*m,as:1<h.frames?h.length*m:0,Wb:h.Wb,Fi:h.Fi*m,Lk:h.Lk})}if("DEBUG"==r.type())for(e in d)t=l.nj(e),b=l.WP(c.Sc,t),b=c.Sc[b],h=a.ab.bg+" | "+a.ab.Ae,t=d[e].length*
d[e].frames*l.mC(e),w.lM(b.EL,h,e,t,e in f);E.Zu&&g(a)};a.gJ=g;a.kK=function(a){for(var b=h.Ew(),c=0;c<a.ne.length;c++)b.deleteVertexArray(a.ne[c]);a.ne.length=0};a.mK=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({ou:d.ou,xm:d.xm,Nd:d.Nd,jr:d.jr,as:d.as,Wb:d.Wb,Fi:d.Fi,Lk:d.Lk})}return b};a.fJ=n;a.kA=function(a){var b=a.ib,c=a.Sa;a=a.Ie;m.useProgram(b.Ch);for(var d=0;d<c.length;d++)m.uniform1i(b.Gl[a[d]],d)};a.Et=function(a,b,c,d,f,e){d||(d=1);f||(f=1);e||(e=new Uint8Array(4*d*f));
e.length!=4*d*f&&u.D("read_pixels(): Wrong storage");m.bindFramebuffer(m.FRAMEBUFFER,a);m.readPixels(b,c,d,f,m.RGBA,m.UNSIGNED_BYTE,e);m.bindFramebuffer(m.FRAMEBUFFER,null);return e};a.CR=function(a){var b=a.ib;b.jt||(m.useProgram(b.Ch),b.Lp.length||n(b),b=b.Nx.u_cube_fog,b.vm(m,b.Nd,null,a))};a.BP=function(a,b){var c=m.createFramebuffer();m.bindFramebuffer(m.FRAMEBUFFER,c);if(f.Dm(a)){var d=a.pe;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.RENDERBUFFER,d)}else if(f.Em(a)){var e=
a,d=e.Cb,e=e.qb==m.TEXTURE_CUBE_MAP?m.TEXTURE_CUBE_MAP_NEGATIVE_Z:e.qb;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,e,d,0)}f.Dm(b)?(d=b.pe,m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,d)):f.Em(b)&&(e=b,d=e.Cb,e=e.qb,m.framebufferTexture2D(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,e,d,0));w.SJ();m.bindFramebuffer(m.FRAMEBUFFER,null);return c};a.AP=function(a,b,c,d,e){null==a?(m.bindFramebuffer(m.FRAMEBUFFER,a),m.viewport(0,0,d,e),m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT)):
(f.Dm(b)?m.deleteRenderbuffer(b.pe):f.Em(b)&&m.deleteTexture(b.Cb),f.Dm(c)?m.deleteRenderbuffer(c.pe):f.Em(c)&&m.deleteTexture(c.Cb),m.deleteFramebuffer(a))};a.rU=function(){};a.OL=function(a,b,c,d,f,e){a=a.Cb;m.viewport(0,0,c,c);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,b,a,0);b=B.Kv("FLIP_CUBEMAP_COORDS");a=b.ib;m.activeTexture(m.TEXTURE0);m.bindTexture(m.TEXTURE_2D,f);var h=f=0;c!=d&&(f=1/(6*d),h=1/(4*d));m.uniform1i(a.Gl.u_tex_number,e);m.uniform2fv(a.Gl.u_delta,[f,h]);m.useProgram(a.Ch);
y(b,0);m.bindTexture(m.TEXTURE_2D,null)};a.PL=function(a,b,c,d,f){m.bindFramebuffer(m.FRAMEBUFFER,d);d=a.Cb;a=a.qb;m.bindTexture(a,d);m.viewport(0,0,b,c);m.texImage2D(a,0,m.RGBA,b,c,0,m.RGBA,m.UNSIGNED_BYTE,null);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,a,d,0);b=B.Kv("NONE");c=b.ib;m.activeTexture(m.TEXTURE0);m.bindTexture(a,f);m.useProgram(c.Ch);y(b,0);m.bindFramebuffer(m.FRAMEBUFFER,null);m.bindTexture(a,null)};a.cleanup=function(){};a.gQ=function(){var a=h.nN(),b=h.Ew();E.bA=a?
!0:!1;E.Zu=b?!0:!1;a?(A=function(b,c,d,f){a.drawElementsInstanced(m.TRIANGLES,b,c,d,f)},I=function(b,c){a.vertexAttribDivisor(b,c)},p=function(b,c,d){a.drawArraysInstanced(m.TRIANGLES,b,c,d)}):(A=function(a,b,c){m.drawElements(m.TRIANGLES,a,b,c)},I=function(){},p=function(a,b){m.drawArrays(m.TRIANGLES,a,b)});b?(Q=function(a){b.bindVertexArray(a)},y=function(a,b){var c=a.da;Q(a.ne[b]);c.Jf?A(c.count,c.Tk,0,c.Zk):p(0,c.count,c.Zk);Q(null)}):y=function(a,b){for(var c=a.da,d=a.ao,f=0;f<c.Sc.length;f++){m.bindBuffer(m.ARRAY_BUFFER,
c.Sc[f].Qi);for(var e=0;e<d.length;e++){var h=d[e];h.ou==c.Sc[f].type&&(m.enableVertexAttribArray(h.Nd),m.vertexAttribPointer(h.Nd,h.Wb,h.xm,h.xm==m.FLOAT?!1:!0,h.Fi,h.jr+h.as*b),I(h.Nd,h.Lk))}}c.Jf?(m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,c.Jf),A(c.count,c.Tk,0,c.Zk)):p(0,c.count,c.Zk);for(f=0;f<d.length;f++)h=d[f],m.disableVertexAttribArray(h.Nd)}};a.reset=function(){Q=p=I=A=m=null}};b4w.module.__shaders=function(a,q){function d(a,b,d){var f=a.di;"string"==typeof d?(a=c(a,d))&&(d=a[1]):d=String(d);for(a=0;a<f.length;a++)if(f[a][0]==b){f[a][1]=d;break}}function c(a,b){for(var c=a.di,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){var c=a+b;if(!(c in E)){var d=k(y.shaders_path,a),f=k(y.shaders_path,b),d=F(d),f=F(f),e;for(e in f)d[e]=f[e];f=[];for(e in d)f.push([e,d[e]]);E[c]=f}return E[c]}function g(a,b){return a+b}function n(a,b){return(a.split(";").map(function(a){return(a=
a.match(b))&&(a[3]?parseInt(a[3],10):1)}).filter(function(a){return a})||[]).reduce(g,0)}function B(a,b){var c=x(a.type),d=x(b.type),f=a.qk,e=b.qk;return c>d?-1:c<d?1:f>e?-1:f<e?1:0}function e(a){if(p.Rb){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var b=ba}else b=oa;a=a.split(";").map(function(a){return(a=a.match(b))&&{type:a[2],qk:a[4]?parseInt(a[4],10):1}}).filter(function(a){return a});return w(a,ha,Q.Ws)}function v(a,b,c){a=a.split(";");for(var d=[],f=0;f<a.length;f++){var e=a[f].match(K);e&&
d.push({type:e[2],qk:e[4]?parseInt(e[4],10):1})}return w(d,b,c)}function w(a,b,c){function d(){for(var c=0;m<a.length;){var d=a[m];if(3!=x(d.type))break;c+=l(d.type)*d.qk;m++}t=k+c;if(t>L)return!1;h(b,k,c,0,3);return!0}function f(){for(var c=L-t,d=c,f=c;m<a.length;){var e=a[m];if(2!=x(e.type))break;e=l(e.type)*e.qk;if(e<=d)d-=e;else if(e<=f)f-=e;else return!1;m++}f=c-f;h(b,t,c-d,0,2);h(b,L-f,f,2,2);return!0}function e(){for(;m<a.length;){for(var d=a[m],d=l(d.type)*d.qk,f=-1,e=c+1,g=-1,N=0;4>N;N++){var t=
X;t[0]=0;t[1]=1;var k;k=b;for(var r=N,p=d,A=t;da<k.length&&15===k[da];)da++;for(;0<L&&15===k[L];)L--;if(L-da<p)k=!1;else{for(var r=1<<r,n=0,y=-1,u=k.length+1,O=!1,pa=da;pa<=L;pa++)pa<L&&!(k[pa]&r)?O||(n=pa,O=!0):(O&&(O=pa-n,O>=p&&O<u&&(u=O,y=n)),O=!1);0>y?k=!1:(A[0]=y,A[1]=u,k=!0)}k&&t[1]<e&&(g=t[0],e=t[1],f=N)}if(0>f)return!1;h(b,g,d,f,1);m++}return!0}if(!a.length)return!0;for(var g=0;g<c;g++)b[g]=0;L=c;a.sort(B);var t=0,k=0,m=0;return function(){for(;m<a.length;){var c=a[m];if(4!=x(c.type))break;
k+=l(c.type)*c.qk;m++}if(k>L)return!1;da=k;h(b,0,k,0,4);return!0}()&&d()&&f()&&e()}function h(a,b,c,d,f){for(var e=0,h=0;h<f;h++)e|=1<<d+h;for(h=0;h<c;h++)a[b+h]|=e}function l(a){switch(a){case "mat4":a=4;break;case "mat3":a=3;break;case "mat2":a=2;break;default:a=1}return a}function x(a){switch(a){case "mat4":case "vec4":case "ivec4":case "bvec4":case "mat2":a=4;break;case "mat3":case "vec3":case "ivec3":case "bvec3":a=3;break;case "vec2":case "ivec2":case "bvec2":a=2;break;default:a=1}return a}
function k(a,b){var c=a+b;if(R[c])return R[c];if(G){var d=G[b];if(!d)return null;d=q("__gpp_parser").KU.parse(d)}else if(d=q("shader_texts")[b],!d)return null;return R[c]=d}function f(a,b){for(var c={},d=b.di||[],f=0;f<d.length;f++)c[d[f][0]]=[d[f][1]];for(f=0;f<b.Rf.length;f++)c["USE_NODE_"+b.Rf[f].id]=["1"];p.Rb?(c.GLSL1=["0"],c.GLSL3=["1"],c.GLSL_VERSION=["300 es"],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],
c.GLSL_TEXTURE_PROJ=["textureProj"]):(c.GLSL1=["1"],c.GLSL3=["0"],c.GLSL_VERSION=["100"],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[""],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"]);c.GLSL_SMPLR2D_SHDW=p.Go?["sampler2DShadow"]:["sampler2D"];for(var e in c)c[e][0].constructor!=String&&A.warn("Warning! The value of a directive '"+e+"' is not of type string.");return c}
function F(a){function b(a){"var"==a.a?d[a.c]=a.b.join(""):"include"==a.a&&(a=k(y.shaders_path,y.yE+a.A),c(a,b))}function c(a,b,d){if(a instanceof Array)for(var f=0;f<a.length;f++)c(a[f],b,d);else if(a instanceof Object&&a){b&&b(a);for(f in a)c(a[f],b,d);d&&d(a)}}var d={};c(a,b);return d}function u(a,b,c){function d(b){b=b.f;for(var c=0;c<b.length;c++){var f=b[c];switch(f.a){case "cond":a:for(var f=f.f,m=0;m<f.length;m++){var p=f[m];switch(p.a){case "if":case "elif":if(e(p.i)){d(p.j);break a}break;
case "else":d(p.j);break a;case "ifdef":p.c in L&&d(p.j);break;case "ifndef":p.c in L||d(p.j)}}break;case "include":f=f.A;m=k(y.shaders_path,y.yE+f);N.push("include/"+f);d(m);N.pop();break;case "var":break;case "define":L[f.c]=f.b;break;case "error":I.D("Shader error: #error "+f.b.join(" "));break;case "line":break;case "pragma":n.push("#pragma "+f.c+" "+f.b.join(" "));break;case "undef":delete L[f.c];break;case "warning":A.warn("Shader warning: #warning "+f.b.join(" "));break;case "extension":f=
l(f.b,L,u,!1);n.push("#extension "+f.join(" "));break;case "version":f=l(f.b,L,u,!1),n.push("#version "+f.join(" "));case "#":break;case "node":v[f.c]=f;break;case "nodes_global":f=r;for(m=0;m<f.length;m++){var p=f[m],M=v[p.id];if(M)for(var pa=0,w=0;w<M.s.length;w++){var wa=M.s[w];if("node_param"==wa.a){var ma;if("PARTICLE_INFO"==p.id&&wa.g)if(1==L.PARTICLE_BATCH)switch(ma=!1,pa){case 0:ma=H(p.hb,"PART_INFO_IND")||H(p.hb,"PART_INFO_AGE")||H(p.hb,"PART_INFO_LT")||H(p.hb,"PART_INFO_SIZE");break;case 1:ma=
H(p.hb,"PART_INFO_LOC");break;case 2:ma=H(p.hb,"PART_INFO_VEL");break;case 3:ma=H(p.hb,"PART_INFO_A_VEL");break;case 4:ma=H(p.hb,"PART_INFO_IND")}else ma=!1;else ma=!0;ma&&(wa=wa.h.join(" ")+" ","vert"==a?wa+=p.oe[pa]:"frag"==a&&(wa+=p.X[pa],null!==p.st[pa]&&(wa+="="+p.st[pa])),wa+=";",t(g(wa)));pa++}}}break;case "nodes_main":f=r;for(m=0;m<f.length;m++)if(p=f[m],M=v[p.id]){pa={};O=E=z=0;w=M;wa=p;ma=w;for(var C={},B=0;B<ma.u.length;B++){var K=ma.u[B];C[K.c]=[K.b.join("")]}ma=C;for(C=0;C<wa.hb.length;C++)B=
wa.hb[C][0],B in ma&&(ma[B]=[wa.hb[C][1]]);for(C=B=0;C<w.s.length;C++)K=w.s[C],"node_out"==K.a&&(ma["USE_OUT_"+K.c]=[-1<x.indexOf(wa.outputs[B])|0],B++);w=ma;wa=p;ma=M.s;C=pa;B=w;for(K=0;K<ma.length;K++){var Q=ma[K];switch(Q.a){case "node_in":var D=wa.inputs[z];if(null!==wa.Rw[z]){if(("MATERIAL_BEGIN"==wa.id&&3===z||!B.MATERIAL_EXT&&("MATERIAL_BEGIN"==wa.id&&4===z||"MATERIAL_END"==wa.id&&3===z||"MATERIAL_END"==wa.id&&4===z||"MATERIAL_END"==wa.id&&5===z)||"TEXTURE_COLOR"==wa.id||"TEXTURE_NORMAL"==
wa.id)&&Q.g){C[Q.c]=wa.Rw[z];z++;continue}var F=Q.h.join(" ")+" ",F=F+(D+"="+wa.Rw[z]+";");t(g(F))}C[Q.c]=D;z++;break;case "node_out":D=wa.outputs[E];if(!Q.g||-1<x.indexOf(D))F=Q.h.join(" ")+" ",F+=D+";",t(g(F)),C[Q.c]=D;E++;break;case "node_param":"vert"==a?D=wa.oe[O]:"frag"==a&&(D=wa.X[O]),C[Q.c]=D,O++}}n.push("{");h(p,M.m,pa,w);n.push("}")}break;case "txt":t(f.b);break;default:I.D("Unknown element type: "+f.a)}}}function e(a,b){var c;c=l(a,L,u,!0,b);for(var d=[],f=0;f<c.length;f++)if(c[f]instanceof
Object)switch(c[f].a){case "conditional_expr":var e=d.pop(),h=d.pop();d.pop()?d.push(h):d.push(e);break;case "logical_or_expr":for(var h=d.pop(),g=0;g<c[f].l-1;g++)e=d.pop(),h=h||e;d.push(h);break;case "logical_and_expr":h=d.pop();for(g=0;g<c[f].l-1;g++)e=d.pop(),h=h&&e;d.push(h);break;case "logical_bitor_expr":h=d.pop();for(g=0;g<c[f].l-1;g++)h|=d.pop();d.push(h);break;case "logical_bitxor_expr":h=d.pop();for(g=0;g<c[f].l-1;g++)h^=d.pop();d.push(h);break;case "logical_bitand_expr":h=d.pop();for(g=
0;g<c[f].l-1;g++)h&=d.pop();d.push(h);break;case "equal_expr":e=d.pop();h=d.pop();d.push(h==e);break;case "non_equal_expr":e=d.pop();h=d.pop();d.push(h!=e);break;case "le_expr":e=d.pop();h=d.pop();d.push(h<=e);break;case "ge_expr":e=d.pop();h=d.pop();d.push(h>=e);break;case "l_expr":e=d.pop();h=d.pop();d.push(h<e);break;case "g_expr":e=d.pop();h=d.pop();d.push(h>e);break;case "left_shift_expr":h=d.pop();e=d.pop();d.push(h<<e);break;case "right_shift_expr":h=d.pop();e=d.pop();d.push(h>>e);break;case "add_expr":h=
d.pop();e=d.pop();d.push(h+e);break;case "sub_expr":h=d.pop();e=d.pop();d.push(h-e);break;case "mul_expr":h=d.pop();e=d.pop();d.push(h*e);break;case "div_expr":h=d.pop();e=d.pop();d.push(h/e);break;case "mod_expr":h=d.pop();e=d.pop();d.push(h%e);break;case "pre_inc_expr":case "post_inc_expr":e=d.pop();d.push(++e);break;case "pre_dec_expr":case "post_dec_expr":e=d.pop();d.push(--e);break;case "positive_expr":e=d.pop();d.push(+e);break;case "negative_expr":e=d.pop();d.push(-e);break;case "one_compl_expr":e=
d.pop();d.push(~e);break;case "logic_negative_expr":e=d.pop();d.push(!e);break;default:I.D("Unknown operation type: "+c[f].a)}else e=c[f],/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(e)?(d.push(0),0!=e.indexOf("USE_NODE_")&&(h=N[N.length-1],h in w||(w[h]=[]),-1==w[h].indexOf(e)&&(w[h].push(e),A.error("Undefined directive '"+e+"' in shader '"+h+"'. Should it be defined with #var/#node_var or #define?")))):d.push(parseFloat(c[f]));1==d.length?c=d[0]:(I.D("Incorrect expression: "+c.join(" ")),c=void 0);return c}
function h(a,b,c,d){for(var f=0;f<b.length;f++){var g=b[f];switch(g.a){case "node_cond":a:for(var O=a,g=g.f,N=c,l=d,m=0;m<g.length;m++){var k=g[m];switch(k.a){case "node_if":case "node_elif":if(e(k.i,l)){h(O,k.m,N,l);break a}break;case "node_else":h(O,k.m,N,l);break a;case "node_ifdef":(k.c in L||k.c in l)&&h(O,k.m,N,l);break;case "node_ifndef":k.c in L||k.c in l||h(O,k.m,N,l)}}break;case "txt":O=[];for(N=0;N<g.b.length;N++)l=g.b[N],l in c?O.push(c[l]):O.push(l);t(O,d)}}}function g(a){return a.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}
function t(b,c){var d=b;if(!p.Rb&&"frag"==a){var f=d.join(" ");K&&(f.match(/[^;]*;/)?(f=f.replace(/[^;]*;/,""),K=!1):f="");f=f.replace(/GLSL_OUT [^;]*;/g,"");f.match(/GLSL_OUT(?:$| [^;]*)/)&&(f=f.replace(/GLSL_OUT(?:$| [^;]*)/,""),K=!0);f=f.replace(/ {2,}/g," ");(f=f.trim())?d=f.split(" "):d=[]}b=d;b.length&&(d=l(b,L,u,!1,c),n.push(d.join(" ")))}function l(a,b,c,d,f){var e=[];m(a,b,c,d,e,f);return e}function m(a,b,c,d,f,e){for(var h=0;h<a.length;h++){var g=a[h];if(e&&g in e)g=e[g];else if(g in b)g=
b[g];else{f.push(g);continue}0==g.length&&d?f.push(0):m(g,b,c,d,f,e)}}var r=c.Rf,n=[],L=f(a,c),u={},N=[c[a]],w={},v={},x=[],C;for(C in r)for(var B in r[C].inputs)x.push(r[C].inputs[B]);var K=!1;d(b);var z=0,E=0,O=0;return n.join("\n")}function r(a,b,c){c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);return c}function z(a){aa.deleteProgram(a.Ch);aa.deleteShader(a.vu);aa.deleteShader(a.cs);delete Y[a.qy]}function J(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return D(a);case 2:return"vec2("+
D(a[0])+","+D(a[1])+")";case 3:return"vec3("+D(a[0])+","+D(a[1])+","+D(a[2])+")";case 4:return"vec4("+D(a[0])+","+D(a[1])+","+D(a[2])+","+D(a[3])+")";case 9:return"mat3("+D(a[0])+","+D(a[1])+","+D(a[2])+","+D(a[3])+","+D(a[4])+","+D(a[5])+","+D(a[6])+","+D(a[7])+","+D(a[8])+")";case 16:return"mat4("+D(a[0])+","+D(a[1])+","+D(a[2])+","+D(a[3])+","+D(a[4])+","+D(a[5])+","+D(a[6])+","+D(a[7])+","+D(a[8])+","+D(a[9])+","+D(a[10])+","+D(a[11])+","+D(a[12])+","+D(a[13])+","+D(a[14])+","+D(a[15])+")";default:I.D("Wrong glsl value dimension")}}
function D(a){return a%1?String(a):String(a)+".0"}function H(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var C=q("__assets"),t=q("__config"),m=q("__debug"),A=q("__print"),I=q("__util"),p=t.H,Q=t.pg,y=t.ge,Y={},R={},G=null,E={},W="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv proc_skybox.glslf skybox.glslv lens_flares.glslf lens_flares.glslv sky.glslf sky.glslv water.glslf water.glslv tex_skybox.glslf debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/sky_blending.glslf include/std.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.Tu=0;a.mG=1;a.lG=2;a.pG=4;a.oG=8;a.nG=16;a.jG=32;var V=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,K=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,ba=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,oa=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,
X=new Int16Array(2),ha=null,Z=null,ca=null,da=0,L=0,ja=[],aa=null,P=!1;a.mf=function(a){aa=a};a.ia=d;a.$M=c;a.eQ=function(a){a.di=I.bh(b(a.bg,a.Ae));d(a,"PRECISION",t.H.precision);"highp"==t.H.precision?d(a,"EPSILON",J(1E-6)):d(a,"EPSILON",J(1E-4));d(a,"CONSTANTS_HACK",p.py|0);d(a,"SRGB",p.srgb_type);d(a,"COMPARED_MODE",p.Go|0)};a.kU=function(a){return a.bg};a.dU=function(a){return a.Ae};a.VM=function(a){var b=JSON.stringify(a.bg)+JSON.stringify(a.Ae)+JSON.stringify(a.di)+JSON.stringify(a.Rf),c=Y[b];
if(c)return c;var d=a.Ae,f=k(y.shaders_path,a.bg),d=k(y.shaders_path,d);if(!f||!d)return null;var f=u("vert",f,a),d=u("frag",d,a),c=0,h=n(d,V);a.fF=h;h>Q.ox&&(c|=1);ha||(ha=new Uint32Array(Q.Ws));Z||(Z=new Uint32Array(Q.kx));ca||(ca=new Uint32Array(Q.Xs));v(d,Z,Q.kx)||(c|=2);v(f,ca,Q.Xs)||(c|=4);h=p.Rb?(f.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(f.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length;a.lA=h;h>Q.px&&(c|=8);e(d)||(c|=16);a.status=c;if(0===
a.status){var c=aa,g=r(c,f,c.VERTEX_SHADER),t=r(c,d,c.FRAGMENT_SHADER),h=c.createProgram();c.attachShader(h,g);c.attachShader(h,t);c.linkProgram(h);for(var g={vu:g,cs:t,Ch:h,attributes:{},Gl:{},Lp:I.dj(),Mx:I.dj(),Nx:{},Om:!0,jt:!1,rF:I.dj(),qF:I.dj(),ab:I.bh(a),qy:b,Bf:!0},l=c.getProgramParameter(h,c.ACTIVE_ATTRIBUTES),t=0;t<l;t++){var A=c.getActiveAttrib(h,t).name;g.attributes[A]=c.getAttribLocation(h,A)}l=c.getProgramParameter(h,c.ACTIVE_UNIFORMS);for(t=0;t<l;t++)A=c.getActiveUniform(h,t).name.split("[0]").join(""),
g.Gl[A]=c.getUniformLocation(h,A);Y[b]=c=g;h=!aa.getShaderParameter(c.cs,aa.COMPILE_STATUS);g=!aa.getShaderParameter(c.vu,aa.COMPILE_STATUS);t=!aa.getProgramParameter(c.Ch,aa.LINK_STATUS);h?m.UD(c.cs,b,d):g?m.UD(c.vu,b,f):t&&m.HP(c.Ch,b,f,d);if(h||g||t)a.status|=32,c=null}else c=null;return c};a.rO=function(){P=!1;if(b4w.module_check("shader_texts"))P=!0;else{for(var a=[],b=C.AT_TEXT,c=0;c<W.length;c++){var d=I.yh(y.shaders_path+W[c]);a.push({id:W[c],type:b,url:d})}b=function(a,b){G||(G={});G[b]=
a};a.length?C.enqueue(a,b,function(){P=!0}):A.error("Shaders have not been found.")}};a.TA=function(){return P};a.GT=function(){return ja};a.aC=function(){return Y};a.cleanup=function(){for(var a in Y)z(Y[a]);for(var b in R)delete R[b];for(var c in ja)delete ja[c];ca=Z=ha=null;E={}};a.jK=z;a.HT=function(a){var b=a.di;A.log("Shader: "+a.bg+" "+a.Ae+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)A.log("  "+b[a][0],b[a][1])};a.N=J;a.UA=function(a,b){return b in a.Gl?!0:!1};a.reset=function(){aa=
null}};b4w.module.__geometry=function(a,q){function d(){return{length:0,frames:1,Wb:0,Fi:0,offset:0,Lk:0}}function c(a,b){for(var c=b.a_tbn_quat,d=b.a_position,f=c.length,e=d.length,h=1;h<a.eb.length;h++)for(var g=a.eb[h].cf,t=a.eb[h].pp,g=g.a_position,l=0;l<e;l++)d[l]+=t*g[l];d=aa;for(h=0;h<f;h+=4){e=c.subarray(h,h+4);d.set(Z.Wl);for(l=1;l<a.eb.length;l++)g=a.eb[l].cf,t=a.eb[l].pp,t=X.slerp(Z.Wl,g.a_tbn_quat,t,P),X.normalize(t,t),X.multiply(t,d,d);X.multiply(d,e,e)}}function b(a){return 65536<a.Ha?ba.cC()?
!1:!0:!1}function g(a){return 0<a.ma.length?!0:!1}function n(a,b,c){if(!g(a))return a;c||oa.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.Ha*(b||1)+", will use drawArrays","color: #aa0");b=a.ma;c=a.Ha;var d=a.pa,f=a.aa,e;for(e in d){var h=d[e],t=D(h,c);d[e]=B(b,h,t)}for(d=0;d<f.length;d++){var l=f[d];for(e in l)h=l[e],t=D(h,c),l[e]=B(b,h,t)}for(d=0;d<a.eb.length;d++){e=a.eb[d].cf;for(var k in e)h=e[k],t=D(h,c),e[k]=B(b,h,t)}a.Ha=b.length;a.ma=new Uint16Array(0);return a}
function B(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),f=0;f<a.length;f++)for(var e=a[f],h=0;h<c;h++)d[c*f+h]=b[c*e+h];return d}function e(){return{zd:null,Kb:Q(),Tk:0,count:0,Fb:{},usage:0,fm:0,hm:0,Sc:[],Jf:null,eb:null,Zk:1,Bf:!0}}function v(a,b){var c=a.Fb[b];if(c){var d=W(b);return G(a.Kb,d).subarray(c.offset,c.offset+c.length)}Z.D("extract_array() failed; invalid name: "+b)}function w(b,c){var d;switch(c){case a.Tl:case a.Jn:d=T.STATIC_DRAW;break;
case a.Oq:d=T.DYNAMIC_DRAW;break;default:Z.D("Wrong draw_mode")}b.usage=d}function h(a,b,c){function d(a,b){f[a]||(f[a]=0);f[a]+=b}var f={},e;for(e in a[0]){var h=a[0][e],g=W(e);d(g,h.length*a.length)}for(e in b)h=b[e],g=W(e),d(g,h.length);if(c){a=c.qq.length;g=W("a_part_ts");d(g,4*a);g=W("a_part_r");d(g,4*a);b=c.Rm;for(e in b)g=W(e),d(g,b[e].Wb*a);c=c.du;for(e in c)g=W(e),d(g,a)}return f}function l(a){a.zd?(a.Jf||(a.Jf=T.createBuffer()),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,a.Jf),T.bufferData(T.ELEMENT_ARRAY_BUFFER,
a.zd,a.usage),a.fm=a.zd.byteLength):a.fm=0;for(var b=a.hm=0;b<a.Kb.length;b++){var c=a.Kb[b].type,d=Y(a.Sc,c);-1==d&&(a.Sc.push({Qi:null,type:c,EL:Z.uF()}),d=a.Sc.length-1);c=a.Sc[d];c.Qi||(c.Qi=T.createBuffer());T.bindBuffer(T.ARRAY_BUFFER,c.Qi);T.bufferData(T.ARRAY_BUFFER,a.Kb[b].Jh,a.usage);a.hm+=a.Kb[b].Jh.byteLength}}function x(a,b){a.U=K.wk(a.U,b);a.Z=K.ko(a.Z,b);a.va=K.lo(a.va,b);a.fd=K.mv(a.fd,b)}function k(a){for(var b=a[0],c=a[0],d=p("JOIN_"+a.length+"_SUBMESHES"),f=0,e=0;e<a.length;e++)f+=
a[e].ma.length;d.ma=new Uint32Array(f);var h=f=0;if(0<a[0].eb.length)for(var g=0;g<a[0].eb.length;g++){for(e=0;e<a.length;e++)f+=a[e].eb[g].cf.a_position.length,h+=a[e].eb[g].cf.a_tbn_quat.length;e={a_position:new Float32Array(f),a_tbn_quat:new Float32Array(h)};d.eb.push({pp:a[0].eb[g].pp,cf:e})}for(e=f=0;e<a.length;e++)f+=a[e].Ha;d.Ha=f;for(var t in c.pa){for(e=f=0;e<a.length;e++)f+=a[e].pa[t].length;d.pa[t]=new Float32Array(f)}for(t in c.aa[0]){for(e=f=0;e<a.length;e++)f+=a[e].aa[0][t].length;for(e=
0;e<c.aa.length;e++)d.aa[e]=d.aa[e]||{},d.aa[e][t]=new Float32Array(f)}e=d.pf;e.U=K.yk(b.pf.U);h=f=0;g=[];for(c=0;c<a.length;c++){var l=a[c],k=l.ma,m=l.Ha,N=l.pa;t=l.pf.va;K.gw(e.U,l.pf.U);K.aM(e.va,t);K.jw(l.pf.fd,g);for(t=0;t<k.length;t++)d.ma[f+t]=k[t]+h;var f=f+k.length,r;for(r in N){var k=N[r],A=h*D(k,m);d.pa[r].set(k,A)}for(t=0;t<l.aa.length;t++){var N=l.aa[t],n=d.aa[t];for(r in N)k=N[r],A=h*D(k,m),n[r].set(k,A)}h+=m}e.Z=K.Br(Z.f32(g),!0);if(0<d.eb.length)for(c=0;c<d.eb.length;c++)for(r=d.eb[c].cf,
t=f=e=0;t<a.length;t++)h=a[t].eb[c].cf,r.a_position.set(h.a_position,e),r.a_tbn_quat.set(h.a_tbn_quat,f),e+=h.a_position.length,f+=h.a_tbn_quat.length;a[0].ff&&(d.ff={qq:b.ff.qq,Ay:b.ff.Ay,PE:!0,du:b.ff.du,Rm:b.ff.Rm,Pr:b.ff.Pr});return d}function f(a,b,c){b=b.pf;for(var d=K.sd(),f=K.Dr(),e=[],h=0;h<c.length;h++)K.wk(a.pf.U,c[h],d),K.gw(b.U,d),K.mv(a.pf.fd,c[h],f),K.jw(f,e);b.Z=K.Br(Z.f32(e),!0);b.fd=K.yK(b.Z);b.va=K.Lo(b.Z)}function F(a,b,c,d,f,e){var h=a.submeshes[b],g=h.base_length,t=p("SUBMESH_"+
a.name+"_"+a.materials[b].name);t.Ha=g;var l=!1;if(z(c,"a_texcoord")){var k=null,A=a.materials[b];b=a.submeshes[b];if(A.texture_slots.length)switch(A=A.texture_slots[0],A.texture_coords){case "UV":k=r(b,A.uv_layer,a.name);break;case "ORCO":for(var N=a.b4w_boundings.bb_src,k=new Float32Array(2*b.base_length),A=(N.max_x+N.min_x)/2,L=(N.max_y+N.min_y)/2,y=N.max_x-N.min_x,N=N.max_y-N.min_y,w=0,v=0;v<b.position.length;v+=3)k[w++]=(b.position[v]-A)/y+.5,k[w++]=(b.position[v+1]-L)/N+.5}null===k&&(k=new Float32Array(2*
b.base_length));b=k}else b=new Float32Array(0);if(z(c,"a_orco_tex_coord")){for(var k=a.b4w_boundings.bb_src,A=new Float32Array(3*h.base_length),L=h.position,y=k.max_x-k.min_x,N=k.max_y-k.min_y,w=k.max_z-k.min_z,x=v=0;x<L.length;x+=3)y?A[v++]=Z.clamp(parseFloat(((L[x]-k.min_x)/y).toFixed(5)),0,1):A[v++]=.5,N?A[v++]=Z.clamp(parseFloat(((L[x+1]-k.min_y)/N).toFixed(5)),0,1):A[v++]=.5,w?A[v++]=Z.clamp(parseFloat(((L[x+2]-k.min_z)/w).toFixed(5)),0,1):A[v++]=.5;k=A}else k=new Float32Array(0);A=h.group;if(z(c,
"a_influence")&&d){L=new Float32Array(4*g);y=A.length/g;N=new Float32Array(y);for(w=0;w<y;w++){N[w]=-1;for(var C in d)if(v=d[C],v.UF===w){N[w]=v.Vv;break}}x=3<y?y:4;d=new Float32Array(x);C=new Uint32Array(x);for(var w=new Float32Array(4),v=new Float32Array(x),x=new Uint32Array(x),B=new Float32Array(4),E=0;E<g;E++)d.set(v),C.set(x),w.set(B),L.set(J(A,y,E,g,N,d,C,w),4*E)}else L=new Float32Array(0);d=L;f=f?Z.S(f):{};f.a_color={Sk:!0};f.a_color.src=z(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,
Mf:7}]:[];t.pa.a_texcoord=b;t.pa.a_influence=d;t.pa.a_orco_tex_coord=k;d=t.pa;C=h.vertex_colors;b=h.color;k=a.name;A=[];for(L=0;L<C.length;L++)A.push(C[L].name);for(var O in f)if(L=f[O].src,L.length){for(N=y=0;N<L.length;N++)y+=Z.xl(L[N].Mf);d[O]=new Float32Array(y*g);for(N=w=0;N<L.length;N++){var pa=L[N].name,v=L[N].Mf,x=Z.WD(v),B=A.indexOf(pa);if(-1==B)oa.warn('vertex color "'+pa+'" for mesh "'+k+'" not found'),E=7;else{for(var E=C[B].mask,Q,D=Q=0;D<B;D++)Q+=Z.xl(C[D].mask);Q*=g}D=Z.xl(E);(v&E)!==
v&&oa.error("Wrong color extraction from "+pa+" to "+O+' for the mesh "'+k+'".');for(pa=0;pa<g;pa++)for(var H=0;3>H;H++)if(x[H]){var F=Z.Ym(E,H);d[O][pa*y+(w+Z.Ym(v,H))]=-1==B?0:b[Q+pa*D+F]}w+=D}}else d[O]=new Float32Array(0);O=a.name;Q=t.pa;if(e)for(var Ta in e)Q[e[Ta]]=r(h,Ta,O);t.ma=new Uint32Array(h.indices);Ta=h.position.length/g/3;O=z(c,"a_tbn_quat")&&h.tbn_quat.length?!0:!1;Q=z(c,"a_shade_tangs")&&h.shade_tangs.length?!0:!1;0<a.b4w_shape_keys.length&&(l=!0);for(f=0;f<Ta;f++){e=u(h,g,O,Q,f);
if(l)if(d={},d.name=a.b4w_shape_keys[f].name,t.eb.push(d),f){d.cf=e;d.pp=a.b4w_shape_keys[f].value;continue}else d.cf=u(h,g,O,Q,f),d.pp=1;t.aa.push(e)}if(1<Ta&&!l){a=t.aa[0];e={};for(var I in a)e[I]=new Float32Array(a[I]);t.aa.push(e)}z(c,"a_polyindex")&&(n(t,1,!0),t.pa.a_polyindex=m(t));h=h.boundings;c=t.pf;c.U=K.sd();c.U.max_x=h.bb.max_x;c.U.max_y=h.bb.max_y;c.U.max_z=h.bb.max_z;c.U.min_x=h.bb.min_x;c.U.min_y=h.bb.min_y;c.U.min_z=h.bb.min_z;I=h.rbb;a=h.caxis_x;g=h.caxis_y;l=h.caxis_z;e=h.be_ax;
c.Z=K.fo(a,g,l,h.be_cen);ca.scale(c.Z.Ea,e[0],c.Z.Ea);ca.scale(c.Z.Fa,e[1],c.Z.Fa);ca.scale(c.Z.Ga,e[2],c.Z.Ga);c.va=K.Lo(c.Z);ca.copy(I.rbb_c,c.fd.M);ca.copy(a,c.fd.Ea);ca.copy(g,c.fd.Fa);ca.copy(l,c.fd.Ga);h=I.rbb_s;ca.scale(c.fd.Ea,h[0],c.fd.Ea);ca.scale(c.fd.Fa,h[1],c.fd.Fa);ca.scale(c.fd.Ga,h[2],c.fd.Ga);return t}function u(a,b,c,d,f){var e={},h=new Float32Array(3*b),g=new Float32Array(c?4*b:0),t=f*b*3;h.set(a.position.subarray(t,t+3*b),0);c&&(t=f*b*4,g.set(a.tbn_quat.subarray(t,t+4*b),0));d&&
(c=new Float32Array(3*b),c.set(a.shade_tangs.subarray(0,3*b),0),e.a_shade_tangs=c);e.a_position=h;e.a_tbn_quat=g;return e}function r(a,b,c){var d=2*a.base_length,f=a.uv_layers.indexOf(b);if(-1==f)return oa.warn('uv layer "'+b+'" for mesh "'+c+'" not found'),new Float32Array(d);b=f*d;return a.texcoord.subarray(b,b+d)}function z(a,b){return-1<a.indexOf(b)?!0:!1}function J(b,c,d,f,e,h,g,t){for(var l=!0,k=0;k<c;k++){var m=b[k*f+d];if(-1!==m){var r=e[k];-1!==r&&(h[k]=m,g[k]=r,l=!1)}}if(l)return t;H(h,
g,a.Ru,!1);for(k=b=0;4>k;k++)b+=h[k];if(.01>b)return t;for(k=0;4>k;k++)h[k]/=b;if(.01>Math.abs(h[0]-1))t[0]=g[0]+1;else for(k=0;4>k;k++)t[k]=g[k]+h[k];return t}function D(a,b){if(0==b)return 0;var c=a.length,d=c/b;d!=Math.floor(d)&&Z.D("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return d}function H(b,c,d,f){for(var e=b.length,h=e,g=!1,t=f?-1:1;1<h||g;){1<h&&(h=Math.floor(h/1.247330950103979));for(var g=!1,l=0;h+l<e;l++)if(d==a.Ru?0>t*(b[l]-b[l+h]):b[l]<b[l+
h]&&f)g=b[l],b[l]=b[l+h],b[l+h]=g,g=c[l],c[l]=c[l+h],c[l+h]=g,g=!0}}function C(a,b,c){var d=[],f=[];ca.subtract(b,a,d);ca.subtract(c,a,f);ca.normalize(d,d);ca.normalize(f,f);a=Z.clamp(ca.dot(d,f),-1,1);return Math.acos(a)}function t(a,b){var c=[];if(g(b))for(var d=b.ma,f=d.length/3,e=0;e<f;e++){var h=new Float32Array(9),t=d[3*e];h[0]=a[3*t];h[1]=a[3*t+1];h[2]=a[3*t+2];t=d[3*e+1];h[3]=a[3*t];h[4]=a[3*t+1];h[5]=a[3*t+2];t=d[3*e+2];h[6]=a[3*t];h[7]=a[3*t+1];h[8]=a[3*t+2];c[e]=h}else for(e=0;e<a.length;e++)h=
new Float32Array(9),h[0]=a[9*e],h[1]=a[9*e+1],h[2]=a[9*e+2],h[3]=a[9*e+3],h[4]=a[9*e+4],h[5]=a[9*e+5],h[6]=a[9*e+6],h[7]=a[9*e+7],h[8]=a[9*e+8],c[e]=h;return c}function m(a){for(var b=new Float32Array(a.Ha),c=0;c<a.Ha;c++)b[c]=c%3/2;return b}function A(a,b,c){var d=ca.dist(a,b);a=ca.dist(a,c);b=ca.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function I(a){for(var b=new Float32Array([0,0,0,1,1,1,1,0]),c=new Float32Array(8*a),d=0;d<a;d++)c.set(b,8*d);return c}function p(a){return{name:a,Ha:0,ma:null,
aa:[],pa:{a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)},eb:[],pf:{U:K.sd(),Z:K.qg(),va:K.fh(),fd:K.Dr()},ff:null}}function Q(a){var b=[],c;for(c in a)b.push(y(c,a[c]));return b}function y(a,b){return{Jh:new (E(a))(b),type:a}}function Y(a,b){for(var c=0;c<a.length;c++)if(a[c].type==b)return c;return-1}function R(a,b){var c=Y(a,b);return-1==c?null:a[c].Qi}function G(a,b){var c=Y(a,b);return-1==c?null:a[c].Jh}function E(a){switch(a){case "float":return Float32Array;
case "short":return Int16Array;case "unsigned_byte":return Uint8Array;default:return Float32Array}}function W(a){a=a.replace(/_next$/,"");a=a.replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a");switch(a){case "a_tbn_quat":case "a_shade_tangs":return"short";case "a_color":case "a_bending_col_main":case "a_bending_col_detail":case "a_grass_size":case "a_grass_color":case "param_GEOMETRY_VC_a":case "a_polyindex":case "a_p_bb_vertex":case "a_halo_bb_vertex":case "a_bb_vertex":return"unsigned_byte";
default:return"float"}}function V(a,b,c,d){var f=W(b);b=Y(a,f);switch(f){case "float":a[b].Jh.set(c,d);break;case "short":for(f=0;f<c.length;f++)a[b].Jh[d+f]=Z.ap(c[f]);break;case "unsigned_byte":for(f=0;f<c.length;f++)a[b].Jh[d+f]=Z.tR(c[f])}}var K=q("__boundings"),ba=q("__extensions"),oa=q("__print"),X=q("__quat"),ha=q("__tsr"),Z=q("__util"),ca=q("__vec3"),da=new Float32Array(3),L=new Float32Array(3),ja=new Float32Array(3),aa=new Float32Array(4),P=new Float32Array(4),la=new Float32Array(8);a.Jn=
10;a.Oq=20;a.Ru=0;a.YS=1;a.Tl=a.Jn;var T=null;a.Yl="float";a.aT="short";a.bT="unsigned_byte";a.mf=function(a){T=a};a.WE=function(a,f,g){b(a)&&n(a);var t=a.ma,k=a.Ha,m=a.aa,r={},p;for(p in a.pa)p in g&&!g[p].Sk||(r[p]=a.pa[p]);g=e();0<a.eb.length&&c(a,m[0]);p=a.ff;if(t.length){var A=t.length;if(65536>=k)var t=new Uint16Array(t),L=T.UNSIGNED_SHORT;else t=new Uint32Array(t),L=T.UNSIGNED_INT}else A=k,t=null;for(var y=h(m,r,p),y=Q(y),u={},N=0;N<y.length;N++)u[y[N].type]=0;var v={},x;for(x in r){var C=
r[x],B=C.length;if(B){var K=W(x),N=v[x]=d();N.length=B;N.Wb=D(C,k);N.offset=u[K];V(y,x,C,u[K]);u[K]+=B}}r=m.length;for(x in m[0])if(C=m[0][x],K=W(x),B=C.length,C=D(C,k),B)for(N=v[x]=d(),N.length=B,N.frames=r,N.Wb=C,N.offset=u[K],1<r&&(N=v[x+"_next"]=d(),N.length=B,N.frames=r,N.Wb=C,N.offset=u[K]+B),N=0;N<r;N++)C=m[N][x],K=W(x),V(y,x,C,u[K]),u[K]+=B;if(p){m=p.qq;x=p.Ay;var r=p.Rm,B=p.du,K=p.PE,k={a_part_ts:{data:[],Wb:4},a_part_r:{data:[],Wb:4}},z;for(z in r)k[z]={data:[],Wb:r[z].Wb};for(z in B)k[z]=
{data:[],Wb:1};for(C=0;C<m.length;C++){N=m[C];K&&x&&!p.Pr&&(N=ha.multiply(x,m[C],la));!K&&p.Pr&&ca.subtract(m[C],x,m[C]);k.a_part_ts.data.push(N[0],N[1],N[2],N[3]);k.a_part_r.data.push(N[4],N[5],N[6],N[7]);for(z in r)for(var N=r[z].Wb,E=0;E<N;E++)k[z].data.push(r[z].data[C*N+E]);for(z in B)k[z].data.push(B[z][0])}for(z in k)m=W(z),V(y,z,k[z].data,u[m]),x=d(),x.Wb=k[z].Wb,x.offset=u[m],x.Lk=1,x.length=k[z].data.length,v[z]=x,u[m]+=x.length;g.Zk=p.qq.length}g.count=A;g.zd=t;g.Kb=y;g.Tk=L;g.Fb=v;w(g,
f);l(g);g.eb=a.eb;return g};a.hR=c;a.RN=b;a.QN=g;a.cu=n;a.wF=function(a,b,c){w(a,b);a.count=c.length;a.zd=c;a.Tk=c instanceof Uint16Array?T.UNSIGNED_SHORT:T.UNSIGNED_INT};a.vF=function(a,b,c,f){var e=a.Fb,h=e[b],g=W(b);if(h)c&&h.Wb!=c&&Z.D('invalid num_comp for "'+b+'"'),V(a.Kb,b,f,h.offset);else{h=Y(a.Kb,g);-1==h&&(a.Kb.push(y(g,0)),h=a.Kb.length-1);var g=a.Kb[h].Jh,t=new g.constructor(g.length+f.length);t.set(g);a.Kb[h].Jh=t;V(a.Kb,b,f,g.length);b=e[b]=d();b.Wb=c;b.offset=g.length;b.length=f.length}l(a)};
a.dM=v;a.GU=function(a){a.usage=T.STATIC_DRAW};a.AO=function(a){a.usage=T.DYNAMIC_DRAW};a.cz=l;a.vq=function(a,b,c,d){T.bindBuffer(T.ARRAY_BUFFER,a.Sc[Y(a.Sc,b)].Qi);T.bufferSubData(T.ARRAY_BUFFER,Z.Nh*d,c)};a.hK=function(a){a.Jf&&T.deleteBuffer(a.Jf);for(var b=0;b<a.Sc.length;b++)a.Sc[b].Qi&&T.deleteBuffer(a.Sc[b].Qi);a.Sc.length=0};a.uC=function(a,b){return a.submeshes[b].base_length?!1:!0};a.bu=function(a,b){for(var c=0;c<a.aa.length;c++){var d=a.aa[c].a_position;ha.transform_vectors(d,b,d,0);
d=a.aa[c].a_tbn_quat;0<d.length&&ha.pF(d,b,d,0);(d=a.aa[c].a_shade_tangs)&&0<d.length&&ha.transform_dir_vectors(d,b,d,0)}(c=a.pa.au_center_pos)&&c.length&&ha.transform_vectors(c,b,c,0);x(a.pf,b)};a.gR=function(a,b){var c=a.pa.au_center_pos;if(c&&c.length){var d=new Float32Array(c);ha.transform_vectors(d,b,d,0);for(var f=0;f<a.aa.length;f++)for(var e=0;e<d.length;e++)a.aa[f].a_position[e]+=d[e]-c[e];c.set(d)}else Z.D('Attribute "au_center_pos" is missing in particle submesh');x(a.pf,b)};a.uJ=x;a.fR=
function(a,b){var c=a.Ha,d;for(d in b){var f=b[d].length;a.pa[d]=new Float32Array(f*c);for(var e=0;e<c;e++)for(var h=0;h<f;h++)a.pa[d][e*f+h]=b[d][h]}};a.VE=k;a.zO=function(a,b,c){if(!a.Ha)return p("EMPTY");var d=c.length;65536<a.Ha*d&&!ba.cC()&&n(a,d);var e=a.ma,h=a.Ha,g=a.pa,t=a.aa,l;for(l in b){var k=b[l].length,m=k*h;g[l]=new Float32Array(m);for(var r=0;r<h;r++)for(m=0;m<k;m++)g[l][r*k+m]=b[l][m]}b=p("CLONE_"+d+"_SUBMESHES");b.Ha=h*d;b.ma=new Uint32Array(e.length*d);for(r=0;r<d;r++)for(k=e.length*
r,l=h*r,m=0;m<e.length;m++)b.ma[k+m]=e[m]+l;for(var N in g)for(e=g[N],m=e.length*d,k=D(e,h),b.pa[N]=new Float32Array(m),r=0;r<d;r++)l=h*k*r,b.pa[N].set(e,l);for(N in t[0])for(r=0;r<t.length;r++)for(e=t[r][N],m=e.length*d,k=D(e,h),b.aa[r]=b.aa[r]||{},b.aa[r][N]=new Float32Array(m),m=0;m<d;m++)switch(g=c[m],l=h*k*m,N){case "a_position":ha.transform_vectors(e,g,b.aa[r][N],l);break;case "a_tbn_quat":ha.pF(e,g,b.aa[r][N],l);break;case "a_shade_tangs":ha.transform_tangents(e,g,b.aa[r][N],l);break;default:Z.D("Wrong attribute name: "+
N)}f(a,b,c);return b};a.GA=f;a.kw=F;a.gM=function(a){var b=a.Ha,c=a.aa[0].a_position,d=new Float32Array(12*b);a=new Uint32Array(4*a.ma.length);for(var f=new Float32Array(4*b),e=0;e<b;e++){d[12*e]=c[3*e];d[12*e+1]=c[3*e+1];d[12*e+2]=c[3*e+2];d[12*e+3]=c[3*e];d[12*e+4]=c[3*e+1];d[12*e+5]=c[3*e+2];d[12*e+6]=c[3*e];d[12*e+7]=c[3*e+1];d[12*e+8]=c[3*e+2];d[12*e+9]=c[3*e];d[12*e+10]=c[3*e+1];d[12*e+11]=c[3*e+2];a[6*e]=4*e+2;a[6*e+1]=4*e+1;a[6*e+2]=4*e;a[6*e+3]=4*e+2;a[6*e+4]=4*e;a[6*e+5]=4*e+3;var h=Math.random();
f[4*e]=h;f[4*e+1]=h;f[4*e+2]=h;f[4*e+3]=h}c=p("HALO");c.aa[0]={};c.Ha=4*b;c.aa[0].a_position=d;c.pa.a_halo_bb_vertex=I(b);c.pa.a_random_vals=f;c.ma=a;return c};a.BN=z;a.HB=function(a,b,c){for(var d=[],f=0;f<a.submeshes.length;f++){var e=F(a,f,b,null,c,null);e.Ha&&d.push(e)}return d.length?1==d.length?d[0]:k(d):p("EMPTY")};a.FR=function(a,b,c,d){var f=a.zd,e=v(a,"a_position"),h=b.IO,g=b.JO;b=b.LL;for(var t=f,l=t.length/3,k=0;k<l;k++){var m=t[3*k],N=t[3*k+1],r=t[3*k+2],p=e[3*m+1],A=e[3*m+2],n=e[3*N+
1],L=e[3*N+2],y=e[3*r+1],u=e[3*r+2];h[3*k]=(e[3*m]+e[3*N]+e[3*r])/3;h[3*k+1]=(p+n+y)/3;h[3*k+2]=(A+L+u)/3}ha.transform_vectors(h,c,g);c=g.length/3;for(e=0;e<c;e++)h=g[3*e]-d[0],t=g[3*e+1]-d[1],l=g[3*e+2]-d[2],b[e]=h*h+t*t+l*l;d=f;f=b.length;if(!(2>f))for(g=f,e=!1;1<g||e;)for(1<g&&(g=Math.floor(g/1.247330950103979)),e=!1,c=0;g+c<f;c++)0>b[c]-b[c+g]&&(e=b[c],b[c]=b[c+g],b[c+g]=e,e=d,h=c,t=c+g,l=e[3*h],k=e[3*h+1],m=e[3*h+2],e[3*h]=e[3*t],e[3*h+1]=e[3*t+1],e[3*h+2]=e[3*t+2],e[3*t]=l,e[3*t+1]=k,e[3*t+
2]=m,e=!0);f=d;T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,a.Jf);T.bufferData(T.ELEMENT_ARRAY_BUFFER,f,T.DYNAMIC_DRAW)};a.RQ=H;a.EA=function(a,b,c){for(var d=b.length/3,f=a.length/3,e=[],h=Array(3),g=Array(3),t=Array(3),l=0;l<f;l++){for(var k=a[3*l],m=a[3*l+1],N=a[3*l+2],r=0;3>r;r++)h[r]=b[3*k+r],g[r]=b[3*m+r],t[r]=b[3*N+r];if(c)var r=C(h,g,t),p=C(g,t,h),A=Math.PI-r-p;else A=p=r=1;var n=e,L;L=h;var y=t,u=[],w=[],O=[];ca.subtract(g,L,u);ca.subtract(y,L,w);ca.cross(u,w,O);ca.normalize(O,O);L=O;for(y=0;3>y;y++)u=
3*m+y,w=3*N+y,n[3*k+y]=r*L[y],n[u]=p*L[y],n[w]=A*L[y]}if(c)for(var pa in c)for(l=c[pa],a=0;3>a;a++){b=3*l[0]+a;for(f=1;f<l.length;f++)h=3*l[f]+a,e[b]+=e[h];for(f=1;f<l.length;f++)h=3*l[f]+a,e[h]=e[b]}for(l=0;l<d;l++){c=l;pa=e;a=new Float32Array(3);for(b=0;3>b;b++)f=3*c+b,a[b]=pa[f];ca.normalize(a,a);for(b=0;3>b;b++)f=3*c+b,pa[f]=a[b]}return e};a.FA=function(a,b,c){for(var d={},f=b.length/3,e=0;e<f;e++){var h=String(b[3*e])+String(b[3*e+1])+String(b[3*e+2]);d[h]=[]}b=a.length;for(e=0;e<b;e++)f=a[e],
h=String(c[3*f])+String(c[3*f+1])+String(c[3*f+2]),h in d&&d[h].push(f);return d};a.ow=function(a,b,c,d){var f;f=t(a.aa[0].a_position,a);if(c){var e;e=a.aa[0].a_tbn_quat;for(var h=e.length/4,g=new Float32Array(3*h),l=0;l<h;l++){var k=aa;k[0]=e[4*l];k[1]=e[4*l+1];k[2]=e[4*l+2];k[3]=e[4*l+3];k=ca.transformQuat(Z.AXIS_Y,k,da);g[3*l]=k[0];g[3*l+1]=k[1];g[3*l+2]=k[2]}e=t(g,a)}g=f.length;l=new Float32Array(g);for(a=0;a<g;a++){var m=f[a];da.set(m.subarray(0,3));L.set(m.subarray(3,6));ja.set(m.subarray(6));
l[a]=Math.sqrt(A(da,L,ja))}h=new Float32Array(g);h[0]=l[0];for(a=1;a<g;a++)h[a]=h[a-1]+l[a];g=h[l.length-1];l=[];for(a=0;a<b;a++){var k=g*Z.Uf(d),k=Z.lr(h,k,0,h.length-1),m=c?e[k]:f[k],r=d;(k=da)||(k=new Float32Array(3));var N=m[0],p=m[1],n=m[2],y=m[3],u=m[4],w=m[5],v=m[6],x=m[7],m=m[8],C=Z.Uf(r),r=Z.Uf(r);1<C+r&&(C=1-C,r=1-r);var O=1-C-r;k[0]=O*N+C*y+r*v;k[1]=O*p+C*u+r*x;k[2]=O*n+C*w+r*m;c?(l[a]=new Float32Array(4),ca.normalize(k,k),k=X.rotationTo(Z.AXIS_Y,k,aa),l[a][0]=k[0],l[a][1]=k[1],l[a][2]=
k[2],l[a][3]=k[3]):(l[a]=new Float32Array(3),l[a][0]=k[0],l[a][1]=k[1],l[a][2]=k[2])}return l};a.Ur=m;a.hV=A;a.PB=I;a.bE=function(a,b,c){a=a.aa[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.bv=function(a,b,c){var d=a.K[0].R;a=a.o.nf;for(var f=1;f<a.length;f++)a[f].name==b&&(a[f].value=c);for(f=0;f<d.length;f++)if(!d[f].Ff&&d[f].me&&!d[f].ci){b=d[f].da;c=W("a_position");var e=G(b.Kb,c);T.bindBuffer(T.ARRAY_BUFFER,
R(b.Sc,c));var h=b.Fb.a_position;c=d[f];var g=a;if(h){for(var t=h.offset,h=h.length+t,l=c.da.eb[0].cf.a_position,k=t;k<h;k++)e[k]=l[k-t];for(k=1;k<c.da.eb.length;k++){var l=c.da.eb[k].cf.a_position,m=g[k].value;if(m)for(var N=t;N<h;N++)e[N]+=m*l[N-t]}T.bufferSubData(T.ARRAY_BUFFER,Z.Nh*t,e.subarray(t))}e=W("a_tbn_quat");c=G(b.Kb,e);T.bindBuffer(T.ARRAY_BUFFER,R(b.Sc,e));t=b.Fb.a_tbn_quat;b=d[f];e=a;if(t){g=t.offset;t=t.length+g;h=b.da.eb[0].cf.a_tbn_quat;k=aa;for(l=g;l<t;l+=4){k[0]=0;k[1]=0;k[2]=
0;for(m=k[3]=1;m<b.da.eb.length;m++){var N=b.da.eb[m].cf.a_tbn_quat,r=e[m].value;if(r){var p=P;p[0]=N[l-g];p[1]=N[l+1-g];p[2]=N[l+2-g];p[3]=N[l+3-g];N=X.slerp(Z.Wl,p,r,P);X.multiply(N,k,k)}}m=P;m[0]=h[l-g];m[1]=h[l-g+1];m[2]=h[l-g+2];m[3]=h[l-g+3];N=0<m[3];X.multiply(k,m,m);(0<m[3]&&!N||0>m[3]&&N)&&X.scale(m,-1,m);c[l]=Z.ap(m[0]);c[l+1]=Z.ap(m[1]);c[l+2]=Z.ap(m[2]);c[l+3]=Z.ap(m[3])}T.bufferSubData(T.ARRAY_BUFFER,Z.Nh*g,c.subarray(g))}}};a.check_shape_keys=function(a){return a.o.me};a.get_shape_keys_names=
function(a){var b=[];if(a.o)for(var c=1;c<a.o.nf.length;c++)b.push(a.o.nf[c].name);return b};a.get_shape_key_value=function(a,b){if(a.o)for(var c=1;c<a.o.nf.length;c++)if(b==a.o.nf[c].name)return a.o.nf[c].value;return 0};a.Lw=function(a,b){var c=a.o.nf;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.pj=function(a){return a&&a.o&&a.o.be?!0:!1};a.draw_line=function(b,c,d){var f=b.da;if(f){for(var e=d?c.length/3/2:c.length/3-1,h=new Float32Array(12*e),g=new Float32Array(12*e),t=
new Uint16Array(6*e),k=0;k<e;k++){if(d)var m=6*k,r=6*k+3;else m=3*k,r=3*(k+1);var p=c[m],N=c[m+1],m=c[m+2],A=c[r],n=c[r+1],r=c[r+2],L=A-p,y=n-N,u=r-m;h[12*k]=p;h[12*k+1]=N;h[12*k+2]=m;g[12*k]=L;g[12*k+1]=y;g[12*k+2]=u;h[12*k+3]=A;h[12*k+4]=n;h[12*k+5]=r;g[12*k+3]=-L;g[12*k+4]=-y;g[12*k+5]=-u;h[12*k+6]=p;h[12*k+7]=N;h[12*k+8]=m;g[12*k+6]=-L;g[12*k+7]=-y;g[12*k+8]=-u;h[12*k+9]=A;h[12*k+10]=n;h[12*k+11]=r;g[12*k+9]=L;g[12*k+10]=y;g[12*k+11]=u;t[6*k]=4*k;t[6*k+1]=4*k+1;t[6*k+2]=4*k+2;t[6*k+3]=4*k;t[6*
k+4]=4*k+3;t[6*k+5]=4*k+1}d=0;for(var w in f.Fb)c=f.Fb[w],d+=h.length/3*c.Wb;c={};c["float"]=d;d=f.Kb=Q(c);a.wF(f,b.tg,t);b=0;for(w in f.Fb)switch(c=f.Fb[w],w){case "a_position":V(d,w,h,b);c.offset=b;c.length=h.length;b+=c.length;break;case "a_direction":V(d,w,g,b);c.offset=b;c.length=g.length;b+=c.length;break;default:c.offset=b,c.length=h.length/3*c.Wb,t=new Float32Array(c.length),V(d,w,t,b),b+=c.length}l(f)}};a.nK=function(a){var b=e();if(a.zd)switch(a.Tk){case T.UNSIGNED_SHORT:b.zd=new Uint16Array(a.zd);
break;case T.UNSIGNED_INT:b.zd=new Uint32Array(a.zd)}else b.zd=null;for(var c=a.Kb,d=[],f=0;f<c.length;f++){var h=c[f].Jh,g=c[f].type;d.push({Jh:new h.constructor(h),type:g})}b.Kb=d;b.Tk=a.Tk;b.count=a.count;b.Fb=Z.S(a.Fb);b.usage=a.usage;b.fm=a.fm;b.hm=a.hm;b.Jf=null;b.Cs=Z.S(a.Cs);b.eb=Z.S(a.eb);b.Zk=a.Zk;b.Bf=a.Bf;return b};a.ef=p;a.reset=function(){T=null};a.IN=Q;a.WP=Y;a.jU=R;a.ns=G;a.bC=E;a.nj=W;a.mC=function(a){switch(W(a)){case "float":return Z.Nh;case "short":return Z.Pn;case "unsigned_byte":return Z.Du;
default:return Z.Nh}};a.kN=function(a){switch(W(a)){case "float":return T.FLOAT;case "short":return T.SHORT;case "unsigned_byte":return T.UNSIGNED_BYTE;default:return T.FLOAT}};a.Gq=V};b4w.module.__objects=function(a,q){function d(a){var b=a.K;a=a.o;for(var c=0;c<b.length;c++){var d=b[c].pb;d.F.outline&&a.Jg&&K.IP(d)}}function c(a){a.o.Jg=0;a=ta.indexOf(a);-1!=a&&ta.splice(a,1)}function b(a){if(a.pm)for(var b=a.K,c=0;c<b.length;c++)K.yF(b[c].pb,a)}function g(a,b){for(var c=a.K,d=b.K,f=0;f<c.length;f++){for(var e=!1,h=0;h<d.length;h++)if(c[f].pb==d[h].pb){e=!0;break}e||n(b,c[f].pb)&&Y.Xn(b,c[f].pb)}}function n(a,b){return!b.Vz&&"SPEAKER"==a.type||!b.tI&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function B(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.Wu||a.parent&&a.parent.Wu)return!0;switch(a.type){case "MESH":var c=a.b4w_do_not_batch,d=a.b4w_collision,f=a.b4w_vehicle,h=a.b4w_floating,g=a.b4w_character,t=R.DN(a),l=Q.CA(a),k=0<a.data.b4w_shape_keys.length,m=a.b4w_dynamic_geometry;if(!(c=J.DA(a,b)||c||d||f||k||h||t||g||l||m))a:{c=a.data;for(d=0;d<c.materials.length;d++)if(f=c.materials[d],f.b4w_water||f.b4w_lens_flares||e(f.node_tree)){c=!0;break a}c=!1}return c;case "EMPTY":return c=
Q.CA(a),d=a.b4w_do_not_batch,f=!!a.b4w_anchor,J.DA(a,b)||c||d||f;default:return!0}}function e(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var d=c.convert_from,f=c.convert_to,e=c.outputs[0];if(!(!e.is_linked||"WORLD"==d&&"CAMERA"==f||"CAMERA"==d&&"WORLD"==f||"OBJECT"==d&&"OBJECT"==f))return!0}if("NORMAL_MAP"==c.type&&(d=c.space,e=c.outputs[0],e.is_linked&&("OBJECT"==d||"BLENDER_OBJECT"==d))||"TEX_COORD"==c.type&&c.outputs[3].is_linked||"OBJECT_INFO"==
c.type&&(e=c.outputs[1],d=c.outputs[3],c.outputs[0].is_linked||e.is_linked||d.is_linked))return!0}return!1}function v(a,b){var c=a.animation_data,d=a.data?a.data.animation_data:null;c&&c.action&&(c=c.action,(c.F.type==J.OBJ_ANIM_TYPE_OBJECT||c.F.type==J.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==b.type||c.F.type==J.nH&&"LAMP"==b.type||c.F.type==J.mH&&"WORLD"==b.type)&&b.sg.push(J.zC(null,c)));d&&d.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.sg.push(J.zC(null,d.action));"MESH"==b.type&&b.sg.push.apply(b.sg,
J.TM(a))}function w(a,b,c){b=T[b]||[];for(var d=[],f=0;f<b.length;f++){var e=b[f];if(e.o.ud==c||-1==c)for(var h=e.K,g=0;g<h.length;g++)h[g].pb==a&&d.push(e)}return d}function h(a,b){var c=T[a]||[];if(-1==b)return c;for(var d=[],f=0;f<c.length;f++){var e=c[f];e.o.ud==b&&d.push(e)}return d}function l(a,b,c,d){for(var f=0;f<a.K.length;f++)for(var e=a.K[f].R,h=0;h<e.length;h++){var g=e[h];g.da&&(g.da.Bf=b);g.Bf=b;g.ib&&(g.ib.Bf=c);""!==g.Cj&&(g=y.hC(g.Cj))&&(g.XA=d)}}function x(a,b,c,d,f){for(var e=null,
h=0;h<b.length;h++){var g=b[h];if(!((c?g.Cd:g.name)!=a||g.o.ud!=d&&-1!=d||f&&!g.Yi||(e=g,Y.get_dg_parent(e))))break}return e}function k(a){T.ALL.push(a);T[a.type]||(T[a.type]=[]);T[a.type].push(a);var b=a.o.jd;if(null!=b)for(var c=0;c<ra.length;c++){var d=ra[c];d.o.jd==b&&d.Xp.push(a)}}function f(a,b){l(a,!0,!1,!0);for(var c=h("ALL",-1),d=0;d<c.length;d++){var f=c[d];f!=a&&l(f,!1,!1,!1)}K.SD(a,b);for(d=0;d<a.K.length;d++)for(f=a.K[d].R.length-1;0<=f;f--){var e=a.K[d].R[f];0!=e.Jb.length&&-1==e.Jb.indexOf(b)||
a.K[d].R.splice(f,1)}G.ka(a)&&G.remove_object(a);for(d=0;d<c.length;d++)c[d]!=a&&l(c[d],!0,!0,!0);c=a.ig.Ua;a.ig.Ua=a;return c}function F(a,b){a.ig.Ua=b;l(a,!0,!0,!0)}function u(a,b,c,d){var f=c.rc.Fj.indexOf(d);b=a.rc.Xi[a.rc.Fj.indexOf(b)];c.rc.Xi[f]=b;a=b.name;b.name=d;for(d=0;d<c.ig.data.materials.length;d++)c.ig.data.materials[d]=c.rc.Xi[d],c.rc.$k[d]=d!=f;return a}function r(a,b,c,d){for(var f=0;f<c.ig.data.materials.length;f++)c.rc.$k[f]=!1;a.rc.Xi[a.rc.Fj.indexOf(b)].name=d}function z(a,b,
c,d,f){for(var e=1;e<a.o.nf.length;e++)I.bv(a,a.o.nf[e].name,a.o.nf[e].value);if(J.is_animated(a))for(e=0;e<a.fa.length;e++){var h=a.fa[e];if(h)switch(h.type){case J.OBJ_ANIM_TYPE_PARTICLES:J.set_frame(a,J.sw(a,e),e);break;case J.OBJ_ANIM_TYPE_MATERIAL:if(h.Dj)for(var g=h.Dj.length-1;0<=g;g--)-1!=h.Dj[g].Jb.indexOf(b)&&h.Dj.splice(g,1)}}d&&D.Yw(a,b,function(b){if(b.wa){var c=b.wa.name;if(d[c]){var f=b.wa.Ar!=d[c].Ar;b.wa=ca.S(d[c]);f&&R.set_factor(a,c,b.wa.Ar)}}},"PARTICLES");f&&(e=D.Oa(a,b,"MAIN"))&&
(e.xd.set(f.xd),e.ih=f.ih,e.hh=f.hh,e.$c.set(f.$c),e.Yf.set(f.Yf),e.Di=f.Di,e.Rd.set(f.Rd),e.Cl=f.Cl,e.ug=f.ug,e.lg=f.lg,e.xf=f.xf,e.kl=f.kl,e.Pm=f.Pm,e.reflect_factor=f.reflect_factor,e.Vm=f.Vm,e.bf.set(f.bf),e.parallax_scale=f.parallax_scale,e.$f.set(f.$f),e.shallow_water_col.set(f.shallow_water_col),e.shallow_water_col_fac=f.shallow_water_col_fac,e.shore_water_col.set(f.shore_water_col),e.shore_water_col_fac=f.shore_water_col_fac,e.foam_factor=f.foam_factor,e.gk=f.gk,e.Gg=ca.S(f.Gg),e.Bd=ca.S(f.Bd));
D.Yw(a,b,function(b){for(var d=0;d<b.Ve.length;d++){var f=b.Ve[d],e=b.Sa[d];if("IMAGE"==e.source||"ENVIRONMENT"==e.source){var h=ha.Cw(c,f);h&&e.rj!=h.rj&&ha.zQ(a,f,h)}}})}var J=q("__animation"),D=q("__batch"),H=q("__boundings"),C=q("__camera"),t=q("__config"),m=q("__constraints"),A=q("__container"),I=q("__geometry"),p=q("__lights"),Q=q("__nla"),y=q("__nodemat"),Y=q("__obj_util"),R=q("__particles"),G=q("__physics"),E=q("__print"),W=q("__primitives"),V=q("__quat"),K=q("__scenes"),ba=q("__subscene"),
oa=q("__sfx"),X=q("__transform"),ha=q("__textures"),Z=q("__tsr"),ca=q("__util"),da=q("__vec3"),L=q("__armature"),ja=q("__anchors"),aa=q("__renderer"),P=t.H,la=t.Ic,T={ALL:[]},ka=new Float32Array(24),ea=0,Ba=0,ra=[],ta=[],qa=new Float32Array(3),fa=new Float32Array(4);a.Nu=0;a.Mu=1;a.Cc=2;a.DATA_ID_ALL=-1;a.update=function(a){for(var b=0;b<ta.length;b++){var f=ta[b],e=f,h=a,g=0,t=e.wD;0==t.eu&&(t.eu=h);h-=t.eu;if(t.Xx&&h/t.kf>=t.Xx)c(e);else{h%=t.kf;if(h<t.Ix)switch(t=h/(t.Ix/5),h=Math.floor(t),h){case 0:g=
(t-h)/2;break;case 1:g=(t-h)/2+.5;break;case 2:g=1;break;case 3:g=1-(t-h)/2;break;case 4:g=.5-(t-h)/2}e.o.Jg=g}f.o.Jg&&d(f)}if(a=T.ARMATURE)for(b=0;b<a.length;b++)f=a[b],f.Bx&&(X.L(f),f.Bx=!1)};a.set_outline_intensity=function(a,b){a.o.Jg=b;d(a)};a.apply_outline_anim=function(a,b,c,d){var f=a.wD;f.eu=0;f.Ix=b;f.kf=c;f.Xx=d;-1==ta.indexOf(a)&&ta.push(a)};a.clear_outline_anim=c;a.bk=function(a,b){b.Oi=a.uuid;b.Yi=!0;if(a.b4w_dynamic_geometry){b.ig=a;for(var c=0;c<a.data.materials.length;c++){var d=
a.data.materials[c];b.rc.Fj.push(d.name);b.rc.Xi.push(d);b.rc.$k.push(!1)}}v(a,b);a.Wu=b.is_dynamic=B(a,b);a.uI=!0;b.Ce=a.b4w_vehicle;b.is_character=a.b4w_character;b.bl=a.b4w_floating;b.xn=a.b4w_collision;b.Ub=a.b4w_collision_id;b.zr=a.b4w_correct_bounding_offset;c=a.game;b.Kg={Mp:c.physics_type,Cq:c.use_ghost,NF:c.use_sleep,vh:c.mass,RF:c.velocity_min,QF:c.velocity_max,sB:c.damping,YD:c.rotation_damping,sO:c.lock_location_x,tO:c.lock_location_y,uO:c.lock_location_z,vO:c.lock_rotation_x,wO:c.lock_rotation_y,
xO:c.lock_rotation_z,Do:c.collision_margin,Bo:c.collision_group,Eo:c.collision_mask,fz:c.use_collision_bounds,wr:c.collision_bounds_type,zq:c.use_collision_compound};if(c=a.b4w_vehicle_settings)b.Le={name:c.name,Fe:c.part,jR:c.suspension_rest_length,Fy:c.suspension_compression,Hy:c.suspension_stiffness,Gy:c.suspension_damping,pz:c.wheel_friction,dy:c.roll_influence,nx:c.max_suspension_travel_cm,ep:c.force_max,no:c.brake_max,jn:c.steering_max,Jm:c.max_speed_angle,So:c.delta_tach_angle,lq:c.speed_ratio,
oq:c.steering_ratio,rp:c.inverse_control,Ok:c.floating_factor,Nl:c.water_lin_damp,Ol:c.water_rot_damp,$E:c.synchronize_position};if(c=a.b4w_floating_settings)b.rm={name:c.name,Fe:c.part,Ok:c.floating_factor,Nl:c.water_lin_damp,Ol:c.water_rot_damp,$E:c.synchronize_position};if(c=a.b4w_character_settings)b.OA={wS:c.walk_speed,TP:c.run_speed,dR:c.step_height,ZN:c.jump_strength,yS:c.waterline};for(c=0;c<a.constraints.length;c++)d=a.constraints[c],"RIGID_BODY_JOINT"==d.type&&b.Ox.push({target:d.target.Ua,
eP:d.pivot_type,fP:d.pivot_x,gP:d.pivot_y,hP:d.pivot_z,Ea:d.axis_x,Fa:d.axis_y,Ga:d.axis_z,jS:d.use_limit_x,kS:d.use_limit_y,lS:d.use_limit_z,fS:d.use_angular_limit_x,gS:d.use_angular_limit_y,hS:d.use_angular_limit_z,jO:d.limit_max_x,kO:d.limit_max_y,lO:d.limit_max_z,mO:d.limit_min_x,nO:d.limit_min_y,oO:d.limit_min_z,dO:d.limit_angle_max_x,eO:d.limit_angle_max_y,fO:d.limit_angle_max_z,gO:d.limit_angle_min_x,hO:d.limit_angle_min_y,iO:d.limit_angle_min_z});c=b.o=Y.No("MESH"===b.type?b.is_dynamic?"DYNAMIC":
"STATIC":b.type);a.parent?(b.parent=a.parent.Ua,"BONE"==a.parent_type&&"ARMATURE"==a.parent.type&&(b.Ip=a.parent_bone),a.pinverse_tsr&&(b.wt=Z.create(),Z.copy(a.pinverse_tsr,b.wt))):a.dg_parent&&(b.parent=a.dg_parent.Ua,b.Lj=!0);var d=a.location,f=a.scale[0];ca.Tx(a.rotation_quaternion,fa);X.set_translation(b,d);X.set_rotation(b,fa);X.set_scale(b,f);b.Aq=a.b4w_use_default_animation;b.mk=J.av(a.b4w_anim_behavior);a.b4w_object_tags&&(b.$s={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,
category:a.b4w_object_tags.category});b.Ir=a.b4w_custom_prop;a.b4w_viewport_alignment&&(b.uu={yI:a.b4w_viewport_alignment.alignment,distance:a.b4w_viewport_alignment.distance});c.hide=a.b4w_hidden_on_load;switch(a.type){case "ARMATURE":L.bk(a,b);d=c.zf;f=J.FJ(d);a.b4w_animation_mixing?(c.Pd=new Float32Array(f.wb),c.he=new Float32Array(f.wb),c.Td=new Float32Array(f.trans),c.ke=new Float32Array(f.trans)):(c.Pd=f.wb,c.he=f.wb,c.Td=f.trans,c.ke=f.trans);for(var e in d){var h=d[e];1==h.sr.length&&L.ER(h,
!0,f.trans,f.wb)}c.Qp=f;c.Be=0;c.Qh=a.b4w_animation_mixing;break;case "MESH":b.DC=a.data.is_boundings_overridden;c.jm=a.b4w_do_not_render;c.Th=D.mJ(a.data.b4w_boundings.bb);c.Qj=la.outlining_overview_mode||a.b4w_selectable;c.ot=a.b4w_selectable;c.Ic=la.outlining_overview_mode||a.b4w_outlining;c.nt=a.b4w_outlining;c.pt=la.outlining_overview_mode||a.b4w_outline_on_select;c.ng=a.b4w_billboard;c.ho=a.b4w_pres_glob_orientation;c.jo="BASIC";c.io="SPHERICAL"==a.b4w_billboard_geometry;e=c.zh;e.Gj=a.b4w_outline_settings.outline_duration;
e.Hj=a.b4w_outline_settings.outline_period;e.Ij=a.b4w_outline_settings.outline_relapses;c.Qj&&(c.aj=ca.QB(ea),ea++);for(e=0;e<a.data.b4w_vertex_anim.length;e++)d=a.data.b4w_vertex_anim[e],b.Kc.push({name:d.name,sa:d.frame_start,Za:d.frame_end,mT:d.averaging,nT:d.averaging_interval,zI:d.allow_nla});b.o.Kc=b.Kc.length?!0:!1;"MESH"!=a.type&&ca.D("Wrong object type: "+a.name);e=b.o;if(a.data.b4w_shape_keys.length)for(e.me=!0,d=0;d<a.data.b4w_shape_keys.length;d++)f={},f.value=a.data.b4w_shape_keys[d].value,
f.name=a.data.b4w_shape_keys[d].name,e.nf.push(f);else e.me=!1;c.ie=a.b4w_shadow_cast;c.Gd=a.b4w_shadow_receive;c.Qd=a.b4w_shadow_cast_only&&c.ie;c.Ed=a.b4w_reflexible;c.md=a.b4w_reflexible_only&&c.Ed;c.ld=a.b4w_reflective;c.Mg=a.b4w_reflection_type;if(!c.ld)for(e=a.data.materials,d=0;d<e.length;d++)f=e[d],f.use_nodes&&-1!=f.node_tree.Vu.indexOf("BSDF_GLOSSY")&&(c.ld=!0,c.Mg="CUBE");c.og=a.b4w_caustics;if(c.Ud=a.b4w_wind_bending)c.Ql=a.b4w_wind_bending_angle,e=D.aG(a.b4w_wind_bending_angle,c.Th,a.scale[0]),
c.Ne=e,c.Oe=a.b4w_wind_bending_freq,c.ye=a.b4w_detail_bending_freq,c.xe=a.b4w_detail_bending_amp,c.te=a.b4w_branch_bending_amp,c.oi=a.b4w_main_bend_stiffness_col,e=a.b4w_detail_bend_colors,c.ae.ax=e.leaves_stiffness_col,c.ae.$w=e.leaves_phase_col,c.ae.Jx=e.overall_stiffness_col;c.be=a.b4w_dynamic_geometry;"MESH"!==a.type&&ca.D("Wrong object");e=a.data.materials[0];c.um=e.physics.friction;c.mm=e.physics.elasticity;c.Dg=0;c.De=Y.Mn;c.Eg=a.b4w_lod_transition;c.vt=a.pass_index;break;case "LINE":c.U=H.sd();
c.Z=H.qg();c.Pa=H.sd();c.jb=H.qg();break;case "CAMERA":C.LJ(a,b);C.dJ(b);break;case "LAMP":p.$N(a,b);break;case "SPEAKER":b.Y=oa.TK();e=!1;for(c=0;c<b.K.length;c++)if(b.K[c].pb.Dc){e=!0;break}e&&oa.bk(a,b);break;case "EMPTY":e=H.sd(),c.U=e,e=H.fh(),c.va=e,a.field&&(b.pm={type:a.field.type,TE:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,im:a.b4w_anchor.detect_visibility,gj:a.b4w_anchor.element_id,GO:a.b4w_anchor.max_width})}k(b)};a.bS=function(a,b){b.Oi=a.uuid;b.Yi=!0;v(a,b);
a.Wu=b.is_dynamic=B(a,b);a.uI=!0;b.o=Y.No(b.type);b.Aq=a.b4w_use_default_animation;b.mk=J.av(a.b4w_anim_behavior);k(b)};a.OR=function(a,b){var c=b.o;if(b.parent){!b.Lj&&b.Kg.zq&&b.parent.Kg.zq&&(b.xn=!1);for(var d=!1,f=0;f<b.K.length;f++)if(b.K[f].pb.jc){d=!0;break}if(f=d)f=b.Kg,f=b.Ce||b.bl||b.is_character||b.xn&&!f.Cq&&0<f.vh&&("DYNAMIC"==f.Mp||"RIGID_BODY"==f.Mp);if(f)f=b.Lj?Z.copy(c.v,Z.create()):c.v,Z.multiply(b.parent.o.v,f,c.v),X.set_translation(b,Z.get_trans_view(c.v)),X.set_scale(b,Z.get_scale(c.v)),
X.set_rotation(b,Z.get_quat_view(c.v));else if(b.Lj||!b.Ip)if(f=Z.copy(c.v,Z.create()),b.uu&&"CAMERA"==b.parent.type){f={distance:b.uu.distance,rotation:Z.get_quat_view(f)};switch(b.uu.yI){case "TOP_LEFT":f.top=0;f.left=0;break;case "TOP":f.top=0;f.left=.5;break;case "TOP_RIGHT":f.top=0;f.right=0;break;case "LEFT":f.top=.5;f.left=0;break;case "CENTER":f.top=.5;f.left=.5;break;case "RIGHT":f.top=.5;f.right=0;break;case "BOTTOM_LEFT":f.bottom=0;f.left=0;break;case "BOTTOM":f.bottom=0;f.left=.5;break;
case "BOTTOM_RIGHT":f.bottom=0,f.right=0}m.append_stiff_viewport(b,b.parent,f)}else m.DI(b,b.parent,f);else f=Z.copy(c.v,Z.create()),m.EI(b,b.parent,b.Ip,f)}if("ARMATURE"==b.type)for(d=a.pose.bones,f=0;f<d.length;f++){var e=d[f],h=e.constraints;if(h)for(var t=0;t<h.length;t++){var l=h[t];"COPY_TRANSFORMS"!=l.type||l.subtarget||l.mute||m.SI(b,l.target.Ua,e.name,ca.Tz,ca.Wl)}}if("MESH"==b.type){if(f=J.$B(a)){t=f.Ua;d=t.o.Qp;e=b.o;h=a.data;b.fr=t;h=h.vertex_groups;if(h.length){var t=t.o.zf,l=0,r={},
p;for(p in t){var A=ca.keysearch("name",p,h);A&&(r[p]={UF:A.index,Uh:t[p].Uh,Vv:l++})}e.Vh=r;p=l;h=J.fC();e.Fg=p;p>2*h?(e.xj=!1,E.error('too many bones for "'+a.name+'" / '+e.Fg+" bones (max "+h+" with blending, "+2*h+" without blending). Skinning will be disabled.")):e.xj=!0}p=J.hM(d.trans,d.wb,c.Vh);f.b4w_animation_mixing?(c.Pd=new Float32Array(p.wb),c.he=new Float32Array(p.wb),c.Td=new Float32Array(p.trans),c.ke=new Float32Array(p.trans)):(c.Pd=p.wb,c.he=p.wb,c.Td=p.trans,c.ke=p.trans);c.Zn=new Float32Array(4);
c.Yn=V.create();c.Qp=p;c.Be=0}if(c.ld)if(c=b.o,"CUBE"==c.Mg)c.td=Ba++;else if("PLANE"==c.Mg){a:{p=a.constraints;for(f=0;f<p.length;f++)if(d=p[f],"LOCKED_TRACK"==d.type&&"REFLECTION PLANE"==d.name){if(d.target.Ua){p=d.target.Ua;break a}E.warn('Reflection plane target "'+d.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}p=null}p||(p=ca.tq("%reflection%"),p=Y.Mo(p,"EMPTY"),f=Y.No("EMPTY"),p.o=f,g(b,p),m.fA(p,b,[0,0,0],null,1),k(p));f=null;for(d=0;d<ra.length;d++)if(ra[d]==
p){f=d;break}null==f&&(f=ra.length,ra.push(p));p.o.jd=f;c.jd=f;p.Xp.push(b)}}};a.JR=b;a.BT=g;a.UJ=n;a.PR=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.o||"DYNAMIC"!=c.o.type&&"CAMERA"!=c.o.type||X.L(c);c.Aq&&J.uD(c)&&(J.apply_def(c),c.fa.length&&J.play(c,null,J.SLOT_ALL))}};a.get_meta_tags=function(a){return ca.S(a.$s)};a.get_custom_prop=function(a){return a.Ir};a.cleanup=function(){Ba=ea=0;ra.length=0;ta.length=0;T={ALL:[]}};a.copy=function(a,b,c){var d=b,f=Y.get_dg_parent(a);b=f?Y.RB(f.name,
b):b;if(x(b,T.ALL,!1,-1)){for(var f=1,e;;){e="."+(3>String(f).length?("000"+String(f)).slice(-3):String(f));if(!x(b+e,T.ALL,!1,-1))break;f++}E.error('Object "'+b+'" already exists. Name was replaced by "'+b+e+'".');d+=e;b+=e}d=Y.Mo(b,a.type,d);d.Yi=a.Yi;d.ig=a.ig;d.rc.Fj=Y.dm(a.rc.Fj);d.rc.Xi=Y.dm(a.rc.Xi);d.rc.$k=Y.dm(a.rc.$k);d.is_dynamic=a.is_dynamic;d.tp=a.tp;d.Aq=a.Aq;d.sg=a.sg;d.o=Y.Av(a.o);d.$s=Y.Ko(a.$s);d.Ir=Y.Ko(a.Ir);g(a,d);d.ar=Y.dm(a.ar);d.parent=Y.dm(a.parent);d.Lj=a.Lj;d.Ip=a.Ip;d.Kc=
Y.dm(a.Kc);d.mk=a.mk;!a.J||a.Ce||a.is_character||a.bl||(d.xn=a.xn,d.J=null);d.Ub=a.Ub;d.zr=a.zr;d.Kg=Y.Ko(a.Kg);b=[];for(f=0;f<a.K.length;f++){var h=d.K[f];e=a.K[f].R;if(c){for(var h=h.R,t=0;t<e.length;t++)if(!e[t].Ff){var l=Y.Ko(e[t]);l.da=I.nK(e[t].da);h.push(l);b.push(e[t].da)}for(t=0;t<e.length;t++)if(e[t].Ff){l=Y.Ko(e[t]);h.push(l);for(var m=0;m<b.length;m++)b[m]==e[t].da&&(l.da=h[m].da)}for(t=0;t<h.length;t++)h[t].da&&I.cz(h[t].da),P.Zu&&aa.gJ(h[t]),h[t].Ej=D.NM(h[t],d.o,d.Oi),D.zR(h[t]);ha.JQ(h)}else h.R=
e}c||(d.o.wn=!1);Y.jy(d,!1);k(d);d.o.Hs=!0;d.o.Is=c;d.o.aj=ca.QB(ea);ea++;return d};a.update_boundings=function(a){for(var b=a.o,c=a.K[0].R,d,f,e,h,g,t,l,k,m,r,p,O,A=[],n=0;n<c.length;n++){var L=c[n];if("MAIN"==L.type){var y=I.nj("a_position");if(y=I.ns(L.da.Kb,y)){var u=L.da.Fb.a_position.offset;d=h=y[u];f=g=y[u+1];e=t=y[u+2]}}}for(n=0;n<c.length;n++)if(L=c[n],L.da&&L.jb&&L.Pa&&(y=I.nj("a_position"),y=I.ns(L.da.Kb,y))){var u=L.da.Fb.a_position.offset,w=L.da.Fb.a_position.length+u;l=r=y[u];k=p=y[u+
1];m=O=y[u+2];for(var v=u;v<w;v+=3){var u=y[v],x=y[v+1],C=y[v+2];l=Math.max(u,l);k=Math.max(x,k);m=Math.max(C,m);r=Math.min(u,r);p=Math.min(x,p);O=Math.min(C,O)}L.U.max_x=l.toFixed(3);L.U.max_y=k.toFixed(3);L.U.max_z=m.toFixed(3);L.U.min_x=r.toFixed(3);L.U.min_y=p.toFixed(3);L.U.min_z=O.toFixed(3);H.wk(L.U,b.v,L.Pa);H.GB(L.Pa,ka);for(y=A.length=0;y<ka.length;y++)A.push(ka[y]);L.jb=H.Br(A,!0);L.Z=H.BJ(L.jb,b.v);L.va=H.Lo(L.Z);L.gb=H.Lo(L.jb);L.Je=H.Gs(L.Z,L.va);"MAIN"==L.type&&(d=Math.max(l,d),f=Math.max(k,
f),e=Math.max(m,e),h=Math.min(r,h),g=Math.min(p,g),t=Math.min(O,t))}A={max_x:parseFloat(d.toFixed(3)),max_y:parseFloat(f.toFixed(3)),max_z:parseFloat(e.toFixed(3)),min_x:parseFloat(h.toFixed(3)),min_y:parseFloat(g.toFixed(3)),min_z:parseFloat(t.toFixed(3))};l=d-h;k=f-g;m=e-t;h=.5*(d+h);r=.5*(f+g);O=.5*(e+t);var B=h,K=O;g=Math.max(l,Math.max(k,m))/2;t=Math.max(l,m)/2;var z=[h/(l?l:1),r/(k?k:1),O/(m?m:1)];p=.5;if(b.ng)u=Math.max(Math.abs(A.max_x),Math.abs(A.min_x)),x=Math.max(Math.abs(A.max_y),Math.abs(A.min_y)),
C=Math.max(Math.abs(A.max_z),Math.abs(A.min_z)),e=Math.sqrt(u*u+x*x+C*C),n=Math.sqrt(u*u+x*x),A.max_x=A.max_y=A.max_z=e,A.min_x=A.min_y=A.min_z=-e,t=n,g=e,d=new Float32Array([0,0,0]),y=new Float32Array([g,g,g]),e=new Float32Array([0,0,0]);else{for(n=0;n<c.length;n++)if(L=c[n],"MAIN"==L.type&&(y=I.nj("a_position"),y=I.ns(L.da.Kb,y)))for(w=c[n].da.Fb,u=w.a_position.offset,w=w.a_position.length+u,v=u;v<w;v+=3){var u=y[v],x=y[v+1],C=y[v+2],E=Math.sqrt((h-u)*(h-u)+(r-x)*(r-x)+(O-C)*(O-C));if(E>g){var L=
h-g*(u-h)/E,Q=r-g*(x-r)/E,E=O-g*(C-O)/E;h=(L+u)/2;r=(Q+x)/2;O=(E+C)/2;g=Math.sqrt((h-u)*(h-u)+(r-x)*(r-x)+(O-C)*(O-C))}Q=Math.sqrt((B-u)*(B-u)+(K-C)*(K-C));Q>t&&(L=B-t*(u-B)/Q,E=K-t*(C-K)/Q,B=(L+u)/2,K=(E+C)/2,t=Math.sqrt((B-u)*(B-u)+(K-C)*(K-C)));u/=l?l:1;x/=k?k:1;C/=m?m:1;E=Math.sqrt((z[0]-u)*(z[0]-u)+(z[1]-x)*(z[1]-x)+(z[2]-C)*(z[2]-C));E>p&&(L=z[0]-p*(u-z[0])/E,Q=z[1]-p*(x-z[1])/E,E=z[2]-p*(C-z[2])/E,z[0]=(L+u)/2,z[1]=(Q+x)/2,z[2]=(E+C)/2,p=Math.sqrt((z[0]-u)*(z[0]-u)+(z[1]-x)*(z[1]-x)+(z[2]-
C)*(z[2]-C)))}n=l?l*z[0]:d;f=k?k*z[1]:f;e=m?m*z[2]:e;d=new Float32Array([h,r,O]);y=new Float32Array([p*l,p*k,p*m]);e=new Float32Array([n,f,e]);t=parseFloat(t.toFixed(3))}b.U=A;D.qQ(b,t,t,A);n=H.pv(g,d);b.va=n;e=H.fo([y[0],0,0],[0,y[1],0],[0,0,y[2]],e);b.Z=e;X.L(a);if(P.debug_view)for(n=0;n<c.length;n++)if("DEBUG_VIEW"===c[n].type&&c[n].ci){a=W.es(1,e.M);I.bE(a,[e.Ea[0],e.Fa[1],e.Ga[2]],e.M);I.cu(a,1,!0);a.pa.a_polyindex=I.Ur(a);D.yR(c[n],a);break}};a.Ib=w;a.kC=function(a,b,c){b=T[b]||[];for(var d=
[],f=0;f<b.length;f++){var e=b[f];if((e.o.ud==c||-1==c)&&e.Yi)for(var h=e.K,g=0;g<h.length;g++)h[g].pb==a&&d.push(e)}return d};a.get_all_objects=h;a.get_first_character=function(a){var b=T.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];if(G.tC(d))for(var f=d.K,e=0;e<f.length;e++)if(f[e].pb==a)return d}return null};a.lt=l;a.get_selectable_objects=function(){var a=[],b=T.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.o.Qj&&d.Yi&&a.push(d)}return a};a.get_outlining_objects=function(){var a=[],
b=T.MESH;if(b)for(var c=0;c<b.length;c++){var d=b[c];d.o.Ic&&d.Yi&&a.push(d)}return a};a.oc=function(b,c,d,f){var e=null,h=T.ALL;switch(b){case a.Nu:e=x(c,h,!0,d,f);break;case a.Mu:a:{for(b=0;b<h.length;b++)if(e=h[b],e.Cd==d&&(e.o.ud==f||-1==f)){var g=Y.get_dg_parent(e);if(g&&g.Cd==c)break a}e=null}break;case a.Cc:a:{for(f=0;f<h.length;f++){b=h[f];for(var e=c.length-1,g=b,t=!0;0<=e&&t;)t=g&&g.Cd==c[e]&&(g.o.ud==d||-1==d),g&&(g=Y.get_dg_parent(g)),e--;if(t&&!g){e=b;break a}}e=null}}return e};a.get_world_by_name=
function(a,b){return x("%meta_world%"+a,T.WORLD,!0,b)};a.pick_object=function(b,c){var d=K.nh();if(!d)return E.error("No active scene"),null;var f=K.Aa(d,ba.uf);f&&f.enable_hmd_stereo&&(f=A.get_canvas(),b=f.clientHeight/2,c=f.clientWidth/2);if(f=ja.cP(b,c))return f;f=K.dP(d,b,c);if(!f)return null;for(var d=w(d,"MESH",-1),e=0;e<d.length;e++){var h=d[e].o,g=h.aj;if(g&&3>Math.abs(255*g[0]-f[0])&&3>Math.abs(255*g[1]-f[1])&&3>Math.abs(255*g[2]-f[2]))return h.Ic&&h.pt&&(la.outlining_overview_mode?a.apply_outline_anim(d[e],
la.Gj,la.Hj,la.Ij):(f=h.zh,a.apply_outline_anim(d[e],f.Gj,f.Hj,f.Ij))),d[e]}return null};a.set_wind_params=function(a,c){for(var d=w(a,"EMPTY",-1),f=0;f<d.length;f++){var e=d[f];if(e.pm&&"WIND"===e.pm.type){var h=e;break}}if(!h)return E.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(d=ca.deg_to_rad(c.wind_dir),da.set(Math.sin(d),-Math.cos(d),0,qa),ca.dir_to_quat(qa,ca.AXIS_Z,fa),X.set_rotation(h,fa));"number"==typeof c.wind_strength&&(h.pm.TE=c.wind_strength);b(h)};a.remove_object=
function(a){m.VJ(a)&&m.remove(a);var b=T.ALL,c=T[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.VO=k;a.JU=function(a){return T[a.type]&&-1<T[a.type].indexOf(a)};a.kQ=function(a){var b=a.o,c=b.Ne,d=b.Oe,f=b.ye,e=b.xe,h=b.te;a=a.K;for(b=0;b<a.length;b++)for(var g=a[b].R,t=0;t<g.length;t++){var l=g[t].da,k=l.Fb,m=k.au_wind_bending_amp,r=k.au_wind_bending_freq,p=k.au_detail_bending_amp,O=k.au_detail_bending_freq,k=k.au_branch_bending_amp;if(r){var A=Array.apply(null,
Array(r.length)).map(function(){return d});I.vq(l,I.Yl,new Float32Array(A),r.offset)}m&&(A=Array.apply(null,Array(m.length)).map(function(){return c}),I.vq(l,I.Yl,new Float32Array(A),m.offset));p&&(A=Array.apply(null,Array(p.length)).map(function(){return e}),I.vq(l,I.Yl,new Float32Array(A),p.offset));O&&(A=Array.apply(null,Array(O.length)).map(function(){return f}),I.vq(l,I.Yl,new Float32Array(A),O.offset));k&&(A=Array.apply(null,Array(k.length)).map(function(){return h}),I.vq(l,I.Yl,new Float32Array(A),
k.offset))}};a.inherit_material=function(a,b,c,d){if(a.o.be&&c.o.be){var e=D.Oa(a,b,"MAIN"),h=null;D.Yw(c,d,function(a){h||(h={});a.wa&&(h[a.wa.name]=a.wa)},"PARTICLES");for(var g=f(c,d),t=u(a,b,c,d),l=K.get_active(),k=0;k<c.K.length;k++){var m=c.K[k].pb;K.set_active(m);var p=w(m,"LAMP",0),A=c.K[k].R;c.K[k].R=[];D.UB(m,[c.ig],p,[]);D.Cr(c,K.ls(m),m);K.iA(m,[c]);K.append_object(m,c,!1,!0);c.K[k].R.push.apply(c.K[k].R,A)}r(a,b,c,t);F(c,g);z(c,d,a,h,e);K.set_active(l)}}};b4w.module.__obj_util=function(a,q){function d(a){a={type:a,ud:0,v:v.Ek(),Bu:v.Ek(),pivot:new Float32Array(3),fc:new Float32Array(3),sj:0,tj:0,Hs:!1,Is:!1,aj:null,Jg:0,Yj:!1,sf:h.create(),use_panning:!1,kb:0,An:1,zn:1,Bn:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,gd:!1,dof_object:null,Bb:null,Da:null,ub:null,cd:null,bd:null,Dd:null,jh:!0,zh:{Gj:1,Hj:1,Ij:0},td:-1,jd:-1,hc:new Float32Array(4),um:0,mm:0,Bm:!1,hl:new Float32Array(3),
il:0,De:-1,Dg:0,Eg:0,jm:!1,ie:!1,Gd:!1,Qd:!1,Ed:!1,md:!1,ld:!1,Mg:"",Ud:!1,be:!1,yc:!1,hide:!1,Qj:!1,ot:!1,Ic:!1,nt:!1,pt:!1,vj:!1,is_visible:!1,fp:!1,Ql:0,Ne:0,Oe:0,ye:0,xe:0,te:0,oi:"",ae:{ax:"",$w:"",Jx:""},rk:!1,so:new Float32Array(3),ng:!1,ho:!1,jo:"",io:!1,Be:0,mu:0,nu:0,Fg:0,Qk:!1,Kc:!1,me:!1,nf:[],xj:!1,Qh:!1,mg:1,Vn:0,Un:1,tn:new Int8Array([-1,-1]),dn:[],Ys:[],Mt:[],Pd:null,he:null,Td:null,ke:null,zf:null,Vh:null,Qp:null,Zn:null,Yn:null,Th:null,U:B.sd(),Pa:B.sd(),va:B.fh(),gb:B.fh(),Z:B.qg(),
jb:B.qg(),fd:B.Dr(),qA:B.Dr(),eo:null,bo:null,co:null,wn:!0,Je:!1,vt:0};h.copy(w.AXIS_Z,a.sf);return a}function c(a){if(!(a instanceof Object))return a;var b=null,d=null,e=null,h=null,g=null,l=null;a.Sa&&(b=a.Sa,a.Sa=null);a.Ie&&(d=a.Ie,a.Ie=null);a.Ve&&(e=a.Ve,a.Ve=null);a.eb&&(h=a.eb,a.eb=null);a.ib&&(g=a.ib,a.ib=null);a.ne&&(l=a.ne,a.ne=null);var k;k=a.constructor;switch(k){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:k=
new k(a);break;case Array:k=new k(a.length);for(var n=0;n<a.length;n++)k[n]=c(a[n]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:k=a;break;case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:k=null;break;case Function:k=a;break;default:for(n in k=new k,a)k[n]=c(a[n])}b&&(k.Sa=b,a.Sa=b);d&&(k.Ie=d,a.Ie=d);e&&(k.Ve=e,a.Ve=e);h&&(k.eb=h,a.eb=h);g&&(k.ib=g,a.ib=g);l&&(k.ne=w.dj(),a.ne=l);return k}function b(a,b){for(var c=a.K,d=0;d<c.length;d++){var f=c[d];if(f.pb==b)return f}return null}
function g(a){return{pb:a,Fs:!1,R:[],Ah:[],ai:null,ry:[],Bp:0,tD:!1,ea:[],zE:[]}}function n(a){return a.Lj?a.parent:a.parent?n(a.parent):null}var B=q("__boundings"),e=q("__config"),v=q("__tsr"),w=q("__util"),h=q("__vec3"),l=q("__vec4"),x=e.H;a.Mn=-1;a.No=d;a.Av=function(a){var b=d(a.type);b.ud=a.ud;v.copy(a.v,b.v);v.copy(a.Bu,b.Bu);h.copy(a.pivot,b.pivot);h.copy(a.fc,b.fc);b.sj=a.sj;b.tj=a.tj;b.Hs=a.Hs;b.Is=a.Is;a.aj&&(b.aj=h.clone(a.aj));b.Jg=a.Jg;b.Yj=a.Yj;h.copy(a.sf,b.sf);b.use_panning=a.use_panning;
b.kb=a.kb;b.An=a.An;b.zn=a.zn;b.Bn=a.Bn;b.dof_distance=a.dof_distance;b.dof_front_start=a.dof_front_start;b.dof_front_end=a.dof_front_end;b.dof_rear_start=a.dof_rear_start;b.dof_rear_end=a.dof_rear_end;b.dof_power=a.dof_power;b.dof_bokeh_intensity=a.dof_bokeh_intensity;b.dof_bokeh=a.dof_bokeh;b.gd=a.gd;b.dof_object=a.dof_object;b.Bb=w.S(a.Bb);b.Da=w.S(a.Da);b.ub=w.S(a.ub);b.cd=w.S(a.cd);b.bd=w.S(a.bd);b.Dd=a.Dd;b.jh=a.jh;b.zh.Gj=a.zh.Gj;b.zh.Hj=a.zh.Hj;b.zh.Ij=a.zh.Ij;b.td=a.td;b.jd=a.jd;b.hc=a.hc;
b.um=a.um;b.mm=a.mm;b.Bm=a.Bm;h.copy(a.hl,b.hl);b.il=a.il;b.De=a.De;b.Dg=a.Dg;b.Eg=a.Eg;b.jm=a.jm;b.ie=a.ie;b.Gd=a.Gd;b.Qd=a.Qd;b.Ed=a.Ed;b.md=a.md;b.ld=a.ld;b.Mg=a.Mg;b.Ud=a.Ud;b.be=a.be;b.yc=a.yc;b.hide=a.hide;b.Qj=a.Qj;b.ot=a.ot;b.Ic=a.Ic;b.nt=a.nt;b.pt=a.pt;b.vj=a.vj;b.is_visible=a.is_visible;b.fp=a.fp;b.Ql=a.Ql;b.Ne=a.Ne;b.Oe=a.Oe;b.ye=a.ye;b.xe=a.xe;b.te=a.te;b.oi=a.oi;b.ae=a.ae;b.rk=a.rk;h.copy(a.so,b.so);b.ng=a.ng;b.ho=a.ho;b.jo=a.jo;b.io=a.io;b.Be=a.Be;b.mu=a.mu;b.nu=a.nu;b.Fg=a.Fg;b.Qk=
a.Qk;b.Kc=a.Kc;b.me=a.me;b.nf=w.S(a.nf);b.xj=a.xj;b.Qh=a.Qh;b.mg=a.mg;b.Vn=a.Vn;b.Un=a.Un;b.tn.set(a.tn);b.dn=w.S(a.dn);b.Ys=w.S(a.Ys);b.Mt=w.S(a.Mt);b.Pd=w.S(a.Pd);b.he=w.S(a.he);b.Td=w.S(a.Td);b.ke=w.S(a.ke);b.zf=w.S(a.zf);b.Vh=w.S(a.Vh);b.Qp=w.S(a.Qp);b.Zn=w.S(a.Zn);b.Yn=w.S(a.Yn);b.Th=w.S(a.Th);B.cm(a.U,b.U);B.cm(a.Pa,b.Pa);B.Hv(a.va,b.va);B.Hv(a.gb,b.gb);B.Gv(a.Z,b.Z);B.Gv(a.jb,b.jb);b.eo=w.S(a.eo);b.bo=w.S(a.bo);b.co=w.S(a.co);b.wn=a.wn;b.Je=a.Je;b.vt=a.vt;return b};a.Mo=function(a,b,c){c||
(c=a);return{name:a,Oi:w.nw(),Cd:c,type:b,Yi:!1,ig:null,rc:{Fj:[],Xi:[],$k:[]},is_dynamic:!1,tp:!1,Aq:!1,DC:!1,o:null,cc:null,Y:null,nb:null,fr:null,anchor:null,pm:null,$s:null,Ir:null,K:[],Kc:[],ve:w.dj(),Fv:w.dj(),fa:[],Xp:[],Qf:[],ar:[],Og:null,zl:[],parent:null,Lj:!1,Ip:"",uu:null,wt:null,xn:!1,Ub:"",zr:"AUTO",Ce:!1,is_character:!1,bl:!1,jv:!1,J:null,I:null,Df:null,Le:null,rm:null,OA:null,Ox:[],Kg:{Mp:"NO_COLLISION",Cq:!1,NF:!1,vh:0,RF:0,QF:0,sB:0,YD:0,sO:!1,tO:!1,uO:!1,vO:!1,wO:!1,xO:!1,Do:0,
Bo:0,Eo:0,fz:!1,wr:"BOX",zq:!1},wD:{eu:0,Ix:0,kf:0,Xx:0},mk:0,sg:[],Bx:!1,kD:!1,Zs:[]}};a.dm=function(a){return a instanceof Array?a.slice():a};a.AT=function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d],h={},g;for(g in e)e[g]==e.Pa?h.Pa=c(e.Pa):e[g]==e.jb?h.jb=c(e.jb):h[g]=e[g];b.push(h)}return b};a.Ko=c;a.is_dynamic=function(a){return a.is_dynamic};a.Ag=function(a){return"MESH"==a.type&&a.is_dynamic};a.Xn=function(a,b){a.K.push(g(b))};a.dr=function(a,c,d){b(a,c).R.push(d)};a.OU=function(a,b){for(var c=
a.K,d=0;d<c.length;d++)if(c[d].pb==b){c.splice(d,1);break}};a.oa=b;a.AF=function(a,b){for(var c=0;c<a.length;c++)l.copy(b,a[c].o.hc)};a.sU=g;a.jy=function(a,b,c){for(var d=0;d<a.K.length;d++){var e=a.K[d];c&&e.pb!=c||(e.Fs=b)}};a.ms=function(a,b){for(var c=[],d=b?x.eD-1:x.eD,e=0;e<a.length;e++){var f=a[e];f.nb.VB&&c.length<d&&c.push(f)}return c.length?c:a[0]?[a[0]]:[]};a.KO=function(a,b){v.identity(b.v);b.aj=null;a.o=b};a.RA=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var c=
b.material-1,d=a.data.materials;if(0<=c&&c<d.length&&("ADD"==d[c].game_settings.alpha_blend||"ALPHA"==d[c].game_settings.alpha_blend||"ALPHA_SORT"==d[c].game_settings.alpha_blend))return!0}return!1};a.$J=function(a){a=a.K;for(var b=0;b<a.length;b++)for(var c=a[b].R,d=0;d<c.length;d++)for(var e=c[d].ab.di,h=0;h<e.length;h++){var g=e[h];if("USE_MODEL_TSR_INVERSE"==g[0]&&"1"==g[1])return!0}return!1};a.RB=function(a,b){return a+"*"+b};a.get_parent=function(a){return a.Lj?null:a.parent};a.get_dg_parent=
n;a.tw=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];n(e)==a&&c.push(e)}return c};a.get_object_data_id=function(a){return a.o.ud};a.is_mesh=function(a){return"MESH"===a.type};a.is_armature=function(a){return"ARMATURE"===a.type};a.is_speaker=function(a){return"SPEAKER"===a.type};a.is_camera=function(a){return"CAMERA"===a.type};a.is_lamp=function(a){return"LAMP"===a.type};a.is_empty=function(a){return"EMPTY"===a.type};a.is_line=function(a){return"LINE"===a.type};a.is_world=function(a){return"WORLD"===
a.type}};b4w.module.__particles=function(a,q){function d(){h.D("_rand() undefined")}function c(a,b,c,d,e,h){var g=a.Lr,l=a.vg,r=a.time;a=a.HD;for(var n=0;n<g.length;n+=4){var p=g[n];if(r>a&&r>=p&&p>a||r<a&&(p>a||r>=p))for(p=0;8>p;p++)l[8*n+p]=d[p],f[p]=d[p];else for(p=0;8>p;p++)f[p]=l[8*n+p];p=F;p[0]=b[3*n];p[1]=b[3*n+1];p[2]=b[3*n+2];w.transform_vec3(p,f,p);e[3*n]=p[0];e[3*n+1]=p[1];e[3*n+2]=p[2];var u=k;u[0]=c[4*n];u[1]=c[4*n+1];u[2]=c[4*n+2];u[3]=c[4*n+3];w.rR(u,f,u);h[4*n]=u[0];h[4*n+1]=u[1];h[4*n+2]=
u[2];h[4*n+3]=u[3];for(p=1;4>p;p++)e[3*(n+p)]=e[3*n],e[3*(n+p)+1]=e[3*n+1],e[3*(n+p)+2]=e[3*n+2],h[4*(n+p)]=u[0],h[4*(n+p)+1]=u[1],h[4*(n+p)+2]=u[2],h[4*(n+p)+3]=u[3]}}function b(a){a?(h.bR(a),d=function(){return h.sP()}):d=function(){return Math.random()}}var g=q("__config"),n=q("__batch"),B=q("__geometry"),e=q("__textures"),v=q("__time"),w=q("__tsr"),h=q("__util"),l=q("__vec3"),x=g.H,k=new Float32Array(4),f=new Float32Array(8),F=new Float32Array(3),u=[];a.update=function(){for(var a=0;a<u.length;a++)for(var b=
u[a],d=b.K,e=0;e<d.length;e++)for(var f=b,h=d[e].R,g=0;g<h.length;g++){var l=h[g],k=l.wa;k&&k.ju&&!l.Ff&&(c(k,k.positions,k.eF,f.o.v,k.Qx,k.Ky),k.jD=!0)}};a.Ex=function(a){a=a.K;for(var b=0;b<a.length;b++)for(var c=a[b].R,d=0;d<c.length;d++)if(c[d].wa)return!0;return!1};a.Fx=function(a,b){for(var c=a.K,d=0;d<c.length;d++)for(var e=c[d].R,f=0;f<e.length;f++){var h=e[f].wa;if(h&&h.name==b)return!0}return!1};a.sD=function(a){a=a.K;for(var b=0;b<a.length;b++)for(var c=a[b].R,d=0;d<c.length;d++){var e=
c[d].wa;if(e&&"EMITTER"==e.qt)return!0}return!1};a.wJ=function(a){return 0<a.particle_systems.length};a.vJ=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;return!1};a.DN=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.GN=function(a,b,c){var d=a.wa={name:b.name,qt:b.settings.type,time:0,HD:-1,ju:!1,Ar:1,sa:0,Za:0,jF:0,cx:0,XC:0,
cyclic:0,vh:0,it:0,qC:0,Nk:0,$e:0,bG:0,size:0,dA:0,cA:0,bB:0,aB:new Float32Array(16),jD:!1,positions:null,Qx:null,eF:null,Ky:null,Lr:null,Wv:null,vg:null,xD:null,hF:0,iF:0};d.sa=b.settings.frame_start;d.Za=b.settings.frame_end;d.jF=(d.Za-d.sa)/v.ad();d.cx=b.settings.lifetime;d.XC=d.cx/v.ad();d.cyclic=b.settings.b4w_cyclic?1:0;d.vh=b.settings.mass;d.it=b.settings.normal_factor;d.qC=9.81*b.settings.effector_weights.gravity;d.Nk=b.settings.b4w_fade_in/v.ad();d.$e=b.settings.b4w_fade_out/v.ad();d.bG=
b.settings.effector_weights.wind;d.ju="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var f,g,t;a.op?(f=c.halo.size,g=c.halo.hardness,30>g?(g=.5,t=.9):40>g?(g=.1,t=1):50>g?(g=0,t=.8):(g=0,t=.5)):(f=b.settings.particle_size,t=g=1);d.size=f;d.dA=g;d.cA=t;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(n.mb(a,"NODES",1),n.mb(a,"PARTICLE_BATCH",1),a.qj=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&x.cr&&(b=b[0].texture,
f=[],e.CJ(b.color_ramp,e.Sz,f),f=new Uint8Array(f.map(function(a){return h.clamp(255*a,0,255)})),f=e.hB(f,e.Sz),n.Wi(a,f,"u_color_ramp_tex",b.name),n.mb(a,"USE_COLOR_RAMP",1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(c[0]&&"STRAND"==c[0].texture_coords&&c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(f=0;f<b;f+=4)g=c[f/4],a[f]=g.position,a[f+1]=g.color[0],a[f+2]=g.color[1],a[f+3]=g.color[2];
d.bB=c.length}d.aB.set(a)};a.HM=function(a,e,f,g){var k=a.wa,r=g.v;g=f.settings.count;var t=f.settings.frame_start/v.ad(),m=f.settings.frame_end/v.ad(),n=f.settings.lifetime/v.ad(),u=f.settings.lifetime_random,p=f.settings.emit_from,w=f.settings.factor_random;if(f.settings.use_rotations)var y=f.settings.angular_velocity_mode,x=f.settings.angular_velocity_factor;else y="NONE",x=0;var z=f.settings.b4w_randomize_emission,D=f.settings.b4w_cyclic;k.hF=f.settings.billboard_tilt;k.iF=f.settings.billboard_tilt_random;
b(f.seed);var E;e=B.HB(e,["a_position","a_tbn_quat"],null);switch(p){case "VERT":var F=e.aa[0].a_position;E=e.aa[0].a_tbn_quat;f=F.length/3;e=[];for(p=0;p<g;p++){var q=Math.round((f-1)*d());e.push(q);e.push(q);e.push(q);e.push(q)}f=[];for(p=0;p<e.length;p++)f.push(F[3*e[p]]),f.push(F[3*e[p]+1]),f.push(F[3*e[p]+2]);F=new Float32Array(f);f=[];for(p=0;p<e.length;p++)f.push(E[4*e[p]]),f.push(E[4*e[p]+1]),f.push(E[4*e[p]+2]),f.push(E[4*e[p]+3]);E=new Float32Array(f);break;case "FACE":F=[];E=[];p=[];h.Ds(0,
p);f=B.ow(e,g,!1,p);h.Ds(0,p);e=B.ow(e,g,!0,p);for(p=0;p<f.length;p++)F.push(f[p][0],f[p][1],f[p][2]),F.push(f[p][0],f[p][1],f[p][2]),F.push(f[p][0],f[p][1],f[p][2]),F.push(f[p][0],f[p][1],f[p][2]),E.push(e[p][0],e[p][1],e[p][2],e[p][3]),E.push(e[p][0],e[p][1],e[p][2],e[p][3]),E.push(e[p][0],e[p][1],e[p][2],e[p][3]),E.push(e[p][0],e[p][1],e[p][2],e[p][3]);F=new Float32Array(F);E=new Float32Array(E);break;case "VOLUME":h.D("Particle emission from volume is not supported");break;default:h.D("Wrong emit from option")}E=
[F,E];F=E[0];E=E[1];k.positions=new Float32Array(F);k.eF=new Float32Array(E);k.Qx=new Float32Array(F.length);k.Ky=new Float32Array(E.length);e=[];m=(m-t)/g;for(f=0;f<g;f++)p=z?m*f+10*m*(.5-d()):m*f,D||(p+=t),e.push(p),e.push(p),e.push(p),e.push(p);t=new Float32Array(e);k.Lr=new Float32Array(t);k.Wv=new Float32Array(t);if(k.ju){k.vg=new Float32Array(8*t.length);for(z=0;z<8*t.length;z++)for(D=0;8>D;D++)k.vg[8*z+D]=r[D];c(k,F,E,r,F,E)}r=B.ef("EMITTER_PARTICLES");z=h.rg();z.a_position=F;z.a_tbn_quat=
E;r.aa[0]=z;a.tg=B.Oq;a=[];for(z=0;z<g;z++)a.push(4*z,4*z+2,4*z+1,4*z,4*z+3,4*z+2);a=new Uint16Array(a);r.ma=a;r.pa.a_p_bb_vertex=B.PB(g);r.Ha=F.length/3;a=[];u=n*u;for(z=0;z<g;z++)D=u*d(),a.push(n-D),a.push(n-D),a.push(n-D),a.push(n-D);n=r.pa;u=[];for(z=0;z<g;z++)D=Math.random(),u.push(a[4*z],t[4*z],D),u.push(a[4*z+1],t[4*z+1],D),u.push(a[4*z+2],t[4*z+2],D),u.push(a[4*z+3],t[4*z+3],D);u=new Float32Array(u);n.a_p_data=u;n=r.pa;u=[];for(a=0;a<g;a++){t=[d()-.5,d()-.5,d()-.5];l.normalize(t,t);u.push(w*
t[0]);u.push(w*t[1]);u.push(w*t[2]);switch(y){case "NONE":u.push(0);break;case "SPIN":case "VELOCITY":u.push(x);break;case "RAND":u.push(2*x*(d()-.5));break;default:h.D("Undefined velocity factor")}t=u.slice(-4);for(z=0;12>z;z++)u.push(t[z%4])}g=new Float32Array(u);n.a_p_vels=g;k.xD=new Float32Array(r.pa.a_p_data);return r};a.AQ=function(a,b,c){a=a.K;for(var d=0;d<a.length;d++)for(var e=a[d].R,f=0;f<e.length;f++){var h=e[f].wa;h&&h.name==b&&!e[f].Ff&&(h.HD=h.time,h.time=c)}};a.nP=function(a){for(var b=
a.Ha,c=a.aa[0].a_position,d=[],e=[],f=0;f<b;f++)e.push(c[3*f]),d.push(c[3*f+1]),e.push(c[3*f+2]);d=new Float32Array(d);e=new Float32Array(e);a.pa.a_lf_dist=d;a.pa.a_lf_bb_vertex=e;return a};a.set_size=function(a,b,c){a=a.K;for(var d=0;d<a.length;d++)for(var e=a[d].R,f=0;f<e.length;f++){var h=e[f].wa;h&&h.name==b&&(h.size=c)}};a.set_normal_factor=function(a,b,c){a=a.K;for(var d=0;d<a.length;d++)for(var e=a[d].R,f=0;f<e.length;f++){var h=e[f].wa;h&&h.name==b&&(h.it=c)}};a.fU=function(a,b){for(var c=
a.K,d=0;d<c.length;d++)for(var e=c[d].R,f=0;f<e.length;f++){var h=e[f].wa;if(h&&h.name==b)return h.it}return 0};a.set_factor=function(a,b,c){a=a.K;for(var d=0;d<a.length;d++)for(var e=a[d].R,f=0;f<e.length;f++){var h=e[f],g=h.wa;if(g&&g.name==b){g.Ar=c;var l=g.Lr;if(1==c)var k=l;else if(0==c)for(var k=g.Wv,p=0;p<k.length;p+=4)k[p]=1E4,k[p+1]=k[p],k[p+2]=k[p],k[p+3]=k[p];else for(var n=4/c,k=g.Wv,r=0,p=0;p<k.length;p+=4)p>=r?(k[p]=l[p],r+=n):k[p]=1E4,k[p+1]=k[p],k[p+2]=k[p],k[p+3]=k[p];h=h.da;if(h.Fb.a_p_data){g=
g.xD;for(p=0;p<g.length;p+=3)g[p+1]=k[Math.round(p/3)];B.vF(h,"a_p_data",3,g)}}}};a.$R=function(a,b,c){a=a.K;for(var d=0;d<a.length;d++)for(var e=a[d].R,f=0;f<e.length;f++){var h=e[f].wa;if(h&&h.ju)for(var g=0;g<8*h.Lr.length;g++)h.vg[8*g]=b[0],h.vg[8*g+1]=b[1],h.vg[8*g+2]=b[2],h.vg[8*g+3]=b[3],h.vg[8*g+4]=c[0],h.vg[8*g+5]=c[1],h.vg[8*g+6]=c[2],h.vg[8*g+7]=c[3]}};a.SR=function(a,b,c){for(var d=[],e=0;e<c;e++)d.push(0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1);a.pa.a_tbn_quat=new Float32Array(d);if(b.Kp){d=[];
for(e=0;e<c;e++)d.push(e,e,e,e);a.pa[b.Kp.name]=new Float32Array(d)}};a.RR=function(a){-1==u.indexOf(a)&&u.push(a)};a.xP=function(a){a=u.indexOf(a);-1!=a&&u.splice(a,1)};a.cleanup=function(){u.length=0}};b4w.module.__primitives=function(a,q){function d(a,b,c,d){for(var h=[],f=[],g=[],l=[],n=2*c/(a-1),w=2*d/(b-1),v=0;v<a;v++)for(var x=-c+v*n,H=0;H<b;H++)if(f.push(x,-d+H*w,0),l.push(0,0,0,1),g.push(v/(a-1),H/(b-1)),v&&H){var C=v*b+H,t=C-1,m=(v-1)*b+H,A=m-1;h.push(C,t,m);h.push(t,A,m)}a=e.rg();a.a_position=new Float32Array(f);a.a_tbn_quat=new Float32Array(l);l=B.ef("GRID_PLANE");l.aa[0]=a;l.pa.a_texcoord=new Float32Array(g);l.ma=new Uint32Array(h);l.Ha=f.length/3;return l}function c(a){var b=a.length;
b%4&&e.D("Wrong array");for(var c=[],d=[],k=0;k<b;k+=4){var f=a[k+1],n=a[k+2],u=a[k+3];g(a[k],d);g(f,d);g(n,d);g(u,d);c.push(k,k+1,k+2);c.push(k,k+2,k+3)}a=e.rg();a.a_position=new Float32Array(d);b=B.ef("FROM_QUADS");b.aa[0]=a;b.ma=new Uint32Array(c);b.Ha=d.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function g(a,b){b.push(a[0],a[1],a[2])}var n=q("__config"),B=q("__geometry"),e=q("__util"),v=n.H;a.LM=function(){var a=B.ef("LINE"),b=e.rg();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.aa[0]=b;a.ma=new Uint32Array(1);a.Ha=1;return a};a.XT=function(a,b){var c=d(2,2,a,b);c.name="PLANE";return c};a.WT=d;a.EM=function(a,b,c){function d(a,b){return 1==a%2&&(0==b||b==l-1)||1==b%2&&(0==a||a==g-1)?!0:!1}var h=c/=Math.pow(2,a-1),f=c,g=b+1,l=b+1;b=[];c=[];for(var n=[],w=0,q=0,D=-1,H=[],C=0;C<a;C++){for(var t=2*h/(g-1),m=2*f/(l-1),A=[],I=[],p=0,Q=0;Q<g;Q++){for(var y=-h+Q*t,Y=[],R=0;R<l;R++){var G=-f+R*m;if(y>-w&&y<w&&G>-q&&G<q)Y.push(-1),p++;else{for(var E=
null,W=0;W<H.length;W+=3)if(y==H[W]&&G==H[W+1]){E=H[W+2];break}W=null!==E?E:D+1;d(Q,R)?(Y.push(-2),p++):(null==E&&(R&&R!=l-1&&Q&&Q!=g-1?E=t:(E=C==a-1?t:2*t,A.push(y,G,W)),c.push(y,G,E),n.push(.707,0,0,.707),D++),Y.push(W));if(Q&&R)if(1==Q)if(d(Q-1,R)){if(1<R){var G=W-1,E=I[Q-1][R+1],V=E-1;b.push(V,G,W)}else E=I[Q-1][R+1],V=E-1;b.push(E,V,W)}else d(Q,R)||(G=W-1,E=I[Q-1][R],b.push(E,G,W));else if(Q==g-1){if(!d(Q,R))if(R==l-1)G=W-1,E=I[Q-1][R-1],V=I[Q-2][R],b.push(E,G,W),b.push(V,E,W);else{var G=W-1,
E=I[Q-1][R],V=E-1,K=E+1;b.push(V,G,W);b.push(E,V,W);b.push(K,E,W);2==R&&(K=I[Q-2][R-2],b.push(V,K,G))}}else 1==R?d(Q,R-1)?(G=I[Q-1][R],E=I[Q-1][R-1],b.push(G,E,W)):(G=Y[R-1],E=I[Q-1][R],V=I[Q-2][R-1],b.push(E,G,W),b.push(E,V,G)):R==l-1?d(Q,R)||(G=Y[R-1],E=I[Q-1][R-1],V=I[Q-2][R],b.push(E,G,W),b.push(V,E,W)):-1!=I[Q-1][R]&&-1!=I[Q-1][R-1]&&-1!=Y[R-1]?(G=Y[R-1],E=I[Q-1][R],V=I[Q-1][R-1],b.push(E,G,W),b.push(E,V,G),R==l-2&&d(Q,R+1)&&(K=I[Q-1][R+1],b.push(K,E,W))):R==l-2&&d(Q,R+1)&&(E=I[Q-1][R],K=I[Q-
1][R+1],b.push(K,E,W))}}I.push(Y)}H=A;w=h;q=f;h*=2;f*=2}if(2E4>w)for(a=-(2*w)/(g-1),c.push(-2E4,-2E4,a),c.push(-2E4,2E4,a),c.push(-w,-q,a),c.push(-w,q,a),c.push(2E4,-2E4,a),c.push(2E4,2E4,a),c.push(w,-q,a),c.push(w,q,a),W=D+1,b.push(W+1,W+2,W+3,W+1,W+0,W+2,W+2,W+4,W+6,W+2,W+0,W+4,W+1,W+7,W+5,W+1,W+3,W+7,W+7,W+4,W+5,W+6,W+4,W+7),Q=0;8>Q;Q++)n.push(.707,0,0,.707);a=e.rg();a.a_position=new Float32Array(c);a.a_tbn_quat=new Float32Array(n);h=B.ef("MULTIGRID_PLANE");h.aa[0]=a;h.ma=new Uint32Array(b);h.Ha=
c.length/3;v.$F&&(B.cu(h,1,!0),a.a_polyindex=B.Ur(h));return h};a.VT=function(a){var b=a.length;b%3&&e.D("Wrong array");for(var c=[],d=[],k=0;k<b;k+=3){var f=a[k+1],n=a[k+2];g(a[k],d);g(f,d);g(n,d);c.push(k,k+1,k+2)}a=e.rg();a.a_position=new Float32Array(d);b=B.ef("FROM_TRIANGLES");b.aa[0]=a;b.ma=new Uint32Array(c);b.Ha=d.length/3;return b};a.UT=c;a.IM=function(a){a=e.oS(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],a[5]);b.push(a[1],a[7],a[6],a[2]);b.push(a[0],
a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=c(b);a.name="FRUSTUM";return a};a.Gc=function(){var a=B.ef("FULLSCREEN_TRI"),b=e.rg();b.a_position=new Float32Array([0,0,1,0,0,1]);a.aa[0]=b;a.ma=new Uint32Array([0,1,2]);a.Ha=3;return a};a.JM=function(){var a=B.ef("FULLSCREEN_QUAD"),b=e.rg();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.aa[0]=b;a.ma=new Uint32Array([0,2,1,1,2,3]);a.Ha=4;return a};a.DM=function(){var a=B.ef("BILLBOARD"),b=e.rg();b.a_bb_vertex=B.PB(1);a.aa[0]=b;a.ma=new Uint32Array([0,
2,1,0,3,2]);a.Ha=4;return a};a.FM=function(){var a=B.ef("CUBEMAP_BOARD"),b=e.rg();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.aa[0]=b;a.ma=new Uint32Array([0,2,1,0,3,2]);a.Ha=4;return a};a.es=function(a,c){var d=B.ef("UV_SPHERE"),h,k,f=[],n=[],u=[];for(k=0;8>=k;k++)for(h=0;16>=h;h++){var r=h/16,v=k/8;n.push(-a*Math.cos(2*r*Math.PI)*Math.sin(v*Math.PI)+c[0],a*Math.cos(v*Math.PI)+c[1],a*Math.sin(2*r*Math.PI)*Math.sin(v*Math.PI)+c[2])}for(k=r=0;8>k;k++)for(h=0;16>h;h++){var v=b(n,17*k+h+1),
w=b(n,17*k+h),D=b(n,17*(k+1)+h),H=b(n,17*(k+1)+h+1);Math.abs(v[1])==a+c[1]?(g(v,f),g(D,f),g(H,f),u.push(r,r+1,r+2),r+=3):Math.abs(D[1])==a+c[1]?(g(v,f),g(w,f),g(D,f),u.push(r,r+1,r+2),r+=3):(g(v,f),g(w,f),g(D,f),g(H,f),u.push(r,r+1,r+2),u.push(r,r+2,r+3),r+=4)}h={};h.a_position=f;n=B.FA(u,n,f);n=B.EA(u,f,n);h.a_tbn_quat=e.gen_tbn_quats(n);d.aa[0]=h;d.ma=u;d.Ha=f.length/3;return d};a.TB=function(a){var b=B.ef("INDEX"),c=e.rg();c.a_index=new Float32Array(3*a);for(var d=new Uint16Array(3*a),g=0;g<3*
a;g++)c.a_index[g]=g,d[g]=g;b.aa[0]=c;b.ma=d;b.Ha=3*a;return b}};b4w.module.__prerender=function(a,q){function d(a,c){var d=a.Ee;d.is_visible=!1;if(d.hide)return!1;var f=c.B,g=c.type==e.Xc?f.Ss:v.ec(f.v,x);if("STATIC"==d.type&&d.Bm)var l=d.hl,k=d.il;else l=d.gb.M,k=d.gb.Wa;var B=d.Dg,H=d.De,g=h.dist(l,g);if(!(g<B?0:H==n.Mn||g<H+d.Eg*k))return!1;d.is_visible=!0;g=a.qa;if(c.type==e.eg)return c.debug_view_mode==b.DV_BOUNDINGS?g.ci:!g.ci;if(c.type==e.fg&&0==d.Jg)return!1;d.wn?(k=g.gb,B=g.jb,H=g.Je):(k=d.gb,B=d.jb,H=d.Je);if(d=!g.fj)f=f.lh,d=B,B=k.M,w.XQ(B,f,k.Wa)?
d=!0:H?(k=d.Ea,H=d.Fa,g=d.Ga,B=d.M,d=w.VL(B,f,k,H,g)):d=!1;return d?!1:!0}function c(a){var b=a.wa;if(b&&b.jD){a=a.da;g.AO(a);var c=a.Fb;g.Gq(a.Kb,"a_position",b.Qx,c.a_position.offset);g.Gq(a.Kb,"a_tbn_quat",b.Ky,c.a_tbn_quat.offset);g.cz(a)}}var b=q("__debug"),g=q("__geometry"),n=q("__obj_util"),B=q("__renderer"),e=q("__subscene"),v=q("__tsr"),w=q("__util"),h=q("__vec3"),l=[e.Db,e.Vc,e.qd,e.Wc,e.Qe,e.qe,e.Id,e.tf,e.Xc,e.Re,e.fg,e.eg,e.Wd,e.dg],x=new Float32Array(3);a.zt=function(a){if(-1<l.indexOf(a.type)){for(var b=
!1,h=a.type==e.Wc||a.type==e.qe,g=a.Qa,k=0;k<g.length;k++){for(var n=g[k],v=n.ra,w=!1,x=0;x<v.length;x++){var C=v[x],t=C.qa;if(h)for(var m=0;6>m;m++)a.B.lh=a.Po[m],C.cw[m]=d(C,a),C.cw[m]&&(w=b=!0,c(t));else C.Vb=d(C,a),C.Vb&&(w=b=!0,c(t));a.Ba&&(t.ib.Om=!0)}n.Vb=w}a.Ba=!1;switch(a.type){case e.eg:break;default:a.type==e.Db||a.type==e.Re||a.type==e.Id||a.type==e.qd||a.type==e.Wc||b?a.Vb=!0:(a.Vb&&B.clear(a),a.Vb=!1)}}else if(a.Ba){g=a.Qa;for(k=0;k<g.length;k++)for(v=g[k].ra,x=0;x<v.length;x++)C=v[x],
t=C.qa,t.ib.Om=!0;a.Ba=!1}a.yx&&e.QQ(a)}};b4w.module.__print=function(a){function q(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var d=1;d<a.length;d++)c.push(a[d]);return c}function d(){n++;var a=q(arguments,"B4W ERROR");console.error.apply(console,a)}function c(a){a in e||(e[a]=a,d([a]))}function b(a,b){c(a+"() is deprecated, use "+b+"() instead.")}var g=!1,n=0,B=0,e={};a.BQ=function(a){g=a};a.dd=function(){console.log.apply(console,arguments)};a.log=function(){if(g){var a=q(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=d;a.ja=c;a.Ze=b;a.JT=function(a,d){switch(1<d.length){case !0:c(a+"() is deprecated, use "+d.slice(0,-1).join("(), ")+"() or "+d[d.length-1]+"() instead.");break;case !1:b(a,d[0])}};a.ZL=function(){c('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){B++;var a=q(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=q(arguments,"B4W INFO");console.info.apply(console,a)};a.bM=function(){n++;
var a=q(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.cM=function(){B++;var a=q(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){g&&console.time.apply(console,arguments)};a.timeEnd=function(){g&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.wN=function(){return B};a.aN=function(){return n};a.clear_errors_warnings=function(){n=B=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,q){function d(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function c(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.strips.length;e++){var f=d.strips[e];"action"in f||(f.action=null,b("strip",f,"action"));"action_frame_start"in f||(f.action_frame_start=0,b("strip",f,"action_frame_start"));"action_frame_end"in f||(f.action_frame_end=f.frame_end-f.frame_start,b("strip",f,"action_frame_end"));"repeat"in f||(f.repeat=1,b("strip",f,"repeat"));
"use_reverse"in f||(f.use_reverse=!1,b("strip",f,"use_reverse"));"scale"in f||(f.scale=1,b("strip",f,"scale"))}}function b(a,b,c){c=c+">>"+a;c in z||(z[c]={Cy:[],VD:"undefined",type:a});z[c].Cy.push(b.name)}function g(a,b,c){c=c+">>"+a;c in z||(z[c]={Cy:[],VD:"deprecated",type:a});z[c].Cy.push(b.name)}function n(a){h.warn(a)}function B(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=x.bh(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);
e.submeshes=[];for(c=0;c<d.length;c++){var f=x.zo(d[c]);e.submeshes.push(f)}return e}var e=q("__boundings"),v=q("__curve"),w=q("__mat4"),h=q("__print"),l=q("__quat"),x=q("__util"),k=q("__vec3"),f=q("__mat3"),F=q("__logic_nodes"),u=q("__animation"),r=[5,4],z={},J=f.create(),D=l.create();a.SA=function(a){return-1!=x.SF(a,r)};a.TJ=function(a){z={};var e=a.worlds;if(0==e.length){h.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var f={name:"DEFAULT",horizon_color:new Float32Array([0,
0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};e.push(f)}for(var l=0;l<e.length;l++){f=e[l];"use_sky_blend"in f||(b("world",f,"use_sky_blend"),f.use_sky_blend=!1);"use_sky_paper"in f||(b("world",f,"use_sky_paper"),f.use_sky_paper=
!1);"use_sky_real"in f||(b("world",f,"use_sky_real"),f.use_sky_real=!1);"b4w_sky_settings"in f&&"rayleigh_brightness"in f.b4w_sky_settings||(b("world",f,"rayleigh_brightness"),f.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in f||(b("world",
f,"fog_settings"),f.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in f&&(f.fog_settings.use_custom_color=!0,f.fog_settings.color=f.b4w_fog_color),"b4w_fog_density"in f&&0<f.b4w_fog_density&&(f.fog_settings.depth=1/f.b4w_fog_density));"render_sky"in f.b4w_sky_settings||(b("world",f,"render_sky"),f.b4w_sky_settings.render_sky=!1);for(var k=f.texture_slots,r=0;r<k.length;r++){var p=k[r];"blend_type"in p||(p.blend_type=
"MIX",b("world_texture_slot",p,"blend_type"));"use_map_blend"in p||(p.use_map_blend=!1,b("world_texture_slot",p,"use_map_blend"));"use_map_horizon"in p||(p.use_map_horizon=!0,b("world_texture_slot",p,"use_map_horizon"));"use_map_zenith_up"in p||(p.use_map_zenith_up=!1,b("world_texture_slot",p,"use_map_zenith_up"));"use_rgb_to_intensity"in p||(p.use_rgb_to_intensity=!1,b("world_texture_slot",p,"use_rgb_to_intensity"));"invert"in p||(p.invert=!1,b("world_texture_slot",p,"invert"));"color"in p||(p.color=
[1,0,1],b("world_texture_slot",p,"color"));"blend_factor"in p||(p.blend_factor=0,b("world_texture_slot",p,"blend_factor"));"horizon_factor"in p||(p.horizon_factor=1,b("world_texture_slot",p,"horizon_factor"));"zenith_up_factor"in p||(p.zenith_up_factor=0,b("world_texture_slot",p,"zenith_up_factor"));"zenith_down_factor"in p||(p.zenith_down_factor=0,b("world_texture_slot",p,"zenith_down_factor"));"default_value"in p||(p.default_value=1,b("world_texture_slot",p,"default_value"))}"b4w_use_default_animation"in
f||(b("world",f,"b4w_use_default_animation"),f.b4w_use_default_animation=!1);"b4w_anim_behavior"in f||(b("world",f,"b4w_anim_behavior"),f.b4w_anim_behavior="CYCLIC")}r=a.scenes;for(l=0;l<r.length;l++)k=r[l],p=k.world,"timeline_markers"in k||(k.timeline_markers=null,b("scene",k,"timeline_markers")),"b4w_reflection_quality"in k||(k.b4w_reflection_quality="MEDIUM",b("scene",k,"b4w_reflection_quality")),"b4w_use_nla"in k||(k.b4w_use_nla=!1,b("scene",k,"b4w_use_nla")),"fps"in k||(k.fps=24,b("scene",k,
"fps")),"b4w_nla_cyclic"in k||(k.b4w_nla_cyclic=!1,b("scene",k,"b4w_nla_cyclic")),"b4w_logic_nodes"in k||(k.b4w_logic_nodes=[],b("scene",k,"b4w_logic_nodes")),"b4w_detect_collisions"in k&&(g("scene",k,"b4w_detect_collisions"),delete k.b4w_detect_collisions),"audio_doppler_speed"in k||(k.audio_doppler_speed=343.3),"audio_doppler_factor"in k||(k.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in k||(k.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",k,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in k||(k.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in k||(k.b4w_enable_bloom=!1,b("scene",k,"b4w_enable_bloom")),"b4w_enable_motion_blur"in k||(k.b4w_enable_motion_blur=!1,b("scene",k,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in k||(k.b4w_enable_color_correction=!1,b("scene",k,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in k||(k.b4w_antialiasing_quality="MEDIUM",b("scene",k,"b4w_antialiasing_quality")),
"b4w_tags"in k||(k.b4w_tags={title:"",description:""},b("scene",k,"b4w_tags")),"b4w_enable_object_selection"in k||(k.b4w_enable_object_selection="AUTO",b("scene",k,"b4w_enable_object_selection")),"b4w_enable_outlining"in k||(k.b4w_enable_outlining="AUTO",b("scene",k,"b4w_enable_outlining")),"b4w_enable_glow_materials"in k||(k.b4w_enable_glow_materials="AUTO",b("scene",k,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in k||(k.b4w_enable_anchors_visibility="AUTO",b("scene",k,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in k||(k.b4w_outline_color=[1,1,1],b("scene",k,"b4w_outline_color")),"b4w_outline_factor"in k||(k.b4w_outline_factor="b4w_glow_factor"in k?k.b4w_glow_factor:1,b("scene",k,"b4w_outline_factor")),"b4w_shadow_settings"in k||(b("scene",k,"b4w_shadow_settings"),e=p.b4w_shadow_settings,k.b4w_shadow_settings=e?e:{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,
last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0}),e=k.b4w_shadow_settings,"csm_resolution"in e||(b("scene",k,"b4w_shadow_settings.csm_resolution"),e.csm_resolution=2048),"blur_samples"in e||(b("scene",k,"b4w_shadow_settings.blur_samples"),e.blur_samples="16x"),"soft_shadows"in e||(b("scene",k,"b4w_shadow_settings.soft_shadows"),e.soft_shadows=!0),"self_shadow_polygon_offset"in e||(b("scene",k,"b4w_shadow_settings.self_shadow_polygon_offset"),e.self_shadow_polygon_offset=
1),"self_shadow_normal_offset"in e||(b("scene",k,"b4w_shadow_settings.self_shadow_normal_offset"),e.self_shadow_normal_offset=.01),"b4w_enable_csm"in e||(b("scene",k,"b4w_shadow_settings.b4w_enable_csm"),e.b4w_enable_csm=!1),"csm_num"in e||(b("scene",k,"b4w_shadow_settings.csm_num"),e.csm_num=1),"csm_first_cascade_border"in e||(b("scene",k,"b4w_shadow_settings.csm_first_cascade_border"),e.csm_first_cascade_border=10),"first_cascade_blur_radius"in e||(b("scene",k,"b4w_shadow_settings.first_cascade_blur_radius"),
e.first_cascade_blur_radius=3),"csm_last_cascade_border"in e||(b("scene",k,"b4w_shadow_settings.csm_last_cascade_border"),e.csm_last_cascade_border=100),"last_cascade_blur_radius"in e||(b("scene",k,"b4w_shadow_settings.last_cascade_blur_radius"),e.last_cascade_blur_radius=1.5),"fade_last_cascade"in e||(b("scene",k,"b4w_shadow_settings.fade_last_cascade"),e.fade_last_cascade=!0),"blend_between_cascades"in e||(b("scene",k,"b4w_shadow_settings.blend_between_cascades"),e.blend_between_cascades=!0),"b4w_ssao_settings"in
k||(b("scene",k,"b4w_ssao_settings"),e=p.b4w_ssao_settings,k.b4w_ssao_settings=e?e:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),e=k.b4w_ssao_settings,"dist_factor"in e||(b("scene",k,"b4w_ssao_settings.dist_factor"),e.dist_factor=0),"samples"in e||(b("scene",k,"b4w_ssao_settings.samples"),e.samples=16),"hemisphere"in e||(b("scene",k,"b4w_ssao_settings.hemisphere"),e.hemisphere=!1),"blur_depth"in e||(b("scene",k,"b4w_ssao_settings.blur_depth"),e.blur_depth=!1),"blur_discard_value"in
e||(b("scene",k,"b4w_ssao_settings.blur_discard_value"),e.blur_discard_value=1),"b4w_bloom_settings"in k||(b("scene",k,"b4w_bloom_settings"),e=p.b4w_bloom_settings,k.b4w_bloom_settings=e?e:{key:.2,blur:4,edge_lum:1}),"key"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.key"),k.b4w_bloom_settings.key=.2),"blur"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.blur"),k.b4w_bloom_settings.blur=4),"edge_lum"in k.b4w_bloom_settings||(b("scene",k,"b4w_bloom_settings.edge_lum"),k.b4w_bloom_settings.edge_lum=
1),"b4w_motion_blur_settings"in k||(b("scene",k,"b4w_motion_blur_settings"),e=p.b4w_motion_blur_settings,k.b4w_motion_blur_settings=e?e:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in k.b4w_motion_blur_settings||(b("scene",k,"b4w_motion_blur_settings.motion_blur_factor"),k.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in k.b4w_motion_blur_settings||(b("scene",k,"b4w_motion_blur_settings.motion_blur_decay_threshold"),k.b4w_motion_blur_settings.motion_blur_decay_threshold=
.01),"b4w_color_correction_settings"in k||(b("scene",k,"b4w_color_correction_settings"),e=p.b4w_color_correction_settings,k.b4w_color_correction_settings=e?e:{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in k||(b("scene",k,"b4w_god_rays_settings"),e=p.b4w_god_rays_settings,k.b4w_god_rays_settings=e?e:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in k.b4w_god_rays_settings||(b("scene",k,"b4w_god_rays_settings.steps_per_pass"),k.b4w_god_rays_settings.steps_per_pass=
10),"b4w_glow_settings"in k||(b("scene",k,"b4w_glow_settings"),k.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},e=k.b4w_glow_settings,"b4w_render_glow_over_blend"in p&&(e.render_glow_over_blend=p.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in p&&(e.small_glow_mask_coeff=p.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in p&&(e.large_glow_mask_coeff=p.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in
p&&(e.small_glow_mask_width=p.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in p&&(e.large_glow_mask_width=p.b4w_large_glow_mask_width)),p=k.b4w_render_shadows,"AUTO"!=p&&"OFF"!=p&&"ON"!=p&&(k.b4w_render_shadows=p?"ON":"OFF"),p=k.b4w_render_reflections,"OFF"!=p&&"ON"!=p&&(k.b4w_render_reflections=p?"ON":"OFF"),p=k.b4w_render_refractions,"AUTO"!=p&&"OFF"!=p&&"ON"!=p&&(k.b4w_render_refractions=p?"ON":"OFF"),"b4w_render_dynamic_grass"in k||(b("scene",k,"b4w_render_dynamic_grass"),k.b4w_render_dynamic_grass=
"AUTO"),k.b4w_nla_script&&g("scene",k,"b4w_nla_script"),"audio_distance_model"in k||(b("scene",k,"audio_distance_model"),k.audio_distance_model="INVERSE_CLAMPED"),"b4w_custom_prop"in k||(b("scene",k,"b4w_custom_prop"),k.b4w_custom_prop=null);k=a.meshes;for(l=0;l<k.length;l++){p=k[l];p.b4w_boundings||(b("mesh",p,"b4w_boundings"),p.b4w_boundings={},e=p.b4w_boundings,e.bb=p.b4w_bounding_box?p.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},e.bb_src=p.b4w_bounding_box_source?p.b4w_bounding_box_source:
p.b4w_bounding_box,e.bs_cen=p.b4w_bounding_sphere_center?p.b4w_bounding_sphere_center:[0,0,0],e.bc_cen=p.b4w_bounding_cylinder_center?p.b4w_bounding_cylinder_center:[0,0,0],e.be_cen=p.b4w_bounding_ellipsoid_center?p.b4w_bounding_ellipsoid_center:[0,0,0],p.b4w_bounding_ellipsoid_axes?e.be_ax=p.b4w_bounding_ellipsoid_axes:(r=e.bb,e.be_ax=[(r.max_x-r.min_x)/2,(r.max_y-r.min_y)/2,(r.max_z-r.min_z)/2]),p.b4w_rotated_bounding_box?e.rbb=p.b4w_rotated_bounding_box:(r=e.bb,e.rbb={rbb_c:[(r.max_x+r.min_x)/
2,(r.max_y+r.min_y)/2,(r.max_z+r.min_z)/2],rbb_s:[1,1,1]}),e.caxis_x=p.b4w_cov_axis_x?p.b4w_cov_axis_x:[1,0,0],e.caxis_y=p.b4w_cov_axis_y?p.b4w_cov_axis_y:[0,1,0],e.caxis_z=p.b4w_cov_axis_z?p.b4w_cov_axis_z:[0,0,1]);"is_boundings_overridden"in p||(b("mesh",p,"is_boundings_overridden"),p.is_boundings_overridden=!1);"b4w_shape_keys"in p||(p.b4w_shape_keys=[],b("mesh",p,"b4w_shape_keys"));e=!0;for(f=0;f<p.submeshes.length;f++){var u=p.submeshes[f];"boundings"in u||(e=!1,u.boundings={be_ax:p.b4w_bounding_ellipsoid_axes,
be_cen:p.b4w_bounding_ellipsoid_center,bb:{max_x:p.b4w_bounding_box.max_x,max_y:p.b4w_bounding_box.max_y,max_z:p.b4w_bounding_box.max_z,min_x:p.b4w_bounding_box.min_x,min_y:p.b4w_bounding_box.min_y,min_z:p.b4w_bounding_box.min_z}});"uv_layers"in u||(b("submesh",p,"uv_layers"),u.uv_layers=p.uv_textures);"be_ax"in u.boundings||(u.boundings.be_ax=p.b4w_bounding_ellipsoid_axes);"be_cen"in u.boundings||(u.boundings.be_cen=p.b4w_bounding_ellipsoid_center);"bb"in u.boundings||(u.boundings.bb=p.b4w_bounding_box);
"rbb"in u.boundings||(r=p.b4w_bounding_box,u.boundings.rbb={rbb_c:[(r.max_x+r.min_x)/2,(r.max_y+r.min_y)/2,(r.max_z+r.min_z)/2],rbb_s:[1,1,1]});"caxis_x"in u.boundings||(u.boundings.caxis_x=[1,0,0]);"caxis_y"in u.boundings||(u.boundings.caxis_y=[0,1,0]);"caxis_z"in u.boundings||(u.boundings.caxis_z=[0,0,1])}e||b("mesh",p,"submesh_bd");r=p;e=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"];f=null;for(u=0;u<e.length;u++)r[e[u]]&&(f?
(r[e[u]]=!1,h.warn('WARNING property "'+e[u]+'" of object "'+r.name+'" has been set to "false". Foreground property "'+f+'" already exists.')):f=e[u]);for(r=0;r<p.b4w_vertex_anim.length;r++)e=p.b4w_vertex_anim[r],"allow_nla"in e||(b('mesh["b4w_vertex_anim"]',p,"allow_nla"),e.allow_nla=!0)}r=a.cameras;for(l=0;l<r.length;l++)k=r[l],k.type||(k.type="PERSP",b("camera",k,"type")),"b4w_eye_target_dist"in k&&(delete k.b4w_eye_target_dist,g("camera",k,"b4w_eye_target_dist")),"b4w_hover_zero_level"in k||(k.b4w_hover_zero_level=
0,b("camera",k,"b4w_hover_zero_level")),"b4w_trans_velocity"in k||(k.b4w_trans_velocity=1,b("camera",k,"b4w_trans_velocity")),"b4w_rot_velocity"in k||(k.b4w_rot_velocity=1,b("camera",k,"b4w_rot_velocity")),"b4w_zoom_velocity"in k||(k.b4w_zoom_velocity=.1,b("camera",k,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in k||(k.b4w_use_target_distance_limits=k.b4w_use_distance_limits||!1,b("camera",k,"b4w_use_target_distance_limits")),"b4w_use_zooming"in k||(k.b4w_use_zooming=k.b4w_use_distance_limits||
!1,b("camera",k,"b4w_use_zooming")),"b4w_distance_min"in k||(k.b4w_distance_min=1,b("camera",k,"b4w_distance_min")),"b4w_distance_max"in k||(k.b4w_distance_max=100,b("camera",k,"b4w_distance_max")),"b4w_horizontal_translation_min"in k||(k.b4w_horizontal_translation_min=-100,b("camera",k,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in k||(k.b4w_horizontal_translation_max=100,b("camera",k,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in k||(k.b4w_vertical_translation_min=
-100,b("camera",k,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in k||(k.b4w_vertical_translation_max=100,b("camera",k,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in k||(k.b4w_use_horizontal_clamping=!1,b("camera",k,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in k||(k.b4w_rotation_left_limit=-Math.PI,b("camera",k,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in k||(k.b4w_rotation_right_limit=Math.PI,b("camera",k,"b4w_rotation_right_limit")),
"b4w_horizontal_clamping_type"in k||(k.b4w_horizontal_clamping_type="LOCAL",b("camera",k,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in k||(k.b4w_use_vertical_clamping=!1,b("camera",k,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in k||(k.b4w_rotation_down_limit=-Math.PI/2,b("camera",k,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in k||(k.b4w_rotation_up_limit=Math.PI/2,b("camera",k,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in k||(k.b4w_vertical_clamping_type=
"LOCAL",b("camera",k,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in k||(k.b4w_hover_angle_min=Math.PI/6,b("camera",k,"b4w_hover_angle_min")),"b4w_hover_angle_max"in k||(k.b4w_hover_angle_max=Math.PI/6,b("camera",k,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in k||(k.b4w_enable_hover_hor_rotation=!0,b("camera",k,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in k||(k.b4w_use_panning=!0,b("camera",k,"b4w_use_panning")),"b4w_use_pivot_limits"in k||(k.b4w_use_pivot_limits=!1,k.b4w_pivot_z_min=
0,k.b4w_pivot_z_max=10,b("camera",k,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in k||(k.b4w_dof_bokeh=!1,b("camera",k,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in k||(k.b4w_dof_bokeh_intensity=.3,b("camera",k,"b4w_dof_bokeh_intensity")),"b4w_dof_foreground_blur"in k||(k.b4w_dof_foreground_blur=!1,b("camera",k,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in k||(k.b4w_dof_front_start=0,b("camera",k,"b4w_dof_front_start")),"b4w_dof_front_end"in k||(k.b4w_dof_front_end=k.b4w_dof_front,b("camera",k,
"b4w_dof_front_end")),"b4w_dof_rear_start"in k||(k.b4w_dof_rear_start=0,b("camera",k,"b4w_dof_rear_start")),"b4w_dof_rear_end"in k||(k.b4w_dof_rear_end=k.b4w_dof_rear,b("camera",k,"b4w_dof_rear_end")),"sensor_fit"in k||(k.sensor_fit="VERTICAL",b("camera",k,"sensor_fit"));r=a.lamps;for(l=0;l<r.length;l++)k=r[l],"b4w_generate_shadows"in k||(k.b4w_generate_shadows=!1,b("lamp",k,"b4w_generate_shadows")),"b4w_dynamic_intensity"in k||(k.b4w_dynamic_intensity=!1,b("lamp",k,"b4w_dynamic_intensity")),"use_diffuse"in
k||(k.use_diffuse=!0,b("lamp",k,"use_diffuse")),"use_specular"in k||(k.use_specular=!0,b("lamp",k,"use_specular")),"clip_start"in k||(k.clip_start=.1,b("lamp",k,"clip_start")),"clip_end"in k||(k.clip_end=30,b("lamp",k,"clip_end")),"POINT"!=k.type&&"SPOT"!=k.type||"use_sphere"in k||(k.use_sphere=!1,b("lamp",k,"use_sphere"));r=a.speakers;for(l=0;l<r.length;l++)k=r[l],"b4w_behavior"in k||(k.b4w_behavior=k.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in k||(k.b4w_auto_play=!1,
b("speaker",k,"b4w_auto_play")),"b4w_enable_doppler"in k||(k.b4w_enable_doppler=!1,b("speaker",k,"b4w_enable_doppler")),"b4w_delay"in k||(k.b4w_delay=0),"b4w_delay_random"in k||(k.b4w_delay_random=0),"b4w_volume_random"in k||(k.b4w_volume_random=0),"b4w_pitch_random"in k||(k.b4w_pitch_random=0),"b4w_fade_in"in k||(k.b4w_fade_in=0),"b4w_fade_out"in k||(k.b4w_fade_out=0),"b4w_loop"in k||(k.b4w_loop=!1),"b4w_loop_start"in k||(k.b4w_loop_start=0,b("speaker",k,"b4w_loop_start")),"b4w_loop_end"in k||(k.b4w_loop_end=
0,b("speaker",k,"b4w_loop_end")),k.animation_data&&c(k.animation_data);r=a.textures;for(l=0;l<r.length;l++)k=r[l],"b4w_anisotropic_filtering"in k||(k.b4w_anisotropic_filtering="OFF",b("texture",k,"b4w_anisotropic_filtering")),"b4w_water_foam"in k||(k.b4w_water_foam=!1,b("texture",k,"b4w_water_foam")),"b4w_foam_uv_freq"in k||(k.b4w_foam_uv_freq=[1,1],b("texture",k,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in k||(k.b4w_foam_uv_magnitude=[1,1],b("texture",k,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in
k||(k.b4w_parallax_steps=5,b("material",k,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in k||(k.b4w_parallax_lod_dist=10,b("material",k,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in k||(k.b4w_shore_dist_map=!1,b("texture",k,"b4w_shore_dist_map")),"b4w_shore_boundings"in k||(k.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",k,"b4w_shore_boundings")),"b4w_max_shore_dist"in k||(k.b4w_max_shore_dist=100,b("texture",k,"b4w_max_shore_dist")),"b4w_disable_compression"in k||(k.b4w_disable_compression=
!1,b("texture",k,"b4w_disable_compression")),"b4w_source_type"in k||(k.b4w_source_type="",b("texture",k,"b4w_source_type")),"b4w_source_id"in k||(k.b4w_source_id="",b("texture",k,"b4w_source_id")),"b4w_source_size"in k||(k.b4w_source_size=1024,b("texture",k,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in k||(k.b4w_enable_canvas_mipmapping=!0,b("texture",k,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in k||(k.b4w_nla_video=!1,b("texture",k,"b4w_nla_video"));r=a.images;for(l=0;l<r.length;l++)k=
r[l],"colorspace_settings_name"in k||(k.colorspace_settings_name="sRGB",b("image",k,"colorspace_settings_name"));e=a.materials;for(l=0;l<e.length;l++){f=e[l];"ALPHA_ANTIALIASING"==f.game_settings.alpha_blend&&(f.game_settings.alpha_blend="CLIP");"use_tangent_shading"in f||(f.use_tangent_shading=!1,b("material",f,"use_tangent_shading"));"b4w_node_mat_type"in f&&g("material",f,"b4w_node_mat_type");"b4w_skydome"in f&&g("material",f,"b4w_skydome");"b4w_procedural_skydome"in f&&g("material",f,"b4w_procedural_skydome");
"b4w_lens_flares"in f||(f.b4w_lens_flares=!1,b("material",f,"b4w_lens_flares"));"LENS_FLARES"===f.name&&(f.b4w_lens_flares||h.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),f.b4w_lens_flares=!0);f.b4w_water&&("b4w_water_shore_smoothing"in f||(f.b4w_water_shore_smoothing=!1,b("material",f,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in f||(f.b4w_water_dynamic=!1,b("material",f,"b4w_water_dynamic")),"b4w_waves_height"in f||(f.b4w_waves_height=
1,b("material",f,"b4w_waves_height")),"b4w_waves_length"in f||(f.b4w_waves_length=1,b("material",f,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in f||(f.b4w_water_dst_noise_scale0=.05,b("material",f,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in f||(f.b4w_water_dst_noise_scale1=.03,b("material",f,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in f||(f.b4w_water_dst_noise_freq0=1.3,b("material",f,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in f||(f.b4w_water_dst_noise_freq1=
1,b("material",f,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in f||(f.b4w_water_dir_min_shore_fac=.4,b("material",f,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in f||(f.b4w_water_dir_freq=.5,b("material",f,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in f||(f.b4w_water_dir_noise_scale=.05,b("material",f,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in f||(f.b4w_water_dir_noise_freq=.07,b("material",f,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in
f||(f.b4w_water_dir_min_noise_fac=.5,b("material",f,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in f||(f.b4w_water_dst_min_fac=.2,b("material",f,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in f||(f.b4w_water_waves_hor_fac=5,b("material",f,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in f||(f.b4w_water_absorb_factor=6,b("material",f,"b4w_water_absorb_factor")),"b4w_water_fog_color"in f||(f.b4w_water_fog_color=[.5,.7,.7],b("material",f,"b4w_water_fog_color")),"b4w_foam_factor"in
f||(f.b4w_foam_factor=5,b("material",f,"b4w_foam_factor")),"b4w_generated_mesh"in f||(f.b4w_generated_mesh=!1,b("material",f,"b4w_generated_mesh")),"b4w_water_num_cascads"in f||(f.b4w_water_num_cascads=5,b("material",f,"b4w_water_num_cascads")),"b4w_water_subdivs"in f||(f.b4w_water_subdivs=64,b("material",f,"b4w_water_subdivs")),"b4w_water_detailed_dist"in f||(f.b4w_water_detailed_dist=1E3,b("material",f,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in f||(f.b4w_water_enable_caust=!1,b("material",
f,"b4w_water_enable_caust")),"b4w_water_caust_scale"in f||(f.b4w_water_caust_scale=.25,b("material",f,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in f||(f.b4w_water_caust_brightness=.5,b("material",f,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in f||(f.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in f||(f.b4w_dynamic_grass_color="");"diffuse_intensity"in f||(f.diffuse_intensity=1,b("material",f,"diffuse_intensity"));"b4w_use_ghost"in f||(f.b4w_use_ghost=!1);"b4w_collision_margin"in
f||(f.b4w_collision_margin=.04,b("material",f,"b4w_collision_margin"));"b4w_collision_group"in f||(f.b4w_collision_group=128,b("material",f,"b4w_collision_group"));"b4w_collision_mask"in f||(f.b4w_collision_mask=127,b("material",f,"b4w_collision_mask"));"b4w_do_not_render"in f||(f.b4w_do_not_render=!1,b("material",f,"b4w_do_not_render"));"HALO"!=f.type||"b4w_halo_sky_stars"in f||(f.b4w_halo_sky_stars=!1,b("material",f,"b4w_halo_sky_stars"));"HALO"!=f.type||"b4w_halo_stars_blend_height"in f||(f.b4w_halo_stars_blend_height=
10,b("material",f,"b4w_halo_stars_blend_height"));"HALO"!=f.type||"b4w_halo_stars_min_height"in f||(f.b4w_halo_stars_min_height=0,b("material",f,"b4w_halo_stars_min_height"));"specular_shader"in f||(f.specular_shader="COOKTORR",b("material",f,"specular_shader"));"diffuse_shader"in f||(f.diffuse_shader="LAMBERT",b("material",f,"diffuse_shader"));"roughness"in f||(f.roughness=.5,b("material",f,"roughness"));"diffuse_fresnel"in f||(f.diffuse_fresnel=.1,b("material",f,"diffuse_fresnel"));"diffuse_fresnel_factor"in
f||(f.diffuse_fresnel_factor=.5,b("material",f,"diffuse_fresnel_factor"));"specular_slope"in f||(f.specular_slope=.2,b("material",f,"specular_slope"));"specular_toon_size"in f||(f.specular_toon_size=.5,b("material",f,"specular_toon_size"));"specular_toon_smooth"in f||(f.specular_toon_smooth=.1,b("material",f,"specular_toon_smooth"));"specular_alpha"in f||(f.specular_alpha=1,b("material",f,"specular_alpha"));"b4w_wettable"in f||(f.b4w_wettable=!1,b("material",f,"b4w_wettable"));"b4w_refractive"in f||
(f.b4w_refractive=!1,b("material",f,"b4w_refractive"));"b4w_refr_bump"in f||(f.b4w_refr_bump=0,b("material",f,"b4w_refr_bump"));"b4w_shallow_water_col"in f||(f.b4w_shallow_water_col=[0,.8,.3],b("material",f,"b4w_shallow_water_col"));"b4w_shore_water_col"in f||(f.b4w_shore_water_col=[0,.9,.2],b("material",f,"b4w_shore_water_col"));"b4w_shallow_water_col_fac"in f||(f.b4w_shallow_water_col_fac=1,b("material",f,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in f||(f.b4w_shore_water_col_fac=.5,
b("material",f,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in f||(f.b4w_water_sss_strength=5.9,b("material",f,"b4w_water_sss_strength"));"b4w_water_sss_width"in f||(f.b4w_water_sss_width=.45,b("material",f,"b4w_water_sss_width"));"b4w_render_above_all"in f||(f.b4w_render_above_all=!1,b("material",f,"b4w_render_above_all"));"b4w_water_norm_uv_velocity"in f||(f.b4w_water_norm_uv_velocity=.05,b("material",f,"b4w_water_norm_uv_velocity"));"specular_ior"in f||(f.specular_ior=1,b("material",f,"specular_ior"));
"darkness"in f||(f.darkness=0,b("material",f,"darkness"));"diffuse_toon_size"in f||(f.diffuse_toon_size=0,b("material",f,"diffuse_toon_size"));"diffuse_toon_smooth"in f||(f.diffuse_toon_smooth=0,b("material",f,"diffuse_toon_smooth"));"pass_index"in f||(f.pass_index=0,b("material",f,"pass_index"));k=f.texture_slots;for(r=0;r<k.length;r++)p=k[r],"blend_type"in p||(p.blend_type="MIX",b("texture_slot",p,"blend_type"));if(f.node_tree){k=f.node_tree.nodes;for(r=0;r<k.length;r++)d(k[r]);f.node_tree.animation_data&&
c(f.node_tree.animation_data)}}p=a.node_groups;for(l=0;l<p.length;l++)for(k=p[l].node_tree.nodes,r=0;r<k.length;r++)d(k[r]);k=a.objects;for(l=0;l<k.length;l++){p=k[l];switch(p.type){case "MESH":"b4w_dynamic_geometry"in p||(p.b4w_dynamic_geometry=!1);"b4w_reflexible"in p||(p.b4w_reflexible=!1);"b4w_reflexible_only"in p||(p.b4w_reflexible_only=!1);"b4w_reflective"in p||(p.b4w_reflective=!1);"b4w_reflection_type"in p||(p.b4w_reflection_type="PLANE",b("object",p,"b4w_reflection_type"));"b4w_wind_bending"in
p||(p.b4w_wind_bending=!1,b("object",p,"b4w_wind_bending"));"b4w_wind_bending_angle"in p||(p.b4w_wind_bending_angle=10,p.b4w_wind_bending_freq=.25,b("object",p,"wind bending params"));"b4w_detail_bending_amp"in p||(p.b4w_detail_bending_amp=.1,p.b4w_branch_bending_amp=.3,b("object",p,"detail bending params"));"b4w_detail_bending_freq"in p||(p.b4w_detail_bending_freq=1,b("object",p,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in p||(p.b4w_main_bend_stiffness_col="",b("object",p,"b4w_main_bend_stiffness_col"));
"b4w_detail_bend_colors"in p||(p.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",p,"b4w_detail_bend_colors"));"b4w_caustics"in p||(p.b4w_caustics=!1);"vertex_groups"in p&&p.vertex_groups.length&&p.data&&0==p.data.vertex_groups.length&&(p.data.vertex_groups=p.vertex_groups,delete p.vertex_groups,b("object",p,"vertex_groups"));"b4w_vertex_anim"in p&&p.b4w_vertex_anim.length&&p.data&&0==p.data.b4w_vertex_anim.length&&(p.data.b4w_vertex_anim=p.b4w_vertex_anim,
delete p.b4w_vertex_anim,b("object",p,"b4w_vertex_anim"));"b4w_do_not_render"in p||(p.b4w_do_not_render=!1);"b4w_hidden_on_load"in p||(p.b4w_hidden_on_load=!1);"use_ghost"in p.game||(p.game.use_ghost=!1);"use_sleep"in p.game||(p.game.use_sleep=!1);"velocity_min"in p.game||(p.game.velocity_min=0);"velocity_max"in p.game||(p.game.velocity_max=0);"collision_group"in p.game||(p.game.collision_group=1);"collision_mask"in p.game||(p.game.collision_mask=255);r=p;e=r.game;f=e.collision_bounds_type;e.use_collision_bounds&&
"BOX"!=f&&"CYLINDER"!=f&&"CONE"!=f&&"SPHERE"!=f&&"CAPSULE"!=f&&"EMPTY"!=f&&(h.error("Wrong collision bounds type "+f+". Disable physics for object "+r.name),r.b4w_collision=!1,r.b4w_floating=!1,r.b4w_vehicle=!1,r.b4w_character=!1);"b4w_vehicle_settings"in p?p.b4w_vehicle_settings&&("steering_ratio"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.steering_ratio=10),"steering_max"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.steering_max=1),"inverse_control"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.inverse_control=
!1),"force_max"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.force_max=1500),"brake_max"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.brake_max=100),"speed_ratio"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.suspension_compression=
4.4),"suspension_stiffness"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in p.b4w_vehicle_settings||
(p.b4w_vehicle_settings.floating_factor=3),"floating_factor"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in p.b4w_vehicle_settings||(p.b4w_vehicle_settings.water_rot_damp=.9)):(p.b4w_vehicle_settings=null,b("object",p,"b4w_vehicle_settings"));"b4w_floating_settings"in p?p.b4w_floating_settings&&("floating_factor"in p.b4w_floating_settings||(p.b4w_floating_settings.floating_factor=
3),"water_lin_damp"in p.b4w_floating_settings||(p.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in p.b4w_floating_settings||(p.b4w_floating_settings.water_rot_damp=.8)):(p.b4w_floating_settings=null,b("object",p,"b4w_floating_settings"));"b4w_character_settings"in p?p.b4w_character_settings&&("walk_speed"in p.b4w_character_settings||(p.b4w_character_settings.walk_speed=4),"run_speed"in p.b4w_character_settings||(p.b4w_character_settings.run_speed=8),"step_height"in p.b4w_character_settings||
(p.b4w_character_settings.step_height=.25),"jump_strength"in p.b4w_character_settings||(p.b4w_character_settings.jump_strength=5),"waterline"in p.b4w_character_settings||(p.b4w_character_settings.waterline=0)):(p.b4w_character_settings=null,b("object",p,"b4w_character_settings"));"b4w_selectable"in p||(p.b4w_selectable=!1,b("object",p,"b4w_selectable"));"b4w_outlining"in p||(p.b4w_outlining=!1,b("object",p,"b4w_outlining"));"b4w_outline_on_select"in p||(p.b4w_outline_on_select=!1,b("object",p,"b4w_outline_on_select"));
"b4w_billboard"in p||(p.b4w_billboard=!1,b("object",p,"b4w_billboard"));"b4w_billboard_geometry"in p||(p.b4w_billboard_geometry="SPHERICAL",b("object",p,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in p||(p.b4w_pres_glob_orientation=!1,b("object",p,"b4w_pres_glob_orientation"));"b4w_outline_settings"in p||("b4w_glow_settings"in p?p.b4w_outline_settings=p.b4w_glow_settings:(p.b4w_outline_settings={},p.b4w_outline_settings.outline_duration=1,p.b4w_outline_settings.outline_period=1,p.b4w_outline_settings.outline_relapses=
0),b("object",p,"b4w_outline_settings"));"b4w_lod_transition"in p||(p.b4w_lod_transition=.01,b("object",p,"b4w_lod_transition"));"lod_levels"in p||(p.lod_levels=[],b("object",p,"lod_levels"));"b4w_animation_mixing"in p||(p.b4w_animation_mixing=!1,b("object",p,"b4w_animation_mixing"));break;case "EMPTY":"b4w_anchor"in p||(p.b4w_anchor=null,b("object",p,"b4w_anchor")),!p.b4w_anchor||"max_width"in p.b4w_anchor||(p.b4w_anchor.max_width=250)}"collision_margin"in p.game||(p.game.collision_margin=.04,b("object",
p,"collision_margin"));"b4w_anim_behavior"in p||(p.b4w_anim_behavior=p.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",p,"b4w_anim_behavior"));if(!("rotation_quaternion"in p)){r=[0,0,0,1];x.euler_to_quat(p.rotation_euler,r);var e=r,f=r[0],u=r[1],y=r[2];e[0]=r[3];e[1]=f;e[2]=u;e[3]=y;p.rotation_quaternion=r;b("object",p,"rotation_quaternion")}"webgl_do_not_batch"in p&&(p.b4w_do_not_batch=p.webgl_do_not_batch)&&g("object",p,"webgl_do_not_batch");"b4w_shadow_cast_only"in p||(p.b4w_shadow_cast_only=
!1,b("object",p,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in p||(p.b4w_correct_bounding_offset="AUTO",b("object",p,"b4w_correct_bounding_offset"));e=p.particle_systems;for(r=0;r<e.length;r++)f=e[r],u=f.settings,"use_rotation_dupli"in u||(u.use_rotation_dupli=!1,b("particle_settings",u,"use_rotation_dupli")),"use_whole_group"in u||(u.use_whole_group=!1,b("particle_settings",u,"use_whole_group")),f.transforms||(f.transforms=new Float32Array,b("particle_system",f,"transforms")),"b4w_billboard_align"in
u||(u.b4w_billboard_align="VIEW",b("particle_settings",u,"b4w_billboard_align")),"b4w_dynamic_grass"in u||(u.b4w_dynamic_grass=!1,b("object",u,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in u||(u.b4w_dynamic_grass_scale_threshold=.01,b("object",u,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in u||(u.b4w_initial_rand_rotation=!1,b("particle_settings",u,"b4w_initial_rand_rotation")),"b4w_rotation_type"in u||(u.b4w_rotation_type="Z",b("particle_settings",u,"b4w_rotation_type")),
"b4w_rand_rotation_strength"in u||(u.b4w_rand_rotation_strength=1,b("particle_settings",u,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in u||(u.b4w_hair_billboard=!1,b("particle_settings",u,"b4w_hair_billboard")),"b4w_hair_billboard_type"in u||(u.b4w_hair_billboard_type="BASIC",b("particle_settings",u,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in u||(u.b4w_hair_billboard_jitter_amp=0,b("particle_settings",u,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in
u||(u.b4w_hair_billboard_jitter_freq=0,b("particle_settings",u,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in u||(u.b4w_hair_billboard_geometry="SPHERICAL",b("particle_settings",u,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in u||(u.b4w_wind_bend_inheritance="PARENT",b("particle_settings",u,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in u||(u.b4w_shadow_inheritance="PARENT",b("particle_settings",u,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in
u||(u.b4w_reflection_inheritance="PARENT",b("particle_settings",u,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in u||(u.b4w_vcol_from_name="",b("particle_settings",u,"b4w_vcol_from_name")),"b4w_vcol_to_name"in u||(u.b4w_vcol_to_name="",b("particle_settings",u,"b4w_vcol_to_name")),"b4w_coordinate_system"in u||(u.b4w_coordinate_system="LOCAL",b("particle_settings",u,"b4w_coordinate_system")),"b4w_allow_nla"in u||(u.b4w_allow_nla=!0,b("particle_settings",u,"b4w_allow_nla")),"b4w_enable_soft_particles"in
u||(u.b4w_enable_soft_particles=!1,b("particle_settings",u,"b4w_enable_soft_particles")),"b4w_particles_softness"in u||(u.b4w_particles_softness=1,b("particle_settings",u,"b4w_particles_softness")),"billboard_tilt"in u||(u.billboard_tilt=0,b("particle_settings",u,"billboard_tilt")),"billboard_tilt_random"in u||(u.billboard_tilt_random=0,b("particle_settings",u,"billboard_tilt_random")),"use_rotations"in u||(u.use_rotations=!1,b("particle_settings",u,"use_rotations"));"constraints"in p||(p.constraints=
[],b("object",p,"constraints"));e=p.modifiers;for(r=0;r<e.length;r++){a:{f=e[r];switch(f.type){case "ARRAY":if(!("fit_type"in f)){h.error("WARNING Incomplete modifier "+String(f.type)+' for "'+p.name+'", reexport "'+a.b4w_filepath_blend+'" scene');f=!1;break a}}f=!0}f||(e.splice(r,1),r--)}"animation_data"in p||(p.animation_data={action:null,nla_tracks:[]},b("object",p,"animation_data"));p.animation_data&&("action"in p.animation_data||(p.animation_data.action=null,n("no action in animation data "+
p.name)),"nla_tracks"in p.animation_data||(p.animation_data.nla_tracks=[],n("no NLA in animation data "+p.name)),c(p.animation_data));"b4w_collision_id"in p||(p.b4w_collision_id="",b("object",p,"b4w_collision_id"));"b4w_viewport_alignment"in p||(p.b4w_viewport_alignment=null,b("object",p,"b4w_viewport_alignment"));"pinverse_tsr"in p||(p.pinverse_tsr=null,b("object",p,"pinverse_tsr"));"b4w_cluster_data"in p||(p.b4w_cluster_data={cluster_id:-1,cluster_center:null,cluster_radius:0},b("object",p,"b4w_cluster_data"));
"pass_index"in p||(p.pass_index=0,b("object",p,"pass_index"));"b4w_custom_prop"in p||(b("object",p,"b4w_custom_prop"),p.b4w_custom_prop=null);(0>p.scale[0]||0>p.scale[1]||0>p.scale[2])&&n('negative scale for object "'+p.name+'", can lead to some errors');r=p.scale;0==r[0]&&0==r[1]&&0==r[2]?r=!0:(e=Math.abs((r[1]-r[2])/r[1]),r=.005>Math.abs((r[0]-r[1])/r[0])&&.005>e);r||n("non-uniform scale for object "+p.name)}for(var v in z)l=z[v],r=v.match(/.*?(?=>>|$)/i)[0],h.warn('Property "'+String(r)+'" is '+
l.VD+' for "'+l.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.QJ=function(a,b){"num_channels"in a||(a.num_channels=1,n('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.$I=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var d=b[c].type;if("ARRAY"==d||"CURVE"==d){b=!0;break a}}b=!1}if(!b)return null;b=B(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var h=a[c];switch(h.type){case "ARRAY":for(var d=b,g=h,p=
0,r=0,n=0,u=new Float32Array(16),h=[],z=1;z<g.count;z++){g.use_constant_offset&&(p+=g.constant_offset_displace[0],r+=g.constant_offset_displace[1],n+=g.constant_offset_displace[2]);if(g.use_relative_offset)var F=d.b4w_boundings.bb,p=p+(F.max_x-F.min_x)*g.relative_offset_displace[0],r=r+(F.max_y-F.min_y)*g.relative_offset_displace[1],n=n+(F.max_z-F.min_z)*g.relative_offset_displace[2];x.nR(p,r,n,u);for(var E=F=B(d),q=u,H=f.fromMat4(q,J),H=l.fromMat3(H,D),K=0;K<E.submeshes.length;K++){var ba=E.submeshes[K];
x.Um(ba.position,q,ba.position,0);x.MD(ba.tbn_quat,H,ba.tbn_quat,0)}h.push(F)}for(z=0;z<h.length;z++)for(g=d,p=h[z],r=0;r<g.submeshes.length;r++){n=g.submeshes[r];u=p.submeshes[r];F=n.base_length;E=n.indices.length;n.base_length+=u.base_length;for(var oa in n)if("base_length"!=oa&&"boundings"!=oa)if("indices"==oa)for(n[oa]=x.uR(n[oa],u[oa]),q=E;q<n.indices.length;q++)n.indices[q]+=F;else"vertex_colors"!=oa&&(n[oa]=x.qM(n[oa],u[oa]))}break;case "CURVE":for(d=b,z=v.WK(h.object),g=new Float32Array(16),
r=z.uj?4:3,p=new Float32Array(r),r=new Float32Array(r),n=new Float32Array(3),u=new Float32Array(4),F=new Float32Array(4),E=new Float32Array(3),q=new Float32Array(3),H=new Float32Array(3),K=0;K<d.submeshes.length;K++){var X=d.submeshes[K],ba=X.position,X=X.tbn_quat,ha;a:{ha=h.deform_axis;switch(ha){case "POS_X":case "NEG_X":ha=0;break a;case "POS_Y":case "NEG_Y":ha=1;break a;case "POS_Z":case "NEG_Z":ha=2;break a;default:x.D("Wrong deform axis value "+ha)}ha=void 0}E[0]=0;E[1]=0;E[2]=0;E[ha]=1;for(var Z=
v.$Q(z),ca=0;ca<ba.length/3;ca++){H[0]=ba[3*ca];H[1]=ba[3*ca+1];H[2]=ba[3*ca+2];var da=H[ha],L=v.ZQ(z,da);v.aR(z,L,p);n[0]=p[0];n[1]=p[1];n[2]=p[2];v.YQ(z,L,r);q[0]=r[0];q[1]=0;q[2]=r[2];k.normalize(q,q);l.rotationTo(E,q,u);0>da?(p[0]=q[0],p[1]=q[1],p[2]=q[2],k.scale(p,da,p),k.add(n,p,n)):da>Z&&(p[0]=q[0],p[1]=q[1],p[2]=q[2],k.scale(p,da-Z,p),k.add(n,p,n));w.fromRotationTranslation(u,n,g);z.uj&&(l.setAxisAngle(E,p[3],F),k.transformQuat(H,F,H));H[ha]=0;k.transformMat4(H,g,H);ba[3*ca]=H[0];ba[3*ca+
1]=H[1];ba[3*ca+2]=H[2];X.length&&(D[0]=X[4*ca],D[1]=X[4*ca+1],D[2]=X[4*ca+2],D[3]=X[4*ca+3],l.multiply(D,u,D),X[4*ca]=D[0],X[4*ca+1]=D[1],X[4*ca+2]=D[2],X[4*ca+3]=D[3])}}}e.tP(b)}return b};a.MK=function(){return{name:"DEFAULT",uuid:x.nw(),use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:.8,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,
specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,
b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,texture_slots:[],pass_index:0}};a.eJ=function(a,b){function c(b,c){for(var d in b){var f=b[d],e=f[0];if(1<f.length)for(var g=1;g<
f.length;g++)e+="*"+f[g];for(g=0;g<a.length;g++)if(f=a[g],f.name==e)for(var h in c)f[h]=c[h]}}for(var d=b.b4w_logic_nodes,f=0;f<d.length;f++)for(var e=d[f],h=0;h<e.length;h++){var g=e[h],k={register1:"variable1",register2:"variable2",registerd:"variabled"},l;for(l in k)l in g&&(g[k[l]]=g[l]);for(var r in g.variables)"boolean"!=typeof g.variables[r][0]&&(g.variables[r]=[!1,g.variables[r]]);0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(g.type)&&("variable1"in g&&(g.variables.v1=[!1,g.variable1]),
"variable2"in g&&(g.variables.v2=[!1,g.variable2]),"variabled"in g&&(g.variables.vd=[!1,g.variabled]));switch(g.type){case "SELECT":for(var v=0;v<a.length;v++)k=a[v],k.name==g.object&&(k.b4w_selectable=!0);g.bools||(g.bools={});g.bools.not_wait||(g.bools.not_wait=!1);n('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":c(g.objects_paths,{b4w_selectable:!0});if(g.links instanceof Array){n('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+
'"');var k={},x=0;for(v in g.objects_paths)k[v]=g.links[x],x++;g.links=k}break;case "SELECT_PLAY":n('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');g.mute=!0;break;case "SELECT_PLAY_ANIM":n('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":g.bools||(g.bools={}),void 0===g.bools.ch&&(g.bools.ch=!1);case "HIDE":c(g.objects_paths,{b4w_do_not_batch:!0});break;case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(g.objects_paths,
{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(g.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(g.objects_paths,{b4w_do_not_batch:!0});switch(g.common_usage_names.space_type){case "WORLD":g.common_usage_names.space_type=F.jH;break;case "PARENT":g.common_usage_names.space_type=F.iH;break;case "LOCAL":g.common_usage_names.space_type=F.hH}break;case "OUTLINE":c(g.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":g.condition&&(g.common_usage_names.condition=
g.condition);if("cnd"in g.floats)g.common_usage_names.condition=g.floats.cnd;else switch(g.common_usage_names.condition){case "GEQUAL":g.common_usage_names.condition=F.Jz;break;case "LEQUAL":g.common_usage_names.condition=F.Lz;break;case "GREATER":g.common_usage_names.condition=F.Kz;break;case "LESS":g.common_usage_names.condition=F.Mz;break;case "NOTEQUAL":g.common_usage_names.condition=F.Nz;break;case "EQUAL":g.common_usage_names.condition=F.Iz}void 0!=g.number1&&(g.input1=g.number1);void 0!=g.number2&&
(g.input2=g.number2);g.bools||(g.bools={});void 0===g.bools.str&&(g.bools.str=!1,g.floats.inp1=g.input1,g.floats.inp2=g.input2);break;case "SEND_REQ":g.bools||(g.bools={});g.strings||(g.strings={});void 0===g.bools.ct&&(g.bools.ct=!1);void 0!=g.url&&(g.bools.url=!1,g.strings.url=g.url);break;case "MATH":void 0!=g.number1&&(g.input1=g.number1);void 0!=g.number2&&(g.input2=g.number2);void 0!=g.input1&&(g.floats.inp1=g.input1);void 0!=g.input2&&(g.floats.inp2=g.input2);switch(g.operation){case "DIV":g.operation=
F.PG;break;case "SUB":g.operation=F.YG;break;case "MUL":g.operation=F.UG;break;case "ADD":g.operation=F.KG;break;case "RAND":g.operation=F.VG;break;case "SIN":g.operation=F.XG;break;case "COS":g.operation=F.OG;break;case "TAN":g.operation=F.ZG;break;case "ARCSIN":g.operation=F.MG;break;case "ARCCOS":g.operation=F.LG;break;case "ARCTAN":g.operation=F.NG;break;case "LOG":g.operation=F.QG;break;case "MIN":g.operation=F.SG;break;case "MAX":g.operation=F.RG;break;case "ROUND":g.operation=F.WG;break;case "MOD":g.operation=
F.TG;break;case "ABS":g.operation=F.JG}break;case "REGSTORE":g.floats||(g.floats={});g.strings||(g.strings={});void 0!=g.number1&&(g.input1=g.number1);if(void 0!=g.input1)switch(typeof g.input1){case "number":g.floats.inp1=g.input1;g.common_usage_names.variable_type="NUMBER";break;default:g.strings.inp1=g.input1,g.common_usage_names.variable_type="STRING"}switch(g.common_usage_names.variable_type){case "NUMBER":g.common_usage_names.variable_type=F.kH;break;case "STRING":g.common_usage_names.variable_type=
F.lH}break;case "PAGEPARAM":g.bools||(g.bools={});void 0===g.bools.hsh&&(g.bools.hsh=!1);g.floats||(g.floats={});void 0===g.floats.ptp&&(g.floats.ptp=0);break;case "PLAY_ANIM":c(g.objects_paths,{b4w_do_not_batch:!0});g.bools||(g.bools={});void 0===g.bools.env&&(g.bools.env=!1);(k=g.common_usage_names.param_anim_behavior)||(k="FINISH_STOP");g.common_usage_names.param_anim_behavior=u.av(k);break;case "STOP_ANIM":g.bools||(g.bools={});void 0===g.bools.env&&(g.bools.env=!1);break;case "STRING":switch(g.common_usage_names.string_operation){case "JOIN":g.common_usage_names.string_operation=
F.eH;break;case "FIND":g.common_usage_names.string_operation=F.dH;break;case "REPLACE":g.common_usage_names.string_operation=F.fH;break;case "SPLIT":g.common_usage_names.string_operation=F.gH;break;case "COMPARE":g.common_usage_names.string_operation=F.cH}if("cnd"in g.floats)g.common_usage_names.condition=g.floats.cnd;else switch(g.common_usage_names.condition){case "GEQUAL":g.common_usage_names.condition=F.Jz;break;case "LEQUAL":g.common_usage_names.condition=F.Lz;break;case "GREATER":g.common_usage_names.condition=
F.Kz;break;case "LESS":g.common_usage_names.condition=F.Mz;break;case "NOTEQUAL":g.common_usage_names.condition=F.Nz;break;case "EQUAL":g.common_usage_names.condition=F.Iz}break;case "REDIRECT":void 0!=g.url&&(g.bools.url=!1,g.strings.url=g.url);break;case "SET_CAMERA_MOVE_STYLE":switch(g.common_usage_names.camera_move_style){case "STATIC":g.common_usage_names.camera_move_style=F.FG;break;case "TARGET":g.common_usage_names.camera_move_style=F.GG;break;case "EYE":g.common_usage_names.camera_move_style=
F.DG;break;case "HOVER":g.common_usage_names.camera_move_style=F.EG}break;case "ENTRYPOINT":g.bools||(g.bools={});void 0===g.bools.js&&(g.bools.js=!1);g.bools.js&&(g.mute=!0);break;case "JS_CALLBACK":for(l in g=g.common_usage_names.js_cb_params,g)switch(g[l]){case "OBJECT":g[l]=F.HG;break;case "VARIABLE":g[l]=F.IG}}}}};b4w.module.__scenegraph=function(a,q){function d(a,b){var c=[];y.ag(a,function(b,d,f){-1<c.indexOf(f)?y.FP(a,b,d,f,z(f)):c.push(f)});y.ha(a,function(a,d){for(var f=0;f<d.Xa.length;f++){var e=d.Xa[f];b||d.type!=G.qd&&d.type!=G.Wc&&d.type!=G.tf||(e.Ke=!0);-1<c.indexOf(e)?d.Xa[f]=z(e):c.push(e)}})}function c(a,c){y.ha(a,function(b,d){d.type==G.qz&&y.Hh(a,b,function(a,b){if(b.type==G.Ug)for(var c=0;c<b.Xa.length;c++){var d=b.Xa[c];d.Ma=E.P;d.La=E.P}});c||y.Hh(a,b,function(a,b,c){"DEPTH"==c.from&&(c.Ke=
!0)})});y.ha(a,function(c){var d={};b(a,c,d);for(var f in d){c=d[f];for(var e=c[0],g=0;g<c.length;g++)if(c[g].Ma==E.P){e=c[g];break}for(var h=c[0],g=0;g<c.length;g++)if(c[g].La==E.P){h=c[g];break}for(var k=c[0],g=0;g<c.length;g++)if(!c[g].Ke){k=c[g];break}for(g=0;g<c.length;g++)c[g].Ma=e.Ma,c[g].La=h.La,c[g].Ke=k.Ke}})}function b(a,c,d){y.Hh(a,c,function(c,f,e){e.active&&e.from==e.to&&(d[e.from]=d[e.from]||[],-1==d[e.from].indexOf(e)&&d[e.from].push(e),b(a,c,d))});y.Zj(a,c,function(a,b,c){c.active&&
(d[c.from]=d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=y.Ra(a,c);if(c.type==G.Ug)for(var f=0;f<c.Xa.length;f++){var e=c.Xa[f];d[e.from].push(e)}}function g(a){var b=[G.Ug,G.Qu,G.Tq,G.qd,G.Wc,G.On],c=y.Py(a),d=[];y.ha(c,function(a,f){for(var g=0;g<f.Xa.length;g++){var h=f.Xa[g];-1<b.indexOf(f.type)&&(h.un=!0);var k=w(d,h,n(h));h.Ya=k;f.Gh[g]=k}for(g=0;g<f.Gh.length;g++)k=f.Gh[g],v(d,k);y.Zj(c,a,function(g,h,k){if(!k.Ya){if(-1<b.indexOf(f.type))k.un=!0;else if((g=B(c,a,k.from))&&
k.active&&!k.Ya){e(d,g);k.Ya=g;return}g=w(d,k,n(k));k.Ya=g}});y.Hh(c,a,function(a,b,c){v(d,c.Ya)});y.Zj(c,a,function(a,b,c){c.Ya&&"NONE"==c.to&&v(d,c.Ya)})})}function n(a){a=W.bh(a);delete a.to;delete a.active;delete a.Ya;return JSON.stringify(a)}function B(a,b,c){var d=null;y.Hh(a,b,function(a,b,f){if(f.active&&f.from==f.to&&f.from==c&&f.Ya)return d=f.Ya,!0});y.Zj(a,b,function(a,b,f){if(f.active&&f.from==c&&f.Ya)return d=f.Ya,!0});return d}function e(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Ly===
b&&d.Wp++}}function v(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Ly===b&&d.Wp&&d.Wp--}}function w(a,b,c){if(b.tl)return e(a,b.tl.Ya),b.tl.Ya;if(b.un)return h(b);for(var d=null,f=0;f<a.length;f++){var g=a[f];if(g.id==c&&0===g.Wp){d=g;break}}if(d&&!K.IB)return d.Wp++,d.Ly;b=h(b);a.push({id:c,Wp:1,Ly:b});return b}function h(a){var b=a.Al*a.size,c=a.Bl*a.size,d=a.FF;switch(a.from){case "COLOR":return a.Ke?(d=E.Gk(a.Aj?E.Yq:E.Xq,d),E.resize(d,b,c)):(d=E.Gk(E.Vg,d),E.resize(d,b,c),E.ly(d,a.Ma,a.La)),
d;case "DEPTH":return a.Ke?(d=E.Gk(a.Aj?E.Wq:E.Vq,d),E.resize(d,b,c)):(d=E.Gk(E.ik,d),E.resize(d,b,c),E.ly(d,a.Ma,a.La)),d;case "CUBEMAP":return d=E.iB(b);case "SCREEN":case "NONE":return null;default:W.D("Wrong slink param: "+a.from)}}function l(a,b){var c=!1;y.ag(a,function(d,f,e){if(e&&(d=y.Ra(a,d),f=y.Ra(a,f),b(e,!1,d,f)))return c=!0});c||y.ha(a,function(a,c){for(var d=0;d<c.Xa.length;d++)if(b(c.Xa[d],!0,c,null))return!0})}function x(a){y.ha(a,function(b,c){if(c.type!=G.Xl){var d=c.B;y.Zj(a,b,
function(a,b,c){c.active&&c.Ya&&(I.Kt(d,c.from,c.Ya),c.from==c.to&&b.B&&I.Kt(b.B,c.from,c.Ya))});for(var f=0;f<c.Xa.length;f++){var e=c.Xa[f];e.active&&e.from==e.to&&I.Kt(d,e.from,c.Gh[f])}!d.lc&&!d.we||d.ee||(d.ee=Y.BP(d.lc,d.we))}});y.ha(a,function(b,c){if(c.type==G.Rq||c.type==G.Gu){var d=H(a,c);c.B.gp=d[0].B.ee}})}function k(a){var b=null,c=0;y.ha(a,function(a,d){if(d.type==V.pq){if(c==V.iR)return b=d,!0;c++}});return b}function f(a,b){var c=y.xh(a,b),d=G.Fc("NONE"),f=y.O(a,d),e=y.lp(a)[0];y.ag(a,
function(b,c){c==e&&y.uP(a,b,e,b,f)});var g=F(b,a);y.ag(a,function(f,e,h){if(f==c){if(g){f=G.Er();y.O(a,f);e=r("COLOR","RESOLVE",1,1,1,!0);e.Aj=!0;e.Ke=!0;var k=r("DEPTH","RESOLVE",1,1,1,!0);k.Aj=!0;k.Ke=!0;y.C(a,b,f,e);y.C(a,b,f,k);b=f}y.C(a,b,d,r(V.LQ,"u_color",h.size,h.Al,h.Bl,h.uq));return!0}});y.Nc(a,f,e,r("SCREEN","NONE",.5,.5,.5,!0))}function F(a,b){var c=!1,d=y.xh(b,a);y.Ig(b,d)&&(c=y.ph(b,d,0),d=y.yd(b,d,c,0),"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=y.Ra(b,c),c=F(d,
b)):c="RESOLVE"==d.to);return c}function u(a,b,c,d){var f=c.ea,e=b.As,g=b.Dh.Ah,h=b.Dh.xt,k=y.mn(a,y.pN(a,d),y.Sl),l=[],m=[],p=[],k=y.clone(k,function(b){var d;if(-1<oa.indexOf(b.type))m.push(b),d=b;else{d=G.oK(b);if(d.type==G.qd)for(var k=0;k<g.length;k++)if(g[k][0]==b){g[k]=[b,d];d.B.hc=b.B.hc;c.ea.push(d.B);break}if(b.type==G.Qe)for(k=0;k<g.length;k++){if(h[k][0]==b){h[k]=[b,d];d.B=g[k][1].B;break}}else-1<f.indexOf(b.B)&&(e?(I.Vs(b.B,I.re),I.Vs(d.B,I.Yd),d.$r=!0):(I.Vs(b.B,I.pc),I.Vs(d.B,I.wc)),
f.push(d.B));var n=y.xh(a,b);y.Hh(a,n,function(a,b,c){-1<oa.indexOf(b.type)&&l.push([b,d,c])});if(b.type!==G.Ug)for(k=0;k<b.Xa.length;k++)d.Xa[k].tl=b.Xa[k];b=!0;for(k=0;k<y.Yk(a,n);k++){var r=y.mh(a,n,k),r=y.Ra(a,r);-1==oa.indexOf(r.type)&&(b=!1)}b&&p.push(d)}return d},function(a){var b=z(a,!0);b.tl=a;return b});y.ag(k,function(a,b,c){y.Ra(k,a).type===G.Ug&&(c.tl=null)});for(var n=0;n<m.length;n++)y.Vf(k,y.xh(k,m[n]));y.yv(k);b=G.uL(e);n=y.O(a,b);if(K.Es)var t=G.Fc("NONE"),u=r("COLOR","u_color",
1,1,1,!0);else t=G.Mv(),u=r("COLOR","COPY",1,1,1,!0);y.O(a,t);y.C(a,d,t,u);var v=r("COLOR","u_sampler_left",1,1,1,!0);v.un=!0;v.Ma=E.P;v.La=E.P;y.C(a,t,b,v);if(!d.gc){if(K.Es)var v=G.Fc("NONE"),x=r("COLOR","u_color",1,1,1,!0);else v=G.Mv(),x=r("COLOR","COPY",1,1,1,!0);y.O(k,v);x.tl=u;var w=y.lp(k)[0],w=y.Ra(k,w);y.C(k,w,v,x)}v=r("COLOR","u_sampler_right",1,1,1,!0);d.gc&&(v.tl=u);v.Ma=E.P;v.La=E.P;y.gA(k,a,[y.lp(k)[0],n,v]);for(n=0;n<l.length;n++)y.C(a,l[n][0],l[n][1],l[n][2]);d=r("SCREEN","NONE",
0,0,0,!1);for(n=0;n<p.length;n++)y.C(a,t,p[n],d);return b}function r(a,b,c,d,f,e){return{from:a,to:b,size:c,Al:d,Bl:f,uq:e,active:!0,Ya:null,Aj:!1,Ke:!1,Ma:E.Se,La:E.Se,un:!1,FF:!1}}function z(a,b){if(b){var c=a.Ya;a.Ya=null}a.Ya&&W.D("Failed to clone slink with attached texture");var d=W.bh(a);b&&(a.Ya=c,d.Ya=c);return d}function J(a,b,c){if(b.type==c)return!0;b=C(a,b);for(var d=0;d<b.length;d++)if(J(a,b[d],c))return!0;return!1}function D(a,b,c){if(b.type==c)return!0;b=H(a,b);for(var d=0;d<b.length;d++)if(D(a,
b[d],c))return!0;return!1}function H(a,b){var c=y.xh(a,b);c==y.Pu&&W.D("Subscene not in graph");for(var d=[],f=y.Yk(a,c),e=0;e<f;e++){var g=y.mh(a,c,e);g!=c&&d.push(y.Ra(a,g))}return d}function C(a,b){var c=y.xh(a,b);c==y.Pu&&W.D("Subscene not in graph");for(var d=[],f=y.Ig(a,c),e=0;e<f;e++){var g=y.ph(a,c,e);g!=c&&d.push(y.Ra(a,g))}return d}function t(a){var b=[],c=[];l(a,function(a){a.Ya&&-1==b.indexOf(a.Ya)&&(b.push(a.Ya),c.push(a.Ya,b.length-1))});return c}function m(a,b){var c;c=""+(a.from+"\\n");
c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.uq){var d=a.Al,f=a.Bl;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(f)!=f&&(f=f.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==f?"":f)+"S")}else d=a.Al,f=a.Bl,c+=a.size*d+"x"+a.size*f;if("SCREEN"!=a.from){c+=" ";if(a.Ke)c+="RR";else{var d=a.Ma,f=a.La,e="";d==E.P?e+="L":d==E.Se&&(e+="N");f==E.P?e+="L":f==E.Se&&(e+="N");c+=e}for(d=0;d<b.length;d+=2)b[d]==a.Ya&&(c+=" "+b[d+1])}return c+")\\n"}var A=q("__batch"),I=q("__camera"),p=q("__config"),Q=q("__debug"),y=q("__graph"),
Y=q("__renderer"),R=q("__shaders"),G=q("__subscene"),E=q("__textures"),W=q("__util"),V=p.Jk,K=p.H,ba=p.$m,oa=[G.Oh,G.Xc,G.Wc,G.qe];a.bK=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.sR=l;a.RK=function(a,b,e,h){function l(c){var d=I.xc(La,!0);b.ea.push(d);d=G.Fk(c,d,!1,F,q,Aa,Ma,U,a.Ii);y.O(m,d);c==G.tf?(y.C(m,n[0],d,r("COLOR","COLOR",1,1,1,!0)),d.Xa.push(r("DEPTH","DEPTH",1,1,1,
!0))):(c=Z&&n[0].type==G.Rq?Wa:n[0],y.C(m,c,d,Ia),y.C(m,c,d,Ta));ga&&(y.C(m,ga,d,ia),y.C(m,ga,d,S));for(c=0;c<t.length;c++)y.C(m,t[c],d,v[c]);Ec&&y.C(m,Ec,d,hd);if(w.length){var f=w.length;for(c=0;c<f;c++)y.C(m,w[c],d,B[c])}if(A.length)for(c=0;c<A.length;c++)y.C(m,A[c],d,D[c]);Pb&&y.C(m,Pb,d,Oc);return d}var m=y.create(),n=[],p=[],t=[],v=[],w=[],B=[],A=[],D=[],q=a.aO,F=a.Bc,J=a.shore_smoothing,X=a.NQ,R=a.ssao,M=a.god_rays,oa=a.Dh,Y=a.cD,ha=a.sJ,N=a.motion_blur,wa=a.compositing,ma=a.antialiasing,Ma=
a.Gn,Aa=a.dG,U=a.Jc,sa=a.HO,Ha=a.PJ,Ga=a.yN,O=a.XO,pa=a.dof,Va=a.HL,Ea=a.refractions,Ca=!!h.length,Z=1<K.uc,Ta=r("COLOR","COLOR",1,1,1,!0),Ia=r("DEPTH","DEPTH",1,1,1,!0);if(Z){var Ra=z(Ia);Ta.Aj=!0;Ta.Ke=!0;Ia.Aj=!0;Ia.Ke=!0}var La=b.ea[0];if(a.yc){var ga=G.iL();y.O(m,ga);var Fa=ba.np;ga.B.width=Fa;ga.B.height=Fa;var ia=r("DEPTH","u_grass_map_depth",Fa,1,1,!1);K.Rb||(ia.Ma=E.P,ia.La=E.P);var S=r("COLOR","u_grass_map_color",Fa,1,1,!1);S.Ma=E.P;S.La=E.P}else S=ia=ga=null;if(U){I.az(La,U);for(var Da=
0;Da<U.Cg.length;Da++)for(var ab=U.csm_num,ya=0;ya<ab;ya++){var Xa=G.pL(ya,Da,U,q);y.O(m,Xa);t.push(Xa);var Fa=U.csm_resolution,ca=Xa.B;b.zE.push(ca);ca.width=Fa;ca.height=Fa;Xa.rb=!1;var zb=r("DEPTH","u_shadow_map"+(0<Da?Da:ya),Fa,1,1,!1);K.Go&&(zb.Ma=E.P,zb.La=E.P,zb.FF=!0);v.push(zb);(Q.WJ()||K.AE)&&Xa.Xa.push(r("COLOR","COLOR",Fa,1,1,!1));ga&&(y.C(m,ga,Xa,ia),y.C(m,ga,Xa,S))}}if(oa&&oa.pD&&!Ca)for(ya=0;ya<oa.pD;ya++){ca=I.Pc(I.Zc);ca.width=a.bi;ca.height=a.bi;I.jE(ca,Math.PI/2,.1,100);I.Sj(ca,
!1);var Na=G.Fk(G.Wc,ca,!1,F,q,Aa,Ma,null,a.Ii);Na.Hk=W.KM();for(Da=0;6>Da;Da++)Na.Po.push(I.GK());y.O(m,Na);var za=r("CUBEMAP","u_cube_reflection",a.bi,1,1,!1);za.Ma=E.P;za.La=E.P;D.push(za);ga&&(y.C(m,ga,Na,ia),y.C(m,ga,Na,S));if(oa.sC){var Pa=G.Fk(G.qe,ca,!1,F,q,Aa,Ma,null,a.Ii);Pa.Hk=Na.Hk;Pa.Po=Na.Po;y.O(m,Pa);var $a=r("DEPTH","DEPTH",a.bi,1,1,!1),db=r("COLOR","COLOR",a.bi,1,1,!1);y.C(m,Na,Pa,$a);y.C(m,Na,Pa,db);A.push(Pa);oa.Qv.push(Pa);ga&&(y.C(m,ga,Pa,ia),y.C(m,ga,Pa,S))}else{var vb=r("DEPTH",
"DEPTH",a.bi,1,1,!1);Na.Xa.push(vb);A.push(Na)}oa.ai.push(Na)}if(oa&&0<oa.QD.length&&!Ca)for(Da=0;Da<oa.QD.length;Da++)ca=I.xc(La,!0),ca.hc=new Float32Array(4),b.ea.push(ca),Na=G.Fk(G.qd,ca,!1,F,q,Aa,Ma,null,a.Ii),y.O(m,Na),za=r("COLOR","u_plane_reflection",1,a.Lg,a.Lg,!0),za.Ma=E.P,za.La=E.P,B.push(za),ga&&(y.C(m,ga,Na,ia),y.C(m,ga,Na,S)),oa.sC?(Pa=G.Fk(G.Qe,ca,!1,F,q,Aa,Ma,null,a.Ii),y.O(m,Pa),$a=r("DEPTH","DEPTH",1,a.Lg,a.Lg,!0),db=r("COLOR","COLOR",1,a.Lg,a.Lg,!0),db.Ma=E.Se,db.La=E.Se,y.C(m,
Na,Pa,$a),y.C(m,Na,Pa,db),oa.xt.push([Pa]),w.push(Pa),ga&&(y.C(m,ga,Pa,ia),y.C(m,ga,Pa,S))):(vb=r("DEPTH","DEPTH",1,a.Lg,a.Lg,!0),Na.Xa.push(vb),w.push(Na)),oa.Ah.push([Na]);if(Va&&U){var Fb=I.xc(La,!0);b.ea.push(Fb);var Ua=G.qL(Fb,q);y.O(m,Ua);Ua.self_shadow_normal_offset=U.self_shadow_normal_offset;for(ya=0;ya<t.length;ya++)Xa=t[ya],y.C(m,Xa,Ua,v[ya]);var Xc=r("COLOR","u_color",1,1,1,!0),eb=r("DEPTH","u_depth",1,1,1,!0);if(R){var ob=I.xc(La,!0);b.ea.push(ob);var Ya=a.cR,Sa=G.sL(ob,Aa,Ya);y.O(m,
Sa);var Ab=r("COLOR","u_ssao_mask",1,1,1,!0);y.C(m,Ua,Sa,Xc);y.C(m,Ua,Sa,eb);var Yc=I.xc(La,!0);b.ea.push(Yc);var Lb=G.tL(Yc,Ya);y.O(m,Lb);var Mb=r("COLOR","u_shadow_mask",1,1,1,!0);y.C(m,Sa,Lb,Ab);y.C(m,Ua,Lb,eb)}Z?Ua.Xa.push(r("DEPTH","DEPTH",1,1,1,!0)):Ua.Xa.push(Ia);ga&&(y.C(m,ga,Ua,ia),y.C(m,ga,Ua,S))}else Ua=null;var Wa=G.Fk(G.Db,La,!0,F,q,Aa,Ma,null,a.Ii);y.O(m,Wa);if(Z){var Gb=G.Er();y.O(m,Gb);p.push(Gb);var qb=r("COLOR","RESOLVE",1,1,1,!0);qb.Aj=!0;qb.Ke=!0;var cc=r("DEPTH","RESOLVE",1,1,
1,!0);cc.Aj=!0;cc.Ke=!0;y.C(m,Wa,Gb,qb);y.C(m,Wa,Gb,cc)}else p.push(Wa);Ua&&(Ab?y.C(m,Lb,Wa,Mb):U?y.C(m,Ua,Wa,r("COLOR","u_shadow_mask",1,1,1,!0)):W.D("Internal error"));ga&&(y.C(m,ga,Wa,ia),y.C(m,ga,Wa,S));if(w.length)for(var Pc=w.length,Da=0;Da<Pc;Da++)y.C(m,w[Da],Wa,B[Da]);if(A.length)for(Da=0;Da<A.length;Da++)y.C(m,A[Da],Wa,D[Da]);n=p;p=[];if(!Ca&&a.rK){var vc=V.enabled&&(V.pq===G.Wd||V.pq===G.dg),ca=I.xc(La,!0);vc||(ca.width=ca.height=1);b.ea.push(ca);var Tb=G.lB(ca,!1,q);y.O(m,Tb);if(a.Tg){ca=
I.xc(La,!0);vc||(ca.width=ca.height=1);b.ea.push(ca);var Xb=G.lB(ca,!0,q);y.O(m,Xb);y.C(m,Tb,Xb,r("COLOR","COLOR",1,1,1,vc));y.C(m,Tb,Xb,r("DEPTH","DEPTH",1,1,1,vc))}}else Tb=null;if(!Y.refractions&&!Ea||Ca)Pb=null;else{if(Z)Pb=Gb;else{if(K.Es)var Pb=G.Fc("NONE"),Qc=r("COLOR","u_color",1,1,1,!0);else Pb=G.Mv(),Qc=r("COLOR","COPY",1,1,1,!0);y.O(m,Pb);y.C(m,n[0],Pb,Qc)}var Oc=r("COLOR","u_refractmap",1,1,1,!0)}if(Va&&(Ea||J||X)){var wc=I.xc(La,!0);b.ea.push(wc);var Ec=G.fL(wc);y.O(m,Ec);y.C(m,Z?Gb:
Wa,Ec,r("DEPTH","u_depth",1,1,1,!0));var hd=r("COLOR","u_scene_depth",1,1,1,!0);hd.Ma=E.Se;hd.La=E.Se}else Ec=null;if(a.mp){var Fc=l(G.Vc);p.push(Fc);n=p;p=[]}if(a.hi){var oc=I.xc(La,!0);b.ea.push(oc);var dc=G.Fk(G.Id,oc,!1,F,q,Aa,Ma);y.O(m,dc);Ec&&y.C(m,Ec,dc,hd);Pb&&y.C(m,Pb,dc,Oc);ga&&(y.C(m,ga,dc,ia),y.C(m,ga,dc,S));if(w.length)for(Pc=w.length,Da=0;Da<Pc;Da++)y.C(m,w[Da],dc,B[Da]);if(A.length)for(Da=0;Da<A.length;Da++)y.C(m,A[Da],dc,D[Da]);a.mp&&y.C(m,dc,Fc,r("SCREEN","NONE",0,0,0,!0));y.C(m,
Z?Gb:Wa,dc,Z?Ra:Ia);var pb=G.Fc("X_GLOW_BLUR");pb.sb="GLOW_MASK_SMALL";pb.Zf=a.oj.small_glow_mask_width;var pc=r("COLOR","u_color",1,1,1,!0);pc.Ma=E.P;pc.La=E.P;y.O(m,pb);y.C(m,dc,pb,pc);var Hb=G.Fc("Y_GLOW_BLUR");Hb.sb="GLOW_MASK_SMALL";Hb.Zf=a.oj.small_glow_mask_width;var ib=r("COLOR","u_color",1,.5,.5,!0);ib.Ma=E.P;ib.La=E.P;y.O(m,Hb);y.C(m,pb,Hb,ib);var bb=G.Fc("X_GLOW_BLUR");bb.sb="GLOW_MASK_LARGE";bb.Zf=a.oj.large_glow_mask_width;var xc=r("COLOR","u_color",1,.5,.5,!0);xc.Ma=E.P;xc.La=E.P;y.O(m,
bb);y.C(m,Hb,bb,xc);var fb=G.Fc("Y_GLOW_BLUR");fb.sb="GLOW_MASK_LARGE";fb.Zf=a.oj.large_glow_mask_width;var Zc=r("COLOR","u_color",1,.25,.25,!0);Zc.Ma=E.P;Zc.La=E.P;y.O(m,fb);y.C(m,bb,fb,Zc);var ld=I.xc(La,!0);b.ea.push(ld);var Nb=G.gL(ld,a);y.O(m,Nb);var $c=r("COLOR","u_src_color",1,1,1,!0);if(a.mp)if(Z){var qc=G.Er();y.O(m,qc);y.C(m,Fc,qc,qb);y.C(m,Fc,qc,cc);y.C(m,qc,Nb,$c)}else y.C(m,Fc,Nb,$c);else y.C(m,Z?Gb:Wa,Nb,$c);y.C(m,a.mp?Fc:Wa,Nb,Ia);var Yb=r("COLOR","u_glow_mask_small",1,.5,.5,!0);Yb.Ma=
E.P;Yb.La=E.P;y.C(m,Hb,Nb,Yb);var Rc=r("COLOR","u_glow_mask_large",1,.25,.25,!0);Rc.Ma=E.P;Rc.La=E.P;y.C(m,fb,Nb,Rc);n=[Nb];p=[]}a.mp||(Fc=l(G.Vc),p.push(Fc),n=p,p=[]);if(K.debug_view){ca=I.xc(La,!0);b.ea.push(ca);var Ib=G.eL(ca);p.push(Ib);y.O(m,Ib);y.C(m,n[0],Ib,Ta);y.C(m,n[0],Ib,Ia);ga&&(y.C(m,ga,Ib,ia),y.C(m,ga,Ib,S));Q.dQ(Ib);n=p;p=[]}if(Z){var Ub=G.Er();y.O(m,Ub);p.push(Ub);y.C(m,n[0],Ub,qb);y.C(m,n[0],Ub,cc);n=p;p=[]}var Jb=n.slice(0);if(!Ca&&a.AI){ca=I.xc(La,!0);b.ea.push(ca);var jc=G.aL(ca);
y.O(m,jc);y.C(m,n[0],jc,Z?Ra:Ia)}if(M&&Va&&!Ca){var rc=Ga.Im,id=Ga.Sw,wb=Ga.ln,Za=n[0],gb=F?!0:!1,cb=r("DEPTH","u_input",1,1,1,!0),ec=r("COLOR","u_input",1,.25,.25,!0);ec.Ma=E.P;ec.La=E.P;var yc=rc/wb,Sc=I.xc(La,!0);b.ea.push(Sc);var kc=G.Nv(Sc,gb,rc,!0,yc,q,wb);y.O(m,kc);y.C(m,Za,kc,cb);var yc=rc/wb*.5,zc=I.xc(La,!0);b.ea.push(zc);var Qb=G.Nv(zc,gb,rc,!1,yc,q,wb);y.O(m,Qb);y.C(m,kc,Qb,ec);var yc=rc/wb*.25,Ac=I.xc(La,!0);b.ea.push(Ac);var Bc=G.Nv(Ac,gb,rc,!1,yc,q,wb);y.O(m,Bc);y.C(m,Qb,Bc,ec);var fc=
G.hL(id,q);p.push(fc);y.O(m,fc);y.C(m,Za,fc,r("COLOR","u_main",1,1,1,!0));y.C(m,Bc,fc,r("COLOR","u_god_rays",1,1,1,!0));n=p;p=[]}if(ha&&!Ca){var Za=n[0],Vb=G.jL();y.O(m,Vb);y.C(m,Za,Vb,r("COLOR","u_input",1,1,1,!0));var Zb=G.bL();y.O(m,Zb);Zb.B.width=K.Yo?2:1;Zb.B.height=K.Yo?2:1;var rb=r("COLOR","u_input",1,.25,.25,!0);rb.Ma=E.P;rb.La=E.P;var sb=r("COLOR","u_luminance",1,.25,.25,!0);sb.Ma=E.P;sb.La=E.P;y.C(m,Vb,Zb,rb);var kb=ha.key,Gc=ha.edge_lum,ad=I.xc(La,!0);b.ea.push(ad);var tb=G.kL(kb,Gc,q,
ad);y.O(m,tb);y.C(m,Za,tb,r("COLOR","u_main",1,1,1,!0));y.C(m,Vb,tb,sb);y.C(m,Zb,tb,r("COLOR","u_average_lum",1,1,1,!1));var Bb=r("COLOR","u_color",1,.25,.25,!0);Bb.Ma=E.P;Bb.La=E.P;pb=G.kB("X_BLUR");y.O(m,pb);y.C(m,tb,pb,Bb);Hb=G.kB("Y_BLUR");y.O(m,Hb);y.C(m,pb,Hb,Bb);var ub=G.cL(ha.blur);y.O(m,ub);var Hc=r("COLOR","u_bloom",1,.25,.25,!0);Hc.Ma=E.P;Hc.La=E.P;y.C(m,Hb,ub,Hc);y.C(m,Za,ub,r("COLOR","u_main",1,1,1,!0));p.push(ub);n=p;p=[]}if(pa&&Va&&!Ca){var Za=n[0],Oa=I.xc(La,!0);b.ea.push(Oa);if(e.dof_bokeh){var hb=
r("COLOR","u_color",1,1,1,!0);hb.Ma=E.P;hb.La=E.P;var xb=r("DEPTH","u_depth",1,1,1,!0),gc=r("COLOR","u_color",1,.5,.5,!0);gc.Ma=E.Se;gc.La=E.Se;Bb=r("COLOR","u_color",1,.5,.5,!0);Bb.Ma=E.Se;Bb.La=E.Se;var Ja=r("COLOR","u_blurred1",1,.5,.5,!0);Ja.Ma=E.P;Ja.La=E.P;var $b=r("COLOR","u_blurred2",1,.5,.5,!0);$b.Ma=E.P;$b.La=E.P;var Kb=Jb[0];if(e.gd){var Cb=I.xc(La,!0);b.ea.push(Cb);var jb=G.Lv(Cb,"COC_FOREGROUND");Cb.dof_distance=e.dof_distance;Cb.dof_object=e.dof_object;Cb.dof_front_start=e.dof_front_start;
Cb.dof_front_end=e.dof_front_end;Cb.dof_rear_start=e.dof_rear_start;Cb.dof_rear_end=e.dof_rear_end;Cb.dof_power=e.dof_power;Cb.dof_bokeh=e.dof_bokeh;Cb.dof_bokeh_intensity=e.dof_bokeh_intensity;Cb.gd=e.gd;Cb.dof_on=!0;y.O(m,jb);y.C(m,Za,jb,hb);y.C(m,Kb,jb,xb);var Ob=G.Fc("X_ALPHA_BLUR");y.O(m,Ob);y.C(m,jb,Ob,gc);var yb=G.Fc("Y_ALPHA_BLUR");y.O(m,yb);y.C(m,Ob,yb,Bb);var Qa=I.xc(La,!0),Rb=G.Lv(Qa,"COC_COMBINE");b.ea.push(Qa);Qa.dof_distance=e.dof_distance;Qa.dof_object=e.dof_object;Qa.dof_front_start=
e.dof_front_start;Qa.dof_front_end=e.dof_front_end;Qa.dof_rear_start=e.dof_rear_start;Qa.dof_rear_end=e.dof_rear_end;Qa.dof_power=e.dof_power;Qa.dof_bokeh=e.dof_bokeh;Qa.dof_bokeh_intensity=e.dof_bokeh_intensity;Qa.gd=e.gd;Qa.dof_on=!0;y.O(m,Rb);y.C(m,Za,Rb,hb);y.C(m,Kb,Rb,xb);y.C(m,yb,Rb,r("COLOR","u_coc_fg",1,.5,.5,!0))}else Qa=I.xc(La,!0),b.ea.push(Qa),Rb=G.Lv(Qa,"COC_ALL"),Qa.dof_distance=e.dof_distance,Qa.dof_object=e.dof_object,Qa.dof_front_start=e.dof_front_start,Qa.dof_front_end=e.dof_front_end,
Qa.dof_rear_start=e.dof_rear_start,Qa.dof_rear_end=e.dof_rear_end,Qa.dof_power=e.dof_power,Qa.dof_bokeh=e.dof_bokeh,Qa.dof_bokeh_intensity=e.dof_bokeh_intensity,Qa.gd=e.gd,Qa.dof_on=!0,y.O(m,Rb),y.C(m,Za,Rb,hb),y.C(m,Kb,Rb,xb);var Db=G.Fc("X_DOF_BLUR");Db.B.dof_bokeh_intensity=e.dof_bokeh_intensity;y.O(m,Db);y.C(m,Rb,Db,gc);var Cc=G.Fc("Y_DOF_BLUR");Cc.B.dof_bokeh_intensity=e.dof_bokeh_intensity;y.O(m,Cc);y.C(m,Db,Cc,Bb);var Ic=G.Fc("Y_DOF_BLUR");Ic.B.dof_bokeh_intensity=e.dof_bokeh_intensity;y.O(m,
Ic);y.C(m,Db,Ic,Bb);var Eb=G.mB(Oa);Oa.dof_distance=e.dof_distance;Oa.dof_object=e.dof_object;Oa.dof_front_start=e.dof_front_start;Oa.dof_front_end=e.dof_front_end;Oa.dof_rear_start=e.dof_rear_start;Oa.dof_rear_end=e.dof_rear_end;Oa.dof_power=e.dof_power;Oa.dof_bokeh=e.dof_bokeh;Oa.dof_bokeh_intensity=e.dof_bokeh_intensity;Oa.gd=e.gd;Oa.dof_on=!0;p.push(Eb);y.O(m,Eb);y.C(m,Za,Eb,r("COLOR","u_sharp",1,1,1,!0));y.C(m,Cc,Eb,Ja);y.C(m,Ic,Eb,$b)}else{var Jc=r("COLOR","u_color",1,1,1,!0);Jc.Ma=E.P;Jc.La=
E.P;var Wb=r("COLOR","u_color",1,1,1,!0);Wb.Ma=E.P;Wb.La=E.P;Db=G.Fc("X_BLUR");y.O(m,Db);y.C(m,Za,Db,Jc);var lc=G.Fc("Y_BLUR");y.O(m,lc);y.C(m,Db,lc,Wb);var mc=Jb[0],Eb=G.mB(Oa);Oa.dof_distance=e.dof_distance;Oa.dof_object=e.dof_object;Oa.dof_front_start=e.dof_front_start;Oa.dof_front_end=e.dof_front_end;Oa.dof_rear_start=e.dof_rear_start;Oa.dof_rear_end=e.dof_rear_end;Oa.dof_power=e.dof_power;Oa.dof_bokeh=e.dof_bokeh;Oa.dof_bokeh_intensity=e.dof_bokeh_intensity;Oa.gd=e.gd;Oa.dof_on=!0;p.push(Eb);
y.O(m,Eb);y.C(m,Za,Eb,r("COLOR","u_sharp",1,1,1,!0));y.C(m,lc,Eb,r("COLOR","u_blurred",1,1,1,!0));y.C(m,mc,Eb,r("DEPTH","u_depth",1,1,1,!0))}n=p;p=[]}if(a.Tg){var bd=l(G.tf);p.push(bd);n=p;p=[]}if(N&&!Ca){var Tc=n[0],sc=G.lL(sa.mb_decay_threshold,sa.mb_factor);p.push(sc);y.O(m,sc);y.C(m,Tc,sc,r("COLOR","u_mb_tex_curr",1,1,1,!0));sc.Xa.push(r("COLOR","u_mb_tex_accum",1,1,1,!0));n=p;p=[]}if(!Ca&&a.outline){var Za=n[0],ac=I.xc(La,!0);b.ea.push(ac);var Kc=G.nL(ac,q);y.O(m,Kc);var Dc=G.Fc("X_EXTEND"),
Lc=r("COLOR","u_color",1,1,1,!0),bc=r("COLOR","u_outline_mask",1,1,1,!0);Dc.sp=!0;y.O(m,Dc);y.C(m,Kc,Dc,Lc);var lb=r("COLOR","u_color",1,.5,.5,!0);lb.Ma=E.P;lb.La=E.P;var mb=G.Fc("Y_EXTEND");mb.sp=!0;y.O(m,mb);y.C(m,Dc,mb,lb);Db=G.Fc("X_BLUR");Db.sp=!0;y.O(m,Db);y.C(m,mb,Db,lb);var Uc=r("COLOR","u_color",1,.25,.25,!0);Uc.Ma=E.P;Uc.La=E.P;var Mc=r("COLOR","u_outline_mask_blurred",1,.25,.25,!0);Mc.Ma=E.P;Mc.La=E.P;lc=G.Fc("Y_BLUR");lc.sp=!0;y.O(m,lc);y.C(m,Db,lc,Uc);var tc=G.mL(O);y.O(m,tc);y.C(m,Za,
tc,r("COLOR","u_outline_src",1,1,1,!0));y.C(m,Kc,tc,bc);y.C(m,lc,tc,Mc);p.push(tc);n=p;p=[]}d(m,Va);if((a.anaglyph_use||a.As)&&!Ca){var md=u(m,a,b,n[0]);p.push(md);n=p;p=[]}if(wa&&!Ca){var Za=n[0],cd=G.dL(Ha.brightness,Ha.contrast,Ha.exposure,Ha.saturation),nc=r("COLOR","u_color",1,1,1,!0);!a.anaglyph_use&&!a.As||Ca||(nc.un=!0);y.O(m,cd);y.C(m,Za,cd,nc);p.push(cd);n=p;p=[]}if(ma){Za=n[0];if(K.smaa){var hc=r("COLOR","u_color",1,1,1,!0);hc.Ma=E.P;hc.La=E.P;var Sb=G.Ov(G.Sq,a);y.O(m,Sb);y.C(m,Za,Sb,
hc);var uc=G.Ov(G.Qn,a);y.O(m,uc);y.C(m,Sb,uc,hc);var nd=r("COLOR","u_search_tex",1,1,1,!1),ic=r("COLOR","u_area_tex",1,1,1,!1);nd.Ma=E.P;nd.La=E.P;ic.Ma=E.P;ic.La=E.P;uc.Xa.push(nd);uc.Xa.push(ic);var od=G.Ov(G.Tq,a);y.O(m,od);y.C(m,Za,od,hc);var pd=r("COLOR","u_blend",1,1,1,!0);pd.Ma=E.P;pd.La=E.P;y.C(m,uc,od,pd);p.push(od)}else{var dd=G.$K(a);y.O(m,dd);var qd=r("COLOR","u_color",1,1,1,!0);qd.Ma=E.P;qd.La=E.P;!a.anaglyph_use&&!a.As||Ca||(qd.un=!0);y.C(m,Za,dd,qd);p.push(dd)}n=p;p=[]}var xd=y.xh(m,
n[0]);if(n[0].type==G.Ug||n[0].type==G.Rq)var ed=!0;else ed=!1,y.Hh(m,xd,function(a,b,c){if(c.from==c.to)return ed=!0});if(ed){var fd=G.Fc("NONE");y.O(m,fd);y.C(m,n[0],fd,r("COLOR","u_color",1,1,1,!0));p.push(fd);n=p;p=[]}p.push(n[0]);Tb&&(Xb?p.push(Xb):p.push(Tb));jc&&p.push(jc);Fa=ba.Gr;if(a.Pt.TD){var Bd=a.Pt,td=a.Gn,yd=td.fn,Fa=yd?yd.kR:Fa,ud=G.rL(td,q,Bd,Fa);y.O(m,ud);p.push(ud)}var nb=G.nB();y.O(m,nb);for(ya=0;ya<p.length;ya++){var jd=p[ya];switch(jd.type){case G.Wd:case G.dg:y.C(m,jd,nb,r("COLOR",
"NONE",1,1,1,vc));y.C(m,jd,nb,r("DEPTH","NONE",1,1,1,vc));break;case G.gg:y.C(m,jd,nb,r("CUBEMAP","u_sky",Fa,1,1,!1));break;case G.Rl:y.C(m,jd,nb,r("COLOR","NONE",1,1,1,!0));break;default:if(Ca){var Vc=h[0],kd=r("COLOR","OFFSCREEN",1,1,1,!0);kd.Ya=Vc;y.C(m,p[ya],nb,kd);for(Da=1;Da<h.length;Da++){var vd=h[Da],rd=G.Fc("NONE");y.O(m,rd);y.C(m,p[ya],rd,r("COLOR","SCALE",1,1,1,!0));var gd=vd.Bi/Vc.Bi,kd=r("COLOR","OFFSCREEN",1,gd,gd,!0);kd.Ya=vd;y.C(m,rd,nb,kd)}}else y.C(m,p[ya],nb,r("SCREEN","NONE",1,
1,1,!0))}}Gb&&!C(m,Gb).length&&(y.Vf(m,y.xh(m,Gb)),y.yv(m));d(m,Va);c(m,Va);if(V.enabled){var zd=k(m);zd&&f(m,zd)}g(m);x(m);U&&y.ha(m,function(a,b){if(b.type==G.Re||b.type==G.Vc||b.type==G.tf){for(var c=0,d=H(m,b),f=0,e=0;e<d.length;e++){var g=d[e];g.type==G.Xc&&(f++,b.rl=b.rl||[],b.rl[0<g.Pg?g.Pg:c]=g.B.lb,c++)}b.lu&&b.ku||(K.Us?b.hz=new Float32Array(9*f):(b.lu=new Float32Array(4*f),b.ku=new Float32Array(4*f)))}});return m};a.NO=function(a,b,c){var d=[];y.ha(a,function(b,c){if(-1==oa.indexOf(c.type)&&
c.Xa.length&&J(a,c,G.uf))for(var f=0;f<c.Xa.length;f++){var e=c.Xa[f];-1==d.indexOf(e)&&d.push(e)}});y.ag(a,function(b,c,f){b=y.Ra(a,b);c=y.Ra(a,c);-1==oa.indexOf(b.type)&&J(a,c,G.uf)&&-1==d.indexOf(f)&&d.push(f)});for(var f=0;f<d.length;f++)d[f].Al*=b,d[f].Bl*=c};a.od=function(a,b,c){var d=a.Zf;a.My[0]=b*a.xb[0]*d;a.My[1]=c*a.xb[1]*d};a.Ac=function(a,b){a.Zf=b};a.QK=function(){var a=y.create(),b=G.oL(),c=I.Pc(I.Yc);c.width=512;c.height=512;b.B=c;y.O(a,b);b.Xa.push(r("COLOR","u_color",512,1,1,!1));
c=G.nB();y.O(a,c);y.C(a,b,c,r("COLOR","NONE",512,1,1,!1));g(a);x(a);return a};a.oM=function(a){var b=null;y.ha(a,function(a,c){return c.B&&null===c.B.ee?(b=c,!0):!1});return b};a.mc=function(a,b,c){a=H(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];return null};a.xw=function(a,b,c){a=H(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.mU=J;a.oU=D;a.mN=H;a.qN=C;a.dc=function(a,b){var c=null;y.ha(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.CL=function(a){var b=
"digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=t(a);y.ha(a,function(a,d){var f=b+="    ",e=G.Dy(d);if(d.B){for(var e=e+"\\n",g=0;g<c.length;g+=2){var h=d.B.lc;c[g]==h&&(e=E.Dm(h)?e+("CR"+c[g+1]+" "):e+("C"+c[g+1]+" "))}for(g=0;g<c.length;g+=2)h=d.B.we,c[g]==h&&(e=E.Dm(h)?e+("DR"+c[g+1]):e+("D"+c[g+1]))}d.Xa.length&&(e+="\\n-----\\n");for(g=0;g<d.Xa.length;g++)e+=m(d.Xa[g],c);b=f+(String(a)+' [label="'+
e+'" color="black" style="'+((d.type==G.Xl?"dotted":d.enqueue?"solid":"dashed")+",bold")+'"];\n')});y.ag(a,function(a,d,f){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+m(f,c)+'" style="'+(f.active?"solid":"dotted")+'"];\n'});return b+="}"};a.SK=function(a){a=y.mR(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b};a.Ck=function(a,b,c){var d=y.xh(a,b);y.Hh(a,d,function(a,b,d){if(d.active){switch(d.from){case "COLOR":case "CUBEMAP":var f=b.B.lc;break;case "DEPTH":f=
b.B.we;break;case "SCREEN":f=null;break;case G.Wc:return;default:W.D("Wrong slink")}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;default:f||W.D("Connection of SCREEN is forbidden"),f.pe&&W.D("Batch texture can't use renderbuffer"),R.UA(c.ib,d.to)&&A.Wi(c,f,d.to)}}});for(a=0;a<b.Xa.length;a++){var d=b.Xa[a],f=b.Gh[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;
default:f.pe&&W.D("Batch texture can't use renderbuffer"),R.UA(c.ib,d.to)&&A.Wi(c,f,d.to)}}}};b4w.module.__subscene=function(a,q){function d(a,b){a.kt=b;a.dx=new Float32Array(3*b);a.Cp=new Float32Array(4*b);a.Ap=new Float32Array(4*b)}function c(a){a={type:a,sb:"",$r:!1,yb:!1,yD:!1,dv:!1,gt:!1,Ro:0,Xe:0,Ik:[],debug_view_mode:0,debug_colors_seed:0,tB:1,aw:!1,time:0,B:null,Hk:null,Po:[],Qa:[],Xa:[],Gh:[],Ti:new Float32Array(3),hd:new Float32Array(3),ce:new Float32Array(4),Ef:new Float32Array(4),$d:new Float32Array(16),Rt:0,wg:0,kt:0,dx:null,Cp:null,Ap:null,DU:null,Md:new Float32Array(3),Vd:new Float32Array(3),
St:new Float32Array(4),YE:new Float32Array(3),Ey:new Float32Array([0,0,1]),ZE:new Float32Array(4),Qt:new Float32Array(3),Gp:0,dw:0,sp:!1,vi:new Float32Array(3),Kh:!1,uv:0,Lh:null,lz:0,mz:0,fk:0,Bc:null,og:!1,LA:0,MA:new Float32Array(2),KA:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,en:new Float32Array(3),Yt:!1,
Vt:!1,Wt:0,$t:0,Zt:0,Xt:0,nq:0,ssao_only:!1,ssao_white:!1,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,Im:0,Dt:0,ln:0,Pv:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,lu:null,ku:null,hz:null,rl:null,gc:!1,NB:"",nr:0,$l:0,mr:0,iv:0,iw:0,mb_decay_threshold:0,mb_factor:0,iD:0,yt:"",ZA:"",VN:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,My:new Float32Array(2),xb:new Float32Array(2),Kk:new Float32Array(4),
chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,Pg:0,yx:!0,DE:!1,IE:!1,EE:!1,FE:!1,HE:!1,GE:!1,CE:"",Dq:!1,Eq:!1,Fq:!1,Vb:!0,enqueue:!0,rb:!0,tb:!0,wd:!0,Ba:!0,Zf:1};a.xb[0]=1;a.xb[1]=1;a.Kk[2]=.5;a.Kk[3]=.5;a.nq=8;return a}function b(a,b){return a==b?0:a>b?1:-1}function g(a,c){return-b(a.kg,c.kg)||b(a.Sf,c.Sf)||b(a.ib.qy,c.ib.qy)}var n=q("__camera"),B=q("__config"),e=q("__util"),v=q("__boundings"),w=B.Ic;a.Db=0;a.Vc=1;a.tf=2;a.qd=3;a.Wc=4;a.Qe=5;a.qe=6;a.Id=7;a.Xc=8;a.Re=9;a.Oh=
10;a.Zb=11;a.In=12;a.Ln=13;a.Rq=14;a.Wd=15;a.dg=16;a.eg=17;a.Rl=18;a.xz=19;a.Uq=20;a.Su=21;a.qz=22;a.Qn=23;a.Sq=24;a.Qu=25;a.Tq=26;a.Fu=27;a.Ug=28;a.Eu=29;a.Kn=30;a.fg=31;a.Vl=32;a.Ul=33;a.Pq=34;a.gg=35;a.Gu=36;a.uf=37;a.LUMINANCE=38;a.hG=39;a.Qq=40;a.Hn=41;a.kI=42;a.Xl=43;a.On=44;a.pL=function(a,b,e,g){var f=c(8);f.Pv=a;f.self_shadow_polygon_offset=e.self_shadow_polygon_offset;f.Pg=b;switch(e.Cg[b]){case "SPOT":case "POINT":f.B=n.Pc(n.Zc);n.jE(f.B,e.NE[b],e.xo[b],e.wo[b]);break;default:f.B=n.Pc(n.Ph)}d(f,
g);return f};a.oK=function(a){var b=a.B;a.B=null;var c=e.S(a);a.B=b;c.B=n.xc(b,!0);return c};a.iL=function(){var a=c(10);a.B=n.Pc(n.hg);return a};a.Fc=function(a){var b=c(11);b.rb=!1;b.tb=!1;b.wd=!1;b.gc=!0;b.B=n.Pc(n.Yc);b.yt=a;switch(a){case "NONE":b.xb[0]=1;b.xb[1]=1;break;case "GRAYSCALE":b.xb[0]=1;b.xb[1]=1;break;case "X_BLUR":b.xb[0]=1;b.xb[1]=0;break;case "Y_BLUR":b.xb[0]=0;b.xb[1]=1;break;case "X_GLOW_BLUR":b.xb[0]=1;b.xb[1]=0;break;case "Y_GLOW_BLUR":b.xb[0]=0;b.xb[1]=1;break;case "X_DOF_BLUR":b.xb[0]=
1;b.xb[1]=1;break;case "Y_DOF_BLUR":b.xb[0]=1;b.xb[1]=1;break;case "X_ALPHA_BLUR":b.xb[0]=1;b.xb[1]=0;b.Zf=3;break;case "Y_ALPHA_BLUR":b.xb[0]=0;b.xb[1]=1;b.Zf=3;break;case "X_EXTEND":b.xb[0]=1;b.xb[1]=0;break;case "Y_EXTEND":b.xb[0]=0;b.xb[1]=1;break;default:e.D("Wrong postprocessing effect: "+a)}return b};a.kB=function(a){var b=c(12);b.rb=!1;b.tb=!1;b.wd=!1;b.B=n.Pc(n.Yc);b.yt=a;b.gc=!0;switch(a){case "X_BLUR":b.xb[0]=1;b.xb[1]=0;break;case "Y_BLUR":b.xb[0]=0;b.xb[1]=1;break;default:e.D("Wrong postprocessing effect for bloom blur: "+
a)}return b};a.gL=function(a,b){var d=c(13);d.rb=!1;d.tb=!1;d.wd=!1;d.small_glow_mask_coeff=b.oj.small_glow_mask_coeff;d.large_glow_mask_coeff=b.oj.large_glow_mask_coeff;d.small_glow_mask_width=b.oj.small_glow_mask_width;d.large_glow_mask_width=b.oj.large_glow_mask_width;d.B=a;d.gc=!0;return d};a.Fk=function(a,b,g,k,f,n,u,r,v){var h=c(a);0==a?(h.rb=!0,h.tb=g,h.yb=!1):1==a?(h.rb=!1,h.tb=!1,h.yb=!0):2==a?(h.rb=!1,h.tb=!0,h.yb=!0):3==a||4==a?(h.rb=!0,h.tb=!0,h.yb=!1):5==a||6==a?(h.rb=!1,h.tb=!1,h.yb=
!0):7==a?(h.rb=!0,h.tb=!1,h.yb=!0):e.D("wrong main subscene type");h.yb&&r&&(h.self_shadow_normal_offset=r.self_shadow_normal_offset);h.B=b;if(a=u.fn)h.St.set([a.zA,a.xC,a.fG,a.eG]),h.Qt.set(a.color),h.Rt=a.ya;h.Md.set(u.Md);h.Vd.set(u.Vd);h.wg=u.wg;h.ce=n.ce;h.Ef=n.Ef;k&&(h.Bc=k,k.ce&&(h.Lh=new Float32Array(k.ce)),h.lz=k.waves_height,h.mz=k.waves_length,h.fk=k.fk,k.og&&v&&(h.og=!0,h.LA=k.NJ,h.KA=k.MJ,h.MA.set(k.OJ)));d(h,f);return h};a.Er=function(){var a=c(14);a.gc=!0;a.B=n.Pc(n.Yc);return a};a.lB=
function(a,b,e){var g=c(15);b&&(g.type=16,g.rb=!1,g.tb=!0);g.enqueue=!1;g.B=a;d(g,e);return g};a.eL=function(a){var b=c(17);b.Vb=!1;b.rb=!1;b.tb=!1;b.B=a;return b};a.aL=function(a){var b=c(18);b.rb=!0;b.tb=!1;b.B=a;return b};a.qL=function(a,b){var e=c(9);e.B=a;d(e,b);return e};a.fL=function(a){var b=c(19);b.rb=!1;b.tb=!1;b.B=a;b.gc=!0;return b};a.sL=function(a,b,d){var e=c(20);e.rb=!1;e.tb=!1;e.wd=!1;e.B=a;e.ce=b.ce;e.Lh=new Float32Array(b.ce);e.$t=d.radius_increase;e.Yt=d.EN;e.Zt=d.influence;e.Xt=
d.dist_factor;e.nq=d.UP;e.gc=!0;return e};a.tL=function(a,b){var d=c(21);d.rb=!1;d.tb=!1;d.wd=!1;d.B=a;d.Vt=b.tJ;d.Wt=b.blur_discard_value;d.gc=!0;return d};a.$K=function(a){var b=c(22);b.rb=!1;b.tb=!1;b.wd=!1;b.Zf=1/a.Xm;b.NB=a.Wz;b.B=n.Pc(n.Yc);b.gc=!0;return b};a.Ov=function(a,b){var d=c(a);d.rb=23==a||24==a?!0:!1;d.tb=!1;d.wd=!1;d.Zf=1/b.Xm;d.B=n.Pc(n.Yc);23==a&&(d.WN=new Float32Array(4));d.gc=!0;return d};a.dL=function(a,b,d,e){var f=c(27);f.rb=!1;f.tb=!1;f.wd=!1;f.B=n.Pc(n.Yc);f.brightness=
a;f.contrast=b;f.exposure=d;f.saturation=e;f.gc=!0;return f};a.lL=function(a,b){var d=c(28);d.rb=!1;d.tb=!1;d.wd=!1;d.B=n.Pc(n.Yc);d.dv=!0;d.mb_decay_threshold=a;d.mb_factor=b;d.gc=!0;return d};a.Lv=function(a,b){var d=c(29);d.rb=!1;d.tb=!1;d.wd=!1;d.B=a;d.Zf=d.B.dof_power;d.ZA=b;d.gc=!0;return d};a.mB=function(a){var b=c(30);b.rb=!1;b.tb=!1;b.wd=!1;b.B=a;b.Zf=b.B.dof_power;b.gc=!0;return b};a.nL=function(a,b){var e=c(31);e.wd=!1;e.B=a;d(e,b);return e};a.mL=function(a){var b=c(32);w.outlining_overview_mode?
b.vi.set(w.vi):b.vi.set(a.vi);b.Gp=a.Gp;b.iw=5;b.iv=3;b.wd=!1;b.B=n.Pc(n.Yc);b.gc=!0;return b};a.Nv=function(a,b,e,g,f,n,u){var h=c(33);h.rb=!1;h.tb=!1;h.wd=!1;h.Md=new Float32Array([1,1,1]);h.Vd=new Float32Array([1,1,1]);h.wg=1;h.yD=g;h.Kh=b;h.Dt=f;h.Im=e;h.ln=u;h.B=a;d(h,n);return h};a.hL=function(a,b){var e=c(34);e.rb=!1;e.tb=!1;e.wd=!1;e.B=n.Pc(n.Yc);e.god_rays_intensity=a;d(e,b);e.gc=!0;return e};a.rL=function(a,b,g,k){var f=c(35);f.enqueue=!1;f.rb=!1;f.tb=!1;f.wd=!1;var h=n.Pc(n.Yc);h.width=
k;h.height=k;f.B=h;f.Hk=e.GM();d(f,b);f.Md=new Float32Array([1,1,1]);f.Vd=new Float32Array([1,1,1]);f.wg=1;f.en.set(g.en);f.procedural_skydome=g.procedural_skydome;f.use_as_environment_lighting=g.use_as_environment_lighting;f.rayleigh_brightness=g.rayleigh_brightness;f.mie_brightness=g.mie_brightness;f.spot_brightness=g.spot_brightness;f.scatter_strength=g.scatter_strength;f.rayleigh_strength=g.rayleigh_strength;f.mie_strength=g.mie_strength;f.rayleigh_collection_power=g.rayleigh_collection_power;
f.mie_collection_power=g.mie_collection_power;f.mie_distribution=g.mie_distribution;if(a){f.Md.set(a.Md);f.Vd.set(a.Vd);f.wg=a.wg;if(b=a.fn)f.St.set([b.zA,b.xC,b.fG,b.eG]),f.Qt.set(b.color),f.Rt=b.ya,f.DE=b.invert,f.IE=b.MF,f.EE=b.HF,f.FE=b.IF,f.HE=b.KF,f.GE=b.JF,f.CE=b.AA;f.Dq=a.Dq;f.Eq=a.Eq;f.Fq=a.Fq}return f};a.Mv=function(){var a=c(36);a.rb=!1;a.tb=!1;a.B=n.Pc(n.Yc);a.gc=!0;return a};a.uL=function(a){var b=c(37);b.rb=!1;b.tb=!1;b.sb=a?"HMD":"ANAGLYPH";b.B=n.Pc(n.Yc);b.gc=!0;return b};a.jL=function(){var a=
c(38);a.rb=!1;a.tb=!1;a.B=n.Pc(n.Yc);a.gc=!0;return a};a.bL=function(){var a=c(39);a.rb=!1;a.tb=!1;a.B=n.Pc(n.Yc);a.gc=!0;return a};a.kL=function(a,b,e,g){var f=c(40);f.rb=!1;f.tb=!1;f.nr=a;f.mr=b;f.B=g;d(f,e);f.gc=!0;return f};a.cL=function(a){var b=c(41);b.rb=!1;b.tb=!1;b.B=n.Pc(n.Yc);b.$l=a;b.gc=!0;return b};a.ET=function(a){var b=c(42);b.rb=!1;b.tb=!1;b.B=a;b.gc=!0;return b};a.nB=function(){var a=c(43);a.enqueue=!1;return a};a.oL=function(){var a=c(44);a.gc=!0;return a};a.Dy=function(a){switch(a.type){case 0:return"MAIN OPAQUE";
case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.yt.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";
case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";
case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.Ec=function(a,b){for(var c=b.qa,d=c.ib,f=0;f<a.Qa.length;f++){var e=a.Qa[f].ra,g=e.indexOf(b);if(-1!=g&&(e.splice(g,1),!e.length)){a.Qa.splice(f,1);break}}f=a.yb?c.Sf:0;a:{e=a.Qa;for(g=0;g<e.length;g++){var h=e[g];if(h.ib==
d&&f==h.Sf){e=h;break a}}e=null}e?e.ra.push(b):(a.Qa.push({ib:d,ra:[b],kg:c.kg,Sf:f,Vb:!0}),a.yx=!0)};a.sh=function(a,b){var c={Vb:!0,cw:[!0,!0,!0,!0,!0,!0],Ee:b,qa:a,Cs:null};if(a.Pe&&a.da.zd){var d=a.da.zd;c.Cs={IO:new Float32Array(d.length),JO:new Float32Array(d.length),LL:new Float32Array(d.length/3),gG:new Float32Array(3),nJ:v.EJ(a.U)}}return c};a.QQ=function(a){a.Qa.sort(g);a.yx=!1}};b4w.module.__texcomp=function(a,q){function d(a,b,c,d){var f=new Int32Array(c,0,31),h,k,l,B,x,q;if(542327876!=f[0])return n.error("Invalid magic number in DDS header"),0;if(!f[20]&4)return n.error("Unsupported format, must contain a FourCC code"),0;h=f[21];switch(h){case e:k=8;l=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case v:k=16;l=b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case w:k=16;l=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return n.error("Unsupported FourCC code:",g(h)),null}q=
1;f[2]&131072&&!1!==d&&(q=Math.max(1,f[7]));B=f[4];x=f[3];f=f[1]+4;if(b)for(h=0;h<q;++h)d=Math.max(4,B)/4*Math.max(4,x)/4*k,b=new Uint8Array(c,f,d),a.compressedTexImage2D(a.TEXTURE_2D,h,l,B,x,0,b),f+=d,B=Math.max(.5*B,1),x=Math.max(.5*x,1);else if(h==e){c=b=new Uint16Array(c);k=f/2;l=B;f=new Uint16Array(4);b=new Uint16Array(l*x);for(var H,C,t,m,A,I,p=l/4,Q=x/4,y=0;y<Q;y++)for(var Y=0;Y<p;Y++)h=k+4*(y*p+Y),f[0]=c[h],f[1]=c[h+1],H=f[0]&31,C=f[0]&2016,t=f[0]&63488,m=f[1]&31,A=f[1]&2016,I=f[1]&63488,
f[2]=5*H+3*m>>3|5*C+3*A>>3&2016|5*t+3*I>>3&63488,f[3]=5*m+3*H>>3|5*A+3*C>>3&2016|5*I+3*t>>3&63488,H=c[h+2],C=4*y*l+4*Y,b[C]=f[H&3],b[C+1]=f[H>>2&3],b[C+2]=f[H>>4&3],b[C+3]=f[H>>6&3],C+=l,b[C]=f[H>>8&3],b[C+1]=f[H>>10&3],b[C+2]=f[H>>12&3],b[C+3]=f[H>>14],H=c[h+3],C+=l,b[C]=f[H&3],b[C+1]=f[H>>2&3],b[C+2]=f[H>>4&3],b[C+3]=f[H>>6&3],C+=l,b[C]=f[H>>8&3],b[C+1]=f[H>>10&3],b[C+2]=f[H>>12&3],b[C+3]=f[H>>14];a.texImage2D(a.TEXTURE_2D,0,a.RGB,B,x,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,b);d&&a.generateMipmap(a.TEXTURE_2D)}else return n.error("No manual decoder for",
g(h),"and no native support"),0;return q}function c(a,b,c,e,f){var g=new XMLHttpRequest;g.open("GET",c,!0);g.responseType="arraybuffer";g.onload=function(){if(200==g.status){a.bindTexture(a.TEXTURE_2D,e);var c=d(a,b,g.response,!0);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<c?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}f&&f(e)};g.send(null)}function b(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}
function g(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var n=q("__print"),B=q("__util"),e=b("DXT1"),v=b("DXT3"),w=b("DXT5");a.cS=d;a.dS=function(a,b,c){var d=new Uint32Array(c,0,13);if(55727696==d[0]){var f=d[7],e=d[6],g=d[11],h=52+d[12];switch(d[2]){case 0:var l=2,n=1;break;case 1:l=2;n=3;break;case 2:l=4;n=0;break;case 3:l=4;n=2;break;default:B.D("Unsupported PVR V3 format.")}}else if(559044176==d[11]){f=d[2];e=d[1];g=d[3];h=d[0];g++;var v=d[4]&255,d=0<d[10];25==v?(l=4,n=d?
2:0):24==v?(l=2,n=d?3:1):B.D("Unsupported PVR V2 format.")}else B.D("Unsupported PVR version.");v=2==l?8:4;d=4;switch(n){case 0:var w=b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:w=b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:w=b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:w=b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=v*d*l/8;for(l=0;l<g;l++){var n=Math.max(f>>l,1),x=Math.max(e>>l,1),t=n/v,m=x/d;2>t&&(t=2);2>m&&(m=2);t=t*m*b;m=new Uint8Array(c,h,t);a.compressedTexImage2D(a.TEXTURE_2D,l,w,n,x,0,m);
h+=t}};a.pC=function(a,b){switch(b){case "dds":var c=new Int32Array(a,0,31);return{width:c[4],height:c[3]};case "pvr":c=new Uint32Array(a,0,13);if(55727696==c[0])var d=c[7],c=c[6];else d=c[2],c=c[1];return{width:d,height:c}}};a.WM=function(a,b){var c=1;if("dds"==b){var d=new Int32Array(a,0,31),f=d[21];switch(f){case e:c=6;break;case v:case w:c=4;break;default:n.error("Unsupported FourCC code:",g(f))}}else if("pvr"==b)if(d=new Uint32Array(a,0,13),55727696==d[0])switch(d[2]){case 0:c=12;break;case 1:c=
16;break;case 2:c=6;break;case 3:c=8}else f=d[4]&255,d=0<d[10],25==f?c=d?8:6:24==f&&(c=d?16:12);return c};a.EU=function(a,b,d,e){var f=a.createTexture();c(a,b,d,f,e);return f}};b4w.module.__textures=function(a,q){function d(){ta||(ta=M.createFramebuffer());return ta}function c(){ra||(ra=M.createTexture());return ra}function b(){return{type:0,source:"",jq:"",width:0,height:0,Io:1,anisotropic_filtering:"",Bi:1024,hj:!1,Af:null,qb:0,Cb:null,pe:null,li:!1,Jq:-1,Ta:null,qu:"",zj:0,zg:0,sa:0,Mb:0,jj:0,Of:!1,Ng:1,ed:null,bq:0,aq:0,Ai:-1,fq:!1,Rj:-1,Hq:!1,ez:!1,Ni:!1,ck:!1,repeat:!0,rj:"",ym:"",zm:"",Ow:"",Nw:"",Vk:""}}function g(a,b,c){a.zm=b.uuid;a.ym=b.filepath;a.Ow=b.source;
a.Nw=b.name;a.rj=da.yh(c+b.filepath);a.Vk=b.jg;-1==qa.indexOf(a)&&qa.push(a)}function n(a,b,c){var d=-1<b.indexOf(".pvr");a.Vk=-1<b.indexOf(".dds")?"dds":d?"pvr":"";a.ym=b;a.rj=c;qa.push(a)}function B(c,d){var e=b();e.type=c;e.source="NONE";if(c==a.Xq||c==a.Vq||c==a.Yq||c==a.Wq)e.pe=M.createRenderbuffer();else{var f=M.TEXTURE_2D,g=M.createTexture();M.bindTexture(f,g);M.texParameteri(f,M.TEXTURE_MAG_FILTER,M.LINEAR);M.texParameteri(f,M.TEXTURE_MIN_FILTER,M.LINEAR);M.texParameteri(f,M.TEXTURE_WRAP_S,
M.CLAMP_TO_EDGE);M.texParameteri(f,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE);var h=r(e),k=z(e),m=D(e);M.texImage2D(f,0,k,1,1,0,h,m,c==a.ik?null:new Uint8Array([204,204,204,255]));T.Go&&d&&M.texParameterf(f,M.TEXTURE_COMPARE_MODE,M.COMPARE_REF_TO_TEXTURE);M.bindTexture(f,null);e.qb=f;e.Cb=g}return e}function e(a){var b=a.qb;M.bindTexture(b,a.Cb);var c=r(a),d=z(a),e=D(a),f=a.Af.canvas;M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!0);M.texImage2D(b,0,d,c,e,f);M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!1);a.hj&&M.generateMipmap(b);
M.bindTexture(b,null);a.width=f.width;a.height=f.height}function v(a){var b=a.qb;M.bindTexture(b,a.Cb);M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!0);4!=a.Ta.length?a.Of?l(a,a.Ta,a.width*a.Ng,a.height*a.Ng,!1):M.texImage2D(b,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,a.Ta):M.texImage2D(b,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,a.Ta);M.bindTexture(b,null)}function w(a){var b=a.qb;M.bindTexture(b,a.Cb);M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!0);a.Of?l(a,a.ed[a.Ai],a.width*a.Ng,a.height*a.Ng,!1):M.texImage2D(b,0,M.RGBA,M.RGBA,
M.UNSIGNED_BYTE,a.ed[a.Ai]);M.bindTexture(b,null)}function h(){Ba||(Ba=document.createElement("canvas"));return Ba}function l(a,b,f,e,g){g||(k(M.TEXTURE_2D),M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,b));M.bindTexture(M.TEXTURE_2D,null);b=d();g=c();L.PL(a,f,e,b,g)}function x(a,b,c){for(var d=0;6>d;d++){var f=na[d],e=xa[d],g=h();g.width=c;g.height=c;var k=g.getContext("2d");"TEXTURE_CUBE_MAP_POSITIVE_Y"==f||"TEXTURE_CUBE_MAP_NEGATIVE_Y"==f?(k.translate(0,c),k.scale(1,-1)):(k.translate(c,
0),k.scale(-1,1));k.drawImage(a,e[0]*b,e[1]*b,b,b,0,0,c,c);M.texImage2D(M[f],0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,g)}}function k(a){M.bindTexture(a,null);var b=c();M.bindTexture(a,b);M.texParameteri(a,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE);M.texParameteri(a,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE);M.texParameteri(a,M.TEXTURE_MAG_FILTER,M.LINEAR);M.texParameteri(a,M.TEXTURE_MIN_FILTER,M.LINEAR)}function f(a,b,f){var e=a.source,g=a.Cb,m=a.qb,p=a.Vk,n=a.ym,t;M.bindTexture(m,g);a.repeat?(M.texParameteri(m,M.TEXTURE_WRAP_S,
M.REPEAT),M.texParameteri(m,M.TEXTURE_WRAP_T,M.REPEAT)):(M.texParameteri(m,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE),M.texParameteri(m,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE));a.li||"NODE_TEX"==e?M.texParameteri(m,M.TEXTURE_MIN_FILTER,M.LINEAR):M.texParameteri(m,M.TEXTURE_MIN_FILTER,ua[T.El]);a.anisotropic_filtering&&M.texParameterf(m,ha.qw().TEXTURE_MAX_ANISOTROPY_EXT,a.anisotropic_filtering);4==b.length&&(t=!0,b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]]));if("IMAGE"==e)if(t)M.texImage2D(m,0,M.RGBA,
1,1,0,M.RGBA,M.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(p){t=oa.pC(b,p);f=da.vo(t.width)||da.vo(t.height);if(t.width>ka.tc||t.height>ka.tc){Z.error('Image "'+n+'" has unsupported size: '+t.width+"x"+t.height+". Max available: "+ka.tc+"x"+ka.tc+".");return}e=t.width;t=t.height;if(f||"pvr"==p)a.Of=!0,k(m),e=u(e*a.Ng),t=u(t*a.Ng);"dds"==p?oa.cS(M,ha.jC(),b,!0):"pvr"==p&&oa.dS(M,ha.iC(),b);a.Of&&(l(a,null,e,t,!0),M.bindTexture(m,g),M.generateMipmap(m));a.width=e;a.height=t;a.Io=oa.WM(b,p)}else{M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,
!0);a.li?T.cq?(e=b[0].width,t=b[0].height):(e=b.videoWidth,t=b.videoHeight):(e=b.width,t=b.height);a.width=e;a.height=t;if(e>ka.tc||t>ka.tc)Z.warn('Image "'+n+'" has unsupported size: '+e+"x"+t+". Max available: "+ka.tc+"x"+ka.tc+". Reduced image size will be used."),a.Ng=Math.min(ka.tc/e,ka.tc/t),a.Of=!0;a.li&&(f in va||(va[f]={}),va[f][a.qu]=a,T.cq?(a.ed=b,a.bq=b.length,a.zg=a.aq*a.zj/b.length,b=b[0]):(a.Ta=b,a.Ta.loop=a.Ni,a.zg=b.duration?a.zj/b.duration:ca.ad(),ea.zB||(b.playbackRate=ca.ad()/
a.zg,ea.WA&&2<b.playbackRate&&(b.playbackRate=2)),F(a)));e=u(a.width*a.Ng);t=u(a.height*a.Ng);a.Of?(n=h(),p=n.getContext("2d"),n.width=e,n.height=t,p.drawImage(b,0,0,a.width,a.height,0,0,e,t),M.texImage2D(m,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,n)):T.Rb||!da.vo(a.width)&&!da.vo(a.height)?M.texImage2D(m,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,b):(l(a,b,e,t,!1),a.Of=!0);a.width=e;a.height=t;a.li||(M.bindTexture(m,g),M.generateMipmap(m))}else if("ENVIRONMENT_MAP"==e)if(t){for(g=0;6>g;g++)M.texImage2D(M["TEXTURE_CUBE_MAP_"+
na[g]],0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!1);if(b.width%3||b.height%2){Z.error('Cubemap Image "'+n+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}g=b.width/3;g>ka.pi?(Z.warn('Cubemap Image "'+n+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*ka.pi+"x"+2*ka.pi+". Reduced image size will be used."),n=u(ka.pi/g*g),a.Of=!0):(n=u(g),
!T.Rb&&(3*n>ka.tc||2*n>ka.tc)&&(a.Of=!0));if(a.Of||T.by)x(b,g,n);else{p=b;e=n;k(M.TEXTURE_2D);M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,p);M.bindTexture(M.TEXTURE_2D,null);for(p=0;6>p;p++)M.texImage2D(M.TEXTURE_CUBE_MAP_POSITIVE_X+p,0,M.RGBA,e,e,0,M.RGBA,M.UNSIGNED_BYTE,null);M.bindTexture(a.qb,null);p=d();M.bindFramebuffer(M.FRAMEBUFFER,p);t=c();for(p=0;6>p;p++)L.OL(a,M[na[p]],e,g,t,p);M.bindFramebuffer(M.FRAMEBUFFER,null);M.bindTexture(a.qb,a.Cb);M.texParameteri(a.qb,M.TEXTURE_MIN_FILTER,
ua[T.El]);M.texParameteri(a.qb,M.TEXTURE_MAG_FILTER,M.LINEAR)}X.YJ()&&(Z.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),x(b,g,K.Oz));a.width=3*n;a.height=2*n;M.generateMipmap(m)}else"NODE_TEX"==e&&(M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,!1),M.texImage2D(m,0,M.RGBA,b.width,b.height,0,M.RGBA,M.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height);M.bindTexture(m,null)}function F(a){a.Ta.oncanplay=function(){A(a)&&v(a)}}function u(a){return da.vo(a)?da.clamp(Math.pow(2,
(a|0).toString(2).length),2,ka.tc):a}function r(b){var c;switch(b.type){case a.Vg:c=M.RGBA;break;case a.Zq:c=M.RGB;break;case a.Rn:c=M.RGBA;break;case a.Sn:c=M.RGB;break;case a.ik:c=M.DEPTH_COMPONENT;break;default:da.D("Wrong texture type")}return c}function z(b){var c;switch(b.type){case a.Vg:c=T.Rb?M.RGBA8:M.RGBA;break;case a.Zq:c=T.Rb?M.RGB8:M.RGB;break;case a.Rn:c=T.Rb?M.RGBA8:M.RGBA;break;case a.Sn:c=T.Rb?M.RGB8:M.RGB;break;case a.ik:c=T.Rb?J(ka.ej):M.DEPTH_COMPONENT;break;default:da.D("Wrong texture type")}return c}
function J(a){switch(a){case 16:a=M.DEPTH_COMPONENT16;break;case 24:a=M.DEPTH_COMPONENT24;break;case 32:a=M.DEPTH_COMPONENT32F;break;default:a=M.DEPTH_COMPONENT24}return a}function D(b){var c;switch(b.type){case a.Vg:c=M.UNSIGNED_BYTE;break;case a.Zq:c=M.UNSIGNED_BYTE;break;case a.Rn:c=M.FLOAT;break;case a.Sn:c=M.FLOAT;break;case a.ik:c=16==ka.ej?M.UNSIGNED_SHORT:M.UNSIGNED_INT;break;default:da.D("Wrong texture type")}return c}function H(a){a.Ta?a.Ta.play():a.ed&&(a.fq=!0);a.Hq=!1}function C(a){a.Ta?
a.Ta.pause():a.ed&&(a.fq=!1);a.Hq=!0}function t(a){a.Ta?a.Ta.currentTime=a.Mb/a.zg:a.ed&&(a.Ai=I(a,a.Mb),w(a))}function m(a){return a.Ta?!a.Ta.paused:a.ed?a.fq:!1}function A(a){return a.Ta||a.ed?a.Ta?2<=a.Ta.readyState:!0:0}function I(a,b){return Math.round(b*a.bq/a.zj)}function p(a,b){if(ja.is_dynamic(a))return y(a,b);for(var c=a.Zs,d=0;d<c.length;d++){var e=y(c[d],b);if(e)return e}return null}function Q(a,b,c){if(ja.is_dynamic(a))Y(a,b,c);else{a=a.Zs;for(var d=0;d<a.length;d++)Y(a[d],b,c)}}function y(a,
b){var c=a.K;if(c.length)for(var c=c[0].R,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type||"SKY"==e.type)for(var f=0;f<e.Sa.length;f++)if(e.Ve[f]==b)return e.Sa[f]}return null}function Y(a,b,c){a=a.K;if(a.length){a=a[0].R;for(var d=0;d<a.length;d++){var e=a[d];if("MAIN"==e.type)for(var f=0;f<e.Sa.length;f++)e.Ve[f]==b&&(e.Sa[f]=c)}}}function R(a,b){var c=a.K;if(c.length)for(var c=c[0].R,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type)for(var f=0;f<e.Sa.length;f++){var g=e.Sa[f],h=e.Ve[f];-1==b.indexOf(h)&&
"NODE_TEX"!=g.source&&b.push(h)}}}function G(a,b,c){var d=a.elements;a=a.interpolation;for(var e=0;e<b;e++){var f=e/(b-1),g=E(d,f,!0),h=W(d,f,!0);if(g&&h)if("CONSTANT"==a)c.push.apply(c,g.color);else{var k=c,m=g,l=h;m==l?k.push.apply(k,m.color):(k.push(aa.Qs(l.color[0],l.position,m.color[0],m.position,f)),k.push(aa.Qs(l.color[1],l.position,m.color[1],m.position,f)),k.push(aa.Qs(l.color[2],l.position,m.color[2],m.position,f)),k.push(aa.Qs(l.color[3],l.position,m.color[3],m.position,f)))}h&&!g&&c.push.apply(c,
h.color);g&&!h&&c.push.apply(c,g.color)}}function E(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?b-a[e].position:b-a[e][1][0];0<=f&&(d?f<=(c?b-d.position:b-a[e][1][0])&&(d=a[e]):d=a[e])}return d}function W(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?a[e].position-b:a[e][1][0]-b;0<=f&&(d?f<=(c?d.position-b:d[1][0]-b)&&(d=a[e]):d=a[e])}return d}function V(a,b){for(var c=0;c<qa.length;c++){var d=qa[c];if(d.rj==a&&d.type==b.type&&d.source==b.source&&d.repeat==b.repeat&&d.anisotropic_filtering==
b.anisotropic_filtering&&d.ck==b.ck)return d}return null}var K=q("__compat"),ba=q("__config"),oa=q("__texcomp"),X=q("__debug"),ha=q("__extensions"),Z=q("__print"),ca=q("__time"),da=q("__util"),L=q("__renderer");q("__objects");var ja=q("__obj_util"),aa=q("__curve"),P=q("__vec3"),la=q("__scenes"),T=ba.H,ka=ba.pg,ea=ba.Y,Ba=null,ra=null,ta=null;a.Se=0;a.P=0;a.jI=0;a.hI=0;a.iI=0;a.gI=0;a.Vg=10;a.Zq=20;a.Rn=30;a.Sn=40;a.ik=50;a.Xq=60;a.Vq=70;a.Yq=80;a.Wq=90;a.wz=128;a.iG=128;a.Sz=128;var qa=[],fa={},va=
{},M=null,ua,na="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),xa=[[2,0],[0,0],[1,1],[0,1],[1,0],[2,1]];a.mf=function(b){ua=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR];a.Se=b.NEAREST;a.P=b.LINEAR;a.jI=b.NEAREST_MIPMAP_NEAREST;a.hI=b.LINEAR_MIPMAP_NEAREST;a.iI=b.NEAREST_MIPMAP_LINEAR;a.gI=b.LINEAR_MIPMAP_LINEAR;M=
b};a.$T=function(a,b){return b in fa&&a in fa[b]?fa[b][a].Af:null};a.jV=function(a,b){return b in fa&&a in fa[b]?(e(fa[b][a]),!0):!1};a.eA=g;a.Gk=B;a.iB=function(c){var d=M.createTexture(),e=M.TEXTURE_CUBE_MAP;M.bindTexture(e,d);M.texParameteri(e,M.TEXTURE_MAG_FILTER,M.LINEAR);M.texParameteri(e,M.TEXTURE_MIN_FILTER,M.LINEAR);M.texParameteri(e,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE);M.texParameteri(e,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE);for(var f=0;6>f;f++)M.texImage2D(M[na[f]],0,M.RGBA,c,c,0,M.RGBA,M.UNSIGNED_BYTE,
null);M.bindTexture(e,null);e=b();e.type=a.Vg;e.source="NONE";e.width=3*c;e.height=2*c;e.Io=1;e.Cb=d;e.qb=M.TEXTURE_CUBE_MAP;return e};a.ly=function(a,b,c){var d=a.qb;M.bindTexture(d,a.Cb);b&&M.texParameteri(d,M.TEXTURE_MIN_FILTER,b);c&&M.texParameteri(d,M.TEXTURE_MAG_FILTER,c);M.bindTexture(d,null)};a.resize=function(b,c,d){c=Math.max(c,T.Yo?2:1);d=Math.max(d,T.Yo?2:1);if(b.width!=c||b.height!=d){switch(b.type){case a.Xq:M.bindRenderbuffer(M.RENDERBUFFER,b.pe);M.renderbufferStorage(M.RENDERBUFFER,
M.RGB565,c,d);M.bindRenderbuffer(M.RENDERBUFFER,null);break;case a.Vq:M.bindRenderbuffer(M.RENDERBUFFER,b.pe);M.renderbufferStorage(M.RENDERBUFFER,J(ka.ej),c,d);M.bindRenderbuffer(M.RENDERBUFFER,null);break;case a.Yq:M.bindRenderbuffer(M.RENDERBUFFER,b.pe);M.renderbufferStorageMultisample(M.RENDERBUFFER,T.uc,M.RGBA8,c,d);M.bindRenderbuffer(M.RENDERBUFFER,null);break;case a.Wq:M.bindRenderbuffer(M.RENDERBUFFER,b.pe);M.renderbufferStorageMultisample(M.RENDERBUFFER,T.uc,J(ka.ej),c,d);M.bindRenderbuffer(M.RENDERBUFFER,
null);break;default:var e=b.qb;M.bindTexture(e,b.Cb);var f=r(b),g=z(b),h=D(b);M.texImage2D(e,0,g,c,d,0,f,h,null);M.bindTexture(e,null)}c>ka.tc||d>ka.tc?da.D('Slink texture "'+b.type+'" has unsupported size: '+c+"x"+d+". Max available: "+ka.tc+"x"+ka.tc+"."):(b.width=c,b.height=d)}};a.vL=function(c,d,f,h,k){var m=c.type;if("BLEND"==m)return null;var l=c.image,p=b();p.type=a.Vg;p.width=1;p.height=1;var n=c.b4w_anisotropic_filtering;"DEFAULT"===n&&(n=d);"OFF"!==n&&T.anisotropic_filtering&&ha.qw()&&(n=
parseFloat(n.split("x")[0]),p.anisotropic_filtering=n);if("REPEAT"!=c.extension||c.b4w_shore_dist_map)p.repeat=!1;if(l){"IMAGE"==m&&"MOVIE"==l.source&&(p.li=!0,p.qu=c.name,p.sa=c.frame_start,p.Mb=c.frame_offset,p.jj=c.frame_duration,p.ez=c.use_auto_refresh,p.Ni=c.use_cyclic,p.zj=c.movie_length,p.ck=c.b4w_nla_video,0!=p.Mb&&Z.warn('Frame offset for texture "'+c.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.'));p.source=m;d=da.yh(k+l.filepath);if(d=V(d,p))return d;
g(p,l,k)}d=new Uint8Array([204,204,204,255]);switch(m){case "IMAGE":k=M.createTexture();l=M.TEXTURE_2D;M.bindTexture(l,k);M.texImage2D(l,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,d);break;case "NONE":if("NONE"==c.b4w_source_type)return null;k=M.createTexture();l=M.TEXTURE_2D;p.source=c.b4w_source_type;if("SCENE"==p.source){if(!c.b4w_source_id)return null;h=da.keysearch("name",c.b4w_source_id,f);if(!h)return null;p.jq=c.b4w_source_id;p.Bi=c.b4w_source_size;h.wf=h.wf||[];h.wf.push(p);M.bindTexture(l,k);
M.texImage2D(l,0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,d)}else"CANVAS"==p.source&&(f=c.b4w_source_id,d=c.b4w_source_size,p.jq=f,p.hj=c.b4w_enable_canvas_mipmapping,c=document.createElement("canvas"),c.width=d,c.height=d,p.Af=c.getContext("2d"),h in fa||(fa[h]={}),fa[h][f]=p,M.bindTexture(l,k));break;case "ENVIRONMENT_MAP":k=M.createTexture();l=M.TEXTURE_CUBE_MAP;M.bindTexture(l,k);c="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(h=0;6>h;h++)M.texImage2D(M["TEXTURE_CUBE_MAP_"+
c[h]],0,M.RGBA,1,1,0,M.RGBA,M.UNSIGNED_BYTE,d);break;default:return Z.error('texture "'+c.name+'" has unsupported type "'+m+'"'),null}p.Cb=k;p.qb=l;"NONE"==m?(p.hj?M.texParameteri(l,M.TEXTURE_MIN_FILTER,ua[T.El]):M.texParameteri(l,M.TEXTURE_MIN_FILTER,M.LINEAR),p.anisotropic_filtering&&M.texParameterf(l,ha.qw().TEXTURE_MAX_ANISOTROPY_EXT,p.anisotropic_filtering),"CANVAS"==p.source&&e(p)):(M.generateMipmap(l),M.bindTexture(l,null));return p};a.aS=e;a.DF=v;a.CF=w;a.xq=f;a.GJ=u;a.Em=function(a){return a&&
(a.Cb||a.pe)?!0:!1};a.Dm=function(a){return a&&a.pe?!0:!1};a.wU=function(b){return b.type==a.Rn||b.type==a.Sn?!0:!1};a.uN=function(b){var c=0;switch(b.type){case a.Vg:case a.Zq:c=4;break;case a.Rn:case a.Sn:c=16;break;case a.ik:c=3;break;case a.Xq:case a.Vq:c=2;break;case a.Yq:c=4*T.uc;break;case a.Wq:c=3*T.uc}return c};a.cleanup=function(){if(!T.cq)for(var a in va)for(var b in va[a])va[a][b].Ta.pause(),va[a][b].Ta.src="",va[a][b].Ta.load();qa.length=0;fa={};va={}};a.pause=function(){for(var a in va)for(var b in va[a]){var c=
va[a][b];m(c)&&C(c)}};a.reset=function(){for(var a in va)for(var b in va[a])t(va[a][b])};a.play=function(a){for(var b in va)for(var c in va[b]){var d=va[b][c];a&&!d.Hq||H(d)}};a.Fw=function(a,b){return b in va&&a in va[b]?va[b][a]:null};a.jz=function(a){return a.ck};a.play_video=H;a.pause_video=C;a.reset_video=t;a.hQ=function(a,b){if(void 0 in va&&a in va[void 0]){var c=va[void 0][a];c.Ta?c.Ta.currentTime=b/c.zg:c.ed&&(c.Ai=b,w(c))}};a.YF=m;a.ZF=A;a.VF=function(a){return a.Ta||a.ed?a.Ta?Math.round(a.Ta.currentTime*
a.zg):a.Ai:0};a.XF=function(a){return a.Ta||a.ed?a.Ta?a.Mb:I(a,a.Mb):0};a.qS=function(a){if(!a.Ta&&!a.ed)return 0;var b=Math.min(a.jj,a.zj-a.Mb);return a.Ta?a.Mb+b:I(a,a.Mb+b)};a.Jt=function(a,b){return Math.round(b*a.aq*(ca.ad()/a.zg))};a.WF=function(a){return Math.min(a.jj,a.zj-a.Mb)};a.pS=I;a.UM=function(a,b){var c=p(a,b);return c&&"CANVAS"==c.source?c.Af:null};a.Cw=p;a.zQ=Q;a.get_texture_names=function(a){var b=[];if(ja.is_dynamic(a))R(a,b);else{a=a.Zs;for(var c=0;c<a.length;c++)R(a[c],b)}return b};
a.JQ=function(a){for(var c={},d=0;d<a.length;d++){for(var f=a[d].Sa,g=a[d].Ie,h=[],k=[],m=0;m<f.length;m++){var l=f[m],O=g[m];if("CANVAS"==l.source)if(O in c)l=c[O];else{var p=f[m],l=b();l.source="CANVAS";l.width=p.width;l.height=p.height;l.hj=p.hj;l.type=p.type;p=document.createElement("canvas");p.width=l.width;p.height=l.height;l.Af=p.getContext("2d");l.qb=M.TEXTURE_2D;l.Cb=M.createTexture();M.bindTexture(M.TEXTURE_2D,l.Cb);l.hj?M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,ua[T.El]):M.texParameteri(M.TEXTURE_2D,
M.TEXTURE_MIN_FILTER,M.LINEAR);M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,M.LINEAR);M.bindTexture(M.TEXTURE_2D,null);p=l;p.Af.drawImage(f[m].Af.canvas,0,0);e(p);c[O]=l}h.push(l);k.push(O)}a[d].Sa=h}};a.eM=function(a,b){for(var c=[],d=0;d<a.length;d++)G(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return da.clamp(255*a,0,255)}))};a.CJ=G;a.iM=function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),e=[],f=0;f<a.length;f++){for(var g=a[f].data.value,h=[],k=
g.curve_mapping.curves_data,m=g.curve_mapping.curve_extend,l=g.curve_mapping.curves_handle_types,g=0;g<k.length;g++){for(var p=m[g],n=k[g],t=[],r=l[g],u=0;u<n.length;u++)t.push([new Float32Array(3),new Float32Array(n[u].concat(0)),new Float32Array(3)]);aa.sv(t[0],null,t[1],r[0],r[0]);for(u=1;u<t.length-1;u++)aa.sv(t[u],t[u-1],t[u+1],r[u],r[u]);aa.sv(t[t.length-1],t[t.length-2],null,r[t.length-1],r[t.length-1]);if(2<t.length){if("AUTO"==r[0]){P.subtract(t[0][2],t[0][1],c);u=P.length(c);P.copy(t[1][0],
d);d[0]<t[0][1][0]&&(d[0]=t[0][1][0]);P.subtract(d,t[0][1],d);var y=P.length(d);1E-8<y&&(P.scale(d,u/y,d),P.add(t[0][1],d,t[0][2]),P.subtract(t[0][1],d,t[0][0]))}n=t.length-1;"AUTO"==r[0]&&(P.subtract(t[n][0],t[n][1],c),u=P.length(c),P.copy(t[n-1][2],d),d[0]>t[n][1][0]&&(d[0]=t[n][1][0]),P.subtract(d,t[n][1],d),y=P.length(d),1E-8<y&&(P.scale(d,u/y,d),P.add(t[n][1],d,t[n][0]),P.subtract(t[n][1],d,t[n][2])))}for(n=0;n<t.length-1;n++)aa.tK(t[n][1],t[n][2],t[n+1][0],t[n+1][1]);n=[];3>=k.length?(u=Math.round(-b/
2),r=Math.round(b/2)):(u=0,r=b);for(;u<r;u++){var y=u/(r-1),v=E(t,y,!1),w=W(t,y,!1);v&&w?n.push(aa.uA(y,v[1],v[2],w[0],w[1],.001)):w&&!v?"EXTRAPOLATED"==p?(y=w[1][0]==w[2][0]?w[1][1]:aa.YC(y,w[1],w[2]),n.push(y)):n.push(w[1][1]):v&&!w&&("EXTRAPOLATED"==p?(y=v[0][0]==v[1][0]?v[1][1]:aa.YC(y,v[0],v[1]),n.push(y)):n.push(v[1][1]))}h.push(n)}e.push(h)}c=[];for(u=0;u<e.length;u++)for(h=e[u],g=0;g<h[0].length;g++)3>=h.length?(d=da.clamp(127.5*(h[0][g]+1),0,255),f=da.clamp(127.5*(h[1][g]+1),0,255),k=da.clamp(127.5*
(h[2][g]+1),0,255),n=255):(d=da.clamp(255*h[0][g],0,255),f=da.clamp(255*h[1][g],0,255),k=da.clamp(255*h[2][g],0,255),n=da.clamp(255*h[3][g],0,255)),c.push(d,f,k,n);return new Uint8Array(c)};a.hB=function(b,c){var d=B(a.Vg,!1);d.source="NODE_TEX";d.repeat=!1;f(d,{width:c,height:b.length/(4*c),data:b});return d};a.change_image=function(a,c,d,e,g){var h=da.yh(g);if("WORLD"!=a.type){var k=V(h,c);if(!k){k=b();k.type=c.type;k.source=c.source;k.jq=c.jq;k.width=c.width;k.height=c.height;k.Io=c.Io;k.Bi=c.Bi;
k.hj=c.hj;k.Af=c.Af;k.qb=c.qb;k.Cb=c.Cb;k.pe=c.pe;k.li=c.li;k.Jq=c.Jq;k.Ta=c.Ta;k.qu=c.qu;k.zj=c.zj;k.zg=c.zg;k.sa=c.sa;k.Mb=c.Mb;k.jj=c.jj;k.Of=c.Of;k.Ng=c.Ng;k.ed=c.ed;k.bq=c.bq;k.aq=c.aq;k.Ai=c.Ai;k.fq=c.fq;k.Rj=c.Rj;k.Hq=c.Hq;k.ez=c.ez;k.Ni=c.Ni;k.ck=c.ck;k.repeat=c.repeat;k.ym=c.ym;k.rj=c.rj;k.zm=c.zm;k.Ow=c.Ow;k.Nw=c.Nw;k.Vk=c.Vk;var m=k;M.bindTexture(c.qb,c.Cb);var l=M.getTexParameter(c.qb,M.TEXTURE_MAG_FILTER),O=M.getTexParameter(c.qb,M.TEXTURE_MIN_FILTER),p=M.getTexParameter(c.qb,M.TEXTURE_WRAP_S);
c=M.getTexParameter(c.qb,M.TEXTURE_WRAP_T);m.Cb=M.createTexture();M.bindTexture(m.qb,m.Cb);M.texParameteri(m.qb,M.TEXTURE_MAG_FILTER,l);M.texParameteri(m.qb,M.TEXTURE_MIN_FILTER,O);M.texParameteri(m.qb,M.TEXTURE_WRAP_S,p);M.texParameteri(m.qb,M.TEXTURE_WRAP_T,c);M.bindTexture(m.qb,null);n(k,g,h);f(k,e,0)}Q(a,d,k)}else k=c,n(k,g,h),f(k,e,0),la.YR(a)};a.vT=function(){};a.Ld=function(a){return a.texture.F};a.KP=function(){M=null};a.eC=function(){return qa}};b4w.module.__assets=function(a,q){function d(){return f.EC()?q(f.ge.qr).data:null}function c(){var a={$q:null,vI:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.$q=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=d();b&&a.$q in b&&(a.status=200,b[a.$q]&&(a.response=a.vI(b[a.$q])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var f=b[d];20===f.state&&c++;if(c>=H.FO)break;if(10===f.state)switch(f.state=20,c++,f.type){case a.AT_ARRAYBUFFER:g(f,"arraybuffer");break;case a.AT_JSON:g(f,"json");break;case a.AT_TEXT:g(f,"text");break;case a.AT_AUDIOBUFFER:n(f);break;case a.AT_IMAGE_ELEMENT:B(f);
break;case a.AT_AUDIO_ELEMENT:e(f);break;case a.Mq:v(f);break;case a.Lq:w(f);break;default:z.D("Wrong asset type: "+f.type)}}}function g(b,e){var f=b.url.split("?v=")[0];if(f in A)"json"==e?b.Sb(z.S(A[f]),b.id,b.type,b.url,b.vb):b.Sb(A[f],b.id,b.type,b.url,b.vb);else{var g=d(),h=g&&b.url in g?new c:new XMLHttpRequest,g=null;if("GET"==b.request)h.open("GET",b.url,!0);else if("POST"==b.request)switch(h.open("POST",b.url,!0),b.ul){case a.sz:g="text/plain";break;case a.rz:g="application/json"}if(b.Jj)for(var k in b.Jj)"Content-Type"==
k?g=b.Jj[k]:h.setRequestHeader(k,b.Jj[k]);g&&h.setRequestHeader("Content-Type",g);"text"==e?(h.overrideMimeType("text/plain"),h.responseType="text"):"json"==e?(h.overrideMimeType("application/json"),h.responseType="text"):h.responseType=e;h.onreadystatechange=function(){if(40!=b.state&&4==h.readyState){if(200==h.status||0==h.status){var a=h.response;if(a){if("json"==e&&"string"==typeof a)try{a=JSON.parse(a,b.XN)}catch(K){u.error(K+" (parsing JSON "+b.url+")");b.Sb(null,b.id,b.type,b.url,b.vb);return}b.Bg&&
(A[f]="json"==e?z.S(a):a);b.Sb(a,b.id,b.type,b.url,b.vb)}else u.error("empty responce when trying to get "+b.url),b.Sb(null,b.id,b.type,b.url,b.vb)}else u.error(h.status+" when trying to get "+b.url),b.Sb(null,b.id,b.type,b.url,b.vb);b.state=30}};h.addEventListener("progress",function(a){a.lengthComputable&&b.JD(a.loaded/a.total)},!1);h.send(b.Mj)}}function n(a){var b=a.url.split("?v=")[0];if(b in Q)a.Sb(Q[b],a.id,a.type,a.url,a.vb),a.state=30;else{"GET"!=a.request&&z.D("Unsupported request type for audio buffer");
var e=(b=d())&&a.url in b?new c:new XMLHttpRequest;e.open("GET",a.url,!0);e.responseType="arraybuffer";e.onreadystatechange=function(){if(40!=a.state&&4==e.readyState)if(200==e.status||0==e.status){var b=e.response;b?r.GL(b,function(b){a.Sb(b,a.id,a.type,a.url,a.vb);a.state=30;a.Bg&&(Q[a.url.split("?v=")[0]]=b)},function(){a.Sb(null,a.id,a.type,a.url,a.vb);u.error("failed to decode "+a.url);a.state=30}):(a.Sb(null,a.id,a.type,a.url,a.vb),u.error("empty responce when trying to get "+a.url),a.state=
30)}else a.Sb(null,a.id,a.type,a.url,a.vb),u.error(e.status+" when trying to get "+a.url),a.state=30};e.send(a.Mj)}}function B(a){var b=a.url.split("?v=")[0];if(b in I)a.Sb(I[b],a.id,a.type,a.url,a.vb),a.state=30;else{"GET"!=a.request&&z.D("Unsupported request type for image element");var c=document.createElement("img");D.allow_cors&&(c.crossOrigin="Anonymous");c.onload=function(){40!=a.state&&(a.Sb(c,a.id,a.type,a.url,a.vb),a.state=30,a.Bg&&(I[a.url.split("?v=")[0]]=c))};c.addEventListener("error",
function(){40!=a.state&&(a.Sb(null,a.id,a.type,a.url,a.vb),u.error("could not load image: "+a.url),a.state=30)},!1);if((b=d())&&a.url in b)if(b[a.url]){var e=l(a.url);c.src="data:"+e+";base64,"+b[a.url]}else F.is_ie11()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url}}function e(a){var b=a.url.split("?v=")[0];if(b in p)a.Sb(p[b],a.id,a.type,a.url,a.vb),a.state=30;else{"GET"!=a.request&&z.D("Unsupported request type for audio element");
var c=document.createElement("audio");D.allow_cors&&(c.crossOrigin="Anonymous");c.addEventListener("loadeddata",function(){40!=a.state&&(a.Sb(c,a.id,a.type,a.url,a.vb),a.state=30,a.Bg&&(p[a.url.split("?v=")[0]]=c))},!1);c.addEventListener("error",function(){40!=a.state&&(a.Sb(null,a.id,a.type,a.url,a.vb),u.error("could not load sound: "+a.url),a.state=30)},!1);c.addEventListener("stalled",function(){40!=a.state&&(a.Sb(null,a.id,a.type,a.url,a.vb),u.error("could not load sound: "+a.url),a.state=30)},
!1);if((b=d())&&a.url in b)if(b[a.url]){var e=x(a.url);c.src="data:"+e+";base64,"+b[a.url];40!=a.state&&(a.Sb(c,a.id,a.type,a.url,a.vb),a.state=30)}else F.is_ie11()?(b=document.createEvent("CustomEvent"),b.initCustomEvent("error",!1,!1,null)):b=new CustomEvent("error"),c.dispatchEvent(b);else c.src=a.url,D.is_mobile_device&&c.load();D.sx&&(c.autoplay=!0,c.pause());setTimeout(function(){c.wI=1},5E3)}}function v(a){function b(){40!=a.state&&(a.Sb(null,a.id,a.type,a.url),u.error("could not load video: "+
a.url,a.vb),a.state=30)}var c=a.url.split("?v=")[0];if(c in I)a.Sb(I[c],a.id,a.type,a.url,a.vb),a.state=30;else{"GET"!=a.request&&z.D("Unsupported request type for video element");var e=document.createElement("video");e.muted=!0;D.allow_cors&&(e.crossOrigin="Anonymous");e.addEventListener("loadeddata",function(){e.removeEventListener("error",b,!1);40!=a.state&&(a.Sb(e,a.id,a.type,a.url,a.vb),a.state=30,a.Bg&&(I[a.url.split("?v=")[0]]=e))},!1);e.addEventListener("error",b,!1);if((c=d())&&a.url in c)if(c[a.url]){var f=
k(a.url);e.src="data:"+f+";base64,"+c[a.url];40!=a.state&&e.addEventListener("loadeddata",function(){a.Sb(e,a.id,a.type,a.url,a.vb);a.state=30},!1)}else F.is_ie11()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),e.dispatchEvent(c);else e.src=a.url,D.is_mobile_device&&e.load();D.sx&&(e.autoplay=!0,e.pause());setTimeout(function(){e.wI=1},1E4)}}function w(b){function e(a){b.Sb(a,b.id,b.type,b.url,b.vb);b.state=30;b.Bg&&(I[b.url.split("?v=")[0]]=
a)}var f=b.url.split("?v=")[0];if(f in I)b.Sb(I[f],b.id,b.type,b.url,b.vb),b.state=30;else{"GET"!=b.request&&z.D("Unsupported request type for seq video element");var g=(f=d())&&b.url in f?new c:new XMLHttpRequest;if(null==b.ul&&null==b.Mj)g.open("GET",b.url,!0);else switch(g.open("POST",b.url,!0),b.ul){case a.sz:g.setRequestHeader("Content-type","text/plain");break;case a.rz:g.setRequestHeader("Content-type","application/json")}g.responseType="arraybuffer";g.onreadystatechange=function(){if(40!=
b.state&&4==g.readyState)if(200==g.status||0==g.status){var a=g.response;a?h(a,e):(b.Sb(null,b.id,b.type,b.url,b.vb),u.error("empty responce when trying to get "+b.url),b.state=30)}else b.Sb(null,b.id,b.type,b.url,b.vb),u.error(g.status+" when trying to get "+b.url),b.state=30};g.addEventListener("progress",function(a){a.lengthComputable&&b.JD(a.loaded/a.total)},!1);g.send(b.Mj)}}function h(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],BA:[],zg:c[4]},g=20,h=0;h<e;h++){var k=
c[g/4],m=new Blob([d.subarray(g+4,g+4+k)],{type:"image/jpg"}),l=document.createElement("img");l.src=window.URL.createObjectURL(m);f.images.push(l);f.BA.push(m);g+=k+8-k%4}l.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.BA;b(f)}}function l(a){var b="image";switch(z.vw(a).toLowerCase()){case "jpeg":case "jpg":b+="/jpeg";break;case "png":b+="/png"}return b}function x(a){var b="audio";switch(z.vw(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";
break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function k(a){var b="video";switch(z.vw(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var f=q("__config"),F=q("__compat"),u=q("__print"),r=q("__sfx"),z=q("__util"),J=q("__version"),D=f.H,H=f.rd;a.AT_ARRAYBUFFER=10;a.AT_JSON=20;a.AT_TEXT=30;a.AT_AUDIOBUFFER=40;a.AT_IMAGE_ELEMENT=50;a.AT_AUDIO_ELEMENT=60;a.Mq=70;a.Lq=80;a.rz=a.AT_JSON;a.sz=
a.AT_TEXT;var C=[],t=0,m={},A={},I={},p={},Q={};a.gn=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.hU=function(a){if(m[a])return m[a];var b=H.prevent_caching?a+J.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200!=c.status&&c.status)z.D("Error XHR: "+c.status+", GET "+a);else{b=c.responseText;if(b.length)return m[a]=b;z.D("Error XHR: responce is empty, GET "+a)}};a.cleanup=function(){for(var a=
0;a<C.length;a++)C[a].state=40;C=[];t=0;m={}};a.enqueue=function(a,c,e,f,g){for(var h=0;h<a.length;h++){var k=a[h],k={id:k.id,type:k.type,url:k.url,Bg:k.Bg,request:k.request?k.request:"GET",ul:k.ul?k.ul:null,Jj:k.Jj?k.Jj:null,Mj:k.Mj?k.Mj:null,vb:k.vb?k.vb:null,state:10,Sb:c||function(){},zD:e||function(){},JD:f||function(){},XN:g||null,AD:t};if(H.prevent_caching){var m=d();m&&k.url in m||(k.url+=J.timestamp())}C.push(k)}b(C);t++};a.update=function(){b(C);for(var a=C,c=0,d=!0,e=0;e<a.length;e++){var f=
a[e];f.AD===a[c].AD?30!==f.state&&(d=!1):(d&&(a[e-1].zD(),d=e-c,a.splice(c,d),e-=d),c=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(a[e].zD(),a.splice(c))}};a.ZJ=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a||"pvr"==a?!0:!1};a.lK=function(){A={};I={};p={};Q={}}};b4w.module.__loader=function(a,q){function d(b,d,e,g){var h=z,k=F.create(),n;for(n in d){var r=c(d[n]);(g&&r.Nb||!b&&r.bc)&&l(r);F.O(k,r)}for(n in d)for(r=d[n],r.name=n,b=0;b<r.inputs.length;b++)F.C(k,d[r.inputs[b]],r,null);d=c({name:"out",Gb:a.kG,Tb:function(a,b,c,d,e){b.Eb&&(h.zy=!0);f(b)||(b.status=2);b.$C(b.id,!0);e(b,c);u.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Pb:5});if(e)e=F.lp(k);else{n=F.clone(k);do{e=F.lp(n);r=[];for(b=0;b<e.length;b++){g=e[b];var p=F.Ra(n,g);p.Lb&&r.push(g)}for(b=
0;b<r.length;b++)F.Vf(n,r[b]);r.length&&F.yv(n)}while(r.length)}F.O(k,d);for(b=0;b<e.length;b++)g=e[b],p=F.Ra(k,g),d.inputs.push(p.name),F.C(k,p,d,null);return k}function c(a){a.Lb=a.Lb||!1;a.Gb||0===a.Gb||(a.Gb=a.Xd);a.inputs=a.inputs||[];a.al=a.al||!1;a.vy=a.vy||!1;a.Pb=a.Pb||0;a.Nb=a.Nb||!1;a.bc=a.bc||!1;a.status=0;a.FU=0;a.fx=0;a.ro=a.ro||null;return a}function b(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var f=b[e];F.Ra(a.Fh,f).al&&(F.Zj(a.Fh,f,function(d){var e=!0;F.Hh(a.Fh,d,function(a,b){if(!b.al)return e=
!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-1;0<=e;e--)b.splice(d[e],1);return c}function g(a){function c(b,c){var d=F.Ra(a.Fh,b),e=F.Ra(a.Fh,c),f=e.Gb-d.Gb;f||(f=d.Lb-e.Lb);return f}var d=[],e=a.Ei,f=!1;do{var g=b(a,e);d.push.apply(d,e);0<g.length&&(f=!0);e=g}while(0<g.length);f&&d.sort(c);a.Ei=d;return a.Ei.length}function n(a,b,c){if(b.vy)return b.al=!0,e(a,b),!1;if(!b.Tb&&!b.Zi&&!b.qo)return e(a,b),!1;if(0==b.status&&(b.status++,b.Tb))return b.Tb(c,a,b,
b.ro,e,v),!0;if(1==b.status){if(b.Zi)return b.Zi(c,a,b,b.ro,e,v),!0;b.status++}return 2==b.status&&(b.status++,b.qo)?(b.qo(c,a,b,b.ro,e,v),!0):!1}function B(a){if(0==a.au)return 100;var b=0;F.ha(a.Fh,function(c,d){a.do_not_load_resources&&d.Nb||(b+=d.fx*d.Pb)});return r.trunc(100*b/a.au)}function e(a,b){b.al=!0;b.status=3;w(a,b,1)}function v(a,b,c){1>c?w(a,b,c):b.status++}function w(a,b,c){var d=z;if(b.Tb||b.Zi||b.qo)if(b.fx=c,b=B(a),a.rB!=b||1==c)a.yy(b,performance.now()-a.kF),a.rB=b,d.hx=!0}function h(a,
b){var c=null;F.ha(a.Fh,function(a,d){if(d.name==b)return c=d,1});return c}function l(a){a.vy=!0;a.fx=1}function x(a){a.yy=null;a.Ev=null;a.Fh=null;a.Ei=null}function k(){return 0==z.br}function f(a){return a&&(3==a.status||4==a.status)}var F=q("__graph"),u=q("__print"),r=q("__util");a.Xd=0;a.cg=1;a.kG=2;var z=null;a.zw=function(){return z};a.jB=function(){var a={Qg:[],Tv:0,br:0,zy:!1,hx:!1};return z=a};a.oB=function(a,b,c,e,f,g,h,k,l){var m=z,p=m.Qg.length,n={id:p,Eb:0==p,status:0,xg:b,xA:"",$C:c||
function(){},ZC:k||!1,mV:g,kF:0,rB:0,au:0,ay:!1,yy:e||function(){},Ev:f||function(){},Fh:null,Ei:null,Mw:!1,Kw:!1,Pw:!1,wj:l};a=d(n.Eb,a,g,h);n.Fh=a;b=[];c=F.sN(a);for(e=0;e<c.length;e++)b.push(c[e]);n.Ei=b;F.ha(a,function(a,b){!(b.Tb||b.Zi||b.qo)||n.do_not_load_resources&&b.Nb||(n.au+=b.Pb)});m.Qg.push(n);m.br++;return n.id};a.UR=function(b){var c=z;if(c&&!k())if(c.hx)c.hx=!1;else{var d=performance.now();do{var e=c.Qg[c.Tv],h=b[e.id];if(!f(e))if(0==e.status&&(e.status=1,e.kF=performance.now(),e.yy(0,
0)),g(e)){var m=e,l=m.Ei.length;do{var r=F.Ra(m.Fh,m.Ei[0]),p=n(m,r,h);r.Gb==a.cg&&(m.ay=!0);r=m.Ei.shift();m.Ei.push(r);l--}while(!p&&0!=l)}else m=c,l=e,l.Ev(h,l),l.status=3,m.br--,x(l);c.zy&&(c.Tv=(c.Tv+1)%c.Qg.length);if(e.ay){e.ay=!1;break}}while(16>performance.now()-d)}};a.Xz=function(a){var b=z;a.Ev(null,a);a.status=3;b.br--;x(a);a.status=4;a.Eb&&(b.zy=!0);a.$C(a.id,!1)};a.bV=v;a.Ot=function(a,b){var c=h(a,b);null!==c&&l(c)};a.al=k;a.lR=f;a.is_primary_loaded=function(a){var b=z;if(!b)return!1;
a|=0;return b.Qg[a]&&(3==b.Qg[a].status||2==b.Qg[a].status)};a.zN=function(){u.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.cleanup=function(){z=null}};b4w.module.__logic_nodes=function(a,q){function d(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];if(-2==c.state){for(var f=0;f<c.It;f++)if(H.get_sensor_value(a,b,f))for(var g=0;g<c.Ht.length;g++)if(c.Ht[g]==f){e.nl==c.gF?(u.is_play(e.na)&&(c.state=-1),d.qf.df||(c.state=1,c.hq=c.Rs[g])):(c.state=1,c.hq=c.Rs[g]);return}c.state=0}}}function c(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];for(var f=0;f<c.It;f++)if(H.get_sensor_value(a,b,f)&&f==c.eE){if(u.is_play(e.na)&&e.nl==c.gF)c.state=-1;
else if(!d.qf.df||c.T.no_wait)c.state=1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,Na:a.slot_idx_order,hq:a.slot_idx_jump,sa:a.frame_range[0],Za:a.frame_range[1],wM:a.frame_range_mask?a.frame_range_mask[0]:!0,vM:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,It:-1,eE:-1,ZO:a.param_name,WO:a.operation,mute:a.mute,Wo:a.object,obj:null,$b:null,kc:null,$a:{},yf:a.anim_name,qc:k.SLOT_ALL,aP:a.parse_json_vars,$O:a.parse_json_paths,zc:a.objects_paths,oD:a.nodes_paths,
zb:a.floats,T:a.bools,W:a.variables,Gi:a.strings,ix:a.materials_names,xE:a.shader_nd_type,Zd:a.common_usage_names,XL:a.encode_json_vars,WL:a.encode_json_paths,gF:b,ID:ha[a.type]?ha[a.type]:e,At:!1,fu:0,Ht:null,pO:a.links,Rs:[]}}function g(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function n(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function B(a,b,c){switch(b.state){case 2:c.la=a.Na}}function e(a,b,c){switch(b.state){case 1:z.error("Unknown node type: "+a.type);break;case 2:c.la=a.Na}}function v(a){return r.oc(r.Cc,
a.Wo||[],0)}function w(a,c){var d=a.b4w_logic_nodes,e=c.Od;c.state=1;for(var f=0;f<d.length;f++){var g={V:[],qf:{pb:a,la:0,df:!1,Ny:f,G:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};e.push(g);for(var h=e[e.length-1],k=d[f],m=0;m<k.length;m++){var l=b(k[m],h);h.V.push(l)}for(k=0;k<h.V.length;k++)l=h.V[k],l.mute||l.ID(l,c,g.qf,0,0)}var d=a.timeline_markers,p;for(p in d)c.iq.push(d[p]);c.iq.sort(function(a,b){return a-b});c.state=2;Z.push(c)}function h(a,b){switch(b){case 0:return Number(a)?Number(a):
0;case 1:return String(a);default:return null}}function l(a){switch(typeof a){case "string":return h(a,1);case "number":return h(a,0);default:return h(a,1)}}function x(a){da[a]||(da[a]=0);var b=a+"_"+da[a],b=b.replace(/ /g,"_").replace(/\//g,"_");da[a]++;return b}var k=q("__animation"),f=q("__assets"),F=q("__camera"),u=q("__nla"),r=q("__objects"),z=q("__print"),J=q("__scenes"),D=q("__config"),H=q("__controls"),C=q("__batch"),t=q("__geometry"),m=q("__mat3"),A=q("__mat4"),I=q("__physics"),p=q("__quat"),
Q=q("__sfx"),y=q("__time"),Y=q("__transform"),R=q("__tsr"),G=q("__util"),E=q("__vec3"),W=new Float32Array(4),V=new Float32Array(3),K=new Float32Array(3),ba=new Float32Array(2),oa=new Float32Array(9),X=new Float32Array(16);a.kH=0;a.lH=1;a.PG=0;a.YG=1;a.UG=2;a.KG=3;a.VG=4;a.XG=5;a.OG=6;a.ZG=7;a.MG=8;a.LG=9;a.NG=10;a.QG=11;a.SG=12;a.RG=13;a.WG=14;a.TG=15;a.JG=16;a.eH=0;a.dH=1;a.fH=2;a.gH=3;a.cH=4;a.Jz=0;a.Lz=1;a.Kz=2;a.Mz=3;a.Nz=4;a.Iz=5;a.jH=0;a.iH=1;a.hH=2;a.FG=0;a.GG=1;a.DG=2;a.EG=3;a.HG=0;a.IG=1;
var ha={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.la=a.Na}},HIDE:function(a,b,c){switch(b.state){case 1:a.obj=v(a);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:a.T.ch?J.ur(a.obj,!0):J.uo(a.obj,!0),c.la=a.Na}},SHOW:function(a,b,c){switch(b.state){case 1:a.obj=v(a);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:a.T.ch?J.ur(a.obj,!1):J.uo(a.obj,!1),c.la=a.Na}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=
a.W.vd;b=b.G;var e=c.G,f;a:{f=a.ZO;var g=a.zb.ptp,k=a.T.hsh,m=D.get("url_params");if(m&&f in m)f=Number(m[f]);else{if(k=k?location.hash:location.search)for(k=k.slice(1).split("&"),m=0;m<k.length;m++){var l=k[m].split("=");if(1<l.length&&l[0]==f){f=h(l[1],g);break a}}f=0}}n(d,b,e,f);c.la=a.Na}},SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.Od[c.Ny];var e=r.get_selectable_objects();a.Ht=[];a.Rs=[];for(var f in a.zc){var g=r.oc(r.Cc,a.zc[f],0),h=e.indexOf(g);if(-1==h){z.error("logic script error: non-selectable object:",
a.zc[f][a.zc[f].length-1]);break a}a.Ht.push(h);a.Rs.push(a.pO[f])}a.state=-1;a.It=e.length;f=[];for(h=0;h<e.length;h++)f.push(H.create_selection_sensor(e[h],!1));e=d();H.create_sensor_manifold(g,"LOGIC_NODES_SWITCH_SELECT_"+x(a.label),H.CT_SHOT,f,H.default_OR_logic_fun,e,[a,b,c])}break;case 2:if(-1==a.state){b=b.Od[c.Ny].V;for(g=0;g<b.length;g++)e=b[g],"SWITCH_SELECT"==e.type&&(e.state=-1);a.state=-2}if(0==a.state||1==a.state)c.la=a.state?a.hq:a.Na,a.state=-1}},SELECT:function(a,b,d){switch(b.state){case 1:d=
b.Od[d.Ny];var e=v(a),f=r.get_selectable_objects(),g=f.indexOf(e);if(-1==g)z.error("logic script error: non-selectable object:",a.Wo[a.Wo.length-1]);else{a.state=-1;a.It=f.length;a.eE=g;for(var g=[],h=0;h<f.length;h++)g.push(H.create_selection_sensor(f[h],!1));f=c();H.create_sensor_manifold(e,"LOGIC_NODES_SELECT_"+x(a.label),H.CT_SHOT,g,H.default_OR_logic_fun,f,[a,b,d])}break;case 2:0==a.state||1==a.state?(d.la=a.state?a.hq:a.Na,a.state=-1):a.T.not_wait&&(d.la=a.Na)}},PLAY:function(a,b,c,d){switch(b.state){case 1:u.By();
a.state=-1;a.T.not_wait||(a.T.not_wait=!1);break;case 2:switch(a.state){case -1:if(u.is_play(b.na))if(b.Rv==b.nl&&c.df)break;else{var e=b.nl;if(e){e.qf.la=e.V[e.qf.la].Na;e.V[e.qf.la].state=-1;for(var e=b.nl.V,f=0;f<e.length;f++){var g=e[f];"PLAY"==g.type&&(g.state=-1)}}}c.df=!a.T.not_wait;b.nl=b.Rv;a.state=0;a.wM&&(u.vQ(a.sa),u.pE(d));if(a.vM)u.my(a.Za);else{d=u.get_frame(d);var e=-1,h;for(h in b.iq)if(d<b.iq[h]){e=h;break}0<=e?u.my(b.iq[e]):u.my(u.get_frame_end())}u.FD(null);a.T.not_wait&&(c.la=
a.Na,a.state=-1,c.df=!1);break;case 0:u.is_play()||(c.la=a.Na,a.state=-1,c.df=!1);break;case 1:c.la=a.Na;a.state=-1;b.nl=null;c.df=!1;break;default:G.D("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.T.url?h(g(a.W.url,b.G,c.G),1):a.Gi.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.W.v1[1]?a.zb.inp1:h(g(a.W.v1,b.G,c.G),0),e=-1==a.W.v2[1]?a.zb.inp2:h(g(a.W.v2,b.G,c.G),0),f=0;switch(a.WO){case 3:f=d+e;break;case 2:f=
d*e;break;case 1:f=d-e;break;case 0:0==e&&G.D("Division by zero in Logic script");f=d/e;break;case 4:f=Math.random()*(e-d)+d;break;case 5:f=Math.sin(d);break;case 6:f=Math.cos(d);break;case 7:f=Math.tan(d);break;case 8:f=Math.asin(d);break;case 9:f=Math.acos(d);break;case 10:f=Math.atan(d);break;case 11:f=Math.log(d);break;case 12:f=Math.min(d,e);break;case 13:f=Math.max(d,e);break;case 14:f=Math.round(d);break;case 15:f=d%e;break;case 16:f=Math.abs(d)}n(a.W.vd,b.G,c.G,f);c.la=a.Na}},CONDJUMP:function(a,
b,c){switch(b.state){case 2:var d=a.T.str?1:0,e=a.T.str?a.Gi:a.zb,f=-1==a.W.v1[1]?e.inp1:h(g(a.W.v1,b.G,c.G),d);b=-1==a.W.v2[1]?e.inp2:h(g(a.W.v2,b.G,c.G),d);d=!1;switch(a.Zd.condition){case 5:f==b&&(d=!0);break;case 4:f!=b&&(d=!0);break;case 3:f<b&&(d=!0);break;case 2:f>b&&(d=!0);break;case 1:f<=b&&(d=!0);break;case 0:f>=b&&(d=!0)}c.la=d?a.hq:a.Na}},REGSTORE:function(a,b,c){switch(b.state){case 2:n([a.T.gl||a.W.vd[0],a.W.vd[1]],b.G,c.G,(1==a.Zd.variable_type?a.Gi:a.zb).inp1),c.la=a.Na}},PLAY_ANIM:function(a,
b,c){switch(b.state){case 1:a.obj=a.T.env?r.get_world_by_name(a.Wo[0],0):v(a);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:switch(0!=a.state||k.is_play(a.obj,a.qc)||(a.state=1),a.state){case -1:for(var d in b.Od){var e=b.Od[d].qf.la;-1!=e&&(e=b.Od[d].V[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}b=a.Zd.param_anim_behavior;if(""==a.yf)k.apply_def(a.obj),k.set_behavior(a.obj,b,k.SLOT_ALL);else{a:{d=a.obj;for(var e=a.yf,f=-1,
g=0;8>g;g++){var h=d.fa[g];if(h&&h.Rh&&k.UE(h.Rh)==k.UE(e))if(-1!=f)f=g;else{d=-1;break a}}d=f}-1==d?(a.qc=k.MQ(a.obj,a.yf),k.apply(a.obj,null,a.yf,a.qc)):a.qc=d;k.set_behavior(a.obj,b,a.qc)}a.T.not_wait||(c.df=!0);k.play(a.obj,null,a.qc);a.state=0;a.T.not_wait&&(c.la=a.Na,a.state=-1);break;case 0:break;case 1:a.T.not_wait||(c.df=!1);c.la=a.Na;a.state=-1;break;default:G.D("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:B,SEND_REQ:function(a,b,c){function d(a,d,e,f,g){a=JSON.stringify(a);n(g[0].W.dst,
b.G,c.G,a);g[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var e=a.T.url?h(g(a.W.url,b.G,c.G),1):a.Gi.url,k={};a.T.ct&&(k["Content-Type"]=a.Gi.ct);"GET"==a.Zd.request_type?f.enqueue([{id:e,type:f.AT_JSON,url:e,Jj:k,vb:[a,c.G]}],d,null,null,null):"POST"==a.Zd.request_type&&f.enqueue([{id:e,type:f.AT_JSON,url:e,Jj:k,request:"POST",ul:f.AT_JSON,Mj:h(g(a.W.dst1,b.G,c.G),1),vb:[a,c.G]}],d,null,null,null);break;case 1:a.state=-1,c.la=a.Na}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=
0;2>b;b++)a.$a["id"+b]=r.oc(r.Cc,a.zc["id"+b],0),a.$a["id"+b]||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:r.inherit_material(a.$a.id0,a.ix.id0,a.$a.id1,a.ix.id1),c.la=a.Na}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.zc.id0&&(a.$a.id0=r.oc(r.Cc,a.zc.id0,0),a.zc.id0||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0),a.oD.id0.unshift(a.ix.id0));break;case 2:var d=a.$a.id0,e=a.oD.id0,f=e[0],k=C.Oa(d,f,"MAIN");c.la=
a.Na;if(null===k)z.error('Material "'+f+'" was not found in the object "'+d.name+'".');else{if("ShaderNodeRGB"==a.xE){var m=C.oh(k.hf,e);C.set_nodemat_rgb(d,f,m,a.T.id0?h(g(a.W.id0,b.G,c.G),0):a.zb.id0,a.T.id1?h(g(a.W.id1,b.G,c.G),0):a.zb.id1,a.T.id2?h(g(a.W.id2,b.G,c.G),0):a.zb.id2)}"ShaderNodeValue"==a.xE&&(m=C.oh(k.jf,e),C.set_nodemat_value(d,f,m,a.T.id0?h(g(a.W.id0,b.G,c.G),0):a.zb.id0))}}},DELAY:function(a,b,c,d,e){switch(b.state){case 2:-1==a.state?(a.state=0,a.fu=0,c.df=!0):0==a.state&&(a.fu+=
e,(a.T.dl?h(g(a.W.dl,b.G,c.G),0):a.zb.dl)<a.fu&&(a.state=-1,c.la=a.Na,c.df=!1))}},APPLY_SHAPE_KEY:function(a,b,c){switch(b.state){case 1:b=a.$a.id0=r.oc(r.Cc,a.zc.id0,0);b||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);c=a.Zd.sk;t.check_shape_keys(b)?t.Lw(b,c)||(z.error("Wrong key name:",c),a.mute=!0):(z.error("No shape keys in object:",b.name),a.mute=!0);break;case 2:t.bv(a.$a.id0,a.Zd.sk,a.T.skv?h(g(a.W.skv,b.G,c.G),0):a.zb.skv),c.la=a.Na}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=
a.$a.id0=r.oc(r.Cc,a.zc.id0,0);d||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);d&&d.o&&d.o.Ic||(z.error("Can't evaluate 'Outline' logic node: wrong object"),a.mute=!0);break;case 2:d=a.$a.id0;switch(a.Zd.outline_operation){case "PLAY":b=d.o.zh;r.apply_outline_anim(d,b.Gj,b.Hj,b.Ij);break;case "STOP":r.clear_outline_anim(d);break;case "INTENSITY":d.o.Jg=a.T["in"]?h(g(a.W["in"],b.G,c.G),0):a.zb["in"]}c.la=a.Na}},MOVE_CAMERA:function(a,b,c){function d(a,b,c,d){switch(F.get_move_style(a)){case F.MS_TARGET_CONTROLS:F.ny(a,
b,c);break;case F.MS_EYE_CONTROLS:case F.MS_STATIC:Y.set_tsr(a,d);break;case F.MS_HOVER_CONTROLS:E.sub(c,b,V),E.normalize(V,V),F.nE(a,c),K[0]=V[0],K[1]=0,K[2]=V[2],b=E.dot(K,V),c=Math.acos(b/(E.length(K)*E.length(V))),b=V[2]?Math.atan(V[0]/V[2]):0<V[0]?0:Math.PI,0<V[2]&&0<V[0]?ba[1]=-(Math.PI+ba[1]):0<V[2]&&0>V[0]?ba[1]=-(Math.PI+ba[1]):0>V[2]&&0>V[0]?(ba[0]+=Math.PI,b=-(Math.PI-b)):0>V[2]&&0<V[0]&&(ba[0]+=Math.PI,b-=Math.PI),F.fy(a,b+Math.PI,-c,!0,!0)}Y.L(a);I.sync_transform(a)}function e(a,b,c,
d){A.lookAt(b,c,G.AXIS_Z,X);A.invert(X,X);m.fromMat4(X,oa);p.fromMat3(oa,W);p.normalize(W,W);a=R.get_scale(a.o.v);R.set_sep(b,a,W,d)}switch(b.state){case 1:var f=null,f=a.$a.ca=r.oc(r.Cc,a.zc.id0,0);f||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.$a.tr=r.oc(r.Cc,a.zc.id1,0);a.$a.tr||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.$a.ta=r.oc(r.Cc,a.zc.id2,0);a.$a.ta||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=
!0);a.state=-1;a.kc={oF:new Float32Array(3),nF:new Float32Array(3),Uw:new Float32Array(3),Jy:new Float32Array(3),dF:new Float32Array(3),Tw:new Float32Array(3),$j:new Float32Array(8),Ih:new Float32Array(8),qp:new Float32Array(8)};break;case 2:var k=a.$a.ca,f=R.get_trans_view(a.$a.tr.o.v),l=R.get_trans_view(a.$a.ta.o.v);switch(a.state){case -1:b=a.T.dur?h(g(a.W.dur,b.G,c.G),0):a.zb.dur;if(0==b){e(k,f,l,a.kc.Ih);d(k,f,l,a.kc.Ih);c.la=a.Na;break}c=R.get_trans_view(k.o.v);E.copy(c,a.kc.oF);var n=F.get_move_style(k);
n==F.MS_HOVER_CONTROLS?E.copy(k.o.fc,a.kc.Jy):n==F.MS_STATIC||n==F.MS_EYE_CONTROLS?(R.copy(k.o.v,a.kc.$j),e(k,f,l,a.kc.Ih)):E.copy(k.o.pivot,a.kc.Jy);E.copy(f,a.kc.nF);E.copy(l,a.kc.dF);a.state=0;var t=y.animate(0,1,1E3*b,function(b){J.xa()&&(n==F.MS_STATIC||n==F.MS_EYE_CONTROLS?R.interpolate(a.kc.$j,a.kc.Ih,G.smooth_step(b),a.kc.qp):(a.kc.Tw=E.lerp(a.kc.Jy,a.kc.dF,G.smooth_step(b),a.kc.Tw),a.kc.Uw=E.lerp(a.kc.oF,a.kc.nF,G.smooth_step(b),a.kc.Uw)),d(k,a.kc.Uw,a.kc.Tw,a.kc.qp),1==b&&(a.state=1))});
break;case 1:y.clear_animation(t),a.state=-1,c.la=a.Na}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 1:var d;d=a.$a.ca=r.oc(r.Cc,a.zc.id0,0);d||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);b=d.o;a.KJ={Yj:b.Yj,use_panning:b.use_panning,Bb:b.Bb,Da:b.Da,ub:b.ub,bd:b.bd,cd:b.cd,Dd:b.Dd,jh:b.jh};break;case 2:d=a.$a.ca;var e=d.o,f=a.KJ;F.Kq(d);switch(a.Zd.camera_move_style){case 0:e.kb=F.MS_STATIC;break;case 2:e.kb=F.MS_EYE_CONTROLS;var k=R.get_trans_view(e.v);
F.tE(d,k,null,f.Bb,f.Da);break;case 3:e.kb=F.MS_HOVER_CONTROLS;var k=R.get_trans_view(e.v),m=V;a.T.pvo?(m=r.oc(r.Cc,a.zc.id1,0),m=R.get_trans_view(m.o.v)):(m[0]=a.T.pvx?h(g(a.W.pvx,b.G,c.G),0):a.zb.pvx,m[1]=a.T.pvy?h(g(a.W.pvy,b.G,c.G),0):a.zb.pvy,m[2]=a.T.pvz?h(g(a.W.pvz,b.G,c.G),0):a.zb.pvz);F.uE(d,k,m,f.ub,f.Da,f.bd,f.cd,f.jh);break;case 1:e.kb=F.MS_TARGET_CONTROLS,k=R.get_trans_view(e.v),m=V,a.T.pvo?(m=r.oc(r.Cc,a.zc.id1,0),m=R.get_trans_view(m.o.v)):(m[0]=a.T.pvx?h(g(a.W.pvx,b.G,c.G),0):a.zb.pvx,
m[1]=a.T.pvy?h(g(a.W.pvy,b.G,c.G),0):a.zb.pvy,m[2]=a.T.pvz?h(g(a.W.pvz,b.G,c.G),0):a.zb.pvz),F.vE(d,k,m,f.Bb,f.Da,f.ub,f.Dd,f.use_panning)}K[0]=a.T.vtr?h(g(a.W.vtr,b.G,c.G),0):a.zb.vtr;K[1]=a.T.vro?h(g(a.W.vro,b.G,c.G),0):a.zb.vro;K[2]=a.T.vzo?h(g(a.W.vzo,b.G,c.G),0):a.zb.vzo;K[0]=G.clamp(K[0],0,Infinity);K[1]=G.clamp(K[1],0,Infinity);K[2]=G.clamp(K[2],0,.99);e.An=K[0];e.zn=K[1];e.Bn=K[2];Y.L(d);I.sync_transform(d);F.Am(d);c.la=a.Na}},MOVE_TO:function(a,b,c){function d(a,b){Y.set_tsr(a,b);Y.L(a);
I.sync_transform(a)}switch(b.state){case 1:a.$a.ob=r.oc(r.Cc,a.zc.id0,0);a.$a.ob||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.$a.de=r.oc(r.Cc,a.zc.id1,0);a.$a.de||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);a.state=-1;a.$b={yB:new Float32Array(8),Yv:new Float32Array(8),BC:new Float32Array(8)};break;case 2:var e=a.$a.ob;R.copy(a.$a.ob.o.v,a.$b.yB);R.copy(a.$a.de.o.v,a.$b.Yv);switch(a.state){case -1:b=a.T.dur?h(g(a.W.dur,b.G,c.G),0):a.zb.dur;
if(0==b){d(e,a.$b.Yv);c.la=a.Na;break}a.state=0;var f=y.animate(0,1,1E3*b,function(b){J.xa()&&(a.$b.tU=R.interpolate(a.$b.yB,a.$b.Yv,G.smooth_step(b),a.$b.BC),d(e,a.$b.BC),1==b&&(a.state=1))});break;case 1:y.clear_animation(f),a.state=-1,c.la=a.Na}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?Y.set_tsr(a,b):Y.set_tsr_rel(a,b);Y.L(a);I.sync_transform(a)}switch(b.state){case 1:a.$a.ob=r.oc(r.Cc,a.zc.id0,0);a.$a.ob||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=
!0);a.state=-1;a.$b={Ut:0,$j:new Float32Array(8),Ih:new Float32Array(8),qp:new Float32Array(8)};break;case 2:var e=a.$a.ob;switch(a.state){case -1:K[0]=a.T.trx?h(g(a.W.trx,b.G,c.G),0):a.zb.trx;K[1]=a.T["try"]?h(g(a.W["try"],b.G,c.G),0):a.zb["try"];K[2]=a.T.trz?h(g(a.W.trz,b.G,c.G),0):a.zb.trz;V[0]=a.T.rox?h(g(a.W.rox,b.G,c.G),0)*Math.PI/180:a.zb.rox;V[1]=a.T.roy?h(g(a.W.roy,b.G,c.G),0)*Math.PI/180:a.zb.roy;V[2]=a.T.roz?h(g(a.W.roz,b.G,c.G),0)*Math.PI/180:a.zb.roz;var f=a.T.sc?g(a.W.sc,b.G,c.G):a.zb.sc;
G.euler_to_quat(V,W);R.set_sep(K,f,W,a.$b.Ih);a.$b.Ut=a.Zd.space_type;switch(a.$b.Ut){case 0:Y.get_tsr(e,a.$b.$j);break;case 1:Y.get_tsr_rel(e,a.$b.$j);break;case 2:Y.get_tsr_rel(e,a.$b.$j),R.multiply(a.$b.$j,a.$b.Ih,a.$b.Ih)}b=a.T.dur?h(g(a.W.dur,b.G,c.G),0):a.zb.dur;if(0==b){d(e,a.$b.Ih,a.$b.Ut);c.la=a.Na;break}a.state=0;f=y.animate(0,1,1E3*b,function(b){J.xa()&&(R.interpolate(a.$b.$j,a.$b.Ih,G.smooth_step(b),a.$b.qp),d(e,a.$b.qp,a.$b.Ut),1==b&&(a.state=1))});break;case 1:y.clear_animation(f),a.state=
-1,c.la=a.Na}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.obj=r.oc(r.Cc,a.zc.id0,0);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);void 0==a.T.not_wait&&(a.T.not_wait=!0);break;case 2:switch(Q.is_playing(a.obj)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.Od){var e=b.Od[d].qf.la;-1!=e&&(e=b.Od[d].V[e],"SPEAKER_PLAY"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}a.T.not_wait||(c.df=!0);Q.play_def(a.obj);a.state=0;break;case 0:a.T.not_wait&&
(c.la=a.Na,a.state=-1);break;case 1:a.T.not_wait||(c.df=!1);c.la=a.Na;a.state=-1;break;default:G.D("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.obj=r.oc(r.Cc,a.zc.id0,0);a.obj||(z.error("Logic script error: object not found. Node: ",a.name),a.mute=!0);break;case 2:Q.stop(a.obj),c.la=a.Na}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.T.env?r.get_world_by_name(a.Wo[0],0):v(a);a.obj||(z.error("Logic script error: object not found. Node: ",
a.name),a.mute=!0);break;case 2:k.stop(a.obj,k.SLOT_ALL),a.T.rst&&k.set_first_frame(a.obj,k.SLOT_ALL),c.la=a.Na}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.T.rst&&u.pE(d),u.By(),c.la=a.Na}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},e;for(e in a.W)d[a.W[e][1]]=g(a.W[e],b.G,c.G);z.log(a.Zd.msg,JSON.stringify(d));c.la=a.Na}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.T.id0?h(g(a.W.id0,b.G,c.G),1):a.Gi.id0,e=a.T.id1?h(g(a.W.id1,b.G,c.G),1):a.Gi.id1,f=0;switch(a.Zd.string_operation){case 0:f=
d+e;break;case 1:f=d.indexOf(e);break;case 2:f=d.replace(e,a.T.id2?h(g(a.W.id2,b.G,c.G),1):a.Gi.id2);break;case 3:var k=a.W,f=d.substring(0,d.indexOf(e));n(k.dst1,b.G,c.G,d.substring(d.indexOf(e)+1,d.length));""==g(k.dst,b.G,c.G)&&(f=g(k.dst1,b.G,c.G),n(k.dst1,b.G,c.G,""));break;case 4:switch(a.Zd.condition){case 5:f=d==e?1:0;break;case 4:f=d!=e?1:0;break;case 3:f=d<e?1:0;break;case 2:f=d>e?1:0;break;case 1:f=d<=e?1:0;break;case 0:f=d>=e?1:0}}n(a.W.dst,b.G,c.G,f);c.la=a.Na}},GET_TIMELINE:function(a,
b,c,d){switch(b.state){case 2:d=a.T.nla?h(u.get_frame(d),0):h(y.get_frame(d),0),n(a.W.vd,b.G,c.G,d),c.la=a.Na}},JSON:function(a,b,c){function d(a,b,c,d){for(var e=0;e<b.length;e++){for(var f=b[e].split("."),g=a,h=c[e],k=0;k<f.length&&(g=g[f[k]],void 0!==g&&null!==g);k++);g=l(g);d[h]=g}}function e(a,b,c,d){d||(d={});for(var e=0;e<b.length;e++){var f=b[e].split("."),g=d,h=c[e];if(h in a){for(var k=0;k<f.length-1;k++)void 0===g[f[k]]&&(g[f[k]]=isNaN(f[k+1])?{}:[]),g=g[f[k]];g[f[f.length-1]]=l(a[h])}}}
switch(b.state){case 2:switch(a.Zd.json_operation){case "PARSE":try{var f=JSON.parse(h(g(a.W.jsn,b.G,c.G),1));d(f,a.$O,a.aP,c.G)}catch(ka){z.error("logic script error: non valid JSON string")}break;case "ENCODE":f={},e(c.G,a.WL,a.XL,f),f=h(JSON.stringify(f),1),n(a.W.jsn,b.G,c.G,f)}c.la=a.Na}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var d=a.T.cb?h(g(a.W.cb,b.G,c.G),1):a.Gi.cb,e=[],f=0,k="id"+f,m=a.Zd.js_cb_params;k in m;)k=0==m[k]?r.oc(r.Cc,a.zc[k],0):g(a.W[k],b.G,c.G),e.push(k),f++,
k="id"+f;m=[];f=0;for(k="out"+f;k in a.W;)k=g(a.W[k],b.G,c.G),m.push(k),f++,k="out"+f;f=1;if(d in ca){if(f=!ca[d](e,m))for(d=0;d<m.length;d++)k="out"+d,k in a.W&&n(a.W[k],b.G,c.G,l(m[d]))}else z.error("logic script error: no custom callback with id "+d);f&&(c.la=a.Na)}},EMPTY:B},Z=[],ca={},da={};a.FN=function(a,b){var c={ud:b,cE:a.name,state:0,nl:null,pb:a,Rv:null,Od:[],iq:[],G:{}};a.fT=c;w(a,c)};a.update=function(a,b){var c=u.tN();if(!(0>=c))for(var d=0;d<Z.length;d++)for(var e=d,f=a,g=b,h=c,k=Z[e],
m=0;m<Z[e].Od.length;m++){k.Rv=Z[e].Od[m];var l=Z[e].Od[m],n=k,p=f,t=g,r=h,v=l.V;if(v.length){for(var w=0;w<v.length;w++)v[w].At=!1;for(w=0;w<v.length;w++){if(0<=l.qf.la)var B=v[l.qf.la];else break;if(B.At)break;if(B.mute)if("ENTRYPOINT"==B.type)break;else l.qf.la=B.Na,B.At=!0;else B.ID(B,n,l.qf,p,t,r),B.At=!0}}}};a.HI=function(a,b){ca[a]=b};a.wP=function(a){delete ca[a]};a.RP=function(a,b){for(var c=0;c<Z.length;c++)if(Z[c].cE==a){for(var c=Z[c],d=0;d<c.Od.length;d++){var e=c.Od[d].V[0];if(e.name==
b){e.T.js&&(e.mute=!1);c.Od[d].qf.la=0;break}}break}};a.cleanup=function(){Z.length=0;ca={};da={}}};b4w.module.__main=function(a,q){function d(a,b,d){var e=c.get_canvas();if(e.toBlob)e.toBlob(a,b,d);else{d=atob(e.toDataURL(b,d).split(",")[1]);for(var e=new Uint8Array(d.length),g=0;g<d.length;g++)e[g]=d.charCodeAt(g);a(new Blob([e],{type:b||"image/png"}))}}var c=q("__container"),b=null,g="image/png",n=1,B="",e=!1,v=!1;a.canvas_data_url=function(a,c,d,B){e=v="undefined"===typeof B?B:!0;b=a;g=c||g;n=d||n};a.frame=function(){var a=b;a&&(e&&URL.revokeObjectURL(B),d(function(b){B=URL.createObjectURL(b);
a(B)},g,n),b=null,g="image/png",n=1)}};b4w.module.__math=function(a,q){function d(a,b){for(var c=a[1],d=1,e=2;e<a.length;e++)4!=e&&8!=e&&Math.abs(a[e])>Math.abs(c)&&(c=a[e],d=e);for(var g=Math.floor(d/3),d=d%3,c=.5*Math.atan(2*c/(a[3*g+g]-a[3*d+d])),e=0;e<b.length;e++)b[e]=e&&4!=e&&8!=e?0:1;b[d+3*g]=-Math.sin(c);b[g+3*d]=Math.sin(c);b[g+3*g]=Math.cos(c);b[d+3*d]=Math.cos(c);return b}function c(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}function b(a,b){for(var c=a.content[b];0<b;){var d=(b+1>>1)-1,e=a.content[d];if(a.yl(c)<a.yl(e))a.content[d]=
c,a.content[b]=e,b=d;else break}}function g(a,b){for(var c=a.content.length,d=a.content[b],e=a.yl(d);;){var g=b+1<<1,h=g-1,k=null;if(h<c){var l=a.yl(a.content[h]);l<e&&(k=h)}g<c&&a.yl(a.content[g])<(null===k?e:l)&&(k=g);if(null!==k)a.content[b]=a.content[k],a.content[k]=d,b=k;else break}}var n=q("__mat3"),B=q("__vec3"),e=new Float32Array(3),v=new Float32Array(9),w=new Float32Array(9),h=new Float32Array(9),l=new Float32Array(9);a.get_pline_directional_vec=function(a,b){b=b||new Float32Array(3);b[0]=
a[3];b[1]=a[4];b[2]=a[5];return b};a.get_pline_initial_point=function(a,b){b=b||new Float32Array(3);return B.copy(a,b)};a.set_pline_initial_point=function(a,b){B.copy(b,a)};a.set_pline_directional_vec=function(a,b){B.normalize(b,e);a[3]=e[0];a[4]=e[1];a[5]=e[2]};a.calc_pline_point=function(a,b,c){c=c||new Float32Array(3);c[0]=a[0]+a[3]*b;c[1]=a[1]+a[4]*b;c[2]=a[2]+a[5]*b;return c};a.IJ=function(a,b){b[0]=0;b[1]=0;for(var c=b[2]=0;c<a.length;c+=3)b[0]+=a[c],b[1]+=a[c+1],b[2]+=a[c+2];return B.scale(b,
3/a.length,b)};a.DJ=function(a,b,c){for(var d=0;d<c.length;d++)c[d]=0;for(d=0;d<a.length;d+=3){var e=a[d]-b[0],f=a[d+1]-b[1],g=a[d+2]-b[2];c[0]+=e*e;c[1]+=e*f;c[2]+=e*g;c[4]+=f*f;c[5]+=f*g;c[8]+=g*g}c[3]=c[1];c[6]=c[2];c[7]=c[5];for(d=0;d<c.length;d++)c[d]*=3/a.length;return c};a.mM=function(a,b){var e=n.copy(a,v);if(5E-4>c(e))return n.identity(b);var g=d(e,w),k=n.transpose(g,h);n.multiply(e,k,l);n.multiply(g,l,e);for(var r=n.copy(g,b),B=1;5E-4<=c(e)&&100>B;)g=d(e,w),k=n.transpose(g,h),n.multiply(e,
k,l),n.multiply(g,l,e),n.multiply(g,r,r),B++;return r};a.point_plane_dist=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]};a.pJ=function(a){return{content:[],yl:a}};a.wA=function(a,c){a.content.push(c);b(a,a.content.length-1)};a.qJ=function(a){var b=a.content[0],c=a.content.pop();0<a.content.length&&(a.content[0]=c,g(a,0));return b};a.pT=function(a,c){var d=a.content.indexOf(c),e=a.content.pop();d!==a.content.length-1&&(a.content[d]=e,a.yl(e)<a.yl(c)?b(d):g(d))};a.rJ=function(a,c){b(a,a.content.indexOf(c))}};b4w.module.__navmesh=function(a,q){function d(a,c){function d(a){var b=a[0];a[0]=a[1];a[1]=a[2];a[2]=b}for(var e=a.ek,f=c.ek,g=[],h=0;h<e.length;h++)0<=b(f,e[h])&&g.push(e[h]);if(2>g.length)return[];0<=b(g,e[0])&&0<=b(g,e[e.length-1])&&d(e);0<=b(g,f[0])&&0<=b(g,f[f.length-1])&&d(f);g=[];for(h=0;h<e.length;h++)0<=b(f,e[h])&&g.push(e[h]);return g}function c(a){function b(a){for(var c=a.Pf,d=0;d<c.length;d++){var e=c[d];void 0==e.island&&(e.island=a.island,b(e))}}a=a.kP;for(var c=[],d=0,e=0;e<a.length;e++){var f=
a[e];void 0==f.island&&(f.island=d++,b(f));c[f.island]||(c[f.island]=[]);c[f.island].push(a[e])}return c}function b(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]==b)return c;return-1}function g(a){function b(a,b){for(var c=0;c<a.length;c++)if(b===a[c])return c}for(var e={},f=a.Dn,g=0;g<f.length;g++)f[g][0]=parseFloat(f[g][0].toFixed(2)),f[g][1]=parseFloat(f[g][1].toFixed(2)),f[g][2]=parseFloat(f[g][2].toFixed(2));e.Dn=a.Dn;a=c(a);e.Xw=[];for(g=0;g<a.length;g++){for(var f=
[],h=a[g],k=0;k<h.length;k++){for(var m=[],l=h[k],n=0;n<l.Pf.length;n++)m.push(b(h,l.Pf[n]));for(var p=[],n=0;n<l.Pf.length;n++)p.push(d(l,l.Pf[n]));l.Oc[0]=parseFloat(l.Oc[0].toFixed(2));l.Oc[1]=parseFloat(l.Oc[1].toFixed(2));l.Oc[2]=parseFloat(l.Oc[2].toFixed(2));f.push({id:b(h,l),Pf:m,ek:l.ek,Oc:l.Oc,Hc:l.Hc,lP:p,lw:0,hp:0,Ab:0,uK:1,kz:!1,closed:!1,parent:null})}e.Xw.push(f)}return e}function n(a,b,c,d,e){function f(a,b){z.subtract(a,b,D);return z.dot(D,D)}function g(a,b){for(var c=[],d=0;d<b.Pf.length;d++)c.push(a[b.Pf[d]]);
return c}(function(a){for(var b=0;b<a.length;b++){var c=a[b];c.lw=0;c.hp=0;c.Ab=0;c.uK=1;c.kz=!1;c.closed=!1;c.parent=null}})(a);var h=F.pJ(function(a){return a.lw});for(F.wA(h,b);0<h.content.length;){var k=F.qJ(h);if(k===c){a=k;for(c=[];a.parent;)c.push(a),a=a.parent;c.push(b);return c.reverse()}k.closed=!0;for(var m=g(a,k),l=0,n=m.length;l<n;l++){var p=m[l];if(!p.closed){var t=k.hp+z.dist(p.Oc,k.Oc),r=p.kz;if(!r||t<p.hp)p.kz=!0,p.parent=k,p.Ab=p.Ab||f(p.Oc,e)+f(p.Oc,d),p.hp=t,p.lw=p.hp+p.Ab,r?F.rJ(h,
p):F.wA(h,p)}}}return[]}function B(a,b){a.push(b[0]);a.push(b[1]);a.push(b[2])}function e(a,b,c,d){b=z.subtract(b,a,D);a=z.subtract(c,a,H);a=z.cross(b,a,D);return r.sign(z.dot(d,a))}function v(a,b){z.subtract(a,b,D);return 1E-5>z.dot(D,D)}function w(a,b,c){var d=z.subtract(b.right,b.left,D),e=c.Hc,f=b.Hc;c=Math.acos(z.dot(e,f));e=r.sign(z.dot(d,z.cross(e,f,H)));c*=-e;e=u.identity(p);u.translate(e,b.left,e);u.rotate(e,c,d,e);u.translate(e,z.scale(b.left,-1,H),e);u.multiply(a,e,a)}function h(a,b,c,
d,e,f,g,h,k){for(var l=u.identity(A),p=e;p<c;p++)if(a[p].HC&&(p>e||!p)){var n,r=b,v=d;n=a[p].left;var y=a[p].right,K=f,E=l,q=z.create(),x=z.transformMat4(n,E,C);x[3]=1;E=z.transformMat4(y,E,D);E=z.subtract(E,x,t);r=z.subtract(v,r,D);K=z.cross(K,r,m);.01>Math.abs(z.dot(K,E))?v=.5:(z.normalize(K,K),K[3]=-z.dot(K,v),v=-J.dot(K,x)/J.dot(K,E));y=z.subtract(y,n,D);n=z.scaleAndAdd(n,y,v,q);B(g,n);h&&B(k,a[p].Hc);p&&w(l,a[p],a[p-1])}}function l(a,b){function c(b,c){A=r=t=c;m=k=g=b;z.copy(b,l);z.copy(b,p);
z.copy(a[t].Hc,n)}var d=[],f=[],g,k,m,l,p,n,t=0,r=0,A=0;g=a[0].right;k=a[0].left;m=a[0].right;l=z.copy(k,Q);p=z.copy(m,y);n=z.copy(a[0].Hc,G);B(d,g);b&&B(f,a[0].Hc);for(var E=u.identity(I),q=1;q<a.length;q++){var x=a[q].left,C=a[q].right,F=z.transformMat4(x,E,Y),D=z.transformMat4(C,E,R);a[q].HC&&w(E,a[q],a[q-1]);if(0>=e(g,p,D,n)){var H=v(g,m);if(H||0<e(g,l,D,n))m=C,z.copy(D,p),A=q;else{(x=v(l,g))||h(a,l,r,g,t,n,d,b,f);E=u.identity(E);c(k,r);q=t;x||(B(d,g),b&&B(f,a[q].Hc));continue}}0<=e(g,l,F,n)&&
((H=v(g,k))||0>e(g,p,F,n)?(k=x,z.copy(F,l),r=q):((x=v(p,g))||h(a,p,A,g,t,n,d,b,f),E=u.identity(E),c(m,A),q=t,x||(B(d,g),b&&B(f,a[q].Hc))))}E=a.length-1;q=a[E].left;(x=v(g,q))||h(a,l,E,g,t,n,d,b,f);x&&t||B(d,q);return b?(B(f,a[E].Hc),{positions:new Float32Array(d),normals:new Float32Array(f)}):{positions:new Float32Array(d),normals:null}}function x(a,b,c,d,e){for(var f=null,g=Number.MAX_VALUE,h=0;h<a.length;h++){var k=a[h],m=e(c,k.Oc,k.ek,b,g);m<g&&(f=k,g=m)}return 0<d&&g>d?null:f}function k(a,b,c,
d,e){a.push({left:b,right:c,HC:d,Hc:e})}var f=q("__geometry"),F=q("__math"),u=q("__mat4"),r=q("__util"),z=q("__vec3"),J=q("__vec4"),D=z.create(),H=z.create(),C=J.create(),t=J.create(),m=J.create(),A=u.create(),I=u.create(),p=u.create(),Q=z.create(),y=z.create(),Y=z.create(),R=z.create(),G=z.create();a.PO=function(a){var b=f.ns(a.Kb,f.Yl),c=a.zd;a=[];for(var d=0;d<c.length;d+=3)a.push({ma:new Uint32Array([c[d],c[d+1],c[d+2]]),Oc:new Float32Array(3),Hc:new Float32Array(3)});c=[];for(d=0;d<b.length;d+=
3){var e=new Float32Array(3);e[0]=b[d];e[1]=b[d+1];e[2]=b[d+2];c.push(e)}for(b=0;b<a.length;b++)d=a[b],z.add(c[d.ma[0]],c[d.ma[1]],D),z.add(D,c[d.ma[2]],D),z.scale(D,1/3,d.Oc);for(b=0;b<a.length;b++){var d=a[b],e=z.subtract(c[d.ma[1]],c[d.ma[0]],D),h=z.subtract(c[d.ma[2]],c[d.ma[0]],H),e=z.cross(e,h,D);z.normalize(e,e);z.copy(e,d.Hc)}for(var k={},b=[],d=[],m,l,p=Math.pow(10,4),e=0,h=c.length;e<h;e++)m=c[e],l=Math.round(m[0]*p)+"_"+Math.round(m[1]*p)+"_"+Math.round(m[2]*p),void 0===k[l]?(k[l]=e,b.push(m),
d[e]=b.length-1):d[e]=d[k[l]];k=[];e=0;for(h=a.length;e<h;e++)for(m=a[e],m.ma[0]=d[m.ma[0]],m.ma[1]=d[m.ma[1]],m.ma[2]=d[m.ma[2]],m=[m.ma[0],m.ma[1],m.ma[2]],l=0;3>l;l++)if(m[l]==m[(l+1)%3]){k.push(e);break}for(e=k.length-1;0<=e;e--)a.splice(k[e],1);for(e=c.length=0;e<b.length;e++)c.push(b[e]);d=[];for(b=e=0;b<a.length;b++)h=a[b],d.push({id:e++,ek:h.ma,Oc:h.Oc,Hc:h.Hc,Pf:[]});a={kP:d,Dn:c};c={};for(b=0;b<d.length;b++)for(e=0;3>e;e++)h=d[b].ek[e],k=d[b].ek[(e+1)%3],h=h>k?k+"-"+h:h+"-"+k,h in c||(c[h]=
[]),c[h].push(d[b]);d=Object.keys(c);b=0;for(k=d.length;b<k;b++)for(h=d[b],e=0;e<c[h].length;e++)for(m=e+1;m<c[h].length;m++)c[h][e].Pf.push(c[h][m]),c[h][m].Pf.push(c[h][e]);return g(a)};a.navmesh_get_island=function(a,b,c){for(var d=null,e=Number.MAX_VALUE,f=a.Xw,g=0;g<f.length;g++)for(var h=0;h<f[g].length;h++){var k=f[g][h];z.subtract(k.Oc,b,D);k=c(b,k.Oc,k.ek,a.Dn,e);k<e&&(d=g,e=k)}return d};a.UN=function(a,b,c){for(var d=[],e=0;e<b.length;e++)d.push(c[b[e]]);b=!1;c=-1;for(var e=d.length,f=e-
1;++c<e;f=c)(d[c][1]<=a[1]&&a[1]<d[f][1]||d[f][1]<=a[1]&&a[1]<d[c][1])&&a[0]<(d[f][0]-d[c][0])*(a[1]-d[c][1])/(d[f][1]-d[c][1])+d[c][0]&&(b=!b);return b?!0:!1};a.navmesh_find_path=function(a,b,c,d){var e;e=a.Xw[d.island];var f=a.Dn,g=x(e,f,b,d.allowed_distance,d.distance_to_closest);e=g?(f=x(e,f,c,d.allowed_distance,d.distance_to_farthest))?n(e,g,f,b,c):null:null;if(e&&e.length)if(d.do_not_pull_string)if(c=e,d.return_normals){b=new Float32Array(3*c.length);for(e=0;e<c.length;e++)b.set(c[e].Oc,3*e);
c={positions:b,normals:null}}else{b=new Float32Array(3*c.length);a=new Float32Array(3*c.length);for(e=0;e<c.length;e++)b.set(c[e].Oc,3*e),a.set(c[e].Hc,3*e);c={positions:b,normals:a}}else{a=a.Dn;d=d.return_normals;g=[];k(g,b,b,!1,e[0]&&e[0].Hc||r.AXIS_Z);for(b=0;b<e.length;b++){var h=e[b];if(f=e[b+1]){var m=.999>Math.abs(z.dot(h.Hc,f.Hc));a:{for(var p=0;p<h.Pf.length;p++)if(h.Pf[p]===f.id){h=h.lP[p];break a}h=void 0}k(g,a[h[0]],a[h[1]],m,f.Hc)}}k(g,c,c,!1,g[g.length-1].Hc);c=l(g,d)}else c=null;return c}};b4w.module.__nla=function(a,q){function d(){return{type:"CLIP",sa:0,Za:0,yi:!1,paused:!1,yf:"",Wn:"",qc:0,Nm:null,Vi:0,jk:0,FB:0,EB:0,LF:!1,scale:1,repeat:1,Zz:0}}function c(a,b,d){if(a.animation_data){var e=a.animation_data.nla_tracks;if(e)for(var f=0;f<e.length;f++)e[f].Nm=d,b.push(e[f])}a=a.nodes;for(f=0;f<a.length;f++)if(e=a[f],e.node_group){var g=e.node_group.node_tree;if(g){var h=d.slice();h.push(e.name);c(g,b,h)}}}function b(a,b){var c=Math.round(a)-b.sa;b.Ni&&(c%=b.jj,0>c&&(c+=b.jj));return b.Mb+
c}function g(a,b){var c=(b-D)*r.ad()+a.Mb;c>a.sa?(c-=a.sa,a.cyclic&&(c%=a.Za-a.sa+1),c+=a.sa):c=a.sa;return c}function n(a,b){a=z.clamp(a,b.sa,b.Za);var c=a==b.Za?b.Zz:b.Vi+(a-b.sa)/b.scale%(b.jk-b.Vi);b.LF&&(c=b.jk-c+b.Vi);return c}function B(a,b){for(var c=[],e=0;e<a.length;e++){var f=a[e],g=f.strips;if(g)for(var h=0;h<g.length;h++){var k=g[h],l=d();l.type=k.type;l.sa=k.frame_start;l.Za=k.frame_end;l.qc=b;l.Vi=k.action_frame_start;l.jk=k.action_frame_end;l.LF=k.use_reverse;l.scale=k.scale;l.repeat=
k.repeat;k.action&&(l.yf=k.action.name,l.Wn=k.action.uuid,l.Nm=f.Nm);c.push(l)}}return c}function e(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function v(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}
function w(a,b){var c=f.get_active();if(c.na){var d=g(c.na,b);c.na.Mb-=d-a;c.na.tm=!0}}var h=q("__animation"),l=q("__objects"),x=q("__obj_util"),k=q("__print"),f=q("__scenes"),F=q("__sfx"),u=q("__textures"),r=q("__time"),z=q("__util"),J=[],D=-1;a.bk=function(a,b){var f,g=null;for(f=b.K.length-1;0<=f;f--){var k=b.K[f];if(k.pb.b4w_use_nla&&(g=k,k.pb.Vz))break}if(f=g){f.tD=!0;var l=0;if((g=a.animation_data)&&g.nla_tracks.length){var p=g.nla_tracks;if(x.is_armature(b)||x.is_camera(b)||x.is_mesh(b)||x.is_empty(b)||
x.is_lamp(b)||x.is_speaker(b)||x.is_world(b))p=B(p,l),p.length&&(b.Qf=b.Qf.concat(p),l++)}e(a)&&(p=a.data.animation_data.nla_tracks,p=B(p,l),p.length&&(b.Qf=b.Qf.concat(p),l++));if(x.is_mesh(b))for(k=a.data.materials,g=0;g<k.length;g++){var n=k[g];if(n.use_nodes&&n.node_tree&&(p=[],c(n.node_tree,p,[n.name]),p=B(p,l),p.length)){for(var n=l,r=p,u=h.PM(),v=[],w=0,q=0;q<r.length;q++){var C=r[q];""!=C.Wn?C=z.keysearch("uuid",C.Wn,u):(C=C.yf,C=z.keysearch("name",C,u)||z.keysearch("name",C+"_B4W_BAKED",
u));if(C){var C=C.fcurves,F=[],K;for(K in C)F.push(K);v.push(F)}}for(q=0;q<v.length;q++){u=!1;for(C=0;C<q;C++)if(z.cJ(v[q],v[C])){r[q].qc=r[C].qc;u=!0;break}u||(r[q].qc=l+w++)}l=n+w;b.Qf=b.Qf.concat(p)}}if(!x.is_world(b)){for(g=0;g<a.particle_systems.length;g++)k=a.particle_systems[g],K=k.settings,"EMITTER"==K.type&&K.b4w_allow_nla&&(K=d(),K.type="CLIP",K.sa=f.pb.frame_start,K.Za=f.pb.frame_end+1,K.yf=k.name,K.qc=l,K.Vi=K.sa,K.jk=K.Za,b.Qf.push(K),l++);f=l+1;for(g=0;g<b.Kc.length;g++)k=b.Kc[g],k.zI&&
(l=f,K=d(),K.type="CLIP",K.sa=k.sa,K.Za=k.Za,K.yf=k.name,K.qc=l,K.Vi=K.sa,K.jk=K.Za,b.Qf.push(K))}}};a.TR=function(a,b,c){a.na||(a.na={sa:a.frame_start,Za:a.frame_end,Mb:0,zp:-1,Sp:a.frame_end,Tp:a.frame_start,Kl:null,cyclic:b,$a:[],Sa:[],cE:a.name,yj:!1,tm:!1,cy:!0},J.push(a.na));b=a.na;for(var e=l.kC(a,"ALL",c),f=0;f<e.length;f++){var g=e[f];if(g.Qf.length){b.$a[c]||(b.$a[c]=[]);for(var h=0;h<g.K.length;h++){var n=g.K[h];n.pb==a&&n.tD&&b.$a[c].push(g)}for(var h=g.Qf,n=b,r=g.name,t=0;t<h.length;t++){var u=
h[t];n.sa>u.Za||n.Za<u.sa?(k.warn("NLA: Strip is out of scene range: "+(r+" ["+u.sa+":"+u.Za+"]")),h.splice(t,1),t--):u.yf||"CLIP"!=u.type||(k.warn('NLA: no action in strip for object "'+r+'".'),h.splice(t,1),t--)}g=g.Qf;h=b;for(n=0;n<g.length;n++){for(var r=g[n],t=h.sa,u=h.Za+1,v=0;v<g.length;v++){var w=g[v];r.qc==w.qc&&(w.Za<=r.sa&&(t=r.sa),w.sa>=r.Za&&(u=Math.min(u,w.sa)))}r.FB=t;r.EB=u;r.Zz=r.repeat%1?r.Vi+r.repeat%1*(r.jk-r.Vi):r.jk}}}a=a.F.En;for(f=0;f<a.length;f++)e=a[f].F,e.ck&&(e.Ta||e.ed)&&
e.Jq==c&&(g=d(),g.type="VIDEO",e.Ni?(g.sa=0,g.Za=b.Za):(g.sa=z.clamp(e.sa,0,b.Za),g.Za=z.clamp(e.sa+e.jj,0,b.Za)),g.yf=a[f].name,b.Sa.push(e))};a.start=function(){D=0};a.tN=function(){return D};a.eU=function(a){return a.na?a.na.Mb:null};a.RU=function(a,b){return a.na?(a.na.Mb=b,!0):!1};a.update=function(a,c){if(!(0>D)){0==D&&(D=a);for(var d=0;d<J.length;d++){var e=J[d];e.yj&&(e.Mb-=r.ad()*c);var f=g(e,a);if((!e.yj||e.tm)&&f>=e.Sp)if(e.cyclic){var f=e,k=a;f.Kl&&f.Kl();w(f.Tp,k);f.cy=!0;f=g(f,k)}else{var k=
e,l=f;k.yj=!0;k.Mb-=l-k.Sp;k.Kl&&k.Kl()}if(!e.yj||e.tm){for(var k=e,l=f,v=0;v<k.$a.length;v++){var B=k.$a[v];if(B)for(var q=0;q<B.length;q++){for(var x=B[q],C=x.Qf,E=0;E<C.length;E++){var H=C[E];"SOUND"==H.type&&l<k.zp-1E-6&&(H.yi=!1)}for(E=0;E<C.length;E++)switch(H=C[E],H.type){case "CLIP":if(H.FB<=l&&l<H.EB&&!H.yi){var v=x,V=H,K=V.Nm;""!=V.Wn?h.YI(v,K,V.Wn,V.qc):h.apply(v,K,V.yf,V.qc);h.set_behavior(v,h.AB_FINISH_STOP,V.qc);K=n(V.sa,V);h.set_frame(v,K,V.qc);for(v=0;v<C.length;v++)C[v]!=H&&C[v].qc==
H.qc&&(C[v].yi=!1);H.yi=!0}H.yi&&(V=x,K=n(l,H),1E-6<Math.abs(K-h.sw(V,H.qc))&&h.set_frame(V,K,H.qc));break;case "SOUND":if((l<k.zp-1E-6||k.zp<H.sa)&&H.sa<=l&&l<H.Za&&!H.yi){var V=x,ba=H,K=(ba.sa-l)/r.ad(),ba=(ba.Za-ba.sa)/r.ad();F.play(V,K,ba);H.yi=!0}k.zp<H.Za&&H.Za<=l&&H.yi&&(H.yi=!1)}}}k=a;l=e;B=f;for(q=0;q<l.Sa.length;q++)if(x=l.Sa[q],x.Ta||x.ed){C=u.VF(x);E=x;H=z.clamp(b(B,E),E.Mb,E.Mb+u.WF(E)-1);E.ed&&(H=u.pS(E,H),H==E.bq&&H--);E=H;H=u.XF(x);V=v=!1;if(l.tm||l.cy)V=!0;l.yj||(K=b(B,x),K=x.Mb<=
K&&K<=x.Mb+u.WF(x),ba=u.YF(x),x.Ni&&E==H&&(V=!0),ba||C==E||(V=!0),K&&!ba?u.play_video(x):K&&ba?v=!0:!K&&ba&&(x.Ta&&C<E?v=!0:u.pause_video(x)));V?(u.hQ(x,E),x.ed&&(x.Rj=u.Jt(x,k))):v&&u.ZF(x)&&(x.Ta?u.DF(x):(C=u.Jt(x,k),C!=x.Rj&&(x.Ai=E,u.CF(x)),x.Rj=C))}e.zp=f}e.tm=!1;e.cy=!1}}};a.cleanup=function(a){if(0==a)J.length=0,D=-1;else for(var b=0;b<J.length;b++)J[b].$a[a]=null};a.CA=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||e(a)||v(a)?!0:!1};a.set_frame=w;a.get_frame=function(a){var b=
f.get_active();return b.na?g(b.na,a):-1};a.By=function(){var a=f.get_active();if(a.na){a.na.yj=!0;for(var a=a.na.Sa,b=0;b<a.length;b++)u.pause_video(a[b])}};a.FD=function(a){var b=f.get_active();b.na&&(b.na.yj=!1,a?b.na.Kl=a:b.na.Kl=null)};a.get_frame_start=function(){var a=f.get_active();return a.na?a.na.sa:-1};a.get_frame_end=function(){var a=f.get_active();return a.na?a.na.Za:-1};a.is_play=function(){var a=f.get_active();return a.na?!a.na.yj:!1};a.check_nla=function(){var a=f.get_active();return a.na?
a.b4w_use_nla:!1};a.check_logic_nodes=function(){var a=f.get_active();return a.na?0<a.b4w_logic_nodes.length:!1};a.set_range=function(a,b){var c=f.get_active();if(c.na)c.na.Tp=a,c.na.Sp=b;else return!1};a.my=function(a){var b=f.get_active();b.na&&(b.na.Sp=a)};a.vQ=function(a){var b=f.get_active();b.na&&(b.na.Tp=a)};a.reset_range=function(){var a=f.get_active();if(a.na)a=a.na,a.Tp=a.sa,a.Sp=a.Za;else return!1};a.set_cyclic=function(a){var b=f.get_active();if(b.na)b.na.cyclic=a;else return!1};a.clear_callback=
function(){var a=f.get_active();a.na&&(a.na.Kl=null)};a.pE=function(a){var b=f.get_active().na;b&&(b.Mb=-(a-D)*r.ad()+b.Tp,b.tm=!0)};a.get_frame_end=function(){var a=f.get_active().na;return a?a.Za:null}};b4w.module.__camera=function(a,q){function d(a,b,c,d,e){M.set_translation(a,b);c&&J(a,b,c);t(a,d);m(a,e)}function c(a,b,c,d,e,f,g,h){var k=a.o;M.set_translation(a,b);k.pivot.set(c);J(a,b,c);t(a,d);m(a,e);Q(a,f);y(a,g);k.use_panning=h}function b(a,b,c,d,e,f,g,h){var k=a.o;M.set_translation(a,b);k.fc.set(c);J(a,b,c);p(a,d);A(a,e);Y(a,f);R(a,g);k.jh=h}function g(a,b,c){var d=a.o,e=ua.get_trans_view(d.v),f=ua.get_quat_view(d.v),d=pa;d.set(na.AXIS_Z);d[3]=0;a=x(a,Ma)[1];f=na.quat_to_dir(f,na.AXIS_MZ,U);
Ba.set_pline_initial_point(Ka,e);Ba.set_pline_directional_vec(Ka,f);if(!na.line_plane_intersect(d,-b,Ka,c)||Math.abs(a)<ma)ta.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),c[0]=e[0],c[1]=0,c[2]=e[2];return c}function n(b){for(var c=b.o,d=0;d<b.K.length;d++){var e=b.K[d].ea[0];if(e.type==a.Jd)switch(c.kb){case a.MS_TARGET_CONTROLS:var f=ua.get_trans_view(c.v);c.sj=xa.dist(f,c.pivot);c.tj=e.nc;break;
case a.MS_HOVER_CONTROLS:f=ua.get_trans_view(c.v),c.sj=xa.dist(f,c.fc),c.tj=e.nc}}}function B(a){a={type:a,name:"",BE:1,width:0,height:0,ee:null,gp:null,lc:null,we:null,fb:0,nc:0,qm:"VERTICAL",near:0,far:0,left:0,right:0,top:0,bottom:0,Rc:N.create(),v:new Float32Array(9),Hb:new Float32Array(16),su:new Float32Array(16),lb:new Float32Array(16),Tc:new Float32Array(16),ru:new Float32Array(16),Rx:new Float32Array(16),Wf:new Float32Array(16),direction:new Float32Array(3),Me:ua.Ek(),tu:ua.Ek(),Vp:ua.Ek(),
Ft:ua.Ek(),gq:ua.Ek(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,dof_bokeh:!1,gd:!1,dof_on:!1,Ss:new Float32Array(3),lh:v(),Vj:0,He:0,hc:null,gh:null,Oo:null,Fr:new Float32Array(4),Sm:new Float32Array(4)};a.Rc[0]=a.Rc[2]=0;a.Rc[1]=a.Rc[3]=0;return a}function e(a,b){var c=B(a.type);c.name=a.name;c.BE=a.BE;c.width=a.width;c.height=a.height;b||(c.ee=a.ee,c.gp=a.gp,c.lc=a.lc,c.we=a.we);c.fb=a.fb;c.qm=a.qm;c.nc=a.nc;
c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;N.copy(a.Rc,c.Rc);ua.copy(a.v,c.v);ea.copy(a.Hb,c.Hb);ea.copy(a.lb,c.lb);ea.copy(a.Tc,c.Tc);ea.copy(a.ru,c.ru);ea.copy(a.Rx,c.Rx);ea.copy(a.Wf,c.Wf);ua.copy(a.Me,c.Me);ua.copy(a.tu,c.tu);ua.copy(a.Vp,c.Vp);ua.copy(a.Ft,c.Ft);ua.copy(a.gq,c.gq);c.dof_distance=a.dof_distance;c.dof_front_start=a.dof_front_start;c.dof_front_end=a.dof_front_end;c.dof_rear_start=a.dof_rear_start;c.dof_rear_end=a.dof_rear_end;c.dof_power=
a.dof_power;c.dof_bokeh_intensity=a.dof_bokeh_intensity;c.dof_object=a.dof_object;c.dof_bokeh=a.dof_bokeh;c.gd=a.gd;c.dof_on=a.dof_on;xa.copy(a.Ss,c.Ss);var d=a.lh,e=c.lh;N.copy(d.left,e.left);N.copy(d.right,e.right);N.copy(d.top,e.top);N.copy(d.bottom,e.bottom);N.copy(d.near,e.near);N.copy(d.far,e.far);c.Vj=a.Vj;c.He=a.He;a.hc&&(c.hc=N.clone(a.hc));if(a.gh){d=a.gh.length;c.gh=Array(d);for(e=0;e<d;e++)c.gh[e]=xa.clone(a.gh[e]);c.Oo=new Float32Array(a.Oo)}N.copy(a.Fr,c.Fr);N.copy(a.Sm,c.Sm);return c}
function v(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function w(b){switch(b){case "STATIC":return a.MS_STATIC;case "TARGET":return a.MS_TARGET_CONTROLS;case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:na.D("Unknown move style")}}function h(b){var c=B(b);if(b==a.Yc)return c;switch(b){case a.Zc:F(c,wa,
.1,1E3);break;case a.Jd:F(c,2.5,.1,1E3);break;case a.vf:break;case a.hg:break;case a.Ph:break;case a.pc:case a.wc:case a.re:case a.Yd:na.D("Stereo camera may only be created from perspective one");break;default:na.D("Unknown camera type")}return c}function l(b,c,d){b.type!=a.pc&&b.type!=a.wc&&b.type!=a.re&&b.type!=a.Yd&&na.D("set_stereo_params(): wrong camera type");if(b.type==a.pc||b.type==a.wc)b.Vj=c;b.He=d;X(b,!1);if(fa.xa()&&(c=fa.get_active(),b=c.F.Jc))for(c=ra.oa(fa.mj(c),c).ea,d=0;d<c.length;d++)da(c[d],
b)}function x(a,b){var c=ua.get_quat_view(a.o.v);return k(c,b)}function k(a,b){var c=na.quat_to_dir(a,na.AXIS_Z,U),d=na.quat_to_dir(a,na.AXIS_MY,sa),e=-Math.asin(c[2]/xa.length(c)),c=Math.abs(e)>Math.PI/4?xa.scale(d,-na.sign(e),Ha):xa.scale(c,-na.sign(d[2]),Ha),f=Math.atan(Math.abs(c[0]/c[1]));0<d[2]&&(e=na.sign(e)*Math.PI-e);d=f;0<c[1]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function f(a){switch(a.qm){case "AUTO":return 1<a.fb?aa(a)?a.nc/a.fb:2*Math.atan(Math.tan(a.nc/2)/a.fb):
a.nc;case "HORIZONTAL":return aa(a)?a.nc/a.fb:2*Math.atan(Math.tan(a.nc/2)/a.fb);case "VERTICAL":return a.nc}}function F(b,c,d,e){switch(b.type){case a.Zc:case a.pc:case a.wc:b.nc=c;b.fb=1;break;case a.Jd:b.nc=c;b.fb=1;break;case a.re:case a.Yd:break;default:na.D("set_frustum(): Unsupported camera type: "+b.type)}b.near=d;b.far=e}function u(b,c){var d=ua.ec(c.o.v,U),e=ua.Qc(c.o.v,Ga),f=ea.fromRotationTranslation(e,d,Ea);ea.invert(f,b.Hb);if(fa.xa())var f=fa.get_active(),g=fa.Aa(f,va.uf);if(b.type==
a.pc||g&&g.enable_hmd_stereo&&b.type==a.re)b.Hb[12]+=b.He/2;else if(b.type==a.wc||g&&g.enable_hmd_stereo&&b.type==a.Yd)b.Hb[12]-=b.He/2;if(b.hc){ua.from_mat4(b.Hb,b.Vp);ua.invert(b.Vp,b.Ft);var f=b.hc[0],g=b.hc[1],h=b.hc[2],k=b.hc[3],m=b.su;m[0]=1-2*f*f;m[1]=-2*f*g;m[2]=-2*f*h;m[3]=0;m[4]=-2*f*g;m[5]=1-2*g*g;m[6]=-2*g*h;m[7]=0;m[8]=-2*f*h;m[9]=-2*g*h;m[10]=1-2*h*h;m[11]=0;m[12]=-2*f*k;m[13]=-2*g*k;m[14]=-2*h*k;m[15]=1;ea.multiply(b.Hb,b.su,b.Hb);X(b,!0);f=pa;g=Ea;ea.invert(b.Hb,g);ea.transpose(g,
g);N.transformMat4(b.hc,g,f);g=Va;g[0]=(na.sign(f[0])+b.lb[8])/b.lb[0];g[1]=(na.sign(f[1])+b.lb[9])/b.lb[5];g[2]=-1;g[3]=(1+b.lb[10])/b.lb[14];N.scale(f,2/(f[0]*g[0]+f[1]*g[1]+f[2]*g[2]+f[3]*g[3]),f);b.lb[2]=f[0];b.lb[6]=f[1];b.lb[10]=f[2]+1;b.lb[14]=f[3];xa.transformMat4(d,b.su,d)}ua.from_mat4(b.Hb,b.Me);ua.invert(b.Me,b.tu);Z(b);ha(b);ua.set_sep(d,1,e,b.v)}function r(b,c,d,e){ea.lookAt(c,d,e,b.Hb);d=fa.get_active();d=fa.Aa(d,va.uf);if(b.type==a.pc||d&&d.enable_hmd_stereo&&b.type==a.re)b.Hb[12]+=
b.He/2;else if(b.type==a.wc||d&&d.enable_hmd_stereo&&b.type==a.Yd)b.Hb[12]-=b.He/2;ua.from_mat4(b.Hb,b.Me);Z(b);ha(b);ua.set_trans(c,b.v)}function z(a,b,c){c=xa.subtract(c,b,U);xa.length(c)&&(xa.normalize(c,c),c=na.iy(na.AXIS_MZ,c,Ga),M.set_rotation(a,c));M.set_translation(a,b)}function J(a,b,c){var d=a.o,e=C(a);z(a,b,c);e?(b=xa.copy(d.sf,U),xa.negate(b,b),T.correct_up(a,b,!0)):T.correct_up(a,d.sf,!0)}function D(a,b){for(var c=a.o,d=b.ea,e=ua.Qc(c.v,Ga),e=na.quat_to_dir(e,na.AXIS_MZ,U),f=ua.ec(c.v,
sa),g=b.zE,h=0;h<g.length;h++){var k=g[h];xa.copy(e,k.direction);ua.ec(c.v,k.Ss)}for(h=0;h<d.length;h++)k=d[h],u(k,a),xa.copy(e,k.direction),na.om(k.Tc,k.lh),k.dof_object&&k.dof_on&&(c=M.get_translation(k.dof_object,Ha),c=xa.dist(f,c),k.dof_distance=c)}function H(b){var c=b.o;c.kb==a.MS_TARGET_CONTROLS&&(c.Yj=C(b))}function C(a){a=ua.get_quat_view(a.o.v);return 0>na.quat_to_dir(a,na.AXIS_Y,U)[2]}function t(b,c){var d=b.o;if(c){d.Bb=d.Bb||{};d.Bb.left=c.left;d.Bb.right=c.right;d.Bb.Gm=c.left;d.Bb.Zm=
c.right;d.Bb.camera_space=!!c.camera_space;var e=b.o;!(d=e.Bb)||e.kb!=a.MS_EYE_CONTROLS&&e.kb!=a.MS_TARGET_CONTROLS||(e=x(b,Ma),d.camera_space?(d.left+=e[0],d.right+=e[0]):(d.Gm-=e[0],d.Zm-=e[0]),d.left=na.angle_wrap_0_2pi(d.left),d.right=na.angle_wrap_0_2pi(d.right),d.Gm=na.angle_wrap_0_2pi(d.Gm),d.Zm=na.angle_wrap_0_2pi(d.Zm))}else d.Bb=null}function m(a,b){var c=a.o;b?(c.Da=c.Da||{},c.Da.down=b.down,c.Da.up=b.up,c.Da.km=b.down,c.Da.vn=b.up,c.Da.camera_space=!!b.camera_space,I(a)):c.Da=null}function A(a,
b){var c=a.o;if(!b){var d=x(a,Ma);b={down:d[1],up:d[1]}}c.Da=c.Da||{};c.Da.down=b.down;c.Da.up=b.up;I(a);c.ub&&c.Da&&oa(a)}function I(b){var c=b.o,d=c.Da;if(d)switch(c.kb){case a.MS_EYE_CONTROLS:case a.MS_TARGET_CONTROLS:b=x(b,Ma);d.camera_space?(d.up+=b[1],d.down+=b[1]):(d.vn-=b[1],d.km-=b[1]);d.up=na.angle_wrap_periodic(d.up,-Math.PI,Math.PI);d.down=na.angle_wrap_periodic(d.down,-Math.PI,Math.PI);d.vn=na.angle_wrap_periodic(d.vn,-Math.PI,Math.PI);d.km=na.angle_wrap_periodic(d.km,-Math.PI,Math.PI);
break;case a.MS_HOVER_CONTROLS:d.up=na.angle_wrap_periodic(d.up,-Math.PI,Math.PI),d.down=na.angle_wrap_periodic(d.down,-Math.PI,Math.PI),d.up=na.clamp(d.up,-Math.PI/2,0),d.down=na.clamp(d.down,-Math.PI/2,0)}}function p(a,b){var c=a.o;if(!b){var d=M.Ep(a,c.fc);b={min:d,max:d}}c.ub=c.ub||{};c.ub.min=b.min;c.ub.max=b.max;c.ub&&c.Da&&oa(a)}function Q(a,b){var c=a.o;b?(c.ub=c.ub||{},c.ub.min=b.min,c.ub.max=b.max):c.ub=null}function y(a,b){var c=a.o;b?(c.Dd=c.Dd||{},c.Dd.min_z=b.min_z,c.Dd.max_z=b.max_z):
c.Dd=null}function Y(a,b){var c=a.o;b?(c.bd=c.bd||{},c.bd.min=b.min,c.bd.max=b.max):c.bd=null}function R(a,b){var c=a.o;b?(c.cd=c.cd||{},c.cd.min=b.min,c.cd.max=b.max):c.cd=null}function G(b){var c=b.o;if(ra.is_camera(b))for(var d=b.K,e=0;e<d.length;e++){var f=d[e].ea;if(f[0].type===a.Jd){switch(c.kb){case a.MS_TARGET_CONTROLS:var g=ua.get_trans_view(c.v),g=xa.dist(g,c.pivot),g=g/c.sj*c.tj;break;case a.MS_HOVER_CONTROLS:g=ua.get_trans_view(c.v);g=xa.distance(g,c.fc);g=g/c.sj*c.tj;break;default:g=
f[0].nc}for(var h=0;h<f.length;h++){var k=f[h];k.nc=g;X(k,!1)}D(b,d[e])}}}function E(b){var c=b.o,d=c.kb;if(d===a.MS_TARGET_CONTROLS||d===a.MS_EYE_CONTROLS){if(c.Bb){var e=c.Bb.left,f=c.Bb.right,g=x(b,Ma);(g=d==a.MS_TARGET_CONTROLS?na.xk(g[0],e,f):na.xk(g[0],f,e))&&(d==a.MS_TARGET_CONTROLS?V(b,g,0):W(b,g,0))}c.Da&&(e=c.Da.down,f=c.Da.up,g=x(b,Ma),(g=d==a.MS_TARGET_CONTROLS?na.xk(g[1],f,e):na.xk(g[1],e,f))&&(d==a.MS_TARGET_CONTROLS?V(b,0,g):W(b,0,g)));if(d===a.MS_TARGET_CONTROLS&&c.ub){var g=b.o,e=
ua.get_trans_view(g.v),f=xa.subtract(e,g.pivot,U),h=xa.length(f);h>g.ub.max?(xa.scale(f,g.ub.max/h,f),xa.add(g.pivot,f,e)):h<g.ub.min&&(h=ua.get_quat_view(g.v),h=na.quat_to_dir(h,na.AXIS_MZ,sa),xa.scale(h,100*g.ub.min,h),xa.add(f,h,f),xa.scale(f,-g.ub.min/xa.length(f),f),xa.add(g.pivot,f,e))}}d===a.MS_TARGET_CONTROLS&&c.Dd&&(c=b.o,g=c.pivot[2],e=na.clamp(c.pivot[2],c.Dd.min_z,c.Dd.max_z),e!=g&&(g=xa.set(0,0,e-g,U),xa.add(c.pivot,g,c.pivot),c=ua.get_trans_view(c.v),xa.add(c,g,c)));d===a.MS_HOVER_CONTROLS&&
(d=b.o,d.bd&&(g=na.clamp(d.fc[0],d.bd.min,d.bd.max)-d.fc[0],d.fc[0]+=g,c=ua.get_trans_view(d.v),c[0]+=g),d.cd&&(g=na.clamp(d.fc[1],d.cd.min,d.cd.max)-d.fc[1],d.fc[1]+=g,c=ua.get_trans_view(d.v),c[1]+=g),d=b.o,c=x(b,Ma)[1],(d=na.xk(c,d.Da.up,d.Da.down))&&K(b,0,d))}function W(a,b,c,d,e){var f=a.o,g=b,h=c;if(d||e)a=x(a,Aa),d&&(g=b-a[0]),e&&(h=c-a[1]);if(g||h)b=qa.identity(Ga),g&&(g=qa.setAxisAngle(f.sf,g,O),qa.multiply(b,g,b)),f=ua.get_quat_view(f.v),h&&(g=na.quat_to_dir(f,na.AXIS_X,U),h=qa.setAxisAngle(g,
h,O),qa.normalize(h,h),qa.multiply(b,h,b)),qa.multiply(b,f,f)}function V(a,b,c,d,e){var f=a.o,g=b,h=c;if(d||e){var k=x(a,Aa);d&&(g=b-k[0]);e&&(h=c-k[1])}ba(a,a.o.pivot,g,h);a=x(a,Aa);a=na.angle_wrap_periodic(a[1],-Math.PI,Math.PI);f.Yj=Math.abs(a)>Math.PI/2}function K(a,b,c,d,e){var f=a.o,g=b,h=c;if(d||e){var k=x(a,Aa);d&&(g=b-k[0]);e&&(h=c-k[1])}f.jh||(g=0);ba(a,f.fc,g,h);h&&oa(a)}function ba(a,b,c,d){var e=a.o;if(c||d){a=qa.identity(Ga);c&&(c=qa.setAxisAngle(na.AXIS_Z,c,O),qa.multiply(a,c,a));c=
ua.get_quat_view(e.v);if(d){var f=na.quat_to_dir(c,na.AXIS_X,U);d=qa.setAxisAngle(f,d,O);qa.normalize(d,d);qa.multiply(a,d,a)}d=ua.get_trans_view(e.v);na.PP(d,b,a,d);qa.multiply(a,c,c)}}function oa(a){var b=a.o,c=x(a,Ma)[1],d=a.o;a=d.Da;d=d.ub;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(d.max-d.min)+d.min;a=ua.get_trans_view(b.v);d=ua.get_quat_view(b.v);d=na.quat_to_dir(d,na.AXIS_MZ,U);xa.normalize(d,d);xa.scale(d,c,d);xa.subtract(b.fc,d,a)}function X(b,c){switch(b.type){case a.Zc:case a.vf:ea.perspective(f(b),
b.fb,b.near,b.far,b.lb);break;case a.Jd:case a.hg:var d=f(b),e=d*b.fb;ea.ortho(-e,e,-d,d,b.near,b.far,b.lb);break;case a.Ph:ea.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.lb);break;case a.pc:case a.wc:var e=Math.tan(f(b)/2),d=b.near*e,g=b.fb*b.Vj*e;b.type==a.pc?(e=g-b.He/2,g+=b.He/2):(e=g+b.He/2,g-=b.He/2);e=-(b.near/b.Vj*e);g*=b.near/b.Vj;ea.frustum(e,g,-d,d,b.near,b.far,b.lb);b.left=e;b.right=g;break;case a.re:case a.Yd:fa.xa()&&(d=fa.get_active(),(d=fa.Aa(d,va.uf))&&d.enable_hmd_stereo?
(d=Math.tan(b.Rc[1]),e=Math.tan(b.Rc[2]),g=Math.tan(b.Rc[3]),b.top=b.near*Math.tan(b.Rc[0]),b.right=b.near*d,b.bottom=-b.near*e,b.left=-b.near*g,ea.frustum(b.left,b.right,b.bottom,b.top,b.near,b.far,b.lb)):(b.top=b.near*Math.tan(f(b)/2),b.bottom=-b.top,b.right=b.top*b.fb,b.left=-b.right,ea.perspective(f(b),b.fb,b.near,b.far,b.lb)));break;case a.Yc:return;default:na.D("Wrong camera type: "+b.type)}c||(Z(b),ha(b))}function ha(a){ea.copy(a.Hb,a.Wf);a.Wf[12]=0;a.Wf[13]=0;a.Wf[14]=0;a.Wf[15]=1;ea.multiply(a.lb,
a.Wf,a.Wf);ea.invert(a.Wf,a.Wf)}function Z(a){ea.copy(a.Hb,a.Tc);ea.multiply(a.lb,a.Tc,a.Tc);ea.invert(a.Tc,a.ru)}function ca(b,c,d,e,g){e||(e=new Float32Array(24));c||(c=b.near);d||(d=b.far);var h,k,m,l,O,n,p,r;switch(b.type){case a.Yc:na.D("Extraction from NONE camera is not possible");break;case a.Zc:case a.vf:h=c*Math.tan(f(b)/2);l=-h;k=h*b.fb;m=-k;O=d/c*h;r=-O;n=O*b.fb;p=-n;break;case a.Jd:case a.hg:l=f(b);m=l*b.fb;h=O=l;k=n=m;l=r=-l;m=p=-m;break;case a.Ph:h=O=b.top;k=n=b.right;l=r=b.bottom;
m=p=b.left;break;case a.pc:case a.wc:O=c/b.near;h=c*Math.tan(f(b)/2);l=-h;k=b.right*O;m=b.left*O;p=d/c;O=h*p;r=-O;n=k*p;p*=m;break;case a.re:case a.Yd:O=c/b.near;h=b.top*O;l=b.bottom*O;k=b.right*O;m=b.left*O;p=d/c;O=h*p;r=l*p;n=k*p;p*=m;break;default:na.D("Wrong camera type: "+b.type)}e[0]=m;e[1]=l;e[2]=-c;e[3]=k;e[4]=l;e[5]=-c;e[6]=k;e[7]=h;e[8]=-c;e[9]=m;e[10]=h;e[11]=-c;e[12]=p;e[13]=r;e[14]=-d;e[15]=p;e[16]=O;e[17]=-d;e[18]=n;e[19]=O;e[20]=-d;e[21]=n;e[22]=r;e[23]=-d;g&&(c=Ea,ea.invert(b.Hb,c),
na.Um(e,c,e,0));return e}function da(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.gh){var d=b.csm_num;a.gh=Array(d);for(var e=0;e<d;e++)a.gh[e]=new Float32Array(3);a.Oo=new Float32Array(d)}for(d=0;d<c;d++){var e=d?L(b,a,d-1):a.near,f=L(b,a,d),e=ca(a,e,f,Ca),e=la.hN(e);a.gh[d].set(e.M);a.Oo[d]=e.Wa;a.Fr[d]=xa.length(e.M);a.Sm[d]=ja(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.Sm[0]=b.first_cascade_blur_radius}function L(a,b,c){var d=a.csm_num,e=na.clamp(a.csm_first_cascade_border,
b.near,b.far);a=na.clamp(a.csm_last_cascade_border,b.near,b.far);return na.clamp(ja(e,a,d,c),b.near,b.far)}function ja(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-1))}return a}function aa(b){switch(b.type){case a.Jd:case a.hg:case a.Ph:return!0;default:return!1}}function P(a,b){b||(b=new Float32Array(3));var c=ua.get_trans_view(a.o.v);xa.copy(c,b);return b}var la=q("__boundings"),T=q("__constraints"),ka=q("__container"),ea=q("__mat4"),Ba=q("__math"),ra=
q("__obj_util"),ta=q("__print"),qa=q("__quat"),fa=q("__scenes"),va=q("__subscene"),M=q("__transform"),ua=q("__tsr"),na=q("__util"),xa=q("__vec3"),N=q("__vec4");a.Yc=10;a.Zc=20;a.Jd=30;a.vf=40;a.hg=50;a.Ph=60;a.pc=70;a.wc=80;a.re=90;a.Yd=100;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=2;a.MS_EYE_CONTROLS=3;a.MS_HOVER_CONTROLS=4;var wa=na.deg_to_rad(40),ma=na.deg_to_rad(.5),Ma=new Float32Array(2),Aa=new Float32Array(2),U=new Float32Array(3),sa=new Float32Array(3),Ha=new Float32Array(3),Ga=new Float32Array(4),
O=new Float32Array(4),pa=new Float32Array(4),Va=new Float32Array(4),Ea=new Float32Array(16),Ca=new Float32Array(24),Ka=new Float32Array(6);a.LJ=function(f,k){var m=k.o,l=f.data;switch(l.type){case "PERSP":var O=h(a.Zc);O.qm=l.sensor_fit;F(O,l.angle,l.clip_start,l.clip_end);break;case "ORTHO":O=h(a.Jd),O.qm=l.sensor_fit,F(O,l.ortho_scale/2,l.clip_start,l.clip_end)}O.name=k.name;var p=k.K;p[0].ea.push(O);for(var r=1;r<p.length;r++){var t=e(O,!1);p[r].ea.push(t)}m.kb=w(l.b4w_move_style);m.dof_distance=
l.dof_distance;O=l.dof_object;m.dof_object=O?O.Ua:null;m.dof_front_start=l.b4w_dof_front_start;m.dof_front_end=l.b4w_dof_front_end;m.dof_rear_start=l.b4w_dof_rear_start;m.dof_rear_end=l.b4w_dof_rear_end;m.dof_power=l.b4w_dof_power;m.dof_bokeh=l.b4w_dof_bokeh;m.dof_bokeh_intensity=l.b4w_dof_bokeh_intensity;m.gd=l.b4w_dof_foreground_blur;m.An=l.b4w_trans_velocity;m.zn=l.b4w_rot_velocity;m.Bn=l.b4w_zoom_velocity;O=k.o.kb;p=f.data;r=null;O!=a.MS_TARGET_CONTROLS&&O!=a.MS_EYE_CONTROLS||!p.b4w_use_horizontal_clamping||
(r={left:p.b4w_rotation_left_limit,right:p.b4w_rotation_right_limit,camera_space:"LOCAL"==p.b4w_horizontal_clamping_type},O==a.MS_EYE_CONTROLS&&(r.left*=-1,r.right*=-1));O=r;p=k.o.kb;r=f.data;t=null;p!=a.MS_TARGET_CONTROLS&&p!=a.MS_EYE_CONTROLS||!r.b4w_use_vertical_clamping?p==a.MS_HOVER_CONTROLS&&r.b4w_use_zooming&&(r.b4w_hover_angle_min<=r.b4w_hover_angle_max?(t={down:r.b4w_hover_angle_min,up:r.b4w_hover_angle_max},t.down*=-1,t.up*=-1):ta.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):
(t={down:r.b4w_rotation_down_limit,up:r.b4w_rotation_up_limit,camera_space:"LOCAL"==r.b4w_vertical_clamping_type},p==a.MS_TARGET_CONTROLS&&(t.down*=-1,t.up*=-1));var p=t,r=k.o.kb,t=f.data,u=null;r==a.MS_TARGET_CONTROLS&&t.b4w_use_target_distance_limits&&t.b4w_distance_min<=t.b4w_distance_max?u={min:t.b4w_distance_min,max:t.b4w_distance_max}:r===a.MS_HOVER_CONTROLS&&t.b4w_use_zooming&&(t.b4w_distance_min<=t.b4w_distance_max?u={min:t.b4w_distance_min,max:t.b4w_distance_max}:ta.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));
r=u;t=f.data;u=null;k.o.kb==a.MS_HOVER_CONTROLS&&t.b4w_use_horizontal_clamping&&t.b4w_horizontal_translation_min<=t.b4w_horizontal_translation_max&&(u={min:t.b4w_horizontal_translation_min,max:t.b4w_horizontal_translation_max});var t=u,u=f.data,v=null;k.o.kb==a.MS_HOVER_CONTROLS&&u.b4w_use_vertical_clamping&&u.b4w_vertical_translation_min<=u.b4w_vertical_translation_max&&(v={min:u.b4w_vertical_translation_min,max:u.b4w_vertical_translation_max});var u=v,v=f.data,pa=null;k.o.kb==a.MS_TARGET_CONTROLS&&
v.b4w_use_pivot_limits&&(pa={min_z:v.b4w_pivot_z_min,max_z:v.b4w_pivot_z_max});v=pa;switch(m.kb){case a.MS_EYE_CONTROLS:m=ua.get_trans_view(k.o.v);d(k,m,null,O,p);break;case a.MS_TARGET_CONTROLS:m=ua.get_trans_view(k.o.v);c(k,m,l.b4w_target,O,p,r,v,l.b4w_use_panning);break;case a.MS_HOVER_CONTROLS:m=ua.get_trans_view(k.o.v),O=g(k,f.data.b4w_hover_zero_level,sa),b(k,m,O,r,p,t,u,l.b4w_enable_hover_hor_rotation)}E(k);n(k)};a.tE=d;a.vE=c;a.uE=b;a.Am=n;a.xc=e;a.GK=v;a.IU=w;a.Pc=h;a.qT=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return!!a.lc;
case "DEPTH":return!!a.we;case "SCREEN":return!a.lc&&!a.we;default:na.D("Wrong attachment type: "+b)}};a.Kt=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.lc=c;break;case "DEPTH":a.we=c;break;case "SCREEN":a.lc=null;a.we=null;break;default:na.D("Wrong attachment type: "+b)}};a.ZT=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.lc;case "DEPTH":return a.we;case "SCREEN":return null;default:na.D("Wrong attachment type: "+b)}};a.Vs=function(b,c){(b.type!=a.Zc||c!=a.pc&&c!=a.wc&&
c!=a.re&&c!=a.Yd)&&na.D("make_stereo(): wrong camera type");b.type=c;l(b,6,.065)};a.xQ=l;a.get_camera_angles=x;a.rw=k;a.get_camera_angles_char=function(a,b){x(a,b);b[0]=na.angle_wrap_0_2pi(b[0]+Math.PI);b[1]*=-1;return b};a.set_fov=function(b,c){switch(b.type){case a.Zc:case a.vf:case a.pc:case a.wc:b.nc=c}};a.get_fov=function(b){switch(b.type){case a.Zc:case a.vf:case a.pc:case a.wc:return b.nc;default:return 0}};a.vN=f;a.jE=F;a.kE=function(b,c,d,e,f){switch(b.type){case a.Zc:case a.pc:case a.wc:case a.Jd:b.nc=
d;b.fb=1;break;case a.vf:case a.hg:b.nc=d;b.fb=c/d;break;case a.re:case a.Yd:break;default:na.D("set_frustum2(): Unsupported camera type: "+b.type)}b.near=e;b.far=f};a.jQ=function(b,c,d,e,f,g,h){switch(b.type){case a.Ph:b.left=c;b.right=d;b.bottom=e;b.top=f;b.near=g;b.far=h;break;default:na.D("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.o.kb};a.DQ=u;a.UU=r;a.oy=function(a,b,c){var d=U;d[0]=0;d[1]=0;d[2]=-1;xa.transformQuat(d,c,d);d[0]+=b[0];
d[1]+=b[1];d[2]+=b[2];var e=sa;e[0]=0;e[1]=1;e[2]=0;xa.transformQuat(e,c,e);r(a,b,d,e)};a.oE=z;a.rQ=J;a.HR=D;a.GR=function(b){var c=b.o;E(b);G(b);switch(c.kb){case a.MS_TARGET_CONTROLS:var d=ua.get_trans_view(c.v),e=ua.get_quat_view(c.v);T.QP(d,e,c.pivot);for(e=0;e<b.K.length;e++)for(var f=b.K[e].ea,g=0;g<f.length;g++){var h=f[g];h.type!=a.pc&&h.type!=a.wc||l(h,xa.dist(d,c.pivot),h.He)}T.correct_up(b,c.sf);break;case a.MS_EYE_CONTROLS:b.cc||T.correct_up(b,c.sf)}H(b)};a.bz=H;a.mE=t;a.rE=m;a.hover_set_vertical_limits=
A;a.hover_set_distance_limits=p;a.fQ=Q;a.uQ=y;a.lQ=Y;a.CQ=R;a.QR=G;a.ey=W;a.XD=V;a.fy=K;a.xU=function(b){switch(b.type){case a.Zc:case a.Jd:case a.pc:case a.wc:return!0;default:return!1}};a.QM=function(b){switch(b.type){case a.Zc:case a.vf:case a.pc:case a.wc:var c;a:{switch(b.qm){case "AUTO":c=1<b.fb?b.nc:aa(b)?b.nc*b.fb:2*Math.atan(Math.tan(b.nc/2)*b.fb);break a;case "HORIZONTAL":c=b.nc;break a;case "VERTICAL":c=aa(b)?b.nc*b.fb:2*Math.atan(Math.tan(b.nc/2)*b.fb);break a}c=void 0}return Math.min(f(b),
c);default:return ta.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.$P=function(b,c){switch(b.type){case a.vf:case a.hg:ta.error("set_aspect(): Unsupported camera type: "+b.type);break;default:b.fb=c}};a.YT=function(a){return a.fb};a.Sj=X;a.aQ=function(b,c,d,e,g){var h=1/Math.max(g,e);switch(b.type){case a.Zc:case a.vf:g/=2;e/=2;d=-(d-g)/g*Math.tan(f(b)/2);c=(c-e)/e*Math.tan(f(b)/2)*b.fb;e=b.near*(d+h);g=b.near*(c+h);d=b.near*(d-h);c=b.near*(c-h);ea.frustum(c,g,d,e,b.near,
b.far,b.lb);break;case a.Jd:case a.hg:d=-d/g;c/=e;e=f(b);g=e*b.fb;ea.ortho(-g+(c-h)*(g+g),-g+(c+h)*(g+g),e+(d-h)*(e+e),e+(d+h)*(e+e),b.near,b.far,b.lb);break;case a.Ph:d=-d/g,c/=e,e=b.top+(d+h)*(b.top-b.bottom),g=b.left+(c+h)*(b.right-b.left),d=b.top+(d-h)*(b.top-b.bottom),c=b.left+(c-h)*(b.right-b.left),ea.ortho(c,g,d,e,b.near,b.far,b.lb)}ea.copy(b.Hb,b.Tc);ea.multiply(b.lb,b.Tc,b.Tc);na.om(b.Tc,b.lh)};a.rv=ha;a.HA=Z;a.fM=ca;a.dJ=function(a){a=a.o;var b=la.sd();b.min_x=-1;b.max_x=1;b.min_y=-1;b.max_y=
1;b.min_z=-1;b.max_z=1;a.U=b;var c=la.pv(1,na.f32([0,0,0]));a.va=c;a.bo=la.rA(1,b);a.eo=la.tA(1,b);a.co=la.sA(1,b)};a.is_static_camera=function(b){return ra.is_camera(b)&&b.o&&b.o.kb==a.MS_STATIC};a.is_target_camera=function(b){return ra.is_camera(b)&&b.o&&b.o.kb==a.MS_TARGET_CONTROLS};a.is_eye_camera=function(b){return ra.is_camera(b)&&b.o&&b.o.kb==a.MS_EYE_CONTROLS};a.is_hover_camera=function(b){return ra.is_camera(b)&&b.o&&b.o.kb==a.MS_HOVER_CONTROLS};a.is_ortho_camera=function(b){return ra.is_camera(b)&&
b.o&&b.K[0].ea[0].type==a.Jd};a.az=da;a.zL=L;a.project_point=function(b,c,d){b=b.K[0].ea[0];switch(b.type){case a.Zc:case a.vf:case a.Jd:case a.hg:case a.pc:case a.wc:case a.re:case a.Yd:var e=pa;e.set(c);e[3]=1;N.transformMat4(e,b.Tc,e);c=-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;ka.rS(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/Math.abs(e[3])+1)/2);return d;default:return ta.error("Non-compatible camera"),d}};a.bN=function(a){return a.K[0].ea[0]};a.hs=function(b,c){switch(b.type){case a.Zc:case a.vf:case a.pc:case a.wc:var d=
Math.tan(f(b)/2);switch(c){case "LEFT":return-d*b.fb;case "RIGHT":return d*b.fb;case "TOP":return d;case "BOTTOM":return-d}break;case a.Jd:case a.hg:switch(c){case "LEFT":return-f(b)*b.fb;case "RIGHT":return f(b)*b.fb;case "TOP":return f(b);case "BOTTOM":return-f(b)}break;case a.Ph:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.re:case a.Yd:d=fa.get_active();if((d=fa.Aa(d,va.uf))&&d.enable_hmd_stereo)switch(c){case "LEFT":return-Math.tan(Math.min(b.Rc[1],
b.Rc[3]));case "RIGHT":return Math.tan(Math.min(b.Rc[1],b.Rc[3]));case "TOP":return Math.tan(Math.min(b.Rc[0],b.Rc[2]));case "BOTTOM":return-Math.tan(Math.min(b.Rc[0],b.Rc[2]))}else switch(d=Math.tan(f(b)/2),c){case "LEFT":return-d*b.fb;case "RIGHT":return d*b.fb;case "TOP":return d;case "BOTTOM":return-d}break;default:na.D("Unknown camera type")}};a.TN=aa;a.ny=function(a,b,c){a=a.o;ua.set_trans(b,a.v);xa.copy(c,a.pivot)};a.nE=function(a,b){var c=a.o,d=xa.subtract(b,c.fc,U),e=ua.get_trans_view(c.v),
d=xa.add(d,e,d);M.set_translation(a,d);xa.copy(b,c.fc)};a.yQ=function(a,b){var c=a.o,d=xa.subtract(b,c.pivot,U),e=ua.get_trans_view(c.v),d=xa.add(d,e,d);M.set_translation(a,d);xa.copy(b,c.pivot)};a.cU=P;a.TU=function(c,d){c.o.kb=d;c.o.Bb=null;c.o.Da=null;c.o.ub=null;c.o.bd=null;c.o.cd=null;n(c);switch(d){case a.MS_HOVER_CONTROLS:var e=ua.get_trans_view(c.o.v),f=g(c,0,sa);b(c,e,f,null,null,null,null,c.o.jh);break;case a.MS_TARGET_CONTROLS:e=P(c,U),f=ua.get_quat_view(c.o.v),f=na.quat_to_dir(f,na.AXIS_MZ,
sa),f=xa.scaleAndAdd(e,f,10,f),xa.copy(f,c.o.pivot)}};a.Kq=function(a){a=a.o;a.kb=0;xa.set(0,0,0,a.pivot);xa.set(0,0,0,a.fc);a.Yj=!1;a.use_panning=!1;a.Bb=null;a.Da=null;a.ub=null;a.bd=null;a.cd=null;a.Dd=null;a.jh=!0};a.set_eye_distance=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];70!=d.type&&80!=d.type&&90!=d.type&&100!=d.type||l(d,d.Vj,b)}};a.set_hmd_fov=function(a,b,c){var d=fa.get_active();a=ra.oa(a,d).ea;for(d=0;d<a.length;d++){var e=a[d];if(90==e.type||100==e.type)90==e.type&&N.copy(b,
e.Rc),100==e.type&&N.copy(c,e.Rc),e.hc||X(e,!1),Z(e),ha(e)}};a.SU=function(a,b,c){var d=fa.get_active();a=ra.oa(a,d).ea;for(d=0;d<a.length;d++){var e=a[d];if(90==e.type||100==e.type)90==e.type&&b&&ea.copy(b,e.lb),100==e.type&&c&&ea.copy(c,e.lb),Z(e),ha(e)}}};b4w.module.__lights=function(a,q){function d(a){g.scale(a.color,a.Ye,a.Fo)}var c=q("__tsr"),b=q("__util"),g=q("__vec3"),n=new Float32Array(3);a.$N=function(a,e){var v=a.data,w=e.nb={name:"",type:v.type,GD:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),Fo:new Float32Array(3),vB:0,gz:!1,Dl:0,mq:0,xo:.1,wo:30,VB:!1,lD:!1,CB:!1,Hl:!0,Il:!0,Ye:1,distance:25,MT:"INVERSE_SQUARE"};w.name=e.name;w.Hl=v.use_diffuse;w.Il=v.use_specular;var h=c.get_quat_view(e.o.v),h=b.quat_to_dir(h,
b.AXIS_Z,n);g.normalize(h,h);w.direction.set(h);w.color[0]=v.color[0];w.color[1]=v.color[1];w.color[2]=v.color[2];w.Ye=w.vB=v.energy;d(w);w.distance=v.distance;w.gz=v.use_sphere;w.xo=v.clip_start;w.wo=v.clip_end;if("POINT"===w.type||"SPOT"===w.type)w.distance=v.distance;"SPOT"===w.type?(w.mq=v.spot_blend,w.Dl=v.spot_size):"POINT"===w.type&&(w.Dl=Math.PI/2);w.VB=v.b4w_generate_shadows;w.CB=v.b4w_dynamic_intensity};a.set_light_color=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];d(a)};
a.oQ=function(a,b){a.mq=b};a.nQ=function(a,b){a.distance=b};a.pQ=function(a,b){a.Dl=b};a.set_light_energy=function(a,b){a.Ye=b;d(a)};a.LR=function(a){var d=a.nb;if(d){a=c.get_quat_view(a.o.v);b.quat_to_dir(a,b.AXIS_Z,d.direction);g.normalize(d.direction,d.direction);if("SUN"==d.type){a=Math.acos(g.dot(d.GD,b.Uu));var n=Math.acos(g.dot(d.direction,b.Uu));d.lD=Math.floor(a/.025)!=Math.floor(n/.025)?!0:!1}g.copy(d.direction,d.GD)}}};b4w.module.__scenes=function(a,q){function d(){ob||(ob=c(Sa));return ob}function c(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.wf||!c.wf.length)return c}return null}function b(){Ya||ya.D("No active scene available");return Ya}function g(a,b,c){if(!za.Mr||!n(a,b,c))return null;c=a.b4w_shadow_settings;var d={};c.csm_resolution>Pa.tc?(d.csm_resolution=Pa.tc,Ia.error("Shadow map texture has unsupported size. Changed to "+Pa.tc+".")):d.csm_resolution=c.csm_resolution;za.shadow_blur_samples=za.shadow_blur_samples?
za.shadow_blur_samples:c.blur_samples;d.OQ=c.soft_shadows;a=Ea.ms(b,za.ssao&&a.b4w_enable_ssao);d.self_shadow_polygon_offset=c.self_shadow_polygon_offset;d.self_shadow_normal_offset=c.self_shadow_normal_offset;d.enable_csm=c.b4w_enable_csm&&1==a.length;c.b4w_enable_csm&&1<c.csm_num&&1<a.length&&Ia.warn("Disabling Cascaded Shadow Maps because of multiple shadow casting lamps.");d.Cg=[];d.NE=[];d.xo=[];d.wo=[];for(b=0;b<a.length;b++)d.Cg.push(a[b].nb.type),d.NE.push(a[b].nb.Dl),d.xo.push(a[b].nb.xo),
d.wo.push(a[b].nb.wo),"SPOT"!=d.Cg[b]&&"POINT"!=d.Cg[b]||!d.enable_csm||(Ia.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),d.enable_csm=!1);d.enable_csm?(d.csm_num=c.csm_num,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=c.fade_last_cascade,d.blend_between_cascades=c.blend_between_cascades):
(d.csm_num=1,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=!1,d.blend_between_cascades=!1);return d}function n(a,b,c){if(0!=b.length&&za.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,e=!1;a=za.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=
c[b];f.b4w_shadow_cast&&(d=!0);f.b4w_shadow_receive&&(e=!0);if((a||d)&&e)return!0}return!1}function B(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].nb.type)return!0;return!1}function e(a){if(!za.shore_smoothing)return!1;a=aa(a);for(var b=0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function v(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=0;d<c.length;d++)if(Ea.RA(a[b],c[d].settings))return!0;return!1}function w(a){for(var b=aa(a),c=[],
d=0;d<b.length;d++){var e=b[d];if(e.b4w_water){for(var f={},g=0;g<a.length;g++)for(var h=a[g],k=h.data.materials,m=0;m<k.length;m++)k[m]==e&&(f.fk=h.location[2]);f.ce=e.b4w_water_fog_color.slice(0);f.ce.push(e.b4w_water_fog_density);e.b4w_water_dynamic?(f.Xo=!0,f.waves_height=e.b4w_waves_height,f.waves_length=e.b4w_waves_length,f.dst_noise_scale0=e.b4w_water_dst_noise_scale0,f.dst_noise_scale1=e.b4w_water_dst_noise_scale1,f.dst_noise_freq0=e.b4w_water_dst_noise_freq0,f.dst_noise_freq1=e.b4w_water_dst_noise_freq1,
f.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,f.dir_freq=e.b4w_water_dir_freq,f.dir_noise_scale=e.b4w_water_dir_noise_scale,f.dir_noise_freq=e.b4w_water_dir_noise_freq,f.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,f.dst_min_fac=e.b4w_water_dst_min_fac,f.waves_hor_fac=e.b4w_water_waves_hor_fac):(f.Xo=!1,f.waves_height=0,f.waves_length=0);f.og=e.b4w_water_enable_caust;f.NJ=e.b4w_water_caust_scale;f.MJ=e.b4w_water_caust_brightness;f.OJ=new Float32Array([.3,.7]);f.Tj=null;e=e.texture_slots;for(g=
0;g<e.length;g++)h=e[g].texture,!0===h.b4w_shore_dist_map&&"FILE"==h.image.source&&(f.Tj=h.image,f.ty=h.image.size[0],f.mx=h.b4w_max_shore_dist,h=h.b4w_shore_boundings,f.bn=[(h[0]+h[1])/2,(h[2]+h[3])/2],f.cn=[h[0]-h[1],h[2]-h[3]]);c.push(f)}}if(0<c.length){f=c[0];if(!f.Xo)for(d=0;d<c.length;d++)c[d].Xo&&(f=c[d]);return f}return null}function h(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==
e.node_tree_name&&(c.refractions=!0);"BSDF_TRANSPARENT"==e.type&&(c.refractions=!0)}}}var c={refractions:!1};a=aa(a);for(var d=0;d<a.length;d++){var e=a[d];e.b4w_refractive&&(c.refractions=!0);e.node_tree&&b(e.node_tree)}return c}function l(a,b,c){if(za.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;a=[];for(var d=0,e=!1,f=0;f<b.length;f++){var g=b[f];g.o.ld&&"CUBE"==g.o.Mg&&d++;if(g.Xp.length){for(var h=null,k=0;k<a.length;k++)if(a[k]==g){h=k;break}null==h&&a.push(g)}}for(f=
0;f<c.length;f++){a:if(b=c[f],b.b4w_reflexible){b=b.data.materials;for(g=0;g<b.length;g++)if(h=b[g].game_settings.alpha_blend,"OPAQUE"!=h&&"CLIP"!=h){b=!0;break a}b=!1}else b=void 0;b&&(e=!0)}return{QD:a,pD:d,ai:[],Qv:[],Ah:[],xt:[],sC:e}}function x(a,b){var c=a.b4w_sky_settings,d={};d.TD=c.render_sky||c.procedural_skydome;d.procedural_skydome=c.procedural_skydome;d.use_as_environment_lighting=c.use_as_environment_lighting;d.en=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=
c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=c.rayleigh_collection_power;d.mie_collection_power=c.mie_collection_power;d.mie_distribution=c.mie_distribution;d.Ed=c.reflexible;d.md=c.reflexible_only;!b&&c.procedural_skydome&&Ia.warn("There is no sun on the scene. Procedural sky will use a default sun position.");return d}function k(a){var b={};a=a.b4w_ssao_settings;
b.radius_increase=a.radius_increase;b.EN=a.hemisphere;b.tJ=a.blur_depth;b.blur_discard_value=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.UP=a.samples;return b}function f(a){if(!(za.bloom&&a.b4w_enable_bloom&&a.F.Ii))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.edge_lum=a.edge_lum;b.key=a.key;return b}function F(a){var b={};a=a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function u(a){var b=
{};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function r(a){var b={};a=a.b4w_god_rays_settings;b.Sw=a.intensity;b.Im=a.max_ray_length;b.ln=a.steps_per_pass;return b}function z(a){var b={};b.vi=a.b4w_outline_color;b.Gp=a.b4w_outline_factor;return b}function J(a){var b={};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=
a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function D(a,b){var c=a.light_settings,d={};d.wg=c.environment_energy;d.Bq=c.use_environment_light;d.fw=c.environment_color;d.Md=a.horizon_color.slice(0);d.Vd=a.zenith_color.slice(0);d.Eq=a.use_sky_paper;d.Dq=a.use_sky_blend;d.Fq=a.use_sky_real;d.Tt=null;d.fn=null;d.Tr=null;c=!0;if(d.Bq&&"SKY_TEXTURE"==d.fw&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var e=null,f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_environment_lighting&&
!a.texture_slots[f].texture.b4w_use_as_skydome){e=a.texture_slots[f];break}e?d.Tr=e:c=!1}for(f=0;f<a.texture_slots.length;f++)if(a.texture_slots[f].texture.b4w_use_as_skydome){c=!0;e=a.texture_slots[f];d.Tt=e;f=Math.min(Pa.pi,Da.GJ(e.texture.image.size[0]/3));d.fn={kR:f,zA:e.blend_factor,xC:e.horizon_factor,fG:e.zenith_up_factor,eG:e.zenith_down_factor,color:e.color,ya:e.default_value,invert:e.invert,MF:e.use_rgb_to_intensity,AA:e.blend_type,HF:e.use_map_blend,IF:e.use_map_horizon,KF:e.use_map_zenith_up,
JF:e.use_map_zenith_down};break}d.Bq=d.Bq?c:!1;return d}function H(a){var b=a.fog_settings,c={};c.iS=b.use_fog;c.Sw=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.jM=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;c.ce=new Float32Array([a[0],a[1],a[2],1/c.depth]);c.Ef=new Float32Array([c.Sw,c.depth,c.start,c.height]);return c}function C(a,b){if(!za.yc)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=
!1,d=!1,e=0;e<b.length;e++){for(var f=b[e],g=f.data.materials,h=0;h<g.length;h++)g[h].b4w_terrain&&(c=!0);f=f.particle_systems;for(h=0;h<f.length;h++)g=f[h].settings,"HAIR"==g.type&&g.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function t(a,b){if($a.outlining_overview_mode)return!0;if(za.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].Ua.o.Qj)return!0;return!1}else return!1}function m(a,b){if($a.outlining_overview_mode)return!0;
if(za.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].Ua.o.Ic)return!0;return!1}else return!1}function A(a,b){if(za.hi)switch(a.b4w_enable_glow_materials){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,e=0;e<d.length;e++)if(pa.QA(d[e]))return!0;return!1}else return!1}function I(a,b){if(za.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;
case "ON":return!0;case "AUTO":return b.refractions}else return!1}function p(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,d=0;d<c.length;d++){var e=c[d],f=e.game_settings.alpha_blend;if(e.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}function Q(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++){var d=b[c].Ua;if(d.anchor&&d.anchor.im)return!0}return!1}}function y(a){if(a&&a.F&&a.F.Ja){var b=ga.dc(a.F.Ja,
S.gg);b&&ja(a,b)}}function Y(a,b,c,d,e,f){for(var g=b.o,h=Ea.oa(b,e).R,k=0;k<h.length;k++){var m=h[k];if(!(m.Qd||m.md||"MAIN"!=m.type&&"NODES_GLOW"!=m.type&&"PARTICLES"!=m.type&&"LINE"!=m.type)&&("OPAQUE"==m.sb&&"OPAQUE"==d||"BLEND"==m.sb&&"BLEND"==d||"XRAY"==m.sb&&"XRAY"==d||"NODES_GLOW"==m.type&&"GLOW"==d)){if(!f&&(R(m,a,b,c,d,e),!N.vc(m)))if("DEBUG"===zb.type())N.er(m,"error.glslv","error.glslf"),N.vc(m);else continue;var l=S.sh(m,g);S.Ec(a,l);ga.Ck(c,a,m);G(m)}}}function R(a,b,c,d,e,f){var g=
c.o,h=f.F,k=Ea.oa(c,f),m="NO_SHADOWS";c=la(f,[S.Xc]);if(c.length&&a.Gd){switch(e){case "OPAQUE":m="SHADOW_MAPPING_OPAQUE";break;case "BLEND":case "XRAY":m="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":m="NO_SHADOWS";break;case "SHADOW":m="SHADOW_MASK_GENERATION";break;default:ya.D("Wrong subscene type")}for(var l=0;l<c.length;l++)N.jA(a,f.F.Jc)}l="NO_SOFT_SHADOWS";if(h.Jc&&h.Jc.OQ)switch(za.shadow_blur_samples){case "16x":l="POISSON_X_16";break;case "8x":l="POISSON_X_8";
break;case "4x":l="POISSON_X_4"}c=a.ab;ia.ia(c,"SHADOW_USAGE",m);ia.ia(c,"POISSON_DISK_NUM",l);a.yc&&(l=ga.dc(d,S.Oh))&&E(a,l,g);l=b.B;l.type==ma.Jd||l.type==ma.hg||l.type==ma.Ph?ia.ia(c,"CAMERA_TYPE","CAM_TYPE_ORTHO"):ia.ia(c,"CAMERA_TYPE","CAM_TYPE_PERSP");if("SHADOW"!=a.type&&"COLOR_ID"!=e||a.qj){e=b.kt;ia.ia(c,"NUM_LIGHTS",e);ia.ia(c,"NUM_LFACTORS",e%2?Math.floor(e/2)+1:e/2);ia.ia(c,"REFLECTION_PASS","REFL_PASS_NONE");ia.ia(c,"SSAO_ONLY",0);if(e=h.Bc)ia.ia(c,"WATER_EFFECTS",1),ia.ia(c,"WAVES_HEIGHT",
ia.N(e.waves_height)),ia.ia(c,"WAVES_LENGTH",ia.N(e.waves_length)),ia.ia(c,"WATER_LEVEL",ia.N(e.fk));if(b.og&&a.og){ia.ia(c,"CAUSTICS",1);if(l=h.Jc){g=l.Cg;for(l=m=0;l<g.length;l++)"SUN"==g[l]&&(m=l);ia.ia(c,"SUN_NUM",m)}ia.ia(c,"CAUST_SCALE",ia.N(b.LA));ia.ia(c,"CAUST_SPEED",ia.N(b.MA,2));ia.ia(c,"CAUST_BRIGHT",ia.N(b.KA))}b=k.ai;k=k.Ah;if(-1!==a.Ie.indexOf("u_mirrormap"))ia.ia(c,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(a.ld&&b)b=b.B.lc,N.Wi(a,b,"u_cube_reflection"),ia.ia(c,"REFLECTION_TYPE",
"REFL_CUBE");else if(a.ld&&k)for(l=0;l<k.length;l++)b=k[l].B.lc,N.Wi(a,b,"u_plane_reflection"),ia.ia(c,"REFLECTION_TYPE","REFL_PLANE");else ia.ia(c,"REFLECTION_TYPE","REFL_NONE");(k=ga.dc(d,S.gg))?a.Nr?(b=k.B.lc,N.Wi(a,b,"u_sky")):k.procedural_skydome&&(a.$d=k.$d,ia.ia(c,"PROCEDURAL_FOG",1)):ia.ia(c,"PROCEDURAL_FOG",0);b=h.Gn;b.Bq&&(ia.ia(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.fw?(b.Tr?(k=b.Tr.texture,b=Da.Ld(b.Tr),N.Wi(a,b,"u_sky_texture",k.name)):k&&(b=k.B.lc,N.Wi(a,b,"u_sky_texture")),ia.ia(c,
"SKY_TEXTURE",1)):"SKY_COLOR"==b.fw&&ia.ia(c,"SKY_COLOR",1));b=h.dG;b.iS&&(ia.ia(c,"USE_FOG",1),ia.ia(c,"FOG_TYPE",b.jM));a.wi&&a.yb?(za.Mr&&ia.ia(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.qj||"NODES_GLOW"==a.type?(ia.ia(c,"REFRACTIVE",1),h.refractions?ia.ia(c,"USE_REFRACTION",1):ia.ia(c,"USE_REFRACTION",0)):h.refractions?ia.ia(c,"REFRACTIVE",1):ia.ia(c,"REFRACTIVE",0),(h.cD.refractions||h.refractions)&&ia.ia(c,"HAS_REFRACT_TEXTURE",1)):(ia.ia(c,"REFRACTIVE",0),ia.ia(c,"USE_REFRACTION",0),
ia.ia(c,"USE_REFRACTION_CORRECTION",0));a.Kh&&(za.shore_smoothing&&a.Fn&&ga.dc(d,S.xz)?ia.ia(c,"SHORE_SMOOTHING",1):ia.ia(c,"SHORE_SMOOTHING",0),a.water_dynamic&&e&&e.waves_height?ia.ia(c,"DYNAMIC",1):ia.ia(c,"DYNAMIC",0));"PARTICLES"==a.type&&ia.ia(c,"COLOR_RAMP_LENGTH",a.wa.bB);if(!a.Ff)for(a=a.Sa,d=0;d<a.length;d++)if(b=a[d],"SCENE"==b.source)for(h=0;h<Sa.length;h++)for(c=Sa[h],k=Sa[h].wf,e=0;e<k.length;e++)k[e]==b&&sa.C(Ab,c,f,null)}}function G(a){8<a.Sa.length&&Ia.warn(a.type,"too many textures used - "+
a.Sa.length+' (max 8), materials "'+a.Jb.join(", ")+'"')}function E(a,b,c){a.hd=b.hd;var d=b.hd[0],e=b.hd[1],f=b.hd[2];c=c.U;c=Math.max(c.max_x-c.min_x,c.max_y-c.min_y);f=0==f?c:Math.max(f,c);b.hd[2]=f;b=b.B;ma.kE(b,f/2,f/2,-e,-d);ma.Sj(b,!1);d=a.ii||0;d=0==d?c:Math.max(d,c);a.ii=d}function W(a,b,c,d,e,f){for(var g=b.o,h=Ea.oa(b,e).R,k=0;k<h.length;k++){var m=h[k];if(("MAIN"==m.type||"PARTICLES"==m.type||"LINE"==m.type)&&"REFLECT"==m.sb&&m.yb==d){if(a.type==S.qd||a.type==S.Qe){var l;a:{var O=e.F.Dh.Ah;
for(l=0;l<O.length;l++)for(var n=0;n<O[l].length;n++)if(O[l][n]==a)break a;O=e.F.Dh.xt;for(l=0;l<O.length;l++)for(n=0;n<O[l].length;n++)if(O[l][n]==a)break a;l=null}if(l==g.jd)continue}else if(l=xa(e,a),l==g.td)continue;if(!f&&(R(m,a,b,c,"REFLECT",e),l=m.ab,ia.ia(l,"WATER_EFFECTS",0),a.type==S.qd||a.type==S.Qe?ia.ia(l,"REFLECTION_PASS","REFL_PASS_PLANE"):ia.ia(l,"REFLECTION_PASS","REFL_PASS_CUBE"),ia.ia(l,"TEXTURE_NORM",0),!N.vc(m)))if("DEBUG"===zb.type())N.er(m,"error.glslv","error.glslf"),N.vc(m);
else continue;l=S.sh(m,g);S.Ec(a,l);ga.Ck(c,a,m);G(m)}}}function V(a){L(a);var b=T(a,S.Db),c=!0,d=a.F.Jc;sa.ha(a.F.Ja,function(e,f){f.type===S.Xc&&(ba(f,a,b.B,d,c),c=!1)})}function K(a){sa.ha(a.F.Ja,function(a,b){b.type===S.Vl&&(b.dw=1)})}function ba(a,b,c,d,e){if(0!=a.Qa.length){var f=a.B;ab.copy(c.v,f.v);ab.copy(c.Me,f.gq);if("SUN"===d.Cg[a.Pg]||"HEMI"===d.Cg[a.Pg]){var g=c.v,h=Tb;wa.BS(h);for(var k=0;k<a.Qa.length;k++)for(var m=a.Qa[k].ra,l=0;l<m.length;l++){var n=m[l].qa,p=m[l].Ee;if(n.yc){var p=
ab.Qc(g,Gb),r=Xa.transformQuat(ya.AXIS_MZ,p,Wa),p=-r[0],r=r[1],t=ab.ec(g,Wa),p=t[0]-n.ii*(1+p)/2,r=t[1]-n.ii*(1-r)/2,t=n.Pa.max_z-n.Pa.min_z,u=Xb;u.min_x=p;u.min_y=r;u.min_z=n.hd[0]-t;u.max_x=p+n.ii;u.max_y=r+n.ii;u.max_z=n.hd[1]+t}else u=p.Pa;k||l?wa.gw(h,u):wa.cm(u,h)}g=wa.GB(h,Pc);ya.Um(g,f.Hb,g);if(d.enable_csm){b=Xa.copy(c.gh[a.Pv],Mb);d=O.invert(c.Hb,cc);ya.Um(b,d,b);ya.Um(b,f.Hb,b);a=c.Oo[a.Pv];if(e)for(Pb=0,Qc=-Infinity,e=2;e<g.length;e+=3)Pb=Math.min(Pb,g[e]),Qc=Math.max(Qc,g[e]);e=Tb;e.max_x=
b[0]+a;e.max_y=b[1]+a;e.max_z=Qc;e.min_x=b[0]-a;e.min_y=b[1]-a;e.min_z=Pb}else{c=e=Tb;d=vc;d.set(g);g=Yc/9;h=O.identity(cc);O.rotate(h,g,ya.AXIS_MZ,h);m=k=-1;for(l=0;10>l;l++){n=wa.pA(d,Xb);p=(n.max_x-n.min_x)*(n.max_y-n.min_y);if(-1==k||.1<k-p)k=p,m=l,wa.cm(n,c);ya.Um(d,h,d)}c=m*g;0<c&&(d=O.identity(cc),O.rotate(d,c,ya.AXIS_MZ,d),O.multiply(d,f.Hb,f.Hb),ab.from_mat4(f.Hb,f.Me));c=e.max_x-e.min_x;d=e.max_y-e.min_y;c&&d&&(g=Math.abs(c-d)/2,2<c/d?(e.max_y+=g,e.min_y-=g):2<d/c&&(e.max_x+=g,e.min_x-=
g));e.max_x+=.005;e.max_y+=.005;e.max_z+=.005;e.min_x-=.005;e.min_y-=.005;e.min_z-=.005;oa(a,b.F.Ja)}ma.jQ(f,e.min_x,e.max_x,e.min_y,e.max_y,-e.max_z,-e.min_z);ma.Sj(f,!1);ya.om(f.Tc,f.lh)}else"SPOT"!==d.Cg[a.Pg]&&"POINT"!==d.Cg[a.Pg]||ma.Sj(f,!1)}}function oa(a,b){for(var c=a.B,d=ga.qN(b,a),e=0;e<d.length;e++){var f=d[e];if(f.type==S.Db||f.type==S.Re||f.type==S.Vc||f.type==S.tf)if(za.Us)f.hz.set(c.Me,9*a.Pg);else{var g=ab.get_trans_view(c.Me),h=ab.get_scale(c.Me),k=ab.get_quat_view(c.Me);Wc.set(g[0],
g[1],g[2],h,qb);f.lu.set(qb,4*a.Pg);f.ku.set(k,4*a.Pg)}}}function X(a,b,c,d,e){for(var f=b.o,g=Ea.oa(b,d).R,h=0;h<g.length;h++){var k=g[h];if("COLOR_ID"==k.type&&(a.type==S.Wd&&"COLOR_ID"==k.sb||a.type==S.dg&&"COLOR_ID_XRAY"==k.sb)){if(!e&&(R(k,a,b,c,"COLOR_ID",d),N.mb(k,"USE_OUTLINE",0),!N.vc(k)))continue;k=S.sh(k,f);S.Ec(a,k)}}}function ha(a,b,c,d,e){if(!d&&(e.yc&&(d=ga.dc(c,S.Oh))&&E(e,d,b),!N.vc(e)))if("DEBUG"===zb.type())N.er(e,"error.glslv","error.glslf"),N.vc(e);else return;b=S.sh(e,b);S.Ec(a,
b);ga.Ck(c,a,e);G(e)}function Z(a,b){ca(a,b);for(var c=0;c<a.ve.length;c++)a.ve[c].parent==a&&Z(a.ve[c],b)}function ca(a,b){a.o.hide=b;if(Ea.is_lamp(a))for(var c=0;c<a.K.length;c++)for(var d=a.K[c],e=la(d.pb,Fb),f=0;f<e.length;f++){var g=e[f],h=a.o,k=a.nb,m=d.Bp,l=k.Hl&&!h.hide?1:0;g.Cp[4*m+3]=l;l=k.Il&&!h.hide?1:0;g.Ap[4*m+3]=l;g.Ba=!0}}function da(a,b){for(var c=la(b,Fb),d=a.nb,e=a.o,f=Ea.oa(a,b),g=ab.get_trans_view(e.v),e=ab.get_quat_view(e.v),h=0;h<c.length;h++){var k=c[h],m=k,l=a.o,O=a.nb,n=
f.Bp,p=ab.get_trans_view(a.o.v),r=O.Fo;m.dx.set(O.direction,3*n);qb[0]=p[0];qb[1]=p[1];qb[2]=p[2];qb[3]=O.Hl&&!l.hide?1:0;m.Cp.set(qb,4*n);qb[0]=r[0];qb[1]=r[1];qb[2]=r[2];qb[3]=O.Il&&!l.hide?1:0;m.Ap.set(qb,4*n);m.Ba=!0;switch(d.type){case "SUN":k.ZE.set(e);k.YE=d.Fo;k.type===S.gg?(k.gt=d.lD,Xa.copy(d.direction,k.Ey),ja(b,k)):Xa.copy(d.direction,k.Ey);break;case "HEMI":case "POINT":case "SPOT":break;default:Ia.error("Unknown light type: "+d.type+'".')}k=k.Qa;for(m=0;m<k.length;m++)for(l=k[m].ra,
O=0;O<l.length;O++)n=l[O].qa,n.el&&N.mQ(n,a)}c=T(b,S.Db).B;f=f.ry;d=b.F.Jc;for(h=0;h<f.length;h++)k=f[h],ma.oy(k.B,g,e),ba(k,b,c,d,!0),oa(k,b.F.Ja)}function L(a){var b=Va.Ib(a,"LAMP",Va.DATA_ID_ALL),b=Ea.ms(b,za.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var d=b[c],e=d.o,f=ab.ec(e.v,Mb),e=ab.Qc(e.v,Gb),g=0;g<d.K.length;g++){var h=d.K[g],k=h.ry;if(h.pb==a)for(h=0;h<k.length;h++)ma.oy(k[h].B,f,e)}}function ja(a,b){Ka.zt(b);La.lm(b);if(b.gt)for(var c=la(a,Ua),d=0;d<c.length;d++)for(var e=
c[d].Qa,f=0;f<e.length;f++)for(var g=e[f].ra,h=0;h<g.length;h++){var k=g[h];k.Vb&&(k=k.qa,N.RJ(k)&&La.CR(k))}}function aa(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].data,e=0;e<d.materials.length;e++){var f=d.materials[e];-1==b.indexOf(f)&&b.push(f)}return b}function P(a,b,c){for(var d=a.F,e=Ea.oa(a.Ui,a).ea,f=0;f<e.length;f++){var g=e[f];ma.$P(g,b/c);ma.Sj(g,!1);d.Jc&&ma.az(g,d.Jc)}if(d.Jc){d.ht=!0;e=la(a,[S.Re]);for(f=0;f<e.length;f++)e[f].Ba=!0;e=la(a,[S.Vc]);for(f=0;f<e.length;f++)e[f].Ba=
!0}var h=d.Ja;ga.sR(h,function(d,e,f){if(d.uq){var g=d.Al*b,k=d.Bl*c;if(e)for(e=0;e<f.Xa.length;e++)f.Xa[e]==d&&Da.resize(d.Ya,g,k);else switch(Da.Em(d.Ya)&&Da.resize(d.Ya,g,k),d=f.B,d.width=g,d.height=k,f.type){case S.Kn:ea(a,{dof_power:f.B.dof_power});break;case S.Ln:ra(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case S.Hn:Ba(a,{bloom_blur:f.$l});break;case S.Vl:f=ga.mc(h,f,S.Zb);g=ga.mc(h,f,S.Zb);k=ga.mc(h,g,S.Zb);d=ga.mc(h,k,S.Zb);ga.od(f,
1/b,1/c);ga.od(g,1/b,1/c);ga.od(k,1/b,1/c);ga.od(d,1/b,1/c);break;default:ga.od(f,1/b,1/c)}}})}function la(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];a.F.Ja&&sa.ha(a.F.Ja,function(a,b){b.type==e&&c.push(b)})}return c}function T(a,b){return ga.dc(a.F.Ja,b)}function ka(a){var b=d();b&&sa.ha(b.F.Ja,function(b,c){var d=c.B;d&&d.type==ma.Yd&&(c.$r=a)})}function ea(a,b){var c=la(a,[S.Kn]);if(!c.length)return Ia.error("DOF is not enabled on the scene. Check camera settings"),0;for(var d=0;d<c.length;d++){var e=
c[d],f=b,g=a,h=e.B.dof_bokeh,k=h?la(g,[S.Eu]):[],g=g.F.Ja;if("boolean"==typeof f.dof_on&&(e.B.dof_on=f.dof_on,h))for(var m=0;m<k.length;m++)k[m].B.dof_on=f.dof_on;if("number"==typeof f.dof_distance&&(e.B.dof_distance=f.dof_distance,h))for(m=0;m<k.length;m++)k[m].B.dof_distance=f.dof_distance;if("number"==typeof f.dof_front_start&&(e.B.dof_front_start=f.dof_front_start,h))for(m=0;m<k.length;m++)k[m].B.dof_front_start=f.dof_front_start;if("number"==typeof f.dof_front_end&&(e.B.dof_front_end=f.dof_front_end,
h))for(m=0;m<k.length;m++)k[m].B.dof_front_end=f.dof_front_end;if("number"==typeof f.dof_rear_start&&(e.B.dof_rear_start=f.dof_rear_start,h))for(m=0;m<k.length;m++)k[m].B.dof_rear_start=f.dof_rear_start;if("number"==typeof f.dof_rear_end&&(e.B.dof_rear_end=f.dof_rear_end,h))for(m=0;m<k.length;m++)k[m].B.dof_rear_end=f.dof_rear_end;"number"==typeof f.dof_bokeh_intensity&&(e.B.dof_bokeh_intensity=f.dof_bokeh_intensity,h&&(k=ga.xw(g,e,S.Zb),k[0].B.dof_bokeh_intensity=f.dof_bokeh_intensity,k[1].B.dof_bokeh_intensity=
f.dof_bokeh_intensity,k[0]=ga.mc(g,k[0],S.Zb),k[0].B.dof_bokeh_intensity=f.dof_bokeh_intensity));if("number"==typeof f.dof_power)if(h){f=f.dof_power;e.B.dof_power=f;var f=f/2,h=e.B.width,m=e.B.height,l=[1/h,0],O=[1/h*.5,1/m*.866],n=[-1/h*.5,1/m*.866],k=ga.xw(g,e,S.Zb);ga.Ac(k[0],f);ga.od(k[0],n[0],n[1]);ga.Ac(k[1],f);ga.od(k[1],O[0],O[1]);k[0]=ga.mc(g,k[0],S.Zb);ga.Ac(k[0],f);ga.od(k[0],l[0],l[1]);e.B.gd&&(k[0]=ga.mc(g,k[0],S.Eu),k[0]=ga.mc(g,k[0],S.Zb),ga.od(k[0],1/h,1/m),k[0]=ga.mc(g,k[0],S.Zb),
ga.od(k[0],1/h,1/m))}else e.B.dof_power=f.dof_power,k=ga.mc(g,e,S.Zb),g=ga.mc(g,k,S.Zb),ga.Ac(k,e.B.dof_power),ga.od(k,1/e.B.width,1/e.B.height),ga.Ac(g,e.B.dof_power),ga.od(g,1/e.B.width,1/e.B.height)}}function Ba(a,b){var c=la(a,[S.Qq]),d=la(a,[S.Hn]);if(!c.length||!d.length)return Ia.error("Bloom is not enabled on the scene"),0;if("number"==typeof b.key)for(var e=0;e<c.length;e++)c[e].nr=b.key,c[e].Ba=!0;if("number"==typeof b.edge_lum)for(e=0;e<c.length;e++)c[e].mr=b.edge_lum,c[e].Ba=!0;if("number"==
typeof b.blur)for(e=0;e<d.length;e++){var f=a.F.Ja,c=ga.mc(f,d[e],S.In),f=ga.mc(f,c,S.In);d[e].$l=b.blur;ga.Ac(c,b.blur);ga.od(c,1/d[e].B.width,1/d[e].B.height);ga.Ac(f,b.blur);ga.od(f,1/d[e].B.width,1/d[e].B.height)}}function ra(a,b){var c=la(a,[S.Ln]);if(!c.length)return Ia.error("Glow is not enabled on the scene"),null;for(var d=0;d<c.length;d++){for(var e=c[d],f=b,g=a.F.Ja,h=ga.mN(g,e),k=0;k<h.length;++k){var m=h[k];if(m.type==S.Zb&&"GLOW_MASK_LARGE"==m.sb)var l=m;if(m.type==S.Zb&&"GLOW_MASK_SMALL"==
m.sb)var O=m}h=ga.mc(g,l,S.Zb);g=ga.mc(g,O,S.Zb);"number"==typeof f.small_glow_mask_coeff&&(e.small_glow_mask_coeff=f.small_glow_mask_coeff,e.Ba=!0);"number"==typeof f.large_glow_mask_coeff&&(e.large_glow_mask_coeff=f.large_glow_mask_coeff,e.Ba=!0);"number"==typeof f.small_glow_mask_width&&(e.small_glow_mask_width=f.small_glow_mask_width,ga.Ac(O,f.small_glow_mask_width),ga.od(O,1/e.B.width,1/e.B.height),O.Ba=!0,ga.Ac(g,f.small_glow_mask_width),ga.od(g,1/e.B.width,1/e.B.height),g.Ba=!0);"number"==
typeof f.large_glow_mask_width&&(e.large_glow_mask_width=f.large_glow_mask_width,ga.Ac(l,f.large_glow_mask_width),ga.od(l,1/e.B.width,1/e.B.height),l.Ba=!0,ga.Ac(h,f.large_glow_mask_width),ga.od(h,1/e.B.width,1/e.B.height),h.Ba=!0)}}function ta(a,b,c){var d=a.F,e=d.Bc;if(!e.Xo)return e.fk;var f=e.waves_height,g=e.waves_length,h=e.fk,k=Xa.length(d.Ti)||1;a=T(a,S.Db).time;a*=k;k=Lb;k[0]=20/g*(b-.25*a);k[1]=20/g*(c-.25*a);var m=ya.NA(k);k[0]=17/g*(c+.1*a);k[1]=17/g*(b+.1*a);var k=m+ya.NA(k)-1,l=e.dst_noise_scale0,
m=e.dst_noise_scale1,O=e.dst_noise_freq0,n=e.dst_noise_freq1,p=Lb;p[0]=l*(b+O*a);p[1]=l*(c+O*a);l=ya.wy(p);p[0]=m*(c-n*a);p[1]=m*(b-n*a);m=f*l*ya.wy(p);e.Tj?(n=(b-e.bn[0])/e.cn[0],p=(e.bn[1]+c)/e.cn[1],n+=.5,p+=.5,1<n||0>n||1<p||0>p?b=m:(d=ya.ZB(d.sy,e.ty,n,p),n=e.dir_noise_scale,p=e.dir_noise_freq,l=Math.sqrt(d),O=Math.max(l,e.dst_min_fac),b=f*Math.max(d,e.dir_min_shore_fac)*Math.sin(l/(g/e.mx/Math.PI)+e.dir_freq*a)*Math.max(ya.wy([n/g*(b+p*a),n/g*(c+p*a)]),e.dir_min_noise_fac)*(1-O)+m*O,k*=d)):
b=m;return h+(b+.05*k)}function qa(a,b){a.sp&&a.type==S.Zb&&b.Vb!=a.Vb&&(a.Vb=b.Vb);b.Vb||a.type!=S.Vl||(a.dw=0)}function fa(a,b,c,d){var e=sa.Ra(a,b);ma.Kt(e.B,c,d);e.dv=!0;sa.Zj(a,b,function(b,e,f){f.active&&f.from==c&&ga.bK(f)&&va(a,b,f.to,d)});sa.Hh(a,b,function(b,e,f){f.active&&f.from==c&&f.from==f.to&&fa(a,b,c,d)})}function va(a,b,c,d){a=sa.Ra(a,b).Qa;for(b=0;b<a.length;b++)for(var e=a[b].ra,f=0;f<e.length;f++)N.GP(e[f].qa,d,c)}function M(a){for(var b=la(a,[S.Oh]),c=0;c<b.length;c++){var d=
b[c],e=d.B,f=a.Ui.o,g=ab.ec(f.v,Mb),h=Wa;h[0]=0;h[1]=0;h[2]=-d.hd[2]/2;d=ab.Qc(f.v,Gb);Xa.transformQuat(h,d,h);h[0]+=g[0];h[1]+=g[1];h[2]=0;Ra.identity(d);ma.oy(e,h,d)}}function ua(a,b){sa.ha(a,function(c,d){if(d.type==S.Ug){d.Xa[0]&&d.Gh[0]||ya.D("Wrong MOTION_BLUR subscene");var e=d.Xa[0],f=d.Gh[0];d.Gh[0]=d.B.lc;sa.Zj(a,c,function(b,c,d){d.active&&va(a,b,d.to,f)});fa(a,c,e.from,f);va(a,c,e.to,d.Gh[0]);d.iD=Math.exp(-b/d.mb_factor)}})}function na(a){return a.F.Ti}function xa(a,b){if(!a.F.Dh)return null;
for(var c=a.F.Dh.ai,d=0;d<c.length;d++)if(c[d]==b)return d;c=a.F.Dh.Qv;for(d=0;d<c.length;d++)if(c[d]==b)return d;return null}var N=q("__batch"),wa=q("__boundings"),ma=q("__camera"),Ma=q("__config"),Aa=q("__container"),U=q("__debug"),sa=q("__graph"),Ha=q("__hud"),Ga=q("__input"),O=q("__mat4"),pa=q("__nodemat"),Va=q("__objects");q("__textures");var Ea=q("__obj_util"),Ca=q("__physics"),Ka=q("__prerender"),Ta=q("__primitives"),Ia=q("__print"),Ra=q("__quat"),La=q("__renderer"),ga=q("__scenegraph"),Fa=
q("__sfx"),ia=q("__shaders"),S=q("__subscene"),Da=q("__textures"),ab=q("__tsr"),ya=q("__util"),Xa=q("__vec3"),Wc=q("__vec4"),zb=q("__version"),Na=Ma.Jk,za=Ma.H,Pa=Ma.pg,$a=Ma.Ic,db=Ma.$m,vb=[S.Oh,S.Xc,S.Db,S.Vc,S.tf,S.Id,S.qd,S.Wc,S.Qe,S.qe,S.Wd,S.dg,S.Re,S.fg,S.eg];a.XS=vb;var Fb=[S.Db,S.Vc,S.tf,S.Id,S.qd,S.Wc,S.Ul,S.Pq,S.gg,S.Qe,S.qe,S.Qq,S.Re,S.Xc,S.Wd,S.dg,S.fg],Ua=[S.Db,S.Uq,S.Vc,S.tf,S.Id,S.qd,S.Wc,S.Qe,S.qe],Xc=[S.Xc,S.Db,S.Vc,S.tf,S.Id,S.qd,S.Wc,S.Qe,S.qe,S.Wd,S.dg,S.Re,S.Ul,S.fg,S.eg],eb=
[S.Db,S.Vc,S.tf,S.Id,S.qd,S.Wc,S.Qe,S.qe],ob=null,Ya=null,Sa=[],Ab=null,Yc=Math.PI/2,Lb=new Float32Array(2),Mb=new Float32Array(3),Wa=new Float32Array(3),Gb=new Float32Array(4),qb=new Float32Array(4),cc=new Float32Array(16),Pc=new Float32Array(24),vc=new Float32Array(24),Tb=wa.sd(),Xb=wa.sd(),Pb=0,Qc=-Infinity;a.DT=function(){return{}};a.set_active=function(a){Ya=a;Fa.ZP(a)};a.pP=function(a,b){var c=a.F,d=ga.SK(c.Ja);if(a==b){P(a,Aa.oC(),Aa.nC());for(var e=0;e<d.length;e++)a.F.wl.push(d[e])}else for(e=
a.wf[0],P(a,e.Bi,e.Bi),e=0;e<d.length;e++)b.F.wl.push(d[e]);d=la(a,Xc);for(e=0;e<d.length;e++)d[e].Ti.set(c.Ti);for(e=0;e<c.wl.length;e++)c.wl[e].type==S.Xc&&La.lm(c.wl[e])};a.nh=d;a.Vr=c;a.get_active=b;a.xa=function(){return Ya?!0:!1};a.mj=function(a){return a.Ui};a.kp=function(){return Sa};a.yw=function(){if(1==Sa.length)return Sa;for(var a=0;a<Sa.length;a++){var b=Sa[a].F.Ja;sa.ha(b,function(b,c){for(var d=c.Qa,e=0;e<d.length;e++)for(var f=d[e].ra,g=0;g<f.length;g++){for(var h=f[g],k=h.qa.Sa,m=
null,l=0;l<k.length;l++)if("SCENE"==k[l].source&&k[l].jq==Sa[a].name&&c.type!=S.Gu){Ia.error('Texture-scene loop detected. A scene is rendered to texture "'+k[l].name+'" yet this texture belongs to the same scene.');m=h.qa;break}if(m)for(k=m.Sa,m.Sa=[],m.Ie=[],N.BR(m,null),N.vc(m),S.Ec(c,h),l=0;l<k.length;l++);}})}for(var c=[],a=0;a<Sa.length;a++)if(b=Sa[a],!b.wf.length){b=sa.xh(Ab,b);sa.YL(Ab,b);b=sa.mn(Ab,b,sa.Sl);b=sa.Py(b);sa.ha(b,function(a,b){c.push(b)});break}return c};a.KI=function(a,b,c,
d,O){a.wf=a.wf||[];a.na=null;var n=a.F,pa=Ea.oa(a.Ui,a),N=a.Ui.o;n.En=[];var y=a.world;n.aO=c.length;n.Ii=B(c);n.Pt=x(y,n.Ii);n.Gn=D(y,n.Pt);n.dG=H(y);if(y=!a.wf.length)a:{if("HMD"==za.stereo){if(pa.ea[0].type!=ma.Zc){Ia.warn("Head-mounted display stereo is disabled for the non-perspective camera");za.stereo="NONE";y=!1;break a}if(!Ga.can_use_device(Ga.DEVICE_HMD)){Ia.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");za.stereo="NONE";y=!1;break a}}y="HMD"==za.stereo}n.As=
y;if(y=!a.wf.length)pa.ea[0].type!=ma.Zc&&"ANAGLYPH"==za.stereo?(Ia.warn("Anaglyph stereo is disabled for the non-perspective camera"),za.stereo="NONE",y=!1):y="ANAGLYPH"==za.stereo;n.anaglyph_use=y;n.AI=!n.anaglyph_use&&Q(a,O);n.Dh=l(a,b,d);n.sJ=f(a);n.HO=F(a);n.PJ=u(a);n.yN=r(a);n.XO=z(a);n.oj=J(a);n.dof=za.dof&&(0<N.dof_distance||N.dof_object);n.motion_blur=za.motion_blur&&a.b4w_enable_motion_blur;n.compositing=za.compositing&&a.b4w_enable_color_correction;n.antialiasing=za.antialiasing&&1==za.uc&&
"NONE"!=a.b4w_antialiasing_quality;n.ssao=za.ssao&&a.b4w_enable_ssao;n.god_rays=za.god_rays&&a.b4w_enable_god_rays&&n.Ii;n.HL=za.Mr;n.mp=a.b4w_glow_settings.render_glow_over_blend;n.cR=k(a);O=h(d);n.cD=O;n.refractions=I(a,O);n.Jc=g(a,c,d);n.Bc=w(d);n.Tg=p(d);n.NQ=v(d);n.shore_smoothing=e(d);n.yc=C(a,d);n.rK=t(a,d);n.outline=m(a,d);n.hi=A(a,d);switch(za.reflection_quality?za.reflection_quality:a.b4w_reflection_quality){case "LOW":n.bi=db.pB;n.Lg=db.DD;break;case "MEDIUM":n.bi=db.BL;n.Lg=db.jP;break;
case "HIGH":n.bi=db.AL;n.Lg=db.iP;break;default:n.bi=db.pB,n.Lg=db.DD}Aa.PN()?(Ia.log("%cENABLE HIDPI MODE","color: #00a"),n.Wz="AA_QUALITY_LOW",n.Xm=1,za.uc=1):1<za.uc?(Ia.log("%cENABLE MSAA RENDERING: "+za.uc+"x","color: #00a"),n.Xm=1):(n.Wz="AA_QUALITY_"+a.b4w_antialiasing_quality,n.Xm="MEDIUM"===a.b4w_antialiasing_quality&&za.quality===Ma.P_ULTRA||"HIGH"===a.b4w_antialiasing_quality&&za.quality===Ma.P_HIGH?1.33:"HIGH"===a.b4w_antialiasing_quality&&za.quality===Ma.P_ULTRA||"NONE"===a.b4w_antialiasing_quality&&
za.quality===Ma.P_ULTRA?2:1);c=a.wf.sort(function(a,b){return b.Bi-a.Bi});n.Ja=ga.RK(n,pa,N,c);n.wl=[];n.ht=!1;n.zx=!1;n.Ax=!1;n.Ti=new Float32Array(3);Sa.push(a);Ab||(Ab=sa.create());sa.O(Ab,a);for(n=0;n<b.length;n++)Ea.jy(b[n],!0,a);a=Aa.get_container();Aa.resize(a.clientWidth,a.clientHeight,!0)};a.LI=function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d].F;e&&e.li&&(e.Jq=c,a.F.En.push(b[d]))}};a.ls=function(a){return a.F.Ja};a.SB=function(a,b){sa.ha(b,function(c,d){var e=null;switch(d.type){case S.Zb:e=
N.Kv(d.yt);break;case S.Uq:e=N.XK(d);break;case S.Su:e=N.YK(d);break;case S.xz:e=N.EK();break;case S.Ul:e=N.IK(d.yD,d.Kh,d.ln);break;case S.Pq:e=N.JK();break;case S.Ug:e=N.NK();break;case S.Eu:e=N.BK(d.ZA);break;case S.Kn:var e=N.FK(d),f=d.B.dof_power;if(d.B.dof_bokeh){var f=f/2,g=ga.xw(b,d,S.Zb);ga.Ac(g[0],f);ga.Ac(g[1],f);g[0]=ga.mc(b,g[0],S.Zb);ga.Ac(g[0],f)}else{var g=ga.mc(b,d,S.Zb),h=ga.mc(b,g,S.Zb);ga.Ac(g,f);ga.Ac(h,f)}break;case S.Vl:var e=N.OK(),f=ga.mc(b,d,S.Zb),g=ga.mc(b,f,S.Zb),h=ga.mc(b,
g,S.Zb),k=ga.mc(b,h,S.Zb);ga.Ac(g,d.iv);ga.Ac(f,d.iv);ga.Ac(k,d.iw*d.Gp);ga.Ac(h,d.iw*d.Gp);break;case S.Ln:e=N.HK();break;case S.Fu:e=N.CK();break;case S.qz:e=N.wK(d);break;case S.Qu:case S.Sq:case S.Qn:case S.Tq:e=N.VK(d.type);break;case S.uf:e=N.ZK(d.sb);break;case S.gg:e=N.DK(a,d);break;case S.LUMINANCE:e=N.KK();break;case S.hG:e=N.xK();break;case S.Qq:e=N.LK();break;case S.In:e=N.zK();break;case S.Hn:e=ga.mc(b,d,S.In);f=ga.mc(b,e,S.In);ga.Ac(e,d.$l);ga.Ac(f,d.$l);e=N.AK();break;case S.kI:e=N.wL();
break;case S.Rl:e=N.vK();break;case S.On:e=N.PK()}e&&(f=S.sh(e,Ea.No("NONE")),S.Ec(d,f),ga.Ck(b,d,e),G(e))})};a.append_object=function(a,b,c,d){switch(b.type){case "MESH":case "LINE":case "WORLD":var e=a.F.Ja,f=b.o;!ga.dc(e,S.Xc)&&f.Gd&&(f.Gd=!1);f=la(a,vb);(c||d)&&Ca.append_object(b,a);for(d=0;d<f.length;d++){var g=f[d],h=b,k=e,m=a,l=c;switch(g.type){case S.Db:Y(g,h,k,"OPAQUE",m,l);break;case S.Vc:Y(g,h,k,"BLEND",m,l);break;case S.tf:Y(g,h,k,"XRAY",m,l);break;case S.Id:Y(g,h,k,"GLOW",m,l);break;
case S.qd:case S.Wc:W(g,h,k,!1,m,l);break;case S.Qe:case S.qe:W(g,h,k,!0,m,l);break;case S.Re:for(var n=Ea.oa(h,m).R,O=0;O<n.length;O++){var p=n[O];if("SHADOW"==p.type&&"RECEIVE"==p.sb&&p.Gd){if(!l&&(R(p,g,h,k,"SHADOW",m),!N.vc(p)))continue;var r=S.sh(p,h.o);S.Ec(g,r);ga.Ck(k,g,p);G(p)}}break;case S.Xc:n=!1;O=h.o;h=Ea.oa(h,m).R;p=ga.dc(k,S.Oh);for(r=0;r<h.length;r++){var t=h[r];if("SHADOW"==t.type&&"CAST"==t.sb){n=!0;if(!l){var u=g.kt;N.mb(t,"NUM_LIGHTS",u);N.mb(t,"NUM_LFACTORS",u%2?Math.floor(u/
2)+1:u/2);ia.ia(t.ab,"SHADOW_USAGE","SHADOW_CASTING");t.yc&&p&&E(t,p,O);N.mb(t,"SHADOW_TEX_RES",ia.N(m.F.Jc.csm_resolution));if(!N.vc(t))continue}t.yc&&(m.F.Jc.RL=!0);u=S.sh(t,O);S.Ec(g,u);ga.Ck(k,g,t);G(t)}}n&&(h=m.F.Jc,l=ga.dc(k,S.Db),ba(g,m,l.B,h,!0));break;case S.Wd:X(g,h,k,m,l);break;case S.dg:X(g,h,k,m,l);break;case S.fg:n=h.o;O=Ea.oa(h,m).R;for(p=0;p<O.length;p++)if(r=O[p],"COLOR_ID"==r.type&&"OUTLINE"==r.sb){if(!l&&(R(r,g,h,k,"COLOR_ID",m),N.mb(r,"USE_OUTLINE",1),!N.vc(r)))continue;r=S.sh(r,
n);S.Ec(g,r)}break;case S.Oh:k=h.o;h=Ea.oa(h,m).R;for(m=0;m<h.length;m++)if(n=h[m],"GRASS_MAP"==n.type){if(!l&&!N.vc(n))if("DEBUG"===zb.type())N.er(n,"error.glslv","error.glslf"),N.vc(n);else continue;n=S.sh(n,k);S.Ec(g,n);n=g.B;t=k.Pa;O=g.hd[0];p=g.hd[1];r=g.hd[2];0==O&&0==p?(O=t.min_z,p=t.max_z):(O=Math.min(O,t.min_z),p=Math.max(p,t.max_z));t=1E-4*(p-O);O-=t;p+=t;g.hd[0]=O;g.hd[1]=p;ma.kE(n,r/2,r/2,-p,-O);ma.Sj(n,!1)}break;case S.eg:for(n=h.o,h=Ea.oa(h,m).R,m=0;m<h.length;m++)O=h[m],"DEBUG_VIEW"==
O.type&&ha(g,n,k,l,O)}}break;case "LAMP":da(b,a)}for(d=0;d<b.K.length;d++)for(c=b.K[d].R,e=0;e<c.length;e++)null==c[e].ib&&c.splice(e--,1);Ea.jy(b,!0,a)};a.dz=y;a.ky=function(a){a.F.ht=!0};a.VR=function(a,b){sa.ha(b,function(b,c){c.type===S.Xc&&(ab.copy(a.v,c.B.v),ab.copy(a.Me,c.B.gq))})};a.kV=oa;a.XM=function(a,b){for(var c=a.F.Jc,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=ma.zL(c,b,e);return d};a.hT=ha;a.ur=Z;a.uo=ca;a.is_hidden=function(a){return a.o.hide};a.SD=function(a,b){for(var c=
0;c<a.K.length;c++)for(var d=la(a.K[c].pb,vb),e=0;e<d.length;e++)for(var f=d[e].Qa,g=0;g<f.length;g++)for(var h=f[g].ra,k=h.length-1;0<=k;k--){var m=h[k];if(m.Ee==a.o)if(m.qa){if("undefined"==typeof b||-1!=m.qa.Jb.indexOf(b)||0==m.qa.Jb.length)N.YA(m.qa),h.splice(k,1)}else h.splice(k,1)}};a.KR=function(a,b){for(var c=a.nb,d=Ea.oa(a,b).Bp,e=la(b,Fb),f=0;f<e.length;f++){var g=e[f];g.Ap.set(c.Fo,4*d);g.Ba=!0}};a.wq=da;a.YR=function(a){a=a.K;for(var b=0;b<a.length;b++)y(a[b].pb)};a.XR=ja;a.cleanup=function(){for(var a=
0;a<Sa.length;a++){var b=Sa[a];sa.ha(b.F.Ja,function(a,b){if(b.type!=S.Xl){var c=b.B;La.AP(c.ee,c.lc,c.we,c.width,c.height);for(var c=b.Qa,d=0;d<c.length;d++)for(var e=c[d].ra,f=0;f<e.length;f++){var g=e[f].qa;g&&N.YA(g)}}});b.F.Ja=null;b.F.wl=[]}Ya=ob=null;Sa.length=0;Ab=null};a.bD=function(a,b,c){a=ma.fM(a,a.near,a.far,null,!0);var d=Ta.IM(a);a=Ea.No("DYNAMIC");a.Pa=a.U={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.gb=a.va=wa.oJ();var e=a.gb.Wa;a.jb=a.Z=wa.fo([e,0,0],
[0,e,0],[0,0,e],a.gb.M);a.wn=!1;c=N.UK(d,c);c=S.sh(c,a);S.Ec(b,c)};a.gU=function(a){return[a.frame_start,a.frame_end]};a.sE=function(a,b,c){Aa.GQ(a,b,c);Ya&&P(Ya,a,b)};a.VU=P;a.Hi=la;a.Aa=T;a.yP=function(){ka(!1)};a.zP=function(){ka(!0)};a.get_environment_colors=function(a){a=T(a,S.Db);var b=a.Md,c=a.Vd,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.wg,d,e]};a.set_environment_colors=function(a,b,c,d){a=la(a,Fb);for(var e=0;e<a.length;e++){var f=a[e];f.Md.set(c);f.Vd.set(d);
f.wg=b;f.Ba=!0}};a.get_sky_params=function(a){if(a=T(a,S.gg)){var b={};b.color=Array(3);Xa.copy(a.en,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=
a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.eN=function(a){return la(a,Ua)[0].Ef[0]};a.cN=function(a){return la(a,Ua)[0].Ef[1]};a.fN=function(a){return la(a,Ua)[0].Ef[2]};a.dN=function(a){return la(a,Ua)[0].Ef[3]};a.hE=function(a,b){for(var c=la(a,Ua),d=0;d<c.length;d++){var e=c[d];e.Ef[0]=b;e.Ba=!0}};a.fE=function(a,b){for(var c=la(a,Ua),d=0;d<c.length;d++){var e=c[d];e.Ef[1]=b;e.Ba=!0}};a.iE=function(a,b){for(var c=la(a,Ua),d=0;d<c.length;d++){var e=c[d];
e.Ef[2]=b;e.Ba=!0}};a.gE=function(a,b){for(var c=la(a,Ua),d=0;d<c.length;d++){var e=c[d];e.Ef[3]=b;e.Ba=!0}};a.get_fog_color_density=function(a,b){var c=b||[],d=la(a,Ua)[0].ce;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];return c};a.set_fog_color_density=function(a,b){for(var c=la(a,Ua),d=0;d<c.length;d++){var e=c[d];e.ce.set(b);e.Ba=!0}};a.get_ssao_params=function(a){var b=T(a,S.Uq),c=T(a,S.Su);a=T(a,S.Db);if(!b)return null;var d={};d.quality=b.nq;d.use_hemisphere=b.Yt;d.use_blur_depth=c.Vt;d.blur_discard_value=
c.Wt;d.radius_increase=b.$t;d.influence=b.Zt;d.dist_factor=b.Xt;d.ssao_only=a.ssao_only;d.ssao_white=b.ssao_white;return d};a.get_dof_params=function(a){a=T(a,S.Kn);if(!a)return null;var b={};b.dof_on=a.B.dof_on;b.dof_distance=a.B.dof_distance;b.dof_front_start=a.B.dof_front_start;b.dof_front_end=a.B.dof_front_end;b.dof_rear_start=a.B.dof_rear_start;b.dof_rear_end=a.B.dof_rear_end;b.dof_power=a.B.dof_power;b.dof_bokeh=a.B.dof_bokeh;b.dof_bokeh_intensity=a.B.dof_bokeh_intensity;b.dof_object=a.B.dof_object;
return b};a.set_dof_params=ea;a.get_god_rays_params=function(a){var b=la(a,[S.Ul]);a=T(a,S.Pq);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].Im;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=N.Kd(b[0].Qa[0].ra[0].qa,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=la(a,[S.Ul]),d=la(a,[S.Pq]);if(!c.length||!d.length)return Ia.error("God Rays are not enabled on the scene"),0;if("number"==typeof b.god_rays_intensity)for(var e=0;e<d.length;e++)d[e].god_rays_intensity=
b.god_rays_intensity;if("number"==typeof b.god_rays_max_ray_length)for(var f=b.god_rays_max_ray_length,e=0;e<c.length;e++)c[e].Im=f,c[e].Dt=f/c[e].ln/(e+1),c[e].Ba=!0;if("number"==typeof b.god_rays_steps)for(var g=ia.N(b.god_rays_steps,1),f=c[0].Im,e=0;e<c.length;e++){c[e].ln=g;c[e].Dt=f/g/(e+1);c[e].Ba=!0;var h=c[e].Qa[0].ra[0],k=h.qa;N.mb(k,"STEPS_PER_PASS",g);N.vc(k);S.Ec(c[e],h)}for(e=0;e<d.length;e++)d.Ba=!0};a.get_bloom_params=function(a){var b=T(a,S.Qq);a=T(a,S.Hn);if(!b||!a)return null;var c=
{};c.key=b.nr;c.edge_lum=b.mr;c.blur=a.$l;return c};a.set_bloom_params=Ba;a.get_glow_material_params=function(a){a=T(a,S.Ln);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.set_glow_material_params=ra;a.get_wind_params=function(a){var b=na(a);a=Xa.length(b);if(0==a)return null;var b=ya.rad_to_deg(Math.atan2(b[0],-b[1])),
c={};c.wind_dir=b;c.wind_strength=a;return c};a.VP=function(a){a.F.zx=!0};a.get_water_surface_level=ta;a.get_water_mat_params=function(a,b){var c=a.F.Bc,d=T(a,S.Db);d&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,d.Lh&&(b.water_fog_density=d.Lh[3],c=b.water_fog_color=[],c[0]=d.Lh[0],c[1]=d.Lh[1],c[2]=d.Lh[2]))};a.set_water_params=function(a,b){var c=a.F.Bc;if(!c)return Ia.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=
b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=
b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.Xo=b.water_dynamic);for(var d=la(a,eb),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&c.ce&&(f.Lh[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.ce&&f.Lh.set(b.water_fog_color);"number"==typeof b.waves_height&&
(f.lz=b.waves_height);"number"==typeof b.waves_length&&(f.mz=b.waves_length);f.Ba=!0}};a.get_shore_dist=function(a,b,c){var d=a.F.Bc;if(!d.Tj)return 100;var e=d.mx;a=d.fk;var f=(b[0]-d.bn[0])/d.cn[0],g=(d.bn[1]+b[1])/d.cn[1],f=f+.5,g=g+.5;if(!(1<f||0>f||1<g||0>g))return d=e*ya.ZB(Ya.F.sy,d.ty,f,g),b=(a-b[2])*c,b=Math.sqrt(d*d+b*b)};a.update=function(a,c){for(var d=b().Ui.o,e=0;e<Sa.length;e++){var f=Sa[e],g=f.F.Ja,h=f.F;if(h.Bc)var k=ab.get_trans_view(d.v),m=k[2]-ta(f,k[0],k[1]);for(k=0;k<h.En.length;k++){var l=
h.En[k].F,n=l.Ta,O=l.ed;if(!(f.b4w_use_nla&&l.ck||!n&&!O)&&Da.YF(l)){var p=Da.VF(l),r=Da.XF(l);n&&za.is_mobile_device&&(r-=5);var t=Da.qS(l);p>=t&&l.Ni||p<r?(Da.reset_video(l),O&&(l.Rj=Da.Jt(l,a))):p>=t&&!l.Ni?Da.pause_video(l):Da.ZF(l)&&(n?Da.DF(l):(n=Da.Jt(l,a),n!=l.Rj&&(Da.CF(l),l.Ai++),l.Rj=n))}}sa.ha(g,function(b,c){-1<Xc.indexOf(c.type)&&(c.time=a);h.Bc&&(c.uv=m)})}for(e=0;e<Sa.length;e++)if(f=Sa[e],h=f.F,g=h.Ja,d=h.wl,d.length)for(h.ht&&(V(f),h.ht=!1),h.zx&&(M(f),h.zx=!1),h.Ax&&(K(f),h.Ax=
!1),h.motion_blur&&ua(g,c),f=ga.dc(g,S.fg),k=0;k<d.length;k++)g=d[k],Ka.zt(g),f&&qa(g,f),La.lm(g);za.show_hud_debug_info&&Ha.KQ(Sa,c)};a.IP=function(a){a.F.Ax=!0};a.pw=function(a){var b=[];sa.ha(a.F.Ja,function(a,c){b.push(c)});return b};a.get_cam_water_depth=function(){var a=T(Ya,S.Vc),b=Ya;return a||b.F.Bc?a.uv:null};a.BF=function(a){sa.ha(a.F.Ja,function(a,b){b.Ba=!0})};a.cQ=function(a,c){a.debug_view_mode=c;a.Vb=c!=U.DV_NONE;a.yb=c==U.DV_TRANSPARENT_WIREFRAME;a.Ba=!0;for(var d=b(),e=0;e<eb.length;e++)for(var f=
la(d,[eb[e]]),g=0;g<f.length;g++)f[g].aw=c==U.DV_RENDER_TIME};a.bQ=function(a,b){a.debug_colors_seed=b;a.Ba=!0};a.wQ=function(a,b){a.tB=b;a.Ba=!0};a.EQ=function(a,b){for(var c=a.Qa,d=0;d<c.length;d++)for(var e=c[d].ra,f=0;f<e.length;f++){var g=e[f].qa;Xa.copy(b,g.wireframe_edge_color);g.ib.Om=!0}};a.yF=function(a,b){var c=b.pm,d=a.F.Ti;if(c&&"WIND"==c.type&&d){var e=ab.get_quat_view(b.o.v);Xa.transformQuat(ya.AXIS_Z,e,d);Xa.normalize(d,d);Xa.scale(d,c.TE,d);c=la(a,Xc);for(e=0;e<c.length;e++)c[e].Ti.set(d);
return!0}return!1};a.dP=function(a,b,c){var d=T(a,S.Wd);if(d){var e=Na.enabled&&(Na.pq===S.Wd||Na.pq===S.dg);if(e)var f=Aa.po(b,c,Lb,d.B);else{var g=Aa.get_canvas();ma.aQ(d.B,b,c,g.clientWidth,g.clientHeight)}Ka.zt(d);d.Vb&&La.lm(d);(a=T(a,S.dg))?(O.copy(d.B.lb,a.B.lb),O.copy(d.B.Tc,a.B.Tc),ya.om(a.B.Tc,a.B.lh),Ka.zt(a),a.Vb&&La.lm(a),b=a.B):b=d.B;if(d.Vb||a&&a.Vb)return e?(f[1]=b.height-f[1],La.Et(b.ee,f[0],f[1])):La.Et(a?a.B.ee:d.B.ee,0,0)}else Ia.error("Object Selection is not available on the scene");
return null};a.set_outline_color=function(a){for(var c=b(),c=la(c,[S.Vl]),d=0;d<c.length;d++){var e=c[d];e.vi.set(a);e.Ba=!0}};a.lU=na;a.get_meta_tags=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.get_custom_prop=function(a){return a.b4w_custom_prop};a.xF=function(a,b){var c=Mb;Xa.negate(b,c);for(var d=0;6>d;d++){var e=a.Hk[d],f=a.Po[d],g=a.B;O.translate(ya.qG[d],c,e);O.multiply(g.lb,e,g.Tc);ya.om(g.Tc,f)}};a.zF=
function(a,b,c){ya.oR(b,c,ya.AXIS_Z,a.B.hc)};a.iA=function(a,b,c){var d=a.F.Dh;if(d&&b)for(var e=0;e<b.length;e++){var f=b[e],g=Ea.oa(f,a);if(-1!=f.o.jd){var h=d.Ah,k=d.xt,f=f.o.jd;k.length&&f<k.length?g.Ah=k[f]:h.length&&f<h.length&&(g.Ah=h[f])}else-1!=f.o.td&&(h=d.ai,k=d.Qv,f=f.o.td,k.length?g.ai=k[f]:h.length&&(g.ai=h[f]))}if(c)for(b=Ea.ms(c,za.ssao&&a.b4w_enable_ssao),c=a.F.Jc,e=0;e<b.length;e++)if(g=Ea.oa(b[e],a),c)for(d=la(a,[S.Xc]),f=0;f<d.length;f++)e==d[f].Pg&&g.ry.push(d[f])};a.marker_frame=
function(a,b){return a.timeline_markers[b]};a.set_hmd_params=function(a){var c=b();if(c=T(c,S.uf))a.distortion_coefs&&(c.Kk[0]=a.distortion_coefs[0],c.Kk[1]=a.distortion_coefs[1],c.Ba=!0),a.chromatic_aberration_coefs&&(c.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],c.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],c.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],c.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],c.Ba=!0),a.base_line_factor&&
(c.Kk[2]=a.base_line_factor,c.Ba=!0),a.inter_lens_factor&&(c.Kk[3]=a.inter_lens_factor,c.Ba=!0),null!=a.enable_hmd_stereo&&(c.enable_hmd_stereo=a.enable_hmd_stereo,c.Ba=!0)};a.ft=function(b,c){for(var d=Sa,e=0;e<d.length;e++)ga.NO(a.ls(d[e]),b,c)};a.wR=function(a){for(var b=Va.Ib(a,"LAMP",Va.DATA_ID_ALL),c=la(a,vb),d=0;d<c.length;d++)for(var e=c[d],f=e.Qa,g=0;g<f.length;g++)for(var h=f[g].ra,k=0;k<h.length;k++){var m=h[k],l=m.qa;"MAIN"==l.type&&(N.AR(l,b,a),N.vc(l),S.Ec(e,m))}};a.PD=function(a){for(var b=
0;b<Sa.length;b++)sa.ha(Sa[b].F.Ja,function(b,c){for(var d=c.Qa,e=0;e<d.length;e++)for(var f=d[e].ra,g=0;g<f.length;g++){var h=f[g];h.qa==a&&S.Ec(c,h)}})}};b4w.module.__physics=function(a,q){function d(a,b){for(var c=a.ve,e=0;e<c.length;e++)c[e].Kg.zq&&b.push(c[e]),d(c[e],b)}function c(a,b,c){for(var d=a.jc.ra,e=0;e<d.length;e++)for(var f=d[e].J,g=0;g<f.ue.length;g++){var h=f.ue[g];"ANY"!=h.Ub&&c!=h.Ub||J(h,a,b)}}function b(a,b,c){if(G.Fs(a))switch(b){case G.xG:var d=g(a);d.jc.cG=!0;G.ga(a,G.NH,Date.now()-performance.now(),L.max_fps,L.qv?ja.LB:0);break;case G.yG:W.dd("URANIUM:",c.slice(1));break;case G.tG:W.error(c);break;case G.uG:R.fbmsg.apply(this,
c.slice(1));break;case G.Fz:var e=n(c.ba);if(e){a=c.trans;d=c.quat;b=c.th;var f=c.Wg,e=e.J;e.Hr=c.time;X.set_sep(a,1,d,e.Sv);Z.copy(b,e.th);Z.copy(f,e.Wg)}break;case G.Dz:(a=n(c.vv))&&X.set_sep(c.trans,1,c.quat,a.I.Rp[c.Sx]);break;case G.vG:if(d=n(c[1]))a=c[4],d=d.Df.or[c[2]],oa.set_translation(d,c[3]),oa.set_rotation(d,a),oa.L(d);break;case G.BG:if(e=n(c[1]))e.I.speed=c[2];break;case G.Bz:d=g(a);B(d,c.tk,c.uk,c.result,null,null,0);break;case G.Cz:d=g(a);B(d,c.tk,c.uk,c.result,c.Bk,c.dh,c.bm);break;
case G.rG:if(e=n(c[1]))a=e.J,a.Ak&&a.Ak(c[2]);break;case G.Ou:case G.Ez:d=g(a);if(a=d.jc.Nj[c.id])if(d=n(c.am),b==G.Ou)b=a.callback,b(a.id,c.If,d,c.ki);else{b=c.If;var f=c.ki,e=c.rh,h=a.callback;e?h(a.id,b,d,f,e,c.ji):h(a.id,b,d,f)}break;case G.AG:C(c.id);break;case G.zG:a=la.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case G.wG:P=c[1];break;case G.sG:a=la.indexOf(a);
console.log("Worker: #"+String(a));console.log(c[1]);break;default:W.error("Wrong message: "+b)}}function g(a){for(var b=0;b<la.length;b++)if(la[b]==a)return T[b]}function n(a){return ka[a]||null}function B(a,b,c,d,f,g,h){a=a.jc.ra;for(var k=0;k<a.length;k++)for(var m=a[k].J,l=0;l<m.ue.length;l++){for(var p=m.ue[l],r=p.Kj,t=!1,O=0;O<r.length;O++){var u=r[O];if(u[0]===b&&u[1]===c){p.Hp[O]=d;t=!0;break}}t&&(r=e(p),f&&p.kv!=b&&(t=f,O=g,u=h,t[0]+=O[0]*u,t[1]+=O[1]*u,t[2]+=O[2]*u,O[0]*=-1,O[1]*=-1,O[2]*=
-1),p.callback(r,r?p.kv==b?n(c):n(b):null,f,g,h))}}function e(a){a=a.Hp;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function v(){ra.body++;return ra.body}function w(a){var b=Ba.indexOf(a);return-1==b?(Ba.push(a),Ba.length-1):b}function h(a,b){return{ba:a,type:b,vh:0,Js:!1,Uj:!0,Ce:!1,is_character:!1,NN:!1,yr:null,Ub:"",Co:0,yT:{},ue:[],Ak:null,Hr:0,Sv:new Float32Array([0,0,0,1,0,0,0,1]),th:new Float32Array(3),Wg:new Float32Array(3),rr:new Float32Array(3),oo:new Float32Array(4),Dp:null}}function l(a,
b){switch(a){case "BOX":var c=b.U;break;case "CYLINDER":c=b.eo;break;case "CONE":c=b.co;break;case "SPHERE":c=b.va;break;case "CAPSULE":c=b.bo}return c}function x(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===typeof a.M&&(b.center=a.M);
"number"===typeof a.Wa&&(b.radius=a.Wa);"number"===typeof a.height&&(b.height=a.height);return b}function k(a,b,c,d,e){var f=X.get_trans_view(a.o.v),g=X.invert(b.o.v,fa),h=new Float32Array(3);X.transform_vec3(f,g,h);switch(b.I.type){case 10:b=b.Le;a=a.o.U;G.ga(e,G.qH,c,h,b.jR,b.dy,(a.max_z-a.min_z)/2,d);break;case 20:G.ga(e,G.pH,c,h,a.jv)}}function f(a){return a.J&&a.J.yr}function F(a,b,c,d,e,f,g,h,k,m){var l;ra.cc++;l=ra.cc.toString(16);var n=b.J.ba;G.ga(u(n),G.xH,l,a,h,n,c,d,e.J.ba,f,g,k,m);b.J.yr=
l}function u(a){for(var b=0;b<T.length;b++)for(var c=T[b].jc.ra,d=0;d<c.length;d++)if(c[d].J.ba==a)return la[b];return null}function r(a){var b=a.J;if(b=b?0===b.vh?!0:!0===b.Js?!0:!1===b.Uj?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=X.ec(a.o.v,ta),c=X.Qc(a.o.v,qa),b=b[0]!=a.J.rr[0]||b[1]!=a.J.rr[1]||b[2]!=a.J.rr[2]||c[0]!=a.J.oo[0]||c[1]!=a.J.oo[1]||c[2]!=a.J.oo[2]||c[3]!=a.J.oo[3];if(b){var b=a.J,d=a.o,c=G.gC(G.Nn);c.ba=b.ba;var e=X.ec(d.v,c.trans),d=X.Qc(d.v,c.quat);Z.copy(e,b.rr);
V.copy(d,b.oo);"DYNAMIC"==b.type&&V.identity(c.quat);G.ga(u(b.ba),G.Nn)}a=a.ve;for(b=0;b<a.length;b++)r(a[b])}function z(a,b,c,d,e){e=e||new Float32Array(3);a=X.get_quat_view(a.o.v);e[0]=b;e[1]=c;e[2]=d;Z.transformQuat(e,a,e)}function J(a,b,c){var d=a.Kj,e=a.Hp,f=a.kv,g=[],h=a.Ub;g||ha.D("At least one destination required");for(var k=0;k<b.jc.ra.length;k++){var m=b.jc.ra[k];if("ANY"==h||m.J.Ub==h&&"NAVMESH"!=m.J.type)m=m.J.ba,g&&-1==g.indexOf(m)&&g.push(m)}for(b=0;b<g.length;b++)h=g[b],f<h&&!D(d,
f,h)?(d.push([f,h]),e.push(!1)):f>h&&!D(d,h,f)&&(d.push([h,f]),e.push(!1));G.ga(c,G.oH,f);G.ga(c,G.wH,d,a.ah)}function D(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function H(a){a.J&&a.J.Ak&&(a=a.J,G.ga(u(a.ba),G.JH,a.ba),a.Ak=null)}function C(a){var b=m(a),c=t(a).jc;c.Nj[a]&&(delete c.Nj[a],c.Wx.splice(c.Wx.indexOf,1),G.ga(b,G.SH,a))}function t(a){for(var b=0;b<T.length;b++){var c=T[b];if(c.jc.Nj[a])return c}return null}function m(a){for(var b=0;b<T.length;b++)if(T[b].jc.Nj[a])return la[b];
return null}function A(a,b,c){if(b.kn){a=a.J.ba;var d=b.nm*b.ep,e=b.mo*b.no,f=-b.hn*b.jn*2*Math.PI/b.oq;b.rp&&(f*=-1);switch(b.type){case 10:G.ga(c,G.eI,a,d,e,f);break;case 20:G.ga(c,G.dI,a,d,e,f)}}}function I(a){return a.Ce&&"CHASSIS"==a.Le.Fe}function p(a){return a.Ce&&"HULL"==a.Le.Fe}function Q(a){return"NAVMESH"==a.Kg.Mp}function y(a){return a.bl&&"MAIN_BODY"==a.rm.Fe}var Y=q("__config"),R=q("__debug"),G=q("__ipc"),E=q("__obj_util"),W=q("__print"),V=q("__quat"),K=q("__scenes"),ba=q("__subscene"),
oa=q("__transform"),X=q("__tsr"),ha=q("__util"),Z=q("__vec3"),ca=q("__version"),da=q("__navmesh"),L=Y.J,ja=Y.H,aa=Y.rd,P=0,la=[],T=[],ka={},ea=[],Ba=["ANY"],ra={body:0,cc:0,ND:0},ta=new Float32Array(3),qa=new Float32Array(4),fa=X.create(),va=X.create();a.HN=function(a){a.jc={cG:!1,ra:[],Nj:{},Wx:[]};var c=L.yq;aa.prevent_caching&&(c+=ca.timestamp());W.log("%cLOAD PHYSICS","color: #0a0",L.yn?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+L.max_fps);W.log("%cPHYSICS PATH","color: #0a0",
c);var d=G.xL(c,!L.yn);G.hJ(d,b);la.push(d);T.push(a);L.ping&&setInterval(function(){G.ga(d,G.PH,performance.now())},1E3)};a.cK=function(a){return a.jc?a.jc.cG:!0};a.cleanup=function(){for(var a=0;a<la.length;a++)G.terminate(la[a]);la.length=0;T.length=0;ka={};ea.length=0;Ba=["ANY"];for(var b in ra)ra[b]=0};a.append_object=function(a,b){if(b.jc){var e;a:{for(var g=0;g<T.length;g++)if(T[g]==b){e=la[g];break a}e=void 0}var m=[];a.Kg.zq&&d(a,m);var n=b.jc.ra;if(I(a)||p(a)||a.is_character||y(a)||a.xn){var r=
Q(a),t;if(r){var u=v(),B=h(u,"NAVMESH"),K=E.oa(a,b).R;B.Dp=null;for(var q=0;q<K.length;q++){var z=K[q];if("PHYSICS"==z.type){B.Dp=da.PO(z.da);break}}t=B}else{var O=e,pa=a.o,C=a.Kg,D=C.Mp,H=v();if("CAMERA"==a.type)var ra=C.fz?C.wr:"BOX",M=l(ra,pa),ba=.5,J=0;else if("EMPTY"==a.type)ra="EMPTY",M=null,J=ba=0;else{var ra=C.fz?C.wr:"BOX",M=l(ra,pa),L=X.get_scale(pa.v);if(1!=L){var P=M;switch(ra){case "BOX":P.min_x*=L;P.max_x*=L;P.min_y*=L;P.max_y*=L;P.min_z*=L;P.max_z*=L;break;case "CYLINDER":case "CONE":case "CAPSULE":P.height*=
L;P.Wa*=L;break;case "SPHERE":P.Wa*=L}}ba=pa.um;J=pa.mm}var ta=X.get_trans_view(pa.v),ia=X.get_quat_view(pa.v),S=C.Cq,oa=C.NF,aa=C.vh,R=C.RF,Y=C.QF,Z=C.sB,zb=C.YD,ja=a.Ub,za=w(ja),Pa=C.Do,ca=C.Bo,db=C.Eo,vb=pa.va.Wa,Fb=x(M),Ua=a.zr,ua;var eb=ra;if(m.length){var Ba=[],Ya={};Ya.quat=new Float32Array([0,0,0,1]);Ya.trans=new Float32Array(3);Ya.worker_bounding=Fb;Ya.bounding_type=eb;Ba.push(Ya);var Sa=X.invert(pa.v,fa),Ab=qa,Yc=X.get_quat_view(pa.v);V.invert(Yc,Ab);for(var Lb=0;Lb<m.length;Lb++){var Mb=
{},Wa=m[Lb],Gb=Wa.Kg.wr,qb=new Float32Array(4),cc=new Float32Array(3),Pc=X.get_trans_view(Wa.o.v),vc=X.get_quat_view(Wa.o.v);X.transform_vec3(Pc,Sa,cc);V.multiply(Ab,vc,qb);Mb.trans=cc;Mb.quat=qb;Mb.bounding_type=Gb;Mb.worker_bounding=x(l(Gb,Wa.o));Ba.push(Mb)}ua=Ba}else ua=[];G.ga(O,G.tH,H,ta,ia,D,S,oa,aa,R,Y,Z,zb,za,Pa,ca,db,ra,Fb,vb,ba,J,ua,Ua);ka[H]=a;ea.push(a);var Tb=h(H,"BOUNDING");Tb.type=D;Tb.vh=aa;Tb.Js=S;Tb.Ub=ja;Tb.Co=za;t=Tb}var Xb=t;a.J=Xb;var Pb={qa:null,J:Xb};r||(n.push(Pb),c(b,e,
Xb.Ub))}else for(var Qc=E.oa(a,b).R,Oc=0;Oc<Qc.length;Oc++){var wc=Qc[Oc],Ec;if(Ec="PHYSICS"==wc.type){var hd;a:{for(var Fc=b.jc.ra,oc=0;oc<Fc.length;oc++){var dc=Fc[oc].qa;if(dc&&dc.id==wc.id){hd=!0;break a}}hd=!1}Ec=!hd}if(Ec)if(wc.Hd.Ha)if(wc.Kh&&b.F.Bc){var pb=wc,pc=b,Hb=e,ib=pc.F.Bc;G.ga(Hb,G.CH,ib.fk);if(pb.xS){var bb={};bb.dst_noise_scale0=pb.dst_noise_scale0;bb.dst_noise_scale1=pb.dst_noise_scale1;bb.dst_noise_freq0=pb.dst_noise_freq0;bb.dst_noise_freq1=pb.dst_noise_freq1;bb.dir_min_shore_fac=
pb.dir_min_shore_fac;bb.dir_freq=pb.dir_freq;bb.dir_noise_scale=pb.dir_noise_scale;bb.dir_noise_freq=pb.dir_noise_freq;bb.dir_min_noise_fac=pb.dir_min_noise_fac;bb.dst_min_fac=pb.dst_min_fac;bb.waves_hor_fac=pb.waves_hor_fac;var xc=ib.waves_height,fb=ib.waves_length;ib.Tj?G.ga(Hb,G.Pz,bb,ib.cn[0],ib.cn[1],ib.bn[0],ib.bn[1],ib.mx,xc,fb,ib.ty,pc.F.sy):G.ga(Hb,G.Pz,bb,0,0,0,0,0,xc,fb,0,null)}}else{var Zc;if(wc.Cq){var ld=a,Nb=wc,$c=e,qc=v(),Yb=Nb.Hd,Rc=Yb.aa[0].a_position,Ib=Yb.ma||null,Ub=Nb.Ub,Jb=
w(Ub),jc=Nb.Do,rc=Nb.Bo,id=Nb.Eo,wb=X.get_trans_view(ld.o.v);G.ga($c,G.zH,qc,Rc,Ib,wb,Jb,jc,rc,id);var Za=h(qc,"STATIC_MESH");Za.Js=!0;Za.Ub=Ub;Za.Co=Jb;Zc=Za}else{var gb=a,cb=wc,ec=e,yc=v(),Sc=cb.Hd,kc=Sc.aa[0].a_position,zc=Sc.ma||null,Qb=X.get_trans_view(gb.o.v),Ac=cb.um,Bc=cb.mm,fc=cb.Ub,Vb=w(fc);G.ga(ec,G.BH,yc,kc,zc,Qb,Ac,Bc,Vb,cb.Do,cb.Bo,cb.Eo);var Zb=h(yc,"STATIC_MESH");Zb.Ub=fc;Zb.Co=Vb;Zc=Zb}Xb=Zc;a.J=Xb;Pb={qa:wc,J:Xb};n.push(Pb);c(b,e,Xb.Ub)}else W.error("Object "+a.name+" has collision material with no assigned vertices")}if(I(a)||
p(a)){var rb=e,sb=a.J.ba;I(a)?(a.I.type=10,G.ga(rb,G.uH,sb,a.I.Fy,a.I.Hy,a.I.Gy,a.I.pz,a.I.nx)):p(a)&&(a.I.type=20,G.ga(rb,G.sH,sb,a.I.Ok,a.I.Nl,a.I.Ol));if(a.I.vl){var kb=a.I.vl;switch(a.I.type){case 10:k(kb[0],a,sb,!0,rb);k(kb[1],a,sb,!0,rb);k(kb[2],a,sb,!1,rb);k(kb[3],a,sb,!1,rb);break;case 20:for(var Gc=0;Gc<kb.length;Gc++)k(kb[Gc],a,sb,!1,rb)}}A(a,a.I,e)}else if(a.is_character){var ad=e,tb=a.o,Bb=a.J,ub=tb.U.max_z-tb.U.min_z,Hc=Bb.ba,Oa=a.OA,hb=Oa.wS,xb=Oa.TP,gc=Oa.dR,Ja=Oa.ZN,$b=Oa.yS,Kb=ha.JL(a);
G.ga(ad,G.vH,Hc,Kb,ub,hb,xb,gc,Ja,$b);Bb.is_character=!0}else if(y(a)){var Cb=e,jb=a.J.ba;G.ga(Cb,G.yH,jb,a.Df.Ok,a.Df.Nl,a.Df.Ol);if(a.Df.or)for(var Ob=a.Df.or,yb=0;yb<Ob.length;yb++){var Qa=Ob[yb],Rb=X.get_trans_view(Qa.o.v),Db=X.invert(a.o.v,fa),Cc=new Float32Array(3);X.transform_vec3(Rb,Db,Cc);G.ga(Cb,G.rH,jb,Cc,Qa.jv)}a.J.NN=!0}for(Oc=0;Oc<ea.length;Oc++){var Ic=ea[Oc];if(Ic.J){var Eb=Ic;if(!f(Eb))for(var Jc=0;Jc<Eb.Ox.length;Jc++){var Wb=Eb.Ox[Jc],lc=Wb.target,mc=Wb.eP;if(lc.J){var bd=new Float32Array([Wb.fP,
Wb.gP,Wb.hP]),Tc=ha.euler_to_quat(new Float32Array([Wb.Ea,Wb.Fa,Wb.Ga]),new Float32Array(4)),sc=X.identity(fa),sc=X.set_trans(bd,sc),sc=X.set_quat(Tc,sc),ac=X.multiply(Eb.o.v,sc,fa),Kc=X.invert(lc.o.v,va),Dc=X.multiply(Kc,ac,Kc),Lc=X.get_trans_view(Dc),bc=X.get_quat_view(Dc),lb=Wb,mb={};mb.use_limit_x=lb.jS;mb.use_limit_y=lb.kS;mb.use_limit_z=lb.lS;mb.use_angular_limit_x=lb.fS;mb.use_angular_limit_y=lb.gS;mb.use_angular_limit_z=lb.hS;mb.limit_max_x=lb.jO;mb.limit_min_x=lb.mO;mb.limit_max_y=lb.kO;
mb.limit_min_y=lb.nO;mb.limit_max_z=lb.lO;mb.limit_min_z=lb.oO;mb.limit_angle_max_x=lb.dO;mb.limit_angle_min_x=lb.gO;mb.limit_angle_max_y=lb.eO;mb.limit_angle_min_y=lb.hO;mb.limit_angle_max_z=lb.fO;mb.limit_angle_min_z=lb.iO;F(mc,Eb,bd,Tc,lc,Lc,bc,mb,null,null)}}}}}};a.nM=n;a.update=function(a,b){for(var c=0;c<la.length;c++){var d=la[c],e=a;d&&G.JC(d)&&G.ga(d,G.fI,e,b);for(var f=0;f<ea.length;f++){var g=ea[f],h=g.J;if(h.Uj&&h.Hr){var k=G.JC(d)?e-h.Hr:performance.now()/1E3-h.Hr,k=Math.min(k,10/L.max_fps),
k=k-1/L.max_fps;ja.QO&&(k=0);var m=fa;X.JN(h.Sv,k,h.th,h.Wg,fa);oa.set_tsr(g,m);oa.L(g);r(g);if(g.I)for(var h=g,k=h.I.vl,m=h.o.v,l=fa,n=0;n<k.length;n++){var p=k[n];X.multiply(m,h.I.Rp[n],l);oa.set_tsr(p,l);oa.L(p)}g.I&&g.I.kn&&(l=g,k=l.I,h=k.kn)&&(n=l.I.QE,X.multiply(l.o.v,l.I.RE,h.o.v),m=ta,X.transform_dir_vec3(n,l.o.v,m),l=qa,V.setAxisAngle(m,-k.hn*k.jn*2*Math.PI,l),k=X.get_quat_view(h.o.v),V.multiply(l,k,k),oa.L(h));g.I&&g.I.xy&&(l=g,k=l.I,h=k.xy)&&(n=l.I.LE,X.multiply(l.o.v,l.I.ME,h.o.v),m=ta,
X.transform_dir_vec3(n,l.o.v,m),l=qa,n=Math.abs(k.speed)*k.lq,n>k.Jm&&(n=k.Jm),V.setAxisAngle(m,-n,l),k=X.get_quat_view(h.o.v),V.multiply(l,k,k),V.normalize(k,k),oa.L(h));g.I&&g.I.Iy&&(m=g,h=m.I,g=h.Iy)&&(l=m.I.aF,X.multiply(m.o.v,m.I.bF,g.o.v),k=ta,X.transform_dir_vec3(l,m.o.v,k),m=qa,V.setAxisAngle(k,-Math.abs(h.nm)*h.So,m),h=X.get_quat_view(g.o.v),V.multiply(m,h,h),V.normalize(h,h),oa.L(g))}}G.mP(d);d=T[c];(e=d.F.Bc)&&0<e.waves_height&&(d=K.Aa(d,ba.Db),e=Z.length(d.Ti)||1,G.ga(la[c],G.cI,d.time*
e))}};a.OM=function(){return T[0]};a.pause=function(){for(var a=0;a<la.length;a++)G.ga(la[a],G.OH)};a.resume=function(){for(var a=0;a<la.length;a++)G.ga(la[a],G.TH)};a.enable_simulation=function(a){(a=a.J)||ha.D("No object physics");if(!a.Uj){var b=a.ba,c=u(b);a.Uj=!0;G.ga(c,G.MH,b)}};a.disable_simulation=function(a){(a=a.J)||ha.D("No object physics");if(a.Uj){var b=a.ba,c=u(b);a.Uj=!1;G.ga(c,G.LH,b)}};a.Gt=function(a){return!!a.jc};a.ka=function(a){return!!a.J};a.has_dynamic_physics=function(a){return(a=
a.J)&&a.Uj&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.vh&&0==a.Js?!0:!1};a.has_simulated_physics=function(a){return(a=a.J)&&a.Uj?!0:!1};a.set_gravity=function(a,b){var c=a.J.ba;G.ga(u(c),G.bI,c,b)};a.CN=f;a.apply_constraint=F;a.clear_constraint=function(a){a=a.J;G.ga(u(a.ba),G.RH,a.yr);a.yr=null};a.pull_to_constraint_pivot=function(b,c,d,e,f,g){c=X.set_sep(c,1,d,fa);f=X.set_sep(f,1,g,va);X.invert(c,c);X.multiply(f,c,c);oa.get_tsr(e,f);X.multiply(f,c,c);oa.set_tsr(b,c);oa.L(b);e=X.get_trans_view(b.o.v);
f=X.get_quat_view(b.o.v);a.set_transform(b,e,f)};a.set_transform=function(a,b,c){var d=a.J,e=G.gC(G.Nn),f=X.ec(a.o.v,e.trans);a=X.Qc(a.o.v,e.quat);X.set_sep(f,1,a,d.Sv);e.ba=d.ba;Z.copy(b,e.trans);V.copy(c,e.quat);G.ga(u(d.ba),G.Nn)};a.sync_transform=r;a.apply_velocity=function(a,b,c,d){var e=ta;z(a,b,c,d,e);a=a.J.ba;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var f=Math.abs(e[0]),g=Math.abs(e[1]),h=Math.abs(e[2]);e[0]=f?e[0]/f*Math.max(f,b):0;e[1]=g?e[1]/g*Math.max(g,c):0;e[2]=h?e[2]/h*Math.max(h,
d):0;G.ga(u(a),G.Rz,a,e[0],e[1],e[2])};a.apply_velocity_world=function(a,b,c,d){a=a.J.ba;G.ga(u(a),G.Rz,a,b,c,d)};a.apply_force=function(a,b,c,d,e){var f=ta;e?(f[0]=b,f[1]=c,f[2]=d):z(a,b,c,d,f);a=a.J.ba;G.ga(u(a),G.DH,a,f[0],f[1],f[2])};a.apply_torque=function(a,b,c,d){var e=ta;z(a,b,c,d,e);a=a.J.ba;G.ga(u(a),G.FH,a,e[0],e[1],e[2])};a.set_character_move_dir=function(a,b,c){a=a.J.ba;G.ga(u(a),G.WH,a,b,c)};a.set_character_move_type=function(a,b){var c=a.J.ba;G.ga(u(c),G.XH,c,b)};a.set_character_walk_velocity=
function(a,b){var c=a.J.ba;G.ga(u(c),G.aI,c,b)};a.set_character_run_velocity=function(a,b){var c=a.J.ba;G.ga(u(c),G.ZH,c,b)};a.set_character_fly_velocity=function(a,b){var c=a.J.ba;G.ga(u(c),G.UH,c,b)};a.character_jump=function(a){a=a.J.ba;G.ga(u(a),G.HH,a)};a.character_rotation_inc=function(a,b,c){a=a.J.ba;G.ga(u(a),G.IH,a,b,c)};a.set_character_rotation=function(a,b,c){a=a.J.ba;G.ga(u(a),G.YH,a,b,c)};a.set_character_rotation_h=function(a,b){var c=a.J.ba;G.ga(u(c),G.VH,c,b)};a.set_character_rotation_v=
function(a,b){var c=a.J.ba;G.ga(u(c),G.$H,c,b)};a.append_collision_test=function(a,b,c,d){var e=a.J;if(!e.Dp){for(var f=e.ba,h=0;h<e.ue.length;h++)if(a=e.ue[h],a.Ub==b&&a.callback==c)return;a={kv:f,ah:d||!1,Ub:b,callback:c,Kj:[],Hp:[]};e.ue.push(a);b=u(f);J(a,g(b),b)}};a.remove_collision_test=function(a,b,c){a=a.J;for(var d=u(a.ba),f=g(d),h=0;h<a.ue.length;h++){var k=a.ue[h];if(k.Ub==b&&k.callback==c){if(e(k)){var m=Z.set(0,0,0,ta);k.callback(!1,null,m,m,0)}a.ue.splice(h,1);h--;for(var m=d,k=k.Kj,
l=f.jc.ra,n=0;n<l.length;n++)for(var p=l[n].J,r=0;r<p.ue.length;r++)for(var t=p.ue[r],O=0;O<t.Kj.length;O++)for(var v=t.Kj[O],w=0;w<k.length;w++){var B=k[w];v[0]==B[0]&&v[1]==B[1]&&(k.splice(w,1),w--)}k.length&&G.ga(m,G.Qz,k)}}};a.apply_collision_impulse_test=function(a,b){a.J&&a.J.Ak&&H(a);var c=a.J;G.ga(u(c.ba),G.EH,c.ba);c.Ak=b};a.clear_collision_impulse_test=H;a.append_ray_test=function(a,b,c,d,e,f,h,k,m){var l;ra.ND++;l=ra.ND;a={id:l,ba:a?a.J.ba:0,from:new Float32Array(b),to:new Float32Array(c),
Ub:d,Co:w(d),nA:f,AJ:h,ah:k,Bs:m,callback:e};b=u(a.ba)||la[0];c=g(b).jc;c.Nj[l]=a;c.Wx.push(a);G.ga(b,G.AH,a.id,a.ba,a.from,a.to,a.Co,a.nA,a.AJ,a.ah,a.Bs);return l};a.remove_ray_test=C;a.change_ray_test_from_to=function(a,b,c){var d=m(a),e=t(a).jc.Nj[a];e&&!e.nA&&(e.from.set(b),e.to.set(c),G.ga(d,G.GH,a,b,c))};a.KC=function(a){return t(a).jc.Nj[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.I;c.nm=b;A(a,c,u(a.J.ba))};a.vehicle_steer=function(a,b){var c=a.I;c.hn=b;A(a,c,u(a.J.ba))};a.vehicle_brake=
function(a,b){var c=a.I;c.mo=b;A(a,c,u(a.J.ba))};a.is_vehicle_chassis=I;a.is_vehicle_hull=p;a.zU=Q;a.MN=function(a){if(!a.Ce)return!1;a=a.Le.Fe;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.LN=function(a){return a.Ce?"BOB"==a.Le.Fe?!0:!1:!1};a.ON=function(a){return a.bl?"BOB"==a.rm.Fe?!0:!1:!1};a.MC=function(a){return a.Ce&&"STEERING_WHEEL"==a.Le.Fe?!0:!1};a.LC=function(a){return a.Ce&&"SPEEDOMETER"==a.Le.Fe?!0:!1};a.NC=function(a){return a.Ce&&
"TACHOMETER"==a.Le.Fe?!0:!1};a.get_vehicle_speed=function(a){return a.I.speed};a.AS=function(a){switch(a){case "WHEEL_FRONT_RIGHT":return 0;case "WHEEL_FRONT_LEFT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.tC=function(a){return a.J&&a.J.is_character};a.yU=y;a.gN=function(){return P};a.FL=function(){for(var a=0;a<la.length;a++)G.ga(la[a],G.KH)};a.remove_object=function(a){var b=a.J.ba;if("BOUNDING"==a.J.type){var c=ea.indexOf(a);-1==c&&W.error("Object "+a.name+" doesn't have bounding physics");
delete ka[b];ea.splice(c,1)}for(var c=u(b),d=g(c),f=d.jc.ra,h=[],k=0;k<f.length;k++)for(var m=f[k].J,l=0;l<m.ue.length;l++)for(var n=m.ue[l],p=0;p<n.Kj.length;p++){var r=n.Kj[p],t=n.Hp[p];if(r[0]==b||r[1]==b)n.Kj.splice(p,1),n.Hp.splice(p,1),p--,t&&!e(n)&&(t=Z.set(0,0,0,ta),n.callback(!1,null,t,t,0)),h.push(r)}h.length&&G.ga(c,G.Qz,h);a.J&&a.J.Ak&&H(a);a=d.jc.ra;for(d=0;d<a.length;d++)a[d].J.ba==b&&(a.splice(d,1),d--);G.ga(c,G.QH,b)}};b4w.module.__data=function(a,q){function d(a,b){Na[b.id]=null;za[b.id]=null}function c(a,b,c,d){a instanceof ArrayBuffer?(a=M.pC(a,d),d=a.width,a=a.height):(d=a.width,a=a.height);O.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(Pa)&&c&&O.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){(d=b.xg)||ia.D("Nothing requested");ta.enqueue([{id:d,type:ta.AT_JSON,url:d,Bg:b.wj}],function(d,f,g,h){if(d){O.log("%cLOAD METADATA","color: #616",
h);f=ia.SE(d.b4w_format_version);switch(ia.SF(f,ya.jl)){case -1:f[0]<ya.jl[0]?ia.D("JSON version is too old relative to B4W engine: "+ia.dk(f)+", required: "+ia.dk(ya.jl)+". Reexport scene with the latest B4W addon to fix it."):O.warn("JSON version is a bit old relative to B4W engine: "+ia.dk(f)+", required: "+ia.dk(ya.jl)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>ya.jl[0]?ia.D("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
O.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}ya.gx=f;for(var k in d)a[k]=d[k];b.Eb&&($a=Ca.Vr(a.scenes));(d=a.binaries[0].binfile)?b.xA=d:(N.Ot(b,"load_binaries"),N.Ot(b,"prepare_bindata"));ya.is_mobile_device||N.Ot(b,"mobile_media_start");ya.antialiasing&&ya.smaa||N.Ot(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)k=a.b4w_export_errors[d],(b.Eb&&"PRIMARY"==k.type||
"ALL"==k.type)&&O.bM(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)k=a.b4w_export_warnings[d],(b.Eb&&"PRIMARY"==k.type||"ALL"==k.type)&&O.cM(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");b.wj&&z(a);e(b,c)}else N.Xz(b)},null,function(a){f(b,c,a)})}function g(a,b,c,d,e,f){(d=T(b.xg)+b.xA)||ia.D("Binary data is missing");ta.enqueue([{id:d,
type:ta.AT_ARRAYBUFFER,url:d,Bg:b.wj}],function(d,f,g,h){d?(O.log("%cLOAD BINARY","color: #616",h),a.bin_data=d,f=(new Uint32Array(d,4,1))[0],d=(new Uint32Array(d,8,1))[0],d=[f,d],f=ia.SE(a.b4w_format_version),d[0]!=f[0]&&ia.D("BIN version does not match to JSON version: "+ia.dk(d)+", required: "+ia.dk(ya.jl)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&O.warn("BIN version does not match to JSON version: "+ +ia.dk(d)+", required: "+ia.dk(ya.jl)+". Some compatibility issues can occur. Reexport scene to fix it."),
e(b,c)):N.Xz(b)},null,function(a){f(b,c,a)})}function n(a,b,c,d,e){Ta.TA()&&e(b,c)}function B(a,b,c,d,f){d=a.bin_data;var g=a.binaries[0],h=a.objects,k=a.meshes;a=a.actions;for(var m=ia.XJ(),l=["indices"],n=["position","texcoord","texcoord2","shade_tangs"],O=["normal","tangent"],p=["group"],r=["color"],t=0;t<k.length;t++)for(var u=k[t].submeshes,v=0;v<u.length;v++){for(var w in u[v]){var B=u[v][w][1];if(-1!=l.indexOf(w)){var y=u[v][w][0]*ia.Az+g["int"]+12,N=u[v],K=w,q=d;if(m)var A=new Uint32Array(q,
y,B);else for(var A=new Uint32Array(B),q=new DataView(q),z=0;z<B;z++)A[z]=q.getUint32(y+z*ia.Az,!0);N[K]=A}else if(-1!=n.indexOf(w))y=u[v][w][0]*ia.Nh+g["float"]+12,u[v][w]=e(d,y,B,m);else if(-1!=O.indexOf(w)){y=u[v][w][0]*ia.Pn+g["short"]+12;N=u[v];K=w;q=d;A=new Float32Array(B);q=new DataView(q);for(z=0;z<B;z++)A[z]=q.getInt16(y+z*ia.Pn,!0)/32767;N[K]=A}else if(-1!=p.indexOf(w)){y=u[v][w][0]*ia.Pn+g.ushort+12;N=u[v];K=w;q=d;A=new Float32Array(B);q=new DataView(q);for(z=0;z<B;z++)A[z]=q.getUint16(y+
z*ia.Pn,!0)/65535;N[K]=A}else if(-1!=r.indexOf(w)){y=u[v][w][0]*ia.Du+g.uchar+12;N=u[v];K=w;q=d;A=new Float32Array(B);q=new DataView(q);for(z=0;z<B;z++)A[z]=q.getUint8(y+z*ia.Du)/255;N[K]=A}}B=u[v];if(k[t].b4w_shape_keys.length)for(y=B.base_length,N=B.normal.length/y/3,B.tbn_quat=ia.gen_tbn_quats(B.normal.subarray(0,3*y),B.tangent.subarray(0,4*y),new Float32Array(B.normal.length/3*4)),K=1;K<N;K++)for(q=K*y,A=0;A<y;A++){var x=B.normal.subarray(3*A,3*(A+1)),z=S.add(B.normal.subarray(3*(q+A),3*(q+A+
1)),x,vb);if(B.tangent.length)var E=B.tangent.subarray(4*A,4*(A+1)),C=Da.add(B.tangent.subarray(4*(q+A),4*(q+A+1)),E,Fb),x=ia.lC(x,E,Ua),z=ia.lC(z,C,Xc),C=pa.invert(x,Ua),z=pa.multiply(z,C,Ua);else z=pa.rotationTo(x,z,Ua);B.tbn_quat.set(z,4*(q+A))}else B.tbn_quat=ia.gen_tbn_quats(B.normal,B.tangent);"texcoord2"in u[v]&&(B=new Float32Array(u[v].texcoord.length+u[v].texcoord2.length),B.set(u[v].texcoord),B.set(u[v].texcoord2,u[v].texcoord.length),u[v].texcoord=B,delete u[v].texcoord2)}for(w=0;w<h.length;w++)for(k=
h[w].particle_systems,l=0;l<k.length;l++)n=k[l],n.transforms=e(d,n.transforms[0]*ia.Nh+g["float"]+12,n.transforms[1],m);for(h=0;h<a.length;h++){w=a[h];k=w.fcurves;l=w.frame_range;O=l[0];p=l[1];r=ra.SM(O,p);l=null;0>r&&(r=0);var u=t=!1,F;for(F in k)t|=-1<F.indexOf("rotation_euler"),u|=-1<F.indexOf("rotation_quaternion");n=[];for(F in k)if(t&&u&&-1<F.indexOf("rotation_euler"))delete k[F];else{var v=k[F],D;for(D in v)B=v[D],y=e(d,g["float"]+B.bin_data_pos[0]*ia.Nh+12,B.bin_data_pos[1],m),N=new Float32Array(r),
l||(l=new Int8Array(r)),ra.aJ(B,y,N,l,O,p),B.Te=N;-1<F.indexOf("rotation_euler")&&(ra.kM(k[F]),n.push(F))}for(O=0;O<n.length;O++)p=n[O],r=p.replace("euler","quaternion"),k[r]=k[p],delete k[p];w.rI=l}f(b,c)}function e(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+e*ia.Nh,!0)}return d}function v(a,b,c,d,e){var g=a.cameras,n=a.groups,p=a.materials,r=a.meshes,u=a.node_groups,v=a.objects,pa=a.particles,w=a.scenes,B=a.speakers,
y=a.lamps,N=a.textures,A=a.worlds;u||(O.warn('"node_groups" datablock undefined. reexport main scene.'),u=a.node_groups=[]);for(var q="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),x={},E=0;E<q.length;E++)for(var S=a[q[E]],C=0;C<S.length;C++){var F=S[C];x[F.uuid]=F}for(var D=0;D<w.length;D++){for(var ma=w[D],Q=ma.objects,H=0;H<Q.length;H++)m(Q,H,x);ma.camera&&m(ma,"camera",x);ma.world&&m(ma,"world",
x)}for(D=0;D<n.length;D++)for(var I=n[D].objects,H=0;H<I.length;H++)m(I,H,x);for(D=0;D<v.length;D++){var G=v[D];G.dupli_group&&m(G,"dupli_group",x);G.parent&&m(G,"parent",x);G.dg_parent&&m(G,"dg_parent",x);if(G.animation_data){var wa=G.animation_data;wa.action&&m(wa,"action",x);if(wa.nla_tracks)for(H=0;H<wa.nla_tracks.length;H++)for(var ba=wa.nla_tracks[H],J=0;J<ba.strips.length;J++)ba.strips[J].action&&m(ba.strips[J],"action",x)}switch(G.type){case "MESH":G.data||ia.D("mesh not found for object "+
G.name);m(G,"data",x);for(var U=!1,Ha=G.modifiers,H=0;H<Ha.length;H++){var W=Ha[H];"ARMATURE"==W.type?(U&&O.warn('Object "'+G.name+'" has more than one armature modifiers. Only the first one will be used.'),U=!0,m(W,"object",x)):"CURVE"==W.type&&m(W,"object",x)}var L=G.particle_systems;if(L)for(H=0;H<L.length;H++)m(L[H],"settings",x);break;case "ARMATURE":m(G,"data",x);for(var P=G.pose.bones,X=G.data.bones,H=0;H<P.length;H++){var qa=P[H];qa.bone=X[qa.bone];var ta=qa.constraints;if(ta)for(J=0;J<ta.length;J++){var Ma=
ta[J];Ma.target&&m(Ma,"target",x)}for(var Ea=qa.parent_recursive,J=0;J<Ea.length;J++)Ea[J]=P[Ea[J]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":m(G,"data",x)}if(ta=G.constraints)for(H=0;H<ta.length;H++)Ma=ta[H],Ma.target&&m(Ma,"target",x);var oa=G.lod_levels;if(oa)for(H=0;H<oa.length;H++){var aa=oa[H];aa.object&&m(aa,"object",x)}}for(D=0;D<r.length;D++)for(var Da=r[D].materials,H=0;H<Da.length;H++)m(Da,H,x);for(D=0;D<p.length;D++){for(var R=p[D],Pa=R.texture_slots,H=0;H<Pa.length;H++)m(Pa[H],
"texture",x);var M=R.node_tree;M&&t(M,x)}for(D=0;D<u.length;D++)(M=u[D].node_tree)&&t(M,x);for(D=0;D<N.length;D++){var ya=N[D],Aa=ya.type;"IMAGE"!=Aa&&"ENVIRONMENT_MAP"!=Aa||m(ya,"image",x)}for(D=0;D<g.length;D++){var ab=g[D];ab.dof_object&&m(ab,"dof_object",x)}for(D=0;D<B.length;D++){var Y=B[D];Y.sound&&m(Y,"sound",x);if(Y.animation_data&&(wa=Y.animation_data,wa.action&&m(wa,"action",x),wa.nla_tracks))for(H=0;H<wa.nla_tracks.length;H++)for(ba=wa.nla_tracks[H],J=0;J<ba.strips.length;J++)ba.strips[J].action&&
m(ba.strips[J],"action",x)}for(D=0;D<pa.length;D++){for(var Ua=pa[D],Pa=Ua.texture_slots,H=0;H<Pa.length;H++)m(Pa[H],"texture",x);Ua.dupli_group&&m(Ua,"dupli_group",x);Ua.dupli_object&&m(Ua,"dupli_object",x)}for(D=0;D<y.length;D++){var zb=y[D];if(zb.animation_data&&(wa=zb.animation_data,wa.action&&m(wa,"action",x),wa.nla_tracks))for(H=0;H<wa.nla_tracks.length;H++)for(ba=wa.nla_tracks[H],J=0;J<ba.strips.length;J++)ba.strips[J].action&&m(ba.strips[J],"action",x)}for(D=0;D<A.length;D++){var Xa=A[D];
if(Pa=Xa.texture_slots)for(H=0;H<Pa.length;H++)m(Pa[H],"texture",x);if(Xa.animation_data&&(wa=Xa.animation_data,wa.action&&m(wa,"action",x),wa.nla_tracks))for(H=0;H<wa.nla_tracks.length;H++)for(ba=wa.nla_tracks[H],J=0;J<ba.strips.length;J++)ba.strips[J].action&&m(ba.strips[J],"action",x)}Va.TJ(a);z(a);for(var Z=T(b.xg),fa=a.textures,Gb=b.Eb?a.scenes[0].b4w_anisotropic_filtering:$a.b4w_anisotropic_filtering,ja=0;ja<fa.length;ja++){var Na=fa[ja];b.Eb||"SCENE"!=Na.b4w_source_type||(Na.b4w_source_id=
"");var la=Ra.vL(Na,Gb,a.scenes,b.id,Z);Na.F=la}for(var ga={},ha=a.objects,ea=0;ea<ha.length;ea++){var ca=ha[ea];if("MESH"===ca.type&&!ca.particle_systems.length)for(var vb=ca.data,Fb=vb.name,Ta=vb.submeshes,qb=vb.materials,da=0;da<Ta.length;da++)0!==Ta[da].base_length||ga[Fb]||(qb[da]&&O.warn('material "'+qb[da].name+'" is not assigned to any face (object "'+ca.name+'").'),ga[Fb]=!0)}var Ia=a.materials,ka=Va.MK();Ia.push(ka);for(var Pc=a.meshes,db=ia.keysearch("name","DEFAULT",a.materials),Fa=0;Fa<
Pc.length;Fa++){var eb=Pc[Fa];0==eb.materials.length&&eb.materials.push(db)}for(var cc=a.actions,vc=b.id,Ba=0;Ba<cc.length;Ba++){var va=cc[Ba];va.sI=vc;ra.CI(va)}for(var ua=a.scenes,na=0;na<ua.length;na++){for(var Xc=ua[na],Sa=[],ob=[],xa=ua[na].objects,Ya=0;Ya<xa.length;Ya++)V(xa,xa[Ya],null,Sa,ob);for(Ya=0;Ya<ob.length;Ya++)for(var Ab=ob[Ya],Wa=[Xc],Lb=0;Lb<Wa.length;Lb++){for(var Mb=Wa[Lb].objects,Uc=0;Uc<Mb.length;Uc++){var Mc=Mb[Uc].dupli_group;Mc&&K(Ab,Mc)}var tc=Mb.indexOf(Ab);-1<tc&&Mb.splice(tc,
1)}for(Ya=0;Ya<Sa.length;Ya++)ia.XI(Sa[Ya][0],Sa[Ya][1])}!b.Eb&&1<a.scenes.length&&(a.scenes=[Ca.Vr(a.scenes)],O.warn("loading data contains multiple scenes.","Only the first one will be loaded."));var md=b.Eb?$a:Ca.Vr(a.scenes);La.iQ($a.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf($a),1),a.scenes.unshift($a));for(var cd=0;cd<a.scenes.length;cd++){var nc=a.scenes[cd];nc.F={};nc.Vz=nc==md;nc.tI=b.Eb;Wc.enabled&&nc.b4w_enable_physics&&(b.Eb||!Ga.Gt($a)&&nc==Ca.Vr(a))&&Ga.HN(nc)}for(var hc=
0;hc<a.scenes.length;hc++){for(var Sb=a.scenes[hc],uc=l(Sb),nd=0;nd<uc.length;nd++){var ic=uc[nd];sa.UJ(ic,Sb,a)&&(ic.Mc||(ic.Mc=[]),ic.Mc.push(b.Eb?Sb:$a))}for(var od=uc,pd=0;pd<od.length;pd++){var dd=od[pd];if(dd.Mc&&"WORLD"!=dd.type)for(var qd=dd.particle_systems,xd=0;xd<qd.length;xd++){var ed=qd[xd].settings;if("HAIR"==ed.type)if("OBJECT"==ed.render_type){var fd=ed.dupli_object;fd.Mc||(fd.Mc=dd.Mc.slice())}else if("GROUP"==ed.render_type)for(var Bd=ed.dupli_group,td=0;td<Bd.objects.length;td++)fd=
Bd.objects[td],fd.Mc||(fd.Mc=dd.Mc.slice())}}}for(var yd=a.scenes,ud=[],nb=0;nb<yd.length;nb++)k(yd[nb].objects,0,b.Eb,ud);za[b.id]=[];for(nb=0;nb<ud.length;nb++)for(var jd=ud[nb],Vc=0;Vc<jd.length;Vc++)for(var kd=jd[Vc],vd=0;vd<kd.length;vd++)za[b.id].push(kd[vd]);for(var rd=a.particles,nb=0;nb<rd.length;nb++){var gd=rd[nb].dupli_object;gd&&(gd.Uz=!0,za[b.id].push(gd));var zd=rd[nb].dupli_group;if(zd)for(var Ld=zd.objects,Vc=0;Vc<Ld.length;Vc++)gd=Ld[Vc],gd.Uz=!0,za[b.id].push(gd)}for(var Dd=za[b.id],
nb=Dd.length-1;0<=nb;nb--)Dd[nb].Mc||Dd.splice(nb,1);for(var Md=za[b.id],hc=0;hc<Md.length;hc++)if(ic=Md[hc],!b.Eb&&ic.parent&&-1<Yc.indexOf(ic.parent.type)&&(ic.parent=""),"MESH"==ic.type){var Ed=Va.$I(ic);Ed&&(a.meshes.push(Ed),ic.data=Ed)}for(var Nc=0;Nc<a.scenes.length;Nc++){var Nd=a.scenes[Nc],Fd=Nd.world;Fd.Mc||(Fd.Mc=[]);Fd.Mc.push(b.Eb?Nd:$a)}for(var Gd=[],Nc=0;Nc<a.worlds.length;Nc++){var Cd=a.worlds[Nc];Cd.Mc||Gd.push(Cd)}for(Nc=0;Nc<Gd.length;Nc++)Cd=Gd[Nc],a.worlds.splice(a.worlds.indexOf(Cd),
1);for(var Od=a.node_groups,Pd=a.materials,sd=0;sd<Od.length;sd++){var wd=Od[sd].node_tree;if(wd){var Ad=[];h(wd,Ad,!0);wd.Vu=Ad}}for(sd=0;sd<Pd.length;sd++)if(wd=Pd[sd].node_tree)Ad=[],h(wd,Ad,!1),wd.Vu=Ad;for(var Hd=0;Hd<a.scenes.length;Hd++){var Id=a.scenes[Hd];if(Id.b4w_use_logic_editor){var Qd=l(Id);Va.eJ(Qd,Id)}}for(var Jd=0;Jd<a.scenes.length;Jd++){var Rd=a.scenes[Jd],Kd=b.Eb?Rd:$a;f(b.id,Kd,"SPEAKER").length&&!Kd.Dc&&Ka.iJ(Kd)}e(b,c)}function w(a,b,c,d,e){d=T(b.xg);for(var f=[],g=[],h=0;h<
a.speakers.length;h++){var k=a.speakers[h],m=k.sound.uuid;if(-1==g.indexOf(m)){g.push(m);switch(k.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":var l=ta.AT_AUDIOBUFFER;break;case "BACKGROUND_MUSIC":l=ta.AT_AUDIO_ELEMENT}k=ia.yh(d+k.sound.filepath);Y(f,m,l,k,b.wj)}}f.length?ta.enqueue(f,function(){},function(){e(b,c)}):e(b,c)}function h(a,b,c){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d],f=e.type;if("GROUP"==f&&e.node_group){if(e=e.node_group.node_tree)if(c)h(e,b,!0);else for(e=e.Vu,
f=0;f<e.length;f++){var g=e[f];-1==b.indexOf(g)&&b.push(g)}}else-1!=Mb.indexOf(f)&&-1==b.indexOf(f)&&b.push(f)}}function l(a){var b=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);x(a.objects,"ALL",b);return b}function x(a,b,c){for(var d=0;d<a.length;d++){var e=a[d];"ALL"!=b&&b!=e.type||c.push(e);(e=e.dupli_group)&&x(e.objects,b,c)}}function k(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],h=ea(g);e[h]=e[h]||[];(c||-1==Yc.indexOf(g.type))&&-1==e[h].indexOf(g)&&e[h].push(g);
(g=g.dupli_group)&&k(g.objects,b+1,c,d)}}function f(a,b,c){var d=[];a=za[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==c||"ALL"==c)for(var g=0;g<f.Mc.length;g++)b==f.Mc[g]&&d.push(f)}return d}function F(a,b,c,d,e){var f=za[b.id],g=a.worlds;d=b.id;for(var h=0;h<f.length;h++){for(var k=f[h],m=Ha.Mo(k.name,k.type,k.origin_name),l=0;l<k.Mc.length;l++)Ha.Xn(m,k.Mc[l]);k.Ua=m;sa.bk(k,m);m.o.ud=d;m.tp=k.Uz||!1}for(d=0;d<g.length;d++){h=g[d];k="%meta_world%"+h.name;k=Ha.Mo(k,"WORLD",k);for(m=0;m<h.Mc.length;m++)Ha.Xn(k,
h.Mc[m]);h.Ua=k;sa.bS(h,k)}d=sa.get_all_objects("ALL",b.id);for(h=0;h<f.length;h++)k=f[h],m=k.Ua,ma.bk(k,m);for(h=0;h<g.length;h++)k=g[h],ma.bk(k,k.Ua);b.Eb&&u(a,b.id);for(h=0;h<f.length;h++)k=f[h],m=k.Ua,m.tp||(sa.OR(k,m),ga.L(m));for(a=0;a<f.length;a++)if(g=f[a],h=g.Ua,Ha.is_mesh(h)||Ha.is_empty(h))if(k=g.lod_levels.length)for(m=h,h.o.Bm=!0,l=0;l<k;l++){var n=g.lod_levels[l].object;if(n){n=n.Ua;n.o.Bm=!0;n.o.Eg=h.o.Eg;m.o.De=g.lod_levels[l].distance;n.o.Dg=g.lod_levels[l].distance;if(g.lod_levels[l+
1])n.o.De=g.lod_levels[l+1].distance;else{n.o.De=Ha.Mn;break}m=n}else{m.o.De=g.lod_levels[l].distance;break}}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(g=a.fr)){var g=g.o,h=a.o.Vh,k=[],p;for(p in h)m=h[p],k.push(4*m.Vv,4*m.Uh);g.Ys.push(k);g.dn.push(a.o)}f=p=-1;a=ra.fC();for(g=0;g<d.length;g++)h=d[g],k=h.o,Ha.is_mesh(h)&&k.xj&&(h=k.Fg,h>p&&(p=h),a>=h&&h>f&&(f=h));for(g=0;g<d.length;g++)h=d[g],k=h.o,Ha.is_mesh(h)&&k.xj&&(k.Qk=!0,p<a?k.Fg=p:k.Fg<=a?k.Fg=f:(O.warn('too many bones for "'+h.name+
'" / '+k.Fg+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),k.Fg=p,k.Qk=!1),k.Qk=k.Qk&&!ab.MB);for(p=0;p<d.length;p++)if(f=d[p],f.Ce)if(a=f.Le,"CHASSIS"==a.Fe){f.I={};f.I.ep=a.ep;f.I.no=a.no;f.I.Fy=a.Fy;f.I.Hy=a.Hy;f.I.Gy=a.Gy;f.I.pz=a.pz;f.I.dy=a.dy;f.I.nx=a.nx;f.I.nm=0;f.I.mo=1;f.I.hn=0;f.I.speed=0;f.I.vl=[];f.I.Rp=[];f.I.kn=null;h=(g=Ha.get_dg_parent(f))?Ha.tw(g,d):d;for(g=0;g<h.length;g++)k=h[g],k.Ce&&(m=k.Le,Ga.MN(k)&&a.name==m.name?(m=
Ga.AS(k.Le.Fe),f.I.vl[m]=k,f.I.Rp[m]=new Float32Array(8)):Ga.MC(k)&&a.name==m.name?(f.I.kn=k,f.I.jn=m.jn,f.I.oq=m.oq,f.I.rp=m.rp,m=Fa.invert(f.o.v,Fa.create()),k=Fa.multiply(m,k.o.v,m),f.I.RE=k,m=new Float32Array([1,0,0]),Fa.transform_dir_vec3(m,k,m),f.I.QE=m):Ga.LC(k)&&a.name==m.name?(f.I.xy=k,f.I.lq=m.lq,f.I.Jm=m.Jm,m=Fa.invert(f.o.v,Fa.create()),k=Fa.multiply(m,k.o.v,m),f.I.ME=k,m=new Float32Array([1,0,0]),Fa.transform_dir_vec3(m,k,m),f.I.LE=m):Ga.NC(k)&&a.name==m.name&&(f.I.Iy=k,f.I.So=m.So,m=
Fa.invert(f.o.v,Fa.create()),k=Fa.multiply(m,k.o.v,m),f.I.bF=k,m=new Float32Array([1,0,0]),Fa.transform_dir_vec3(m,k,m),f.I.aF=m));4!=f.I.vl.length&&ia.D("Not enough wheels for chassis "+f.name)}else if("HULL"==a.Fe)for(f.I={},f.I.vl=[],f.I.Rp=[],f.I.ep=a.ep,f.I.no=a.no,f.I.Ok=a.Ok,f.I.Nl=a.Nl,f.I.Ol=a.Ol,f.I.nm=0,f.I.mo=1,f.I.hn=0,f.I.speed=0,f.I.kn=null,h=(g=Ha.get_dg_parent(f))?Ha.tw(g,d):d,g=0;g<h.length;g++)k=h[g],k.Ce&&(m=k.Le,Ga.LN(k)&&a.name==m.name?(f.I.vl.push(k),f.I.Rp.push(new Float32Array(8))):
Ga.MC(k)&&a.name==m.name?(f.I.kn=k,f.I.jn=m.jn,f.I.oq=m.oq,f.I.rp=m.rp,m=Fa.invert(f.o.v,Fa.create()),k=Fa.multiply(m,k.o.v,m),f.I.RE=k,m=new Float32Array([1,0,0]),Fa.transform_dir_vec3(m,k,m),f.I.QE=m):Ga.LC(k)&&a.name==m.name?(f.I.xy=k,f.I.lq=m.lq,f.I.Jm=m.Jm,m=Fa.invert(f.o.v,Fa.create()),k=Fa.multiply(m,k.o.v,m),f.I.ME=k,m=new Float32Array([1,0,0]),Fa.transform_dir_vec3(m,k,m),f.I.LE=m):Ga.NC(k)&&a.name==m.name&&(f.I.Iy=k,f.I.So=m.So,m=Fa.invert(f.o.v,Fa.create()),k=Fa.multiply(m,k.o.v,m),f.I.bF=
k,m=new Float32Array([1,0,0]),Fa.transform_dir_vec3(m,k,m),f.I.aF=m));for(p=0;p<d.length;p++)if(f=d[p],f.bl&&(a=f.rm,"MAIN_BODY"==a.Fe))for(f.Df={},f.Df.Ok=a.Ok,f.Df.Nl=a.Nl,f.Df.Ol=a.Ol,f.Df.or=[],g=(g=Ha.get_dg_parent(f))?Ha.tw(g,d):d,h=0;h<g.length;h++)k=g[h],k.bl&&(m=k.rm,Ga.ON(k)&&a.name==m.name&&(f.Df.or.push(k),k.jv=k.rm.$E));e(b,c)}function u(a,b){for(var c=0;c<a.scenes.length;c++){for(var d=a.scenes[c],e=sa.Ib(d,"LAMP",b),f=Array(e.length),g=0;g<e.length;g++)f[g]=g;f.sort(function(a,b){var c=
e[a].nb,d=e[b].nb;return d.Hl&&d.Il&&(!c.Hl||!c.Il)||!c.Hl&&(d.Hl||!c.Il&&d.Il)?1:0});for(g=0;g<f.length;g++)Ha.oa(e[f[g]],d).Bp=g}}function r(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var g=a.scenes[d];g.Ui=g.camera.Ua}for(d=0;d<a.scenes.length;d++){var g=b.Eb?a.scenes[d]:$a,h=b.Eb?sa.Ib(g,"LAMP",b.id):sa.Ib(g,"LAMP",0),k=sa.Ib(g,"ALL",b.id),m=f(b.id,g,"MESH"),l=f(b.id,g,"EMPTY");b.Eb&&Ca.KI(g,k,h,m,l);for(var k=!1,n=0;n<l.length;n++)for(var p=l[n].Ua,r=p.K,t=0;t<r.length;t++){var u=r[t].pb,v=Ca.yF(u,
p);g.name==u.name&&(k=k||v)}b.Eb&&g.F.Bc&&!k&&O.warn('Scene "'+g.name+'" has water but has no wind. Using default settings.');l=[];Ca.set_active(g);qa.UB(g,m,h,l);n=f(b.id,g,"LINE");qa.MM(g,n);p=Ca.ls(g);if(b.Eb){k=g.F.Pt;n=g.world;if(k.TD||k.procedural_skydome)r=n.Ua,qa.QI(g,k,r),qa.Cr(r,p,g);Ca.SB(g,p);(k=g.F.Gn)&&k.Bq&&qa.GI(g,n.Ua)}for(n=0;n<m.length;n++)qa.Cr(m[n].Ua,p,g);for(n=0;n<l.length;n++)qa.Cr(l[n],p,g),sa.VO(l[n]);k=sa.Ib(g,"ALL",b.id);Ca.iA(g,k,h);for(n=0;n<k.length;n++)p=k[n],p.o.me&&
!p.DC&&sa.update_boundings(p),Ha.$J(p)&&(p.kD=!0)}Ca.LI($a,a.textures,b.id);b.Eb&&$a.F.En.length&&(b.Mw=!0);e(b,c)}function z(a){var b=a.materials;a=a.images;for(var c=0;c<a.length;c++){var d=a[c];d.jg="FILE"==d.source&&-1<d.filepath.indexOf(".dds")&&"dds"==ya.Ho?"dds":""}if((Xa.Uv||Xa.Bt)&&ya.GF)for(a=0;a<b.length;a++){for(var d=b[a],e=d.texture_slots,c=0;c<e.length;c++){var f=e[c],g=f.texture;if("IMAGE"==g.type||"ENVIRONMENT_MAP"==g.type){var h=g.image;h&&!h.jg&&(f=!g.b4w_disable_compression&&!f.use_map_normal&&
"ENVIRONMENT_MAP"!=g.type&&!g.b4w_shore_dist_map&&"MOVIE"!=h.source,J(h,f))}}if(c=d.node_tree)for(d=c.nodes,c=0;c<d.length;c++){e=d[c];f=!1;if("TEXTURE"==e.type){if((g=e.texture)&&(h=g.image)&&!h.jg&&(f=!g.b4w_disable_compression&&"MOVIE"!=g.image.source&&"ENVIRONMENT_MAP"!=g.type)){a:{f=e.outputs;for(e=0;e<f.length;e++)if(g=f[e],g.is_linked&&"Normal"==g.identifier){f=!0;break a}f=!1}f=!f}}else"TEX_IMAGE"==e.type?(h=e.image)&&!h.jg&&(f="MOVIE"!=h.source):"TEX_ENVIRONMENT"==e.type&&(f=!1);h&&!h.jg&&
J(h,f)}}}function J(a,b){-1<a.filepath.indexOf(".dds")?a.jg="dds":b?(a.jg=ya.Ho,a.filepath="dds"==ya.Ho?a.filepath+".dds":ta.gn(a.filepath)[0]+".pvr"):a.jg=""}function D(a,b,c,d,e){d=a.groups;for(var f=a.objects,g={},h={},k={},m={},l=0;l<d.length;l++){var n=d[l];g[n.uuid]=n;k[n.uuid]=n}for(l=0;l<f.length;l++)n=f[l],h[n.uuid]=n,m[n.uuid]=n;a=a.scenes;for(l=0;l<a.length;l++)H(a[l].objects,null,m,k,null);for(var O in k)O in g||d.push(k[O]);for(O in m)O in h||f.push(m[O]);e(b,c)}function H(a,b,c,d,e){for(var f=
[],g=0;g<a.length;g++){var h=a[g],k=c[h.uuid];if(h=k.proxy){b&&-1==f.indexOf(h.uuid)&&f.push(h.uuid);for(var m=c[h.uuid],l=m.constraints,h=0;h<l.length;h++){var n=ia.bh(l[h]);n.name=n.name+"_CLONE";k.constraints.push(n)}"b4w_proxy_inherit_anim"in k&&!k.b4w_proxy_inherit_anim||(k.animation_data&&(m.animation_data=ia.bh(k.animation_data)),m.b4w_use_default_animation=k.b4w_use_default_animation,m.b4w_auto_skel_anim=k.b4w_auto_skel_anim,m.b4w_anim_behavior=k.b4w_anim_behavior,m.b4w_cyclic_animation=k.b4w_cyclic_animation)}}for(g=
0;g<f.length;g++)k=ia.lN(a,f[g]),-1<k&&a.splice(k,1);f={};if(b)for(g=0;g<a.length;g++)h=a[g],k=c[h.uuid],l=ia.bh(k),m="origin_name"in k?k.origin_name:k.name,l.name=Ha.RB(b.name,m),l.origin_name=m,l.dg_parent={uuid:b.uuid},C(l),c[l.uuid]=l,f[h.uuid]=l.uuid,h.uuid=l.uuid,e&&e[k.uuid]&&(l.b4w_cluster_data=e[k.uuid]);for(g=0;g<a.length;g++)h=a[g],k=c[h.uuid],k.dupli_group&&(h=k.dupli_group,e=d[h.uuid],l=ia.bh(e),l.name=ia.tq(e.name+"_CLONE"),l.uuid=wa.vC("Group"+l.name),d[l.uuid]=l,h.uuid=l.uuid,H(l.objects,
k,c,d,k.b4w_cluster_data));if(b)for(g=0;g<a.length;g++){h=a[g];k=c[h.uuid];k.parent&&k.parent.uuid in f?k.parent.uuid=f[k.parent.uuid]:k.parent&&(O.warn("Object's \""+k.name+'" parent is not in dupli group. Disabling parenting.'),k.parent=null);l=k.constraints;for(h=0;h<l.length;h++)b=l[h],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=k.pose)for(d=b.bones,h=0;h<d.length;h++)if(e=d[h].constraints)for(l=0;l<e.length;l++)b=e[l],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);
b=k.modifiers;for(h=0;h<b.length;h++)d=b[h],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((k=k.lod_levels)&&k.length)for(h=0;h<k.length;h++)b=k[h],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var p in f)db[p]=f[p]}function C(a){a.uuid=wa.vC("Object"+a.name)}function t(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&m(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in db&&(e.lamp.uuid=db[e.lamp.uuid]),b[e.lamp.uuid]||
(e.lamp=null));"GROUP"==e.type&&e.node_group&&m(e,"node_group",b);"TEX_IMAGE"!=e.type&&"TEX_ENVIRONMENT"!=e.type||!e.image||m(e,"image",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];A(f,"from_node",c);A(f,"to_node",c);I(f,"from_socket",f.from_node.outputs);I(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&m(c,"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&m(e.strips[f],"action",b)}function m(a,b,c){a[b]&&
((c=c[a[b].uuid])||O.error("Dangling link found:",b,a),a[b]=c)}function A(a,b,c){c=ia.keysearch("name",a[b].name,c);a[b]=c}function I(a,b,c){c=ia.keysearch("identifier",a[b].identifier,c);a[b]=c}function p(a,b,d,e,f,g){var h=[],k={};e=a.images;for(var m=Ra.eC(),l=T(b.xg),n=0;n<e.length;n++){var p=e[n],r=p.uuid;if(r){var t=ia.yh(l+p.filepath),u=p.source;if("FILE"===u){var u=p.jg?ta.AT_ARRAYBUFFER:ta.AT_IMAGE_ELEMENT,v=ta.gn(t),pa=v[1].toLowerCase();if(!ta.ZJ(pa)){O.error('image "'+p.name+'" has unsupported format or broken path.');
continue}Xa.rx&&ya.use_min50&&("dds"==v[1]?(t=ta.gn(v[0]),t=t[0]+".min50."+t[1]+".dds"):t=v[0]+".min50."+v[1])}else if("MOVIE"===u)if(ya.cq)v=ta.gn(t),t=v[0]+".altconv.seq",u=ta.Lq;else{v=ta.gn(t);pa=v[1].toLowerCase();u=Ka.detect_video_container(pa);if(""==u){O.error("failed to load video file (unsupported format)",t);continue}t=u!=pa?v[0]+".altconv."+u:v[0]+"."+v[1];u=ta.Mq}else{O.error('Image "'+p.name+'" has unsupported format "'+u+'".');continue}r in k||(k[r]=[]);for(v=0;v<m.length;v++)pa=m[v],
(pa.zm==r&&pa.Vk==p.jg||b.wj)&&k[r].push(pa);k[r].length&&h.push({id:r,type:u,url:t,Bg:b.wj})}}if(h.length){var w=0;ta.enqueue(h,function(e,f,m,l){if(e){var n=m;if(!b.wj){f=k[f];for(n=0;n<f.length;n++){var p=f[n];if(m==ta.Lq)p.aq=e.zg,Ra.xq(p,e.images,b.id);else if(Ra.xq(p,e,b.id),"ENVIRONMENT_MAP"==p.source)for(p=0;p<a.scenes.length;p++)Ca.dz(a.scenes[p])}n=f[0].Vk}m==ta.Mq||m==ta.Lq?(m==ta.Mq?(m=e.videoWidth,e=e.videoHeight):(m=e.images[0].width,e=e.images[0].height),O.log("%cLOAD VIDEO "+m+"x"+
e,"color: #"+(2048<m||2048<e?"a00":1024<m||1024<e?"aa0":"0a0"),l),-1==l.indexOf(Pa)&&O.warn("video",l,"is not from app root.")):c(e,l,!0,n)}l=++w/h.length;g(b,d,l)},function(){O.log("%cLOADED ALL IMAGES","color: #0a0");f(b,d)})}else f(b,d)}function Q(a,b,c,d,e){a=Ca.yw();for(d=0;d<a.length;d++){var f=a[d];if(f.b4w_use_nla){var g=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&(g=!1);ma.TR(f,g,b.id)}}e(b,c)}function y(a,b,c,d,e,f){a=T(b.xg);var g=[],h={};d=sa.get_all_objects("ALL",b.id);for(var k=0;k<d.length;k++){var m=
d[k];if(R(m)){var l=m.Y.Oi;"BACKGROUND_MUSIC"==Ka.Aw(m)?(l=ia.nw(),b.Kw=!0):"NONE"!=Ka.Aw(m)&&ya.Qw&&(b.Pw=!0);if(!(l in h)){h[l]=[];var n=ia.yh(a+m.Y.xg);switch(Ka.KE(m)){case Ka.Cu:var p=ta.AT_AUDIOBUFFER;break;case Ka.uz:p=ta.AT_AUDIO_ELEMENT}Y(g,l,p,n,b.wj)}h[l].push(m)}}if(g.length){var r=0;ta.enqueue(g,function(a,d,e,k){if(a)for(O.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(Pa)&&O.warn("sound",k,"is not from app root."),d=h[d],e=0;e<d.length;e++)Ka.ZR(d[e],a);a=++r/g.length;f(b,c,a)},
function(){O.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)})}else e(b,c)}function Y(a,b,c,d,e){var f=ta.gn(d),g=f[1].toLowerCase(),h=Ka.detect_audio_container(g);""!=h?(d=h!=g?f[0]+".altconv."+h:f[0]+"."+f[1],a.push({id:b,type:c,url:d,Bg:e})):O.error("failed to load audio file (unsupported format)",d)}function R(a){return Ha.is_speaker(a)&&Ka.KE(a)!=Ka.vz}function G(a,b,c){a=sa.Ib(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];Ha.is_speaker(d)&&(Ka.KN(d)||c)&&Ka.play_def(d)}}function E(a,b){for(var c=
a.F.En,d=0;d<c.length;d++){var e=c[d].F;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=e.Jq||(Ra.reset_video(e),Ra.play_video(e))}}function W(a,b,c,d,e){ma.start();O.log("%cSTART NLA","color: #0a0");e(b,c)}function V(a,b,c,d,e){for(var f=b.lod_levels.length,g=0;g<f;g++){var h=b.lod_levels[g],k=h.object;if(k){var m=ia.zo(k);m.name=b.name+"_LOD_"+String(g+1);m.b4w_cluster_data=b.b4w_cluster_data;C(m);m.lod_levels=[];c&&(m.dg_parent=c);d.push([a,m]);e.push(k);h.object=m}}if(a=b.dupli_group)for(a=
a.objects,c=0;c<a.length;c++)V(a,a[c],b,d,e)}function K(a,b){var c=b.objects,d=c.indexOf(a);-1<d&&c.splice(d,1);for(d=0;d<c.length;d++)(b=c[d].dupli_group)&&K(a,b)}function ba(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!Ga.cK(a.scenes[f])){d=!1;break}d&&(e(b,c),O.log("%cPHYSICS READY","color: #0a0"))}function oa(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(b.Eb)var g=Ga.Gt(f);else g=Ga.Gt($a)||Ga.Gt(f),f=$a;if(Wc.enabled&&g)for(g=0;g<Lb.length;g++)for(var h=sa.Ib(f,Lb[g],
b.id),k=0;k<h.length;k++){var m=h[k];m.o.ud==b.id&&(Ga.append_object(m,f),b.ZC&&Ga.ka(m)&&Ga.disable_simulation(m))}}e(b,c)}function X(a,b,d,e,f){var g={};e=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var m=h[k];if(m.F.Bc){var l=m.F.Bc.Tj;if(l&&"FILE"===l.source){var m=l.uuid,n=ia.yh(T(b.xg)+l.filepath);e.push({id:m,type:l.jg?ta.AT_ARRAYBUFFER:ta.AT_IMAGE_ELEMENT,url:n});g[m]=l}}}e.length?ta.enqueue(e,function(a,d,e,f){if(a){c(a,f,!0);e=[];f=Ra.eC();for(var k=0;k<f.length;k++){var m=f[k];m.uri===
d&&e.push(m)}for(d=0;d<e.length;d++)Ra.xq(e[d],a,b.id);for(d=0;d<h.length;d++)if(e=h[d],e.F.Bc&&(f=e.F.Bc.Tj,f===l)){var m=a,n=document.createElement("canvas");f=l.size[0];k=l.size[1];n.width=f;n.height=k;n=n.getContext("2d");n.drawImage(m,0,0);m=n.getImageData(0,0,f,k).data;n=new Float32Array(4);n[0]=1/16581375;n[1]=1/65025;n[2]=1/255;n[3]=1;f*=k;for(var k=new Float32Array(f),p=0;p<f;p++)k[p]=n[1]*m[4*p+2]+n[2]*m[4*p+3];e.F.sy=k}}else for(a=g[d],d=0;d<h.length;d++)e=h[d],f=e.F.Bc.Tj,f===a&&(e.F.Bc.Tj=
null,O.warn("image",f.filepath," was not found. Disabling water shore effects."))},function(){f(b,d)}):f(b,d)}function ha(a,b,d,e,f){e=a.scenes[0];a=[];for(var g=[Ia.Sq,Ia.Qn,Ia.Tq,Ia.Qu],h=0;h<g.length;h++){var k=Ca.Aa(e,g[h]);k&&a.push(k)}if(a.length){e=[];h=ta.AT_IMAGE_ELEMENT;e.push({id:"SEARCH_TEXTURE",type:h,xg:fa.ge.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:h,url:fa.ge.smaa_area_texture_path});for(h=0;h<a.length;h++)if(g=a[h],g.type==Ia.Qn){a=g.Xa;for(h=0;h<a.length;h++)if(g=
a[h],"u_search_tex"==g.to)var m=g.Ya;else if("u_area_tex"==g.to)var l=g.Ya;break}e.length?ta.enqueue(e,function(a,d,e,f){a&&(c(a,f,!1),d="SEARCH_TEXTURE"==d?m:l,d.source="IMAGE",Ra.xq(d,a,b.id),Ra.ly(d,Ra.P,Ra.P))},function(){f(b,d)}):f(b,d)}else f(b,d)}function Z(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];b.Eb||(e=$a);for(var f=sa.Ib(e,"LAMP",b.id),g=0;g<f.length;g++){var h=f[g];h.o.ud==b.id&&d.Yu.push({pb:e,obj:h})}f=sa.Ib(e,"ALL",b.id);for(g=0;g<f.length;g++)h=f[g],"LAMP"!=h.type&&
h.o.ud==b.id&&(b.ZC&&Ha.is_mesh(h)&&Ca.uo(h,!0),d.Yu.push({pb:e,obj:h}))}}function ca(a,b,c,d,e,f){var g=d.Yu;e=d.rD;if(g.length){a=g[e].obj;var h=g[e].pb;e=Ha.oa(a,h);Ca.append_object(h,a);a.anchor&&!h.F.anaglyph_use&&Ba.append(a);d=++d.rD/g.length;g=e.ai;if(-1!=a.o.td&&g){var k=S.copy(a.o.gb.M,vb);Ca.xF(g,k)}g=a.Xp;if(g.length&&h.F.Dh)for(h=Fa.get_trans_view(a.o.v),a=Fa.get_quat_view(a.o.v),e=e.Ah,k=0;k<e.length;k++)Ca.zF(e[k],h,a),Ha.AF(g,e[k].B.hc)}else d=1;f(b,c,d)}function da(a,b,c,d,e){if(b.Eb){a=
Ca.nh();Ca.dz(a);d=Ca.yw();for(var f=0;f<d.length;f++){var g=d[f];Ca.dz(g);Ca.pP(g,a)}Ca.set_active(a)}else Ca.BF($a);a=sa.get_all_objects("ALL",b.id);sa.PR(a);e(b,c)}function L(a,b,c,d,e){if(b.Eb)for(a=Ca.yw(),d=0;d<a.length;d++){var f=a[d];f.b4w_use_logic_editor&&Ma.FN(f,b.id)}e(b,c)}function ja(a,b,c,d,e){if(b.Eb)for(d=0;d<a.scenes.length;d++)E(a.scenes[d],b.id),G(a.scenes[d],b.id,!1);else E($a,b.id),G($a,b.id,!1);e(b,c)}function aa(a,b,c,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;
ya.media_auto_activation&&(b.Mw||b.Kw||b.Pw)?eb||P(a,e,b,c):e(b,c)}function P(a,b,c,d){var e=Wa.parentElement;Ya=e.style.zIndex;e.style.zIndex="999";eb=document.createElement("div");eb.style.position="relative";eb.style.height="88px";eb.style.width="88px";var f=Math.round(Wa.offsetWidth/2-44);eb.style.top=Math.round(Wa.offsetHeight/2-44).toString()+"px";eb.style.left=f.toString()+"px";eb.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
eb.style.backgroundSize="88px";ob=document.createElement("div");ob.style.position="relative";ob.style.height=Wa.offsetHeight.toString()+"px";ob.style.width=Wa.offsetWidth.toString()+"px";ob.style.background="rgba(0, 0, 0, 0.5)";ob.style.zIndex="999";e.appendChild(ob);ob.appendChild(eb);Ab=function(){c.Mw&&(Ra.play(),Ra.pause(),Ra.reset());if(c.Kw){if(c.Eb)for(var e=0;e<a.scenes.length;e++)G(a.scenes[e],c.id,!0);else G($a,c.id,!0);Ka.pause()}c.Pw&&Ka.ED();la();b(c,d)};xa.add_click_listener(eb,Ab)}
function la(){if(eb){var a=Wa.parentElement;a.style.zIndex=Ya;xa.remove_click_listener(eb,Ab);ob.removeChild(eb);a.removeChild(ob);eb=ob=null;Ya=0}}function T(a){(a=a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function ka(a){ra.is_animated(a)&&ra.remove(a);Aa.xP(a);sa.clear_outline_anim(a);va.check_sensor_manifold(a)&&va.remove_sensor_manifold(a);Ga.ka(a)&&Ga.remove_object(a);Ca.SD(a);Ha.is_speaker(a)&&Ka.TQ(a);Ba.is_anchor(a)&&Ba.remove(a)}function ea(a){var b=ra.$B(a);return(a=b&&b.parent==
a?null:a.parent||b)?1+ea(a):0}var Ba=q("__anchors"),ra=q("__animation"),ta=q("__assets"),qa=q("__batch"),fa=q("__config"),va=q("__controls"),M=q("__texcomp"),ua=q("__debug"),na=q("__extensions"),xa=q("__input"),N=q("__loader"),wa=q("__md5"),ma=q("__nla"),Ma=q("__logic_nodes"),Aa=q("__particles"),U=q("__nodemat"),sa=q("__objects"),Ha=q("__obj_util"),Ga=q("__physics"),O=q("__print"),pa=q("__quat"),Va=q("__reformer"),Ea=q("__renderer"),Ca=q("__scenes"),Ka=q("__sfx"),Ta=q("__shaders"),Ia=q("__subscene"),
Ra=q("__textures"),La=q("__time"),ga=q("__transform"),Fa=q("__tsr"),ia=q("__util"),S=q("__vec3"),Da=q("__vec4"),ab=fa.nk,ya=fa.H,Xa=fa.rd,Wc=fa.J,zb=fa.Y,Na=null,za=null,Pa="",$a=null,db={},vb=new Float32Array(3),Fb=new Float32Array(4),Ua=new Float32Array(4),Xc=new Float32Array(4),eb=null,ob=null,Ya=0,Sa=!1,Ab=null,Yc=["LAMP","CAMERA"],Lb=["MESH","CAMERA","EMPTY"],Mb=["BSDF_GLOSSY","BSDF_TRANSPARENT"],Wa=null;a.is_primary_loaded=function(a){return N.is_primary_loaded(a)};a.update=function(){N.UR(Na)};
a.FQ=function(a){Wa=a};a.MR=function(a,b){if(eb){ob.style.height=b.toString()+"px";ob.style.width=a.toString()+"px";var c=Math.round(a/2-44);eb.style.top=Math.round(b/2-44).toString()+"px";eb.style.left=c.toString()+"px"}};a.load=function(a,c,e,f,h){var k={load_main:{Gb:N.cg,Lb:!1,inputs:[],Nb:!1,Pb:500,bc:!1,Tb:b},duplicate_objects:{Gb:N.Xd,Lb:!1,inputs:["load_main"],Nb:!1,Pb:50,bc:!1,Tb:D},load_binaries:{Gb:N.cg,Lb:!1,inputs:["load_main"],Nb:!1,Pb:500,bc:!1,Tb:g},wait_for_shaders:{Gb:N.Xd,Lb:!1,
inputs:[],Nb:!1,Pb:50,bc:!0,Zi:n},prepare_bindata:{Gb:N.Xd,Lb:!1,inputs:["duplicate_objects","load_binaries"],Nb:!1,Pb:100,bc:!1,Tb:B},prepare_bpy_data:{Gb:N.Xd,Lb:!1,inputs:["duplicate_objects","prepare_bindata"],Nb:!1,Pb:100,bc:!1,Tb:v},process_objects:{Gb:N.Xd,Lb:!1,inputs:["prepare_bpy_data"],Nb:!1,Pb:150,bc:!1,Tb:F},process_scenes:{Gb:N.Xd,Lb:!1,inputs:["process_objects","wait_for_shaders"],Nb:!1,Pb:300,bc:!1,Tb:r},load_smaa_textures:{Gb:N.cg,Lb:!1,inputs:["process_scenes"],Nb:!1,Pb:30,bc:!0,
Tb:ha},load_shoremap:{Gb:N.cg,Lb:!1,inputs:["process_scenes"],Nb:!1,Pb:30,bc:!0,Tb:X},load_images:{Gb:N.cg,Lb:!0,inputs:["process_scenes"],Nb:!0,Pb:500,bc:!1,Tb:p},update_scenes_nla:{Gb:N.Xd,Lb:!1,inputs:["process_scenes","load_images"],Nb:!1,Pb:50,bc:!1,Tb:Q},wait_physics_workers:{Gb:N.Xd,Lb:!1,inputs:["load_shoremap"],Nb:!1,Pb:20,bc:!1,Zi:ba},add_physics_objects:{Gb:N.Xd,Lb:!1,inputs:["wait_physics_workers"],Nb:!1,Pb:50,bc:!1,Tb:oa},add_objects:{Gb:N.Xd,Lb:!1,inputs:["add_physics_objects"],Nb:!1,
Pb:600,bc:!1,Tb:Z,Zi:ca,qo:da,ro:{Yu:[],rD:0}},init_logic_nodes:{Gb:N.Xd,Lb:!1,inputs:["update_scenes_nla","add_objects"],Nb:!1,Pb:50,bc:!1,Tb:L},load_speakers:{Gb:N.cg,Lb:!0,inputs:["add_objects"],Nb:!0,Pb:100,bc:!1,Tb:y},mobile_media_start:{Gb:N.Xd,Lb:!1,inputs:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],Nb:!0,Pb:5,bc:!1,Tb:aa,Zi:aa},synchronize_media:{Gb:N.Xd,Lb:!0,inputs:["mobile_media_start"],Nb:!0,Pb:50,bc:!1,Tb:ja},start_nla:{Gb:N.Xd,Lb:!0,inputs:["mobile_media_start"],
Nb:!1,Pb:5,bc:!0,Tb:W}},m=N.zw();m||(m=N.jB(),Na={},za={},db={});Na[m.Qg.length]={};return N.oB(k,a,c,e,d,f||zb.mA,ya.do_not_load_resources,h,!1)};a.unload=function(a){var b=N.zw();if(b&&b.Qg.length&&N.lR(b.Qg[a])){if(0==a)O.log("%cUNLOAD ALL","color: #00a"),Ba.cleanup(),ra.cleanup(),Ka.cleanup(),qa.cleanup(),Ca.cleanup(),N.cleanup(),va.cleanup(),Ga.cleanup(),sa.cleanup(),ia.cleanup(),Ea.cleanup(),U.cleanup(),Ta.cleanup(),na.cleanup(),ta.cleanup(),Ra.cleanup(),Ma.cleanup(),Aa.cleanup(),xa.cleanup(),
ua.cleanup(),za=null,db={},Na=$a=null,Sa=!1;else{O.log("%cUNLOAD DATA "+a,"color: #00a");ra.vP(a);for(var b=sa.get_all_objects("ALL",sa.DATA_ID_ALL),c=0;c<b.length;c++){var d=b[c];Ha.get_object_data_id(d)!=a&&sa.lt(d,!1,!1,!1)}b=sa.get_all_objects("ALL",a);for(c=b.length-1;0<=c;c--)d=b[c],ka(d),sa.remove_object(d);b=sa.get_all_objects("ALL",sa.DATA_ID_ALL);for(c=0;c<b.length;c++)sa.lt(b[c],!0,!0,!0)}ma.cleanup(a);la()}else O.error("Unable to unload data!")};a.oP=ka;a.set_debug_resources_root=function(a){Pa=
a};a.activate_media=function(){Sa||ya.media_auto_activation||(Ra.play(),Ra.pause(),Ra.reset(),G($a,sa.DATA_ID_ALL,!0),Ka.pause(),ya.Qw&&Ka.ED(),Sa=!0)};a.reset=function(){Wa=null};a.prefetch=function(a,c,e){var f={load_main:{Gb:N.cg,Lb:!1,inputs:[],Nb:!1,Pb:500,bc:!1,Tb:b},load_binaries:{Gb:N.cg,Lb:!1,inputs:["load_main"],Nb:!1,Pb:500,bc:!1,Tb:g},load_images:{Gb:N.cg,Lb:!1,inputs:["load_main"],Nb:!1,Pb:500,bc:!1,Tb:p},preload_sounds:{Gb:N.cg,Lb:!1,inputs:["load_main"],Nb:!1,Pb:500,bc:!1,Tb:w}},h=
N.zw();h||(h=N.jB(),Na={},za={},db={});Na[h.Qg.length]={};return N.oB(f,a,c,e,d,!1,ya.do_not_load_resources,!1,!0)};a.unfetch=function(){ta.lK()}};b4w.module.__batch=function(a,q){function d(a){a={type:a,sb:"",id:0,ud:0,Ao:-1,Ej:"",Jr:-1,gm:-1,Qo:0,Xe:0,Ik:[],Sa:[],Ie:[],Ve:[],Jb:[],bj:[],Pi:null,Lc:{},ib:null,ab:{bg:null,Ae:null,di:[],Rf:[],status:ea.Tu,lA:0,fF:0},Cj:"",ao:[],da:null,ne:fa.dj(),me:!1,ci:!1,Kr:!1,num_vertices:0,num_triangles:0,Ns:0,Os:0,yc:!1,os:0,ii:0,hd:new Float32Array(3),$d:new Float32Array(16),kg:!1,yb:!1,Va:!1,Tg:!1,Qb:!1,le:!1,be:!1,ie:!1,Qd:!1,Gd:!1,Ed:!1,md:!1,ld:!1,Nr:!1,tg:qa.Tl,Pe:!1,Ff:!1,fj:!1,og:!1,De:L.Mn,Dg:0,
Eg:0,td:-1,jd:-1,ts:!1,xs:0,us:0,ys:0,zs:0,ws:new Float32Array(3),vs:new Float32Array(3),op:!1,lg:0,ug:0,ih:1,reflect_factor:0,Di:0,Cl:1,parallax_scale:0,hh:0,xf:1,Pm:0,kl:0,Sf:0,Vm:0,$c:new Float32Array(2),Rd:new Float32Array(3),$f:new Float32Array(3),Yf:new Float32Array(3),xd:new Float32Array(4),bf:new Float32Array(4),el:null,Fm:null,yp:null,xp:null,qj:!1,wireframe_edge_color:va.create(),Kh:!1,water_dynamic:!1,Fn:!1,xu:!1,yu:0,zu:0,wu:0,gk:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,
Zr:new Float32Array(2),Yr:new Float32Array(2),bp:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),ui:null,wi:!1,wa:null,Hm:0,lk:null,Kp:null,Gg:[],jf:[],Bd:[],hf:[],U:null,Pa:null,va:null,gb:null,jb:null,Z:null,Je:!1,Hd:null,Bf:!0,AC:0,Qm:new Float32Array(3)};a.xd[3]=1;a.Va=!0;a.Hm=1;return a}function c(a){var b=d(a.type);b.sb=a.sb;b.id=a.id;b.Ao=a.Ao;b.Ej=a.Ej;b.Jr=a.Jr;b.gm=a.gm;b.Qo=a.Qo;b.Xe=a.Xe;b.Ik=[];b.Sa=a.Sa.slice();b.Ie=a.Ie.slice();b.Ve=a.Ve.slice();
b.Jb=a.Jb.slice();b.bj=a.bj.slice();b.Pi=fa.S(a.Pi);b.Lc=fa.S(a.Lc);b.ib=a.ib;b.ab=fa.S(a.ab);b.Cj=a.Cj;b.ao=T.mK(a.ao);b.da=a.da;b.me=a.me;b.ci=a.ci;b.Kr=a.Kr;b.num_vertices=a.num_vertices;b.num_triangles=a.num_triangles;b.Ns=a.Ns;b.Os=a.Os;b.os=a.os;b.ii=a.ii;b.hd=a.hd;b.$d=a.$d;b.kg=a.kg;b.yb=a.yb;b.Va=a.Va;b.Tg=a.Tg;b.Qb=a.Qb;b.le=a.le;b.be=a.be;b.ie=a.ie;b.Qd=a.Qd;b.Gd=a.Gd;b.Ed=a.Ed;b.md=a.md;b.ld=a.ld;b.yc=a.yc;b.Nr=a.Nr;b.tg=a.tg;b.Pe=a.Pe;b.Ff=a.Ff;b.fj=a.fj;b.og=a.og;b.De=a.De;b.Dg=a.Dg;
b.Eg=a.Eg;b.td=a.td;b.jd=a.jd;b.ts=a.ts;b.xs=a.xs;b.us=a.us;b.ys=a.ys;b.zs=a.zs;va.copy(a.ws,b.ws);va.copy(a.vs,b.vs);b.op=a.op;b.lg=a.lg;b.ug=a.ug;b.ih=a.ih;b.reflect_factor=a.reflect_factor;b.Di=a.Di;b.Cl=a.Cl;b.parallax_scale=a.parallax_scale;b.hh=a.hh;b.xf=a.xf;b.Pm=a.Pm;b.kl=a.kl;b.Sf=a.Sf;b.Vm=a.Vm;b.$c[0]=a.$c[0];b.$c[1]=a.$c[1];va.copy(a.Rd,b.Rd);va.copy(a.$f,b.$f);va.copy(a.Yf,b.Yf);M.copy(a.xd,b.xd);M.copy(a.bf,b.bf);b.el=fa.S(a.el);a.Fm&&(b.Fm=new Float32Array(a.Fm),b.yp=new Float32Array(a.yp),
b.xp=new Float32Array(a.xp));b.qj=a.qj;va.copy(a.wireframe_edge_color,b.wireframe_edge_color);b.Kh=a.Kh;b.water_dynamic=a.water_dynamic;b.Fn=a.Fn;b.xu=a.xu;b.yu=a.yu;b.zu=a.zu;b.wu=a.wu;b.gk=a.gk;b.shallow_water_col_fac=a.shallow_water_col_fac;b.shore_water_col_fac=a.shore_water_col_fac;b.foam_factor=a.foam_factor;b.Zr.set(a.Zr);b.Yr.set(a.Yr);b.bp.set(a.bp);va.copy(a.shallow_water_col,b.shallow_water_col);va.copy(a.shore_water_col,b.shore_water_col);b.ui=fa.S(a.ui);b.wi=a.wi;b.wa=fa.S(a.wa);b.Hm=
a.Hm;a.lk&&(b.lk=new Float32Array(a.lk));b.Kp=fa.S(a.Kp);b.Gg=fa.S(a.Gg);b.jf=fa.S(a.jf);b.Bd=fa.S(a.Bd);b.hf=fa.S(a.hf);b.U=ba.yk(a.U);b.Pa=ba.yk(a.Pa);b.Z=ba.yo(a.Z);b.jb=ba.yo(a.jb);b.va=ba.zk(a.va);b.gb=ba.zk(a.gb);b.Je=a.Je;b.Bf=a.Bf;b.Qm=a.Qm;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.sb=a.yb?a.Tg?"XRAY":"BLEND":"OPAQUE";break;case "SHADOW":a.sb=a.Qd?"CAST":"RECEIVE";break;case "COLOR_ID":a.sb=a.Tg?"COLOR_ID_XRAY":"COLOR_ID"}}function g(a,b,c){var f=[],
g=a.Ua,h=e(c,b,!b.jm,!1),k=a.data,l=k.materials,n=Array(l.length),O=Array(l.length),r=[],t=ka.dc(c,Ba.Db),u=!1;t&&(u=t.Cp.length?!0:!1);for(var w=0;w<h.length;w++)for(var B=h[w],pa=0;pa<l.length;pa++){var N=l[pa];if(!K(g,pa)&&!qa.uC(k,pa))if("PHYSICS"==B&&a.b4w_collision&&"NAVMESH"==a.game.physics_type)r.push(qa.kw(k,pa,[],b.Vh,{},null));else if(!N.b4w_lens_flares||u){var q=d(B);"MAIN"==B?n[pa]=q:"DEBUG_VIEW"==B&&(O[pa]=q);q.Ao=a.b4w_cluster_data.cluster_id;if(Q(q,N)&&v(q,N)){"SHADOW"==B&&n[pa]&&
(q.le=n[pa].le);q.tg=b.me||b.be?qa.Oq:qa.Tl;H(q,b);for(var z=q,x=a.particle_systems,E=0;E<x.length;E++){var D=x[E].settings.b4w_vcol_from_name,C=x[E].settings.b4w_vcol_to_name;""!==D&&""!==C&&(z.Lc[D]={Sk:!1,src:[{name:D,Mf:7}]})}if("DYNAMIC"==b.type||"COLOR_ID"==q.type)q.Ej=V(q,b,a.uuid);q.fj=a.b4w_do_not_cull;"MAIN"==q.type&&(q.og=a.b4w_caustics);A(q,"DISABLE_FOG",("COLOR_ID"!=B&&"SHADOW"!=B&&a.b4w_disable_fogging)|0);var F=qa.kw(k,pa,q.bj,b.Vh,q.Lc,q.Pi);!N.use_tangent_shading||"a_shade_tangs"in
F.aa[0]||(A(q,"CALC_TBN",1),m(q,"a_tbn_quat"));N.b4w_lens_flares&&(F=ja.nP(F));y(q);f.push({qa:q,Ee:b,kr:b,Hd:F,Nf:[N.name],nd:[a]})}}}if(r.length){q=d("PHYSICS");q.sb="NAVMESH";q.Ej=V(q,b,a.uuid);for(var F=qa.VE(r),ma=[],w=0;w<l.length;w++)ma.push(l[w].name);y(q);f.push({qa:q,Ee:b,kr:b,Hd:F,Nf:ma,nd:[a]})}for(w=0;w<O.length;w++)O[w]&&(O[w].gm=n[w].id,y(O[w]));var G=a.particle_systems;if(0<G.length&&f.length){for(var wa=!1,I=!1,w=0;w<G.length;w++){var ra=G[w],ba=ra.settings;ba.use_render_emitter&&
(wa=!0);"HAIR"!=ba.type||"OBJECT"!=ba.render_type&&"GROUP"!=ba.render_type&&ra.transforms.length||(I=!0);if(wa&&I)break}var J=f[0].qa.Lc,Va;if(I){var U;if(1<l.length){for(var Ha={},W=0;W<G.length;W++){var P=G[W].settings;if("HAIR"==P.type&&("OBJECT"==P.render_type||"GROUP"==P.render_type)){var Ga=P.b4w_vcol_from_name,Ma=P.b4w_vcol_to_name;""!==Ga&&""!==Ma&&(Ha[Ga]=fa.S(J[Ga]))}}"a_bending_col_main"in J&&(Ha.a_bending_col_main=fa.S(J.a_bending_col_main));"a_bending_col_detail"in J&&(Ha.a_bending_col_detail=
fa.S(J.a_bending_col_detail));U=qa.HB(k,[],Ha)}else U=f[0].Hd;Va=U}else Va=null;for(var oa=Va,aa=a.Ua,R=[],M=a.particle_systems,Aa=a.data,Y=0;Y<M.length;Y++){var T=M[Y],Z=T.settings;if(Z.count)if("EMITTER"==Z.type){if("DYNAMIC"==b.type){var ha=d("PARTICLES");ha.va=b.va;ha.U=b.U;ha.Z=b.Z;ha.gb=b.gb;ha.Pa=b.Pa;ha.jb=b.jb;var ca,sa=T.settings.material-1;sa>=Aa.materials.length&&(X.warn('Wrong material used for rendering particle system "'+T.name+'"'),sa=0);ca=sa;var da=Aa.materials[ca];if(!K(aa,ca)&&
("HALO"===T.settings.render_type&&"HALO"===da.type&&(ha.op=!0),v(ha,da))){var na=ha,xa=a,oc=T.settings;switch(oc.b4w_billboard_align){case "VIEW":A(na,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":A(na,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":A(na,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":A(na,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:fa.D("Wrong billboard align value")}A(na,"BILLBOARD",0);var dc=oc.b4w_enable_soft_particles&&L.RA(xa,oc);A(na,"SOFT_PARTICLES",
0<oc.b4w_particles_softness&&dc&&ua.Mr?1:0);A(na,"SOFT_STRENGTH",ea.N(oc.b4w_particles_softness));ea.ia(na.ab,"WORLD_SPACE","WORLD"==oc.b4w_coordinate_system?1:0);ha.be=!0;ha.fj=a.b4w_do_not_cull;ha.Ej=V(ha,b,aa.name+"_"+Z.uuid);ja.GN(ha,T,da);var pb=ja.HM(ha,Aa,T,aa.o);ja.SR(pb,ha,Z.count);ja.RR(aa);H(ha,aa.o);y(ha);R.push({qa:ha,Ee:b,kr:b,Hd:pb,Nf:[da.name],nd:[a]})}}}else if("HAIR"==Z.type){var pc=fa.Ds(T.seed),Hb=la.SA(ua.gx)&&!Z.b4w_initial_rand_rotation&&!Z.b4w_hair_billboard,ib=4;Hb&&(ib=8);
if(T.transforms.length)var bb=T.transforms;else for(var xc=qa.ow(oa,Z.count,!1,pc),bb=new Float32Array(xc.length*ib),fb=0;fb<xc.length;fb++){var Zc=.75+.5*fa.Uf(pc);bb[fb*ib]=xc[fb][0];bb[fb*ib+1]=xc[fb][1];bb[fb*ib+2]=xc[fb][2];bb[fb*ib+3]=Zc;Hb&&(bb[fb*ib+4]=1,bb[fb*ib+5]=0,bb[fb*ib+6]=0,bb[fb*ib+7]=0)}var ld=ka.dc(c,Ba.Oh)?!0:!1;if("OBJECT"==Z.render_type){var Nb=[e(c,Z.dupli_object.Ua.o,!b.jm,!0)],$c=p(a,b,J,oa,[Z.dupli_object],Nb,[bb],Z,T,ld,pc,!1);R.push.apply(R,$c)}else if("GROUP"==Z.render_type){for(var qc=
Z.dupli_group.objects,Nb=[],fb=0;fb<qc.length;fb++){var Yb=e(c,qc[fb].Ua.o,!b.jm,!0);Nb.push(Yb)}for(var Rc=!1,Ib=[],fb=0;fb<qc.length;fb++)Ib.push(qc[fb].Ua);if(Z.use_whole_group){for(var Ub,Jb=bb,jc=Ib,rc=Hb,id=ib,wb={},Za=new Float32Array([0,0,0,1]),gb=0;gb<Jb.length;gb+=id)for(var cb=0;cb<jc.length;cb++){var ec=va.create(),yc=ta.get_scale(jc[cb].o.v),Sc=ta.get_trans_view(jc[cb].o.v);va.scale(Sc,yc,ec);var kc=va.clone([Jb[gb],Jb[gb+1],Jb[gb+2]]);wb[cb]||(wb[cb]=new Float32Array(Jb.length));rc&&
(wb[cb][gb+4]=Za[0]=Jb[gb+4],wb[cb][gb+5]=Za[1]=Jb[gb+5],wb[cb][gb+6]=Za[2]=Jb[gb+6],wb[cb][gb+7]=Za[3]=Jb[gb+7],fa.Tx(Za,Za),fa.pR(ec,Za,ec));va.add(kc,ec,kc);wb[cb][gb]=kc[0];wb[cb][gb+1]=kc[1];wb[cb][gb+2]=kc[2];wb[cb][gb+3]=Jb[gb+3]}Ub=wb;Rc=!0}else{var zc;if(Z.use_group_count){for(var Qb=bb,Ac=Ib,Bc=Z.dupli_weights,fc=pc,Vb=Hb,Zb=ib,rb={},sb=[],kb=0;kb<Ac.length;kb++)for(var Gc=Ac[kb],ad=Gc.Cd||Gc.name,tb=0;tb<Bc.length;tb++){var Bb=Bc[tb];ad==Bb.name&&sb.push(Bb)}Bc.length!=sb.length&&X.error("dupli weights match failed");
for(kb=0;kb<Qb.length;kb+=Zb){for(var ub,Hc=sb,Oa=[0],hb=0;hb<Hc.length;hb++)Oa[hb+1]=Oa[hb]+Hc[hb].count;for(var xb=Oa[Oa.length-1]*fa.Uf(fc),gc=0,hb=0;hb<Oa.length;hb++)if(xb>=Oa[hb]&&xb<Oa[hb+1]){gc=hb;break}ub=gc;rb[ub]=rb[ub]||[];rb[ub].push(Qb[kb],Qb[kb+1],Qb[kb+2],Qb[kb+3]);Vb&&rb[ub].push(Qb[kb+4],Qb[kb+5],Qb[kb+6],Qb[kb+7])}for(ub in rb)rb[ub]=new Float32Array(rb[ub]);zc=rb}else{for(var Ja=bb,$b=pc,Kb=Hb,Cb=ib,jb=Ib.length,Ob={},yb=0;yb<Ja.length;yb+=Cb){var Qa=Math.floor(jb*fa.Uf($b));Ob[Qa]=
Ob[Qa]||[];Ob[Qa].push(Ja[yb],Ja[yb+1],Ja[yb+2],Ja[yb+3]);Kb&&Ob[Qa].push(Ja[yb+4],Ja[yb+5],Ja[yb+6],Ja[yb+7])}for(Qa in Ob)Ob[Qa]=new Float32Array(Ob[Qa]);zc=Ob}Ub=zc}$c=p(a,b,J,oa,qc,Nb,Ub,Z,T,ld,pc,Rc);R.push.apply(R,$c)}"INSTANCE"==Z.b4w_wind_bend_inheritance&&aa.o.Ud&&X.warn('Emitter object "'+aa.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else fa.D("Unknown particle settings type")}wa?
f.push.apply(f,R):f=R}return f}function n(a){for(var b=[],c=[],d={},e=0;e<a.length;e++){var f=a[e].qa,g=null;if(f.id in d){var h=d[f.id],k=c[h].qa;Y(f,function(a){Y(k,function(b){fa.eR(a,b)&&1!=a.AC&&(g=c[h])})});if(!g){do f.id++;while(d[f.id])}}g||(g={qa:f,vD:[],oA:[],XE:[],nd:[],RD:[],Nf:[]},d[f.id]=c.length,c.push(g));if(a[e].Hd&&a[e].Hd.Ha){g.vD.push(a[e].Ee);g.oA.push(a[e].kr);g.XE.push(a[e].Hd);for(var m=0;m<a[e].nd.length;m++)f=a[e].nd[m],-1==g.RD.indexOf(f.uuid)&&(g.nd.push(f),g.RD.push(f.uuid));
for(m=0;m<a[e].Nf.length;m++)f=a[e].Nf[m],-1==g.Nf.indexOf(f)&&g.Nf.push(f)}g.Nf.sort()}for(e=0;e<c.length;e++){var f=c[e].qa,l=c[e].vD,n=c[e].oA,p=c[e].XE;a=L.Av(n[0]);if("STATIC"==a.type)for(m=0;m<l.length;m++){var r=l[m],O=n[m],d=p[m],t=ta.identity(sa);r.ng&&!r.ho?(r=ta.ec(r.v,ma),ta.set_trans(r,t)):ta.copy(r.v,t);O.vj?d.ff||(O.ng?qa.gR(d,t):qa.bu(d,t)):qa.bu(d,t);if(O.vj)A(f,"AU_QUALIFIER","GLSL_IN");else if(1<c[e].nd.length){r={};if(O.Ud||O.ng)r.au_center_pos=[t[0],t[1],t[2]];O.Ud&&(r.au_wind_bending_amp=
[O.Ne],r.au_wind_bending_freq=[O.Oe],r.au_detail_bending_amp=[O.xe],r.au_detail_bending_freq=[O.ye],r.au_branch_bending_amp=[O.te]);qa.fR(d,r);A(f,"AU_QUALIFIER","GLSL_IN")}else a.so.set(t.subarray(0,3)),O.so.set(t.subarray(0,3)),A(f,"AU_QUALIFIER","uniform")}if(0==p.length)d=qa.ef(fa.tq("%empty"));else if(1==p.length)d=p[0];else{d=[];for(m=0;m<p.length;m++)qa.RN(p[m])||d.push(m);if(d.length<p.length)for(m=0;m<d.length;m++)qa.cu(p[d[m]]);d=qa.VE(p)}if("STATIC"==a.type){if(1<c[e].nd.length){p=[];for(m=
0;m<c[e].nd.length;m++)ba.jw(c[e].nd[m].Ua.o.qA,p);ba.pA(p,a.Pa);ba.cm(a.Pa,a.U);a.jb=ba.Br(fa.f32(p),!0);ba.Gv(a.jb,a.Z);a.gb=ba.Lo(a.jb);ba.Hv(a.gb,a.va)}a.Bm&&(m=c[e].nd[0].b4w_cluster_data,m.cluster_center&&m.cluster_radius?(a.hl.set(m.cluster_center),a.il=m.cluster_radius):(a.hl.set(a.gb.M),a.il=a.gb.Wa),n[0].hl.set(a.hl),n[0].il=a.il);a.Je=ba.Gs(a.Z,a.va)}for(m=0;m<l.length;m++)l[m].Je=ba.Gs(l[m].Z,l[m].va);"PARTICLES"!=f.type&&(m=d.pf,f.U=ba.yk(m.U),f.Z=ba.yo(m.Z),f.va=a.va.Wa<m.va.Wa?"STATIC"==
a.type?ba.zk(a.gb):ba.zk(a.va):ba.zk(m.va),"STATIC"==a.type?(f.jb=f.Z,f.Pa=f.U,f.gb=f.va):(m=a.v,f.jb=ba.ko(f.Z,m),f.gb=ba.lo(f.va,m),f.Pa=ba.wk(f.U,m)),f.Je=ba.Gs(f.Z,f.va));b.push({qa:f,o:a,Hd:d,Nf:c[e].Nf,nd:c[e].nd})}return b}function B(a,b,c,d){a.eo=ba.tA(b,d);a.bo=ba.rA(c,d);a.co=ba.sA(b,d)}function e(a,b,c,d){var e=[];d||(b.Qj&&ka.dc(a,Ba.Wd)||b.Ic&&ka.dc(a,Ba.fg))&&e.push("COLOR_ID");c&&(e.push("MAIN"),e.push("NODES_GLOW"),ka.dc(a,Ba.eg)&&e.push("DEBUG_VIEW"),ka.dc(a,Ba.Re)&&e.push("SHADOW"),
ka.dc(a,Ba.Oh)&&e.push("GRASS_MAP"));e.push("PHYSICS");if(b.Qd||b.md)for(a=null,b.Qd&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),b.md&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a?a=fa.bJ(a,b):a=b),b=a,a=0;a<b.length;a++)c=e.indexOf(b[a]),-1!==c&&e.splice(c,1);return e}function v(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render)c=!1;else{if(b.use_nodes&&"HALO"!=b.type)u(a,b,"MAIN");else{l(a,b);c=b.game_settings.alpha_blend;a.Tg=b.b4w_render_above_all&&"OPAQUE"!=c&&
"CLIP"!=c;a.Sf=b.offset_z;a.$f.set([1,1,1]);var d=b.texture_slots;M.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.xd);if(b.b4w_lens_flares){G(a,"lens_flares.glslv","lens_flares.glslf");m(a,"a_position");m(a,"a_texcoord");var e=ra.Ld(d[0]),g=d[0].texture;E(a,e,"u_sampler",g.name)}else{G(a,"main.glslv","main_stack.glslf");if(!b.use_shadeless){var n=da.Jv(b.uuid,b.name,{le:b.use_shadeless,To:b.diffuse_shader,kq:b.specular_shader,Jl:b.use_tangent_shading});a.ab.Rf=da.xr(n)}var p=
x("use_map_color_diffuse",d),r=x("use_map_color_spec",d),t=x("use_map_normal",d),O=x("use_map_mirror",d),v=x("use_stencil",d),n=p[0],r=r[0],t=t[0],O=O[0],p=p[1],d=v[0]&&x("use_rgb_to_intensity",d)[0];if(n){g=n.texture;switch(n.blend_type){case "MIX":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e=ra.Ld(n);E(a,e,"u_colormap0",g.name);a.hh=n.diffuse_color_factor;n.use_map_alpha?a.xf=n.alpha_factor:a.xf=0;a.$f.set(n.scale)}v=
n&&n==r;r&&(v||(g=r.texture,e=ra.Ld(r),E(a,e,"u_specmap0",g.name)),a.Di=r.specular_color_factor);if(t&&(g=t.texture,m(a,"a_tbn_quat"),e=ra.Ld(t),E(a,e,"u_normalmap0",g.name),a.Pm=t.normal_factor,g.b4w_use_map_parallax&&ua.rt)){var e=ea.N(g.b4w_parallax_steps),B=ea.N(g.b4w_parallax_lod_dist);A(a,"PARALLAX",1);A(a,"PARALLAX_STEPS",e);A(a,"PARALLAX_LOD_DIST",B);a.parallax_scale=g.b4w_parallax_scale}O&&(g=O.texture,e=ra.Ld(O),E(a,e,"u_mirrormap",g.name),a.kl=O.mirror_factor);if(O=n&&p&&d?1:0)e=ra.Ld(p),
g=p.texture,E(a,e,"u_colormap1",g.name),e=ra.Ld(d),g=d.texture,E(a,e,"u_stencil0",g.name);(g=n||r||t)&&a.$f.set(g.scale);A(a,"TEXTURE_SPEC",void 0==r?0:1);A(a,"ALPHA_AS_SPEC",v?1:0);A(a,"TEXTURE_STENCIL_ALPHA_MASK",O);m(a,"a_position");m(a,"a_tbn_quat");(n||r||t)&&m(a,"a_texcoord");if(b.b4w_water){a.Kh=!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.yb?(X.warn('Material: "'+b.name+'" is opaque.',"Disabling water shore smoothing."),a.Fn=!1):a.Fn="REFLECT"!=a.sb?b.b4w_water_shore_smoothing:
!1;G(a,"water.glslv","water.glslf");O=da.Jv(b.uuid,b.name,{le:!1,To:b.diffuse_shader,kq:b.specular_shader,Jl:b.use_tangent_shading});a.ab.Rf=da.xr(O);m(a,"a_position");ua.$F?(m(a,"a_polyindex"),a.Va=!0,va.set(0,0,0,a.wireframe_edge_color),ha.Bw()?A(a,"DEBUG_WIREFRAME",1):A(a,"DEBUG_WIREFRAME",2)):A(a,"DEBUG_WIREFRAME",0);v=b.texture_slots;O=x("use_map_normal",v);e=x("use_map_mirror",v)[0];O.length&&(g=O[0].texture,E(a,ra.Ld(O[0]),"u_normalmap0",g.name),a.gk=b.b4w_water_norm_uv_velocity);A(a,"NUM_NORMALMAPS",
O.length);a.ui=Array(O.length);for(g=0;g<O.length;g++)a.ui[g]=new Float32Array(2),a.ui[g].set([O[g].scale[0],O[g].scale[1]]);e&&(B=ra.Ld(e),g=e.texture,E(a,B,"u_mirrormap",g.name),a.kl=e.mirror_factor);e=null;if(ua.sm)for(g=0;g<v.length;g++){var y=v[g];if(!0===y.texture.b4w_water_foam){e=y;break}}e&&(A(a,"FOAM",1),B=ra.Ld(e),g=e.texture,E(a,B,"u_foam",g.name),a.foam_factor=b.b4w_foam_factor,a.Zr.set(g.b4w_foam_uv_freq),a.Yr.set(g.b4w_foam_uv_magnitude),a.bp[0]=e.scale[0],a.bp[1]=e.scale[1]);for(g=
0;g<v.length;g++)if(y=v[g],!0===y.texture.b4w_shore_dist_map){var q=y;break}q&&ua.cr&&(v=ra.Ld(q),g=q.texture,E(a,v,"u_shore_dist_map",g.name),A(a,"SHORE_PARAMS",1),q=y.texture.b4w_shore_boundings,A(a,"MAX_SHORE_DIST",ea.N(y.texture.b4w_max_shore_dist)),A(a,"SHORE_MAP_SIZE_X",ea.N(q[0]-q[1])),A(a,"SHORE_MAP_SIZE_Y",ea.N(q[2]-q[3])),A(a,"SHORE_MAP_CENTER_X",ea.N((q[0]+q[1])/2)),A(a,"SHORE_MAP_CENTER_Y",ea.N((q[2]+q[3])/2)));b.b4w_generated_mesh?(A(a,"GENERATED_MESH",1),a.xu=!0,a.yu=b.b4w_water_num_cascads,
a.zu=b.b4w_water_subdivs,a.wu=b.b4w_water_detailed_dist):(m(a,"a_tbn_quat"),(e||O.length)&&m(a,"a_texcoord"),A(a,"GENERATED_MESH",0));if(b.b4w_water_dynamic){var y=ea.N(b.b4w_water_dst_noise_scale0),q=ea.N(b.b4w_water_dst_noise_scale1),O=ea.N(b.b4w_water_dst_noise_freq0),v=ea.N(b.b4w_water_dst_noise_freq1),g=ea.N(b.b4w_water_dir_min_shore_fac),e=ea.N(b.b4w_water_dir_freq),B=ea.N(b.b4w_water_dir_noise_scale),N=ea.N(b.b4w_water_dir_noise_freq),K=ea.N(b.b4w_water_dir_min_noise_fac),z=ea.N(b.b4w_water_dst_min_fac),
pa=ea.N(b.b4w_water_waves_hor_fac);A(a,"DST_NOISE_SCALE_0",y);A(a,"DST_NOISE_SCALE_1",q);A(a,"DST_NOISE_FREQ_0",O);A(a,"DST_NOISE_FREQ_1",v);A(a,"DIR_MIN_SHR_FAC",g);A(a,"DIR_FREQ",e);A(a,"DIR_NOISE_SCALE",B);A(a,"DIR_NOISE_FREQ",N);A(a,"DIR_MIN_NOISE_FAC",K);A(a,"DST_MIN_FAC",z);A(a,"WAVES_HOR_FAC",pa)}f(a,b);F(a,b);a.shallow_water_col.set(b.b4w_shallow_water_col);a.shore_water_col.set(b.b4w_shore_water_col);a.shallow_water_col_fac=b.b4w_shallow_water_col_fac;a.shore_water_col_fac=b.b4w_shore_water_col_fac;
A(a,"ABSORB",ea.N(b.b4w_water_absorb_factor));A(a,"SSS_STRENGTH",ea.N(b.b4w_water_sss_strength));A(a,"SSS_WIDTH",ea.N(b.b4w_water_sss_width))}"HALO"===b.type&&(G(a,"halo.glslv","halo.glslf"),w(a,b),a.bj=["a_position"]);b.use_tangent_shading&&(A(a,"USE_TBN_SHADING",1),m(a,"a_shade_tangs"));A(a,"TEXCOORD",0);A(a,"NORMAL_TEXCOORD",0);n&&h(a,n,"TEXTURE_COLOR0_CO");p&&h(a,p,"TEXTURE_COLOR1_CO");d&&h(a,d,"TEXTURE_STENCIL_ALPHA_MASK_CO");r&&h(a,r,"TEXTURE_SPEC_CO");t&&h(a,t,"TEXTURE_NORM_CO");A(a,"SHADELESS",
b.use_shadeless?1:0);a.le=b.use_shadeless}A(a,"ALPHA","OPAQUE"===c?0:1);A(a,"ALPHA_CLIP","CLIP"===c?1:0);A(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(A(a,"VERTEX_COLOR",1),m(a,"a_color")):A(a,"VERTEX_COLOR",0);a.lg=b.ambient;a.ih=b.diffuse_intensity;a.ug=b.emit;a.Yf.set(b.specular_color);a.Cl=b.specular_alpha;f(a,b);F(a,b);b.b4w_wettable?A(a,"WETTABLE",1):A(a,"WETTABLE",0);k(a,b);b.b4w_refractive&&!a.yb?(X.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),
a.wi=!1):a.wi=b.b4w_refractive;a.Vm=b.b4w_refr_bump}c=!0}break;case "NODES_GLOW":c=u(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(l(a,b),a.yb)c=!1;else{n=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==n?u(a,b,"SHADOW"):G(a,"shadow.glslv","shadow.glslf");M.set(0,0,0,b.alpha,a.xd);m(a,"a_position");m(a,"a_tbn_quat");A(a,"ALPHA","OPAQUE"===n?0:1);a.$f.set([1,1,1]);if((c=x("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===
n){switch(c.blend_type){case "MIX":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.$f.set(c.scale);A(a,"TEXTURE_COLOR",1);m(a,"a_texcoord");n=ra.Ld(c);c=c.texture;"IMAGE"!=n.source&&"ENVIRONMENT_MAP"!=n.source&&"CANVAS"!=n.source&&"NONE"!=n.source||E(a,n,"u_colormap0",c.name)}else A(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.Cq=b.b4w_use_ghost,a.Ub=b.b4w_collision_id,a.Do=b.b4w_collision_margin,
a.Bo=b.b4w_collision_group,a.Eo=b.b4w_collision_mask,a.um=b.physics.friction,a.mm=b.physics.elasticity,c=!0):b.b4w_water?(a.Kh=!0,a.xS=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,
a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===b.type)c=!1;else{l(a,b);a.Pe=!1;a.Va=!0;a.yb=!1;n=b.game_settings.alpha_blend;a.Tg=b.b4w_render_above_all&&"OPAQUE"!=n&&"CLIP"!=n;b.use_nodes&&"CLIP"==n?u(a,b,"COLOR_ID"):G(a,"color_id.glslv","color_id.glslf");M.set(0,0,0,b.alpha,a.xd);m(a,"a_position");A(a,"ALPHA","OPAQUE"===n?0:1);a.$f.set([1,1,1]);c=x("use_map_color_diffuse",
b.texture_slots)[0];n="CLIP"===n?1:0;A(a,"ALPHA_CLIP",n);if(c&&n){switch(c.blend_type){case "MIX":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.$f.set(c.scale);A(a,"TEXTURE_COLOR",1);m(a,"a_texcoord");n=ra.Ld(c);c=c.texture;"IMAGE"!=n.source&&"ENVIRONMENT_MAP"!=n.source&&"CANVAS"!=n.source&&"NONE"!=n.source||E(a,n,"u_colormap0",c.name)}else A(a,"TEXTURE_COLOR",0);c=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?
c=!1:(l(a,b),a.yb=!1,a.Pe=!1,a.Va=!0,G(a,"grass_map.glslv","grass_map.glslf"),m(a,"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,n=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.Lc.a_grass_size={Sk:!0,src:[]},c?(a.Lc.a_grass_size.src.push({name:c,Mf:4}),A(a,"DYNAMIC_GRASS_SIZE",1)):A(a,"DYNAMIC_GRASS_SIZE",0),a.Lc.a_grass_color={Sk:!0,src:[]},n?(a.Lc.a_grass_color.src.push({name:n,Mf:7}),A(a,"DYNAMIC_GRASS_COLOR",1)):A(a,"DYNAMIC_GRASS_COLOR",0),A(a,"GRASS_TEXTURE_SIZE",
ea.N(xa.np)),c=!0);break;case "DEBUG_VIEW":c=D(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)c=!1;else{c=b.texture_slots;if(a.op)G(a,"particle_system.glslv","particle_system_stack.glslf"),A(a,"HALO_PARTICLES",1),w(a,b);else{n={le:!1,To:b.diffuse_shader,kq:b.specular_shader,Jl:b.use_tangent_shading};if(b.use_nodes){G(a,"particle_system.glslv","particle_system.glslf");u(a,b,"PARTICLES");c=!0;break a}G(a,"particle_system.glslv","particle_system_stack.glslf");n=da.Jv(b.uuid,b.name,n);a.ab.Rf=da.xr(n);
if(c=x("use_map_color_diffuse",c)[0]){A(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":A(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.hh=c.diffuse_color_factor;c.use_map_alpha?a.xf=c.alpha_factor:a.xf=0;E(a,ra.Ld(c),"default"+String(a.Sa.length),c.texture.name)}}M.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.xd);a.lg=b.ambient;a.ih=b.diffuse_intensity;a.ug=b.emit;a.Yf.set(b.specular_color);
a.Cl=b.specular_alpha;m(a,"a_position");m(a,"a_tbn_quat");c=b.game_settings.alpha_blend;A(a,"ALPHA","OPAQUE"===c?0:1);A(a,"ALPHA_CLIP","CLIP"===c?1:0);A(a,"PARTICLES_SHADELESS",b.use_shadeless?1:0);f(a,b);F(a,b);l(a,b);a.Tg=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.Sf=b.offset_z;c=!0}break;default:fa.D("Wrong batch type: "+a.type)}return c}function w(a,b){var c=b.halo;A(a,"NUM_RINGS",c.ring_count);A(a,"NUM_LINES",c.line_count);A(a,"NUM_STARS",c.star_tip_count);A(a,"SKY_STARS",b.b4w_halo_sky_stars?
1:0);a.xs=c.size;a.us=c.hardness/20;a.ws.set(c.b4w_halo_rings_color);a.vs.set(c.b4w_halo_lines_color);a.ys=1/b.b4w_halo_stars_blend_height;a.zs=b.b4w_halo_stars_min_height;a.ts=!0}function h(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":A(a,c,"TEXTURE_COORDS_UV_ORCO");A(a,"TEXCOORD",1);break;case "NORMAL":A(a,c,"TEXTURE_COORDS_NORMAL");A(a,"NORMAL_TEXCOORD",1);break;default:A(a,c,"TEXTURE_COORDS_NONE")}}function l(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.yb=
!0;a.Pe=!0;a.Va=!0;a.kg=!1;break;case "ALPHA":a.yb=!0;a.Pe=!1;a.Va=!0;a.kg=!1;break;case "CLIP":a.yb=!1;a.Pe=!1;a.Va=!0;a.kg=!0;break;case "ADD":a.yb=!0;a.Pe=!1;a.Va=!1;a.kg=!1;break;case "OPAQUE":a.yb=!1;a.Pe=!1;a.Va=!0;a.kg=!1;break;default:fa.D("Unknown alpha blend mode: "+d)}a.Qb=c.use_backface_culling}function x(a,b){for(var c=[],d=b.length,e=0;e<d;e++){var f=b[e];1==f[a]&&f.texture&&f.texture.F&&c.push(f)}return c}function k(a,b){var c=b.raytrace_transparency;a.bf[0]=c.fresnel;a.bf[1]=1-c.fresnel_factor/
5;c=b.raytrace_mirror;a.reflect_factor=c.reflect_factor;a.bf[2]=c.fresnel;a.bf[3]=1-c.fresnel_factor/5}function f(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;d=b.specular_hardness;break;default:X.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Rd[0]=b.specular_intensity;
a.Rd[1]=c;a.Rd[2]=d}function F(a,b){switch(b.diffuse_shader){case "LAMBERT":a.$c[0]=0;a.$c[1]=0;break;case "OREN_NAYAR":a.$c[0]=b.roughness;a.$c[1]=0;break;case "FRESNEL":a.$c[0]=b.diffuse_fresnel;a.$c[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.$c[0]=b.darkness;a.$c[1]=0;break;case "TOON":a.$c[0]=b.diffuse_toon_size;a.$c[1]=b.diffuse_toon_smooth;break;default:X.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.$c[0]=0,a.$c[1]=0}}function u(a,b,c){if(!b.use_nodes||
b.b4w_do_not_render)return!1;var d;switch(c){case "MAIN":G(a,"main.glslv","main.glslf");d=!1;break;case "GLOW":G(a,"main.glslv","main.glslf");d=!0;break;case "SHADOW":G(a,"shadow.glslv","shadow.glslf");d=!1;break;case "COLOR_ID":G(a,"color_id.glslv","color_id.glslf"),d=!1}var e=b.node_tree;c=da.sK(e,b.uuid,!1,b.name,c);if(!c.Ja)return X.error('Failed to create node graph for material "'+b.name+'", disable nodes'),J(a,b),!0;a.Cj=c.id;a.qj=!0;A(a,"NODES",1);A(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?
1:0);m(a,"a_position");b.use_orco_tex_coord&&m(a,"a_orco_tex_coord");l(a,b);a.Sf=b.offset_z;var f=b.game_settings.alpha_blend;d?(A(a,"ALPHA",1),A(a,"ALPHA_CLIP",0)):(A(a,"ALPHA","OPAQUE"===f?0:1),A(a,"ALPHA_CLIP","CLIP"===f?1:0));a.Tg=b.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f;a.ug=b.emit;a.lg=b.ambient;k(a,b);b.b4w_wettable?A(a,"WETTABLE",1):A(a,"WETTABLE",0);var g=null,h=!1;Z.ha(c.Ja,function(c,d){switch(d.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var e=d.data.name,
f=d.data.value;a.Pi||(a.Pi={});a.Pi[f]=e;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":e=d.data.name;a.Lc[e]={Sk:!0,src:[{name:d.data.value}]};f=0;if("GEOMETRY_VC"==d.type)f=7;else for(var k=0;k<d.outputs.length;k++){var l="RGB".indexOf(d.outputs[k].identifier);-1<l&&(f|=1<<2-l)}a.Lc[e].src[0].Mf=f;break;case "TEX_COORD_NO":case "TEX_COORD_RE":case "GEOMETRY_NO":case "FRESNEL":case "LAYER_WEIGHT":m(a,"a_tbn_quat");break;case "TEX_COORD_OB":A(a,"USE_MODEL_TSR_INVERSE",
1);break;case "TEX_COORD_WI":A(a,"USE_POSITION_CLIP",1);break;case "MATERIAL_BEGIN":d.data.value.Jl&&(A(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type&&m(a,"a_shade_tangs"));m(a,"a_tbn_quat");h=!0;break;case "BSDF_BEGIN":h=!0;m(a,"a_tbn_quat");break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":e=d.data.name;f=d.data.nv;k=d.data.value;E(a,k,e,f);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":A(a,"CALC_TBN_SPACE",1);m(a,"a_tbn_quat");d.data&&(e=d.data.name,f=d.data.nv,k=d.data.value,E(a,k,e,f));break;
case "NORMAL_MAP":m(a,"a_tbn_quat");switch(Number(d.hb[0][1])){case da.bH:A(a,"CALC_TBN_SPACE",1);break;case da.aH:case da.$G:A(a,"USE_MODEL_TSR",1)}break;case "LAMP":d.data&&(a.el=d.data);break;case "B4W_REFRACTION":a.yb?a.wi=!0:(a.wi=!1,X.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));A(a,"USE_POSITION_CLIP",1);break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":g||(g=d.data.Ya);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&d.data&&(a.Kp=d.data);break;case "VECT_TRANSFORM":switch(Number(d.hb[1][1])){case da.qI:A(a,
"USE_MODEL_TSR_INVERSE",1);break;case da.pI:A(a,"USE_VIEW_TSR",1);break;case da.oI:A(a,"USE_MODEL_TSR",1);break;case da.nI:A(a,"USE_MODEL_TSR",1);A(a,"USE_VIEW_TSR",1);break;case da.mI:A(a,"USE_VIEW_TSR_INVERSE",1);break;case da.lI:A(a,"USE_MODEL_TSR_INVERSE",1),A(a,"USE_VIEW_TSR_INVERSE",1)}break;case "OBJECT_INFO":A(a,"USE_MODEL_TSR",1);a.Qm[1]=b.pass_index;a.Qm[2]=Math.random();break;case "B4W_VECTOR_VIEW":case "GEOMETRY_VW":A(a,"USE_VIEW_TSR",1);break;case "B4W_REFLECT":A(a,"USE_VIEW_TSR_INVERSE",
1);break;case "BUMP":case "DISPLACEMENT_BUMP":m(a,"a_tbn_quat");ha.Bw()?A(a,"USE_DERIVATIVES_EXT",1):X.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+b.name+'" material.');break;case "BSDF_TRANSPARENT":a.yb=!0,a.wi=!0}});g&&E(a,g,"u_nodes_texture");h||(a.le=!0);d=a.ab.Rf=da.xr(c.Ja);r(e,a);e=a.jf;c=a.hf;for(f=0;f<d.length;f++){var n=d[f];switch(n.id){case "VALUE":var p=n.st[0];if(p)for(var t=0;t<e.length;t+=2)if(e[t]==p){n.hb.push(["VALUE_IND",e[t+1]]);
break}break;case "RGB":if(p=n.st[0])for(t=0;t<c.length;t+=2)if(c[t]==p){n.hb.push(["RGB_IND",c[t+1]]);break}}}A(a,"NUM_VALUES",a.Gg.length);A(a,"NUM_RGBS",a.Bd.length);return!0}function r(a,b){var c=[],d=[],e=[],f=[];z(a,"",c,d,e,f);b.Gg=c;b.jf=d;b.Bd=e;b.hf=f}function z(a,b,c,d,e,f){for(var g=0;g<a.nodes.length;g++){var h=a.nodes[g];if("VALUE"==h.type){var k=(b?b+"%join%":"")+h.name;c.push(h.outputs[0].default_value);d.push(k,d.length/2)}else"RGB"==h.type?(k=(b?b+"%join%":"")+h.name,h=h.outputs[0].default_value.slice(0,
3),e.push(h[0],h[1],h[2]),f.push(k,f.length/2)):"GROUP"==h.type&&z(h.node_group.node_tree,(b?b+"%join%":"")+h.name,c,d,e,f)}}function J(a,b){switch(a.type){case "SHADOW":G(a,"shadow.glslv","shadow.glslf");break;case "COLOR_ID":G(a,"color_id.glslv","color_id.glslf");break;default:G(a,"main.glslv","main_stack.glslf")}A(a,"SHADELESS",1);m(a,"a_position");m(a,"a_tbn_quat");M.set(1,0,1,1,a.xd);if(b){var c=b.game_settings.alpha_blend;A(a,"ALPHA","OPAQUE"===c?0:1);A(a,"ALPHA_CLIP","CLIP"===c?1:0);A(a,"VERTEX_COLOR",
0);a.Sf=b.offset_z;l(a,b)}return!0}function D(a,b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;G(a,"debug_view.glslv","debug_view.glslf");m(a,"a_position");m(a,"a_tbn_quat");m(a,"a_polyindex");a.Va=!0;va.set(0,0,0,a.wireframe_edge_color);return!0}function H(a,b){a.ud=b.ud;if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.vj?A(a,"AU_QUALIFIER","GLSL_IN"):A(a,"AU_QUALIFIER","uniform"),A(a,"STATIC_BATCH",0)):(A(a,"AU_QUALIFIER","GLSL_IN"),A(a,"STATIC_BATCH",1));"DEBUG_VIEW"==a.type&&(ha.Bw()?A(a,
"WIREFRAME_QUALITY",1):A(a,"WIREFRAME_QUALITY",0),a.ci?(A(a,"DEBUG_SPHERE",1),a.Kr?A(a,"DEBUG_SPHERE_DYNAMIC",1):A(a,"DEBUG_SPHERE_DYNAMIC",0)):A(a,"DEBUG_SPHERE",0),A(a,"ALPHA",1));b.me&&"PARTICLES"!=a.type&&!b.vj&&(a.me=b.me);b.Ud?(""!==b.oi?(a.Lc.a_bending_col_main={Sk:!0,src:[{name:b.oi,Mf:4}]},m(a,"a_bending_col_main"),""!==b.ae.ax&&""!==b.ae.$w&&""!==b.ae.Jx?(a.Lc.a_bending_col_detail={Sk:!0,src:[{name:b.ae.ax,Mf:4},{name:b.ae.$w,Mf:2},{name:b.ae.Jx,Mf:1}]},m(a,"a_bending_col_detail"),m(a,"a_tbn_quat"),
A(a,"DETAIL_BEND",1)):A(a,"DETAIL_BEND",0),A(a,"MAIN_BEND_COL",1)):A(a,"MAIN_BEND_COL",0),b.rk?A(a,"BEND_CENTER_ONLY",1):A(a,"BEND_CENTER_ONLY",0),A(a,"WIND_BEND",1)):A(a,"WIND_BEND",0);A(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.ho|0);b.ng?A(a,"BILLBOARD",1):A(a,"BILLBOARD",0);b.ng&&b.vj?A(a,"HAIR_BILLBOARD",1):A(a,"HAIR_BILLBOARD",0);b.io?A(a,"BILLBOARD_SPHERICAL",1):A(a,"BILLBOARD_SPHERICAL",0);switch(b.jo){case "RANDOM":A(a,"BILLBOARD_RANDOM",1);A(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":A(a,
"BILLBOARD_RANDOM",0);A(a,"BILLBOARD_JITTERED",1);break;default:A(a,"BILLBOARD_RANDOM",0),A(a,"BILLBOARD_JITTERED",0)}b.yc&&ua.cr?A(a,"DYNAMIC_GRASS",1):A(a,"DYNAMIC_GRASS",0);a.yc=b.yc;"PARTICLES"!=a.type&&(a.be=b.be);a.ie=b.ie;a.Qd=b.Qd;a.Gd=b.Gd&&!a.le&&!(a.yb&&ua.Zv);a.Ed=b.Ed;a.md=b.md;a.ld=b.ld;a.Qm[0]=b.vt;a.De=b.De;a.Dg=b.Dg;a.Eg=b.Eg;a.td=b.td;a.jd=b.jd;b.xj?(m(a,"a_influence"),A(a,"SKINNED",1),ua.Nt?(A(a,"DISABLE_TANGENT_SKINNING",1),A(a,"FRAMES_BLENDING",0)):(A(a,"DISABLE_TANGENT_SKINNING",
0),b.Qk?A(a,"FRAMES_BLENDING",1):A(a,"FRAMES_BLENDING",0)),A(a,"MAX_BONES",b.Fg)):(A(a,"SKINNED",0),A(a,"FRAMES_BLENDING",0),A(a,"DISABLE_TANGENT_SKINNING",0));b.Kc?(A(a,"VERTEX_ANIM",1),ua.TF?A(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):A(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):A(a,"VERTEX_ANIM",0);b.xj&&b.Kc&&fa.D("Skinning and vertex animation are mutually exlusive")}}function C(a,b,c){if(b.length){for(var d=L.ms(b,ua.ssao&&c.b4w_enable_ssao),e=a.ab,f=a.el,g=0,h=0;h<a.ab.Rf.length;h++){var k=
a.ab.Rf[h];if("LIGHTING_LAMP"==k.id){var m=b[g++%b.length],l=m.nb,n=L.oa(m,c);if("SPOT"==l.type||"POINT"==l.type)var p=Math.cos(l.Dl/2);if("SPOT"==l.type)var r=l.mq*(1-p);m=d.indexOf(m);k.hb=[["LAMP_TYPE",l.type],["LAMP_IND",n.Bp],["LAMP_SPOT_SIZE",ea.N(p||.01)],["LAMP_SPOT_BLEND",ea.N(r||.01)],["LAMP_LIGHT_DIST",ea.N(l.distance)],["LAMP_USE_SPHERE",l.gz?1:0],["LAMP_SHADOW_MAP_IND",m]]}else if("LAMP"==k.id&&f)for(var n=k.hb[0][1],u=0;u<b.length;u++)if(m=b[u],f[m.Oi]==n){l=m.nb;if("SPOT"==l.type||
"POINT"==l.type)p=Math.cos(l.Dl/2);"SPOT"==l.type&&(r=l.mq*(1-p));k.hb.push(["LAMP_TYPE",l.type],["LAMP_SPOT_SIZE",ea.N(p||.01)],["LAMP_SPOT_BLEND",ea.N(r||.01)],["LAMP_LIGHT_DIST",ea.N(l.distance)],["LAMP_USE_SPHERE",l.gz?1:0])}}if(f){c=0;for(var v in f)c++;a.Fm=new Float32Array(3*c);a.yp=new Float32Array(3*c);a.xp=new Float32Array(3*c);ea.ia(e,"NUM_LAMP_LIGHTS",c);for(h=0;h<b.length;h++)t(a,b[h])}}}function t(a,b){if(b.Oi in a.el){var c=a.el[b.Oi],d=ta.get_trans_view(b.o.v);a.Fm.set(d,3*c);a.yp.set(b.nb.direction,
3*c);a.xp.set(b.nb.Fo,3*c)}}function m(a,b){var c=a.bj;-1==c.indexOf(b)&&c.push(b);a.bj=c.sort()}function A(a,b,c){ea.ia(a.ab,b,c)}function I(a,b){if("PHYSICS"==a.type)"NAVMESH"==a.sb?a.da=qa.WE(b,qa.Tl,[]):(0<b.eb.length&&qa.hR(b,b.aa[0]),a.Hd=b);else{var c=a.tg;a.ts&&"PARTICLES"!=a.type&&(b=qa.gM(b));a.xu&&(b=aa.EM(a.yu,a.zu,a.wu));c=qa.WE(b,c,a.Lc);a.da=c;a.be||a.Pe||a.me||(c.zd=null,c.Kb.length=0);c=b.aa.length;a.num_vertices=b.Ha*c;var d;a:switch(a.tg){case qa.Tl:case qa.Jn:case qa.Oq:d=!0;break a;
default:d=!1}d?qa.QN(b)?a.num_triangles=b.ma.length/3*c:a.num_triangles=b.Ha/3*c:a.num_triangles=0}}function p(a,b,c,e,f,g,h,k,m,l,n,p){var r=a.Ua,t=[],u=k.b4w_dynamic_grass;if(!l&&u)return t;for(var w="INSTANCE"==k.b4w_wind_bend_inheritance,B="INSTANCE"==k.b4w_shadow_inheritance,O="INSTANCE"==k.b4w_reflection_inheritance,q=[],N=[],z=0;z<f.length;z++){var x=f[z].Ua.o,E=L.Av(b);E.ng=k.b4w_hair_billboard;E.jo=k.b4w_hair_billboard_type;E.io="SPHERICAL"==k.b4w_hair_billboard_geometry;E.yc=u;E.vj=!0;w?
(E.Ud=x.Ud,E.Ql=x.Ql,E.Oe=x.Oe,E.ye=x.ye,E.oi=x.oi,E.xe=x.xe,E.te=x.te,E.Ne=x.Ne,E.ae=x.ae,E.rk=!1):(E.Ud=r.o.Ud,E.Ql=r.o.Ql,E.Oe=r.o.Oe,E.ye=r.o.ye,E.oi=r.o.oi,E.xe=r.o.xe,E.te=r.o.te,E.Ne=r.o.Ne,E.ae=r.o.ae,E.rk=!0);B?(E.ie=x.ie,E.Qd=x.Qd,E.Gd=x.Gd):(E.ie=r.o.ie,E.Qd=r.o.Qd,E.Gd=r.o.Gd);O?(E.Ed=x.Ed,E.md=x.md,E.ld=x.ld,E.td=x.td,E.jd=x.jd,E.Mg=x.Mg):(E.Ed=r.o.Ed,E.md=r.o.md,E.ld=r.o.ld,E.td=r.o.td,E.jd=r.o.jd,E.Mg=r.o.Mg);q.push(E);var D=h[z];D||(D=new Float32Array);p&&fa.Ds(m.seed,n);var F=new Float32Array(3),
C=new Float32Array([0,0,0,1]),ma=[],pa=la.SA(ua.gx)&&!k.b4w_initial_rand_rotation&&!k.b4w_hair_billboard,G=4;pa&&(G=8);for(var I=0;I<D.length;I+=G){F[0]=D[I];F[1]=D[I+1];F[2]=D[I+2];var ra=D[I+3]*ta.get_scale(x.v);if(k.b4w_initial_rand_rotation){switch(k.b4w_rotation_type){case "XYZ":var ba=new Float32Array([fa.Uf(n),fa.Uf(n),fa.Uf(n)]);va.normalize(ba,ba);break;case "Z":ba=new Float32Array([0,0,1]);break;default:fa.D("Unsupported random rotation type: "+k.b4w_rotation_type)}P.setAxisAngle(ba,k.b4w_rand_rotation_strength*
(2*Math.PI*fa.Uf(n)-Math.PI),C)}else if(pa&&(C.set(D.subarray(I+4,I+8)),fa.Tx(C,C),!k.use_whole_group))if(k.use_rotation_dupli){var J=ta.get_quat_view(x.v);P.multiply(C,J,C)}else P.multiply(C,wa,C);var U=ta.set_sep(F,ra,C,ta.create());ma.push(U)}N.push(ma)}for(var Ha={},W=0,z=0;z<f.length;z++)for(var Ga=f[z].data.materials,I=0;I<Ga.length;I++)Ga[I].name in Ha?Ha[Ga[I].name]++:(Ha[Ga[I].name]=1,W++);for(var W=W?W:1,Ma={},z=0;z<f.length;z++){var aa=f[z],oa=g[z],E=q[z],Va={};E.Ud&&(Va.au_wind_bending_amp=
[E.Ne],Va.au_wind_bending_freq=[E.Oe],Va.au_detail_bending_freq=[E.ye],Va.au_detail_bending_amp=[E.xe],Va.au_branch_bending_amp=[E.te],E.Ne=0,E.Oe=0,E.ye=0,E.xe=0,E.te=0);ma=N[z];if(ma.length){for(var R=aa.data,Ga=R.materials,M=Array(Ga.length),Aa=Array(Ga.length),I=0;I<Ga.length;I++)if(!K(r,I)&&!qa.uC(R,I))for(var Y=0;Y<oa.length;Y++){var Ea=oa[Y],T=d(Ea),Z=Ga[I];"MAIN"==Ea?M[I]=T:"DEBUG_VIEW"==Ea&&(Aa[I]=T);T.Ao=a.b4w_cluster_data.cluster_id;if(Q(T,Z)&&v(T,Z)){"SHADOW"==Ea&&M[I]&&(T.le=M[I].le);
T.tg=qa.Tl;H(T,E);T.Ej=V(T,E,k.uuid);T.fj=a.b4w_do_not_cull||k.b4w_dynamic_grass;"MAIN"==T.type&&(T.og=a.b4w_caustics);A(T,"DISABLE_FOG",("COLOR_ID"!=Ea&&"SHADOW"!=Ea&&a.b4w_disable_fogging)|0);"JITTERED"==k.b4w_hair_billboard_type&&(T.Ns=k.b4w_hair_billboard_jitter_amp,T.Os=k.b4w_hair_billboard_jitter_freq);u&&(T.os=k.b4w_dynamic_grass_scale_threshold);w||(delete T.Lc.a_bending_col_main,delete T.Lc.a_bending_col_detail);var Ca=qa.kw(R,I,T.bj,b.Vh,T.Lc,T.Pi),ha=r.o.v,ja=!0;if(1<Ha[Z.name]){var ca=
0,ea;for(ea in Ca.aa)ca++;ja=Ca.ma.length*ma.length*ca*Ha[Z.name]>2E5*W}var sa=ua.bA&&ja&&"PHYSICS"!=T.type;if(sa){T.AC=k.use_whole_group?2:1;var da=fa.S(Ca);qa.GA(Ca,da,ma);da.ff={qq:ma,Ay:ha,PE:"STATIC"==b.type,du:Va,Rm:{},Pr:u};if(E.Ud&&E.rk){var Ka=va.fromValues(0,0,0);ta.transform_vec3(Ka,r.o.v,Ka);for(var ka=[],ga=0;ga<ma.length;ga++)ka.push(Ka[0],Ka[1],Ka[2]);da.ff.Rm.a_emitter_center={Wb:3,data:ka}}qa.GA(Ca,Ca,ma);"STATIC"==b.type&&qa.uJ(da.pf,ha)}else{var Ta=da=qa.zO(Ca,Va,ma),Fa=ma;Ta.pa.au_center_pos=
new Float32Array(3*Ta.Ha);for(var La=Fa.length,Ia=Ta.Ha/La,Ra=0;Ra<La;Ra++)for(var Ba=Fa[Ra],na=3*Ia*Ra,xa=0;xa<Ia;xa++)Ta.pa.au_center_pos[na+3*xa]=Ba[0],Ta.pa.au_center_pos[na+3*xa+1]=Ba[1],Ta.pa.au_center_pos[na+3*xa+2]=Ba[2];da=Ta;if(E.Ud&&E.rk){var Yb=da,Rc=r.o.v;Yb.pa.a_emitter_center=new Float32Array(3*Yb.Ha);var Ib=va.fromValues(0,0,0);ta.transform_vec3(Ib,Rc,Ib);for(var Ub=0;Ub<Yb.Ha;Ub++)Yb.pa.a_emitter_center[3*Ub]=Ib[0],Yb.pa.a_emitter_center[3*Ub+1]=Ib[1],Yb.pa.a_emitter_center[3*Ub+
2]=Ib[2];da=Yb}}var Jb=k.b4w_vcol_from_name,jc=k.b4w_vcol_to_name,rc=T,id=c,wb=!w,Za=R,gb=[];if(""!==Jb&&""!==jc){var cb,ec=void 0,yc=jc,Sc=rc.Lc,kc=[];for(ec in Sc)for(var zc=Sc[ec].src,Qb=0,Ac=0;Ac<zc.length;Ac++){var Bc=zc[Ac].Mf;yc==zc[Ac].name&&kc.push(ec,Bc,Qb);Qb+=fa.xl(Bc)}cb=kc;if(0<cb.length)for(var fc=0;fc<cb.length;fc+=3)gb.push({Zo:Jb,Rr:7,tt:cb[fc],ut:cb[fc+1],Or:cb[fc+2]});else qa.BN(rc.bj,"a_color")&&jc==Za.active_vcol_name&&gb.push({Zo:Jb,Rr:7,tt:"a_color",ut:7,Or:0})}wb&&("a_bending_col_main"in
id&&gb.push({Zo:"a_bending_col_main",Rr:4,tt:"a_bending_col_main",ut:4,Or:0}),"a_bending_col_detail"in id&&gb.push({Zo:"a_bending_col_detail",Rr:7,tt:"a_bending_col_detail",ut:7,Or:0}));for(var Vb=da,Zb=ma,rb=e,sb=gb,kb=T.Lc,Gc=sa,ad=!1,tb=0;tb<sb.length;tb++){var Bb=sb[tb].Zo,ub=rb.pa[Bb];if(ub&&0<ub.length){ad=!0;break}}if(Gc)var Hc=Vb.ff.Rm;if(ad){var Oa,hb=r.o.U,xb=rb.aa[0].a_position,gc=Zb,Ja=Ma,$b=new Float32Array(3),Kb=new Float32Array(3),Cb=new Uint32Array(gc.length);if(!("verts_indices"in
Ja)){Ja.Yh=new Float32Array(3);Ja.Sh=new Float32Array(3);Ja.iz=new Uint32Array(xb.length/3);Ja.Fp=new Uint32Array(xb.length/3);Ja.Yh[0]=(hb.max_x-hb.min_x)/20;Ja.Yh[1]=(hb.max_y-hb.min_y)/20;Ja.Yh[2]=(hb.max_z-hb.min_z)/20;Ja.Sh[0]=hb.min_x;Ja.Sh[1]=hb.min_y;Ja.Sh[2]=hb.min_z;for(var jb=0;jb<xb.length/3;jb++){var Ob=fa.trunc((xb[3*jb]-Ja.Sh[0])/Ja.Yh[0]),yb=fa.trunc((xb[3*jb+1]-Ja.Sh[1])/Ja.Yh[1]),Qa=fa.trunc((xb[3*jb+2]-Ja.Sh[2])/Ja.Yh[2]),Ob=fa.clamp(Ob,0,19),yb=fa.clamp(yb,0,19),Qa=fa.clamp(Qa,
0,19);Ja.iz[jb]=jb;Ja.Fp[jb]=Qa*Math.pow(20,2)+20*yb+Ob}qa.RQ(Ja.Fp,Ja.iz,qa.Ru,!0);Ja.Ll=new Uint32Array(Math.pow(20,3));for(jb=0;jb<Ja.Fp.length;jb++)Ja.Ll[Ja.Fp[jb]]++;delete Ja.Fp;for(jb=1;jb<Ja.Ll.length;jb++)Ja.Ll[jb]+=Ja.Ll[jb-1]}for(var Rb=0;Rb<gc.length;Rb++){$b[0]=gc[Rb][0];$b[1]=gc[Rb][1];$b[2]=gc[Rb][2];for(var Db=1E10,Cc=-1,Ic=fa.trunc(($b[0]-Ja.Sh[0])/Ja.Yh[0]),Eb=fa.trunc(($b[1]-Ja.Sh[1])/Ja.Yh[1]),Jc=fa.trunc(($b[2]-Ja.Sh[2])/Ja.Yh[2]),Ic=fa.clamp(Ic,0,19),Eb=fa.clamp(Eb,0,19),Jc=
fa.clamp(Jc,0,19),Wb=Jc*Math.pow(20,2)+20*Eb+Ic,lc=Ja.Ll[Wb],mc=0==Wb?0:Ja.Ll[Wb-1];mc<lc;mc++){var bd=Ja.iz[mc];Kb[0]=xb[3*bd];Kb[1]=xb[3*bd+1];Kb[2]=xb[3*bd+2];va.sub(Kb,$b,Kb);var Tc=va.sqrLen(Kb);Tc<=Db&&(Db=Tc,Cc=bd)}if(-1==Cc)for(mc=0;mc<xb.length/3;mc++)Kb[0]=xb[3*mc],Kb[1]=xb[3*mc+1],Kb[2]=xb[3*mc+2],va.sub(Kb,$b,Kb),Tc=va.sqrLen(Kb),Tc<=Db&&(Db=Tc,Cc=mc);Cb[Rb]=Cc}Oa=Cb;for(var sc=Vb.Ha/Zb.length,tb=0;tb<sb.length;tb++){var ac=sb[tb].tt,Kc=sb[tb].ut,Bb=sb[tb].Zo,Dc=sb[tb].Rr,ub=rb.pa[Bb];
switch(ac){case "a_bending_col_main":var Lc=1;break;case "a_bending_col_detail":Lc=3;break;case "a_color":Lc=3;break;default:for(var bc=Lc=0;bc<kb[ac].src.length;bc++)Lc+=fa.xl(kb[ac].src[bc].Mf)}if(ub&&0<ub.length){var lb=fa.xl(Dc),mb=fa.xl(Kc),Uc=Dc&Kc,Mc=fa.WD(Uc);Uc!=Kc&&X.error("Wrong color extraction from "+Bb+" to "+ac+".");if(Gc)for(Hc[ac]={Wb:Lc,data:[]},bc=0;bc<Zb.length;bc++)for(tc=Oa[bc],md=tc*lb,Sb=0;Sb<Mc.length;Sb++)Mc[Sb]&&(uc=fa.Ym(Dc,Sb),Hc[ac].data.push(ub[md+uc]));else{if("a_bending_col_main"==
ac||"a_bending_col_detail"==ac)Vb.pa[ac]=new Float32Array(Vb.Ha*mb);for(bc=0;bc<Zb.length;bc++){var tc=Oa[bc],md=tc*lb,cd=bc*sc*Lc;if(-1!=tc)for(var nc=0;nc<sc;nc++)for(var hc=nc*Lc,Sb=0;Sb<Mc.length;Sb++)if(Mc[Sb]){var uc=fa.Ym(Dc,Sb);Vb.pa[ac][cd+hc+(sb[tb].Or+fa.Ym(Kc,Sb))]=ub[md+uc]}}}}else Vb.pa[ac]=new Float32Array(0)}}da=Vb;A(T,"USE_INSTANCED_PARTCLS",da.ff?1:0);y(T);t.push({qa:T,Ee:b,kr:E,Hd:da,Nf:[Z.name],nd:[a]})}}for(I=0;I<Aa.length;I++)Aa[I]&&(Aa[I].gm=M[I].id,y(Aa[I]))}}return t}function Q(a,
b){var c=!0;"NODES_GLOW"==a.type&&(c=da.QA(b));return c}function y(a){Y(a,function(a){a.id=0;a.id=fa.HJ(a)})}function Y(a,b){for(var c=null,d=null,e=[],f=0;f<a.Sa.length;f++){var g=a.Sa[f],h=g.Af;h&&(c||(c={}),c[f]=h,g.Af=null);if(h=g.Ta)d||(d={}),d[f]=h,g.Ta=null;e.push(g.qD);g.qD=0}var g=a.U,h=a.Z,k=a.va,m=a.Pa,l=a.jb,n=a.gb;a.U=null;a.Z=null;a.va=null;a.Pa=null;a.jb=null;a.gb=null;var p=a.ne;a.ne=null;var r=a.da;a.da=null;var t=a.Hd;a.Hd=null;b(a);a.da=r;a.Hd=t;a.ne=p;a.U=g;a.Z=h;a.va=k;a.Pa=m;
a.jb=l;a.gb=n;if(c)for(f in c)a.Sa[f].Af=c[f];if(d)for(f in d)a.Sa[f].Ta=d[f];for(f=0;f<a.Sa.length;f++)a.Sa[f].qD=e[f]}function R(a,b,c,e){var f=d("DEBUG_VIEW");G(f,"debug_view.glslv","debug_view.glslf");f.ci=!0;f.Va=!0;f.Ej=V(f,a,b);f.Kr=c;H(f,a);y(f);if(e.Je){c?(c=e.Z,ta.set_trans(e.Z.M,sa)):(c=e.jb,ta.set_trans(c.M,sa));var g=va.create();a=aa.es(1,g);b=va.fromValues(va.length(c.Ea),va.length(c.Fa),va.length(c.Ga));qa.bE(a,b,g);var g=va.normalize(c.Ea,ma),h=va.normalize(c.Fa,Ma);c=va.normalize(c.Ga,
Aa);!b[0]&&b[1]&&b[2]?va.cross(h,c,g):!b[1]&&b[0]&&b[2]?va.cross(c,g,h):!b[2]&&b[0]&&b[1]&&va.cross(g,h,c);b=fa.UL(g,h,c,Ha);ca.invert(b,b);b=P.fromMat3(b,U);ta.set_quat(b,sa);ta.set_scale(1,sa);qa.bu(a,sa)}else c?(b=e.va,a=aa.es(b.Wa,b.M)):(b=e.gb,a=aa.es(b.Wa,va.create()),ta.identity(sa),ta.set_trans(b.M,sa),qa.bu(a,sa));f.U=ba.yk(e.U);f.Z=ba.yo(e.Z);f.va=ba.zk(e.va);f.Pa=ba.yk(e.Pa);f.jb=ba.yo(e.jb);f.gb=ba.zk(e.gb);qa.cu(a,1,!0);a.pa.a_polyindex=qa.Ur(a);I(f,a);return f}function G(a,b,c){a.ab.bg=
b;a.ab.Ae=c;ea.eQ(a.ab)}function E(a,b,c,d){d=d||"";-1==a.Ie.indexOf(c)&&(a.Sa.push(b),a.Ie.push(c),a.Ve.push(d));a.ib&&T.kA(a)}function W(a){a.ab||fa.D("No shaders info for batch "+a.name);a.ib=ea.VM(a.ab);var b=a.ab;if(b.status===ea.Tu){var c=a.ib.attributes,d=a.da.Fb,e;for(e in c)d[e]||fa.D('missing data for "'+e+'" attribute')}b.status&ea.mG&&X.error("Texture limit exceeded for shader - "+b.Ae+', materials: "'+a.Jb.join(", ")+'". Maximum texture count: '+na.ox+", actual texture count: "+b.fF);
b.status&ea.lG&&X.error("Fragment uniform limit exceeded for shader - "+b.Ae+', materials: "'+a.Jb.join(", ")+'". ');b.status&ea.pG&&X.error("Vertex uniform limit exceeded for shader - "+b.bg+', materials: "'+a.Jb.join(", ")+'". ');b.status&ea.oG&&X.error("Vertex attribute limit exceeded for shader - "+b.bg+', materials: "'+a.Jb.join(", ")+'". Maximum attribute count: '+na.px+", actual attribute count: "+b.lA);b.status&ea.nG&&("MAIN"!=a.type||a.qj||X.error("Varying limit exceeded for shader - "+a.ab.Ae+
', materials: "'+a.Jb.join(", ")+'"'),"MAIN"==a.type&&a.qj||"NODES_GLOW"==a.type)&&(d=c=0,a.Pi&&(c=fa.gi(a.Pi)),a.Lc&&(d=fa.gi(a.Lc)),X.error("Varying limit exceeded for node shader - "+a.ab.Ae+", uv: "+c+", vc: "+d+', materials: "'+a.Jb.join(", ")+'"'));b.status&ea.jG&&X.error("Shader compilation/linking error: "+b.bg+", "+b.Ae+', materials: "'+a.Jb.join(", ")+'"');return a.ab.status===ea.Tu?(T.fJ(a.ib),T.cv(a),T.kA(a),!0):!1}function V(a,b,c){return"NAVMESH"==a.sb?c:b.be?"_odd_id_"+fa.uF():c}function K(a,
b){return 0<=b&&b<a.rc.$k.length&&a.rc.$k[b]}var ba=q("__boundings"),oa=q("__config"),X=q("__print"),ha=q("__extensions"),Z=q("__graph"),ca=q("__mat3"),da=q("__nodemat"),L=q("__obj_util"),ja=q("__particles"),aa=q("__primitives"),P=q("__quat"),la=q("__reformer"),T=q("__renderer"),ka=q("__scenegraph"),ea=q("__shaders"),Ba=q("__subscene"),ra=q("__textures"),ta=q("__tsr"),qa=q("__geometry"),fa=q("__util"),va=q("__vec3"),M=q("__vec4"),ua=oa.H,na=oa.pg,xa=oa.$m,N=oa.wC,wa=new Float32Array([0,0,-Math.sqrt(.5),
Math.sqrt(.5)]),ma=new Float32Array(3),Ma=new Float32Array(3),Aa=new Float32Array(3),U=new Float32Array(4),sa=ta.create(),Ha=ca.create(),Ga={};a.kJ=function(a){return Ga[a]||null};a.lJ=function(a,b){Ga[a]=b};a.UB=function(a,c,d,e){var f;f=a.F.Ja;for(var h=[],k=0;k<c.length;k++){var m=c[k],l=m.Ua,p=l.o;if(!l.tp){var r=L.is_dynamic(l),l=l.o,t=m.data.b4w_boundings,u=t.bs_rad,v=t.bs_cen,w=t.bc_rad,y=t.caxis_x,q=t.caxis_y,O=t.caxis_z,N=t.be_ax,x=t.be_cen,z=t.rbb.rbb_c,A=t.rbb.rbb_s,t=ba.yk(l.Th);l.ng&&
(u=Math.max(Math.abs(t.max_x),Math.abs(t.min_x)),v=Math.max(Math.abs(t.max_y),Math.abs(t.min_y)),A=Math.max(Math.abs(t.max_z),Math.abs(t.min_z)),A=Math.sqrt(u*u+v*v+A*A),w=Math.sqrt(u*u+v*v),t.max_x=t.max_y=t.max_z=A,t.min_x=t.min_y=t.min_z=-A,u=A,v=[0,0,0],y=[1,0,0],q=[0,1,0],O=[0,0,1],N=[A,A,A],x=[0,0,0],z=[0,0,0],A=[A,A,A]);ba.cm(t,l.U);ba.wk(l.U,l.v,l.Pa);l.va=ba.pv(u,fa.f32(v));ba.lo(l.va,l.v,l.gb);l.Z=r?ba.fo(y,q,O,x):ba.fo([1,0,0],[0,1,0],[0,0,1],x);va.scale(l.Z.Ea,N[0],l.Z.Ea);va.scale(l.Z.Fa,
N[1],l.Z.Fa);va.scale(l.Z.Ga,N[2],l.Z.Ga);ba.ko(l.Z,l.v,l.jb);r?B(l,w,w,l.U):(l.fd=ba.OP(z,y,q,O,A),ba.mv(l.fd,l.v,l.qA));h.push.apply(h,g(m,p,f))}}f=n(h);for(h=0;h<f.length;h++)if(k=f[h].qa,k.Jb=f[h].Nf,I(k,f[h].Hd),C(k,d,a),"STATIC"==f[h].o.type&&"COLOR_ID"!=k.type){if(m=fa.tq("%meta%"+k.type+"%"+k.Jb.join("%")+"%"),r=L.Mo(m,"MESH"),L.KO(r,f[h].o),L.Xn(r,a),L.dr(r,a,k),e.push(r),"MAIN"==k.type)for(p=0;p<f[h].nd.length;p++)m=f[h].nd[p].Ua,m.Zs.push(r)}else m=f[h].nd[0].Ua,L.dr(m,a,k);if(ua.debug_view){for(h=
0;h<f.length;h++)if(d=f[h].o,"DYNAMIC"==d.type&&(m=f[h].nd[0].Ua,k=f[h].qa,"MAIN"==k.type)){p=L.oa(m,a);r=p.R;l=!1;for(p=0;p<r.length;p++)r[p].ci&&(l=!0);l||(d=R(d,m.name,!0,k),L.dr(m,a,d))}for(h=0;h<e.length;h++)m=e[h],d=m.o,p=L.oa(m,a),k=p.R[0],"MAIN"==k.type&&(d=R(d,m.name,!1,k),L.dr(m,a,d));for(h=0;h<f.length;h++)k=f[h].qa,"DEBUG_VIEW"==k.type&&(k.Jr=h)}for(h=0;h<c.length;h++)for(p=L.oa(c[h].Ua,a),r=p.R,p=0;p<r.length;p++)b(r[p]);for(h=0;h<e.length;h++)for(p=L.oa(e[h],a),r=p.R,p=0;p<r.length;p++)b(r[p])};
a.QI=function(a,e,f){var g=a.F.Gn,h=d("MAIN");G(h,"sky.glslv","sky.glslf");if(e.procedural_skydome)A(h,"PROCEDURAL_SKYDOME",1),h.Nr=!0;else{var k=g.fn,l=ka.dc(a.F.Ja,Ba.gg).B.lc;E(h,l,"u_sky");k&&(A(h,"WO_SKYTEX",1),k.invert&&A(h,"MTEX_NEGATIVE",1),k.MF&&A(h,"MTEX_RGBTOINT",1),A(h,"BLENDTYPE",k.AA),k.HF&&A(h,"WOMAP_BLEND",1),k.IF&&A(h,"WOMAP_HORIZ",1),k.KF&&A(h,"WOMAP_ZENUP",1),k.JF&&A(h,"WOMAP_ZENDOWN",1));g.Dq&&A(h,"WO_SKYBLEND",1);g.Eq&&A(h,"WO_SKYPAPER",1);g.Fq&&A(h,"WO_SKYREAL",1)}e.Ed&&(h.Ed=
!0,e.md&&(h.md=!0));h.Sf=99999;m(h,"a_position");e=aa.JM();I(h,e);b(h);f=L.oa(f,a);h.fj=!0;h.Z=ba.qg();h.jb=ba.qg();h.U=ba.sd();h.Pa=ba.sd();h.va=ba.fh();h.gb=ba.fh();y(h);f.R.push(h);ka.dc(a.F.Ja,Ba.eg)&&(a=c(h),a.type="DEBUG_VIEW",a.sb="",D(a),A(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),e.pa.a_polyindex=qa.Ur(e),I(a,e),a.gm=h.id,y(a),f.R.push(a))};a.Cr=function(a,b,d){d=L.oa(a,d).R;var e=[],f=ka.dc(b,Ba.qd),g=ka.dc(b,Ba.Wc),h=ka.dc(b,Ba.fg);b=ka.dc(b,Ba.Wd);for(var k=0;k<d.length;k++){var m=d[k],l=null;
"SHADOW"==m.type&&"RECEIVE"==m.sb&&m.ie&&(l=c(m),l.sb="CAST");"MAIN"!=m.type&&"PARTICLES"!=m.type||!f&&!g||!m.Ed||(l=c(m),l.sb="REFLECT",l.wi=!1,l.Pe&&(l.Pe=!1,l.Va=!1),l.wa=m.wa);"COLOR_ID"==m.type&&h&&a.o.Ic&&(b&&a.o.Qj?(l=c(m),l.sb="OUTLINE"):m.sb="OUTLINE");l&&(l.Ff=!0,y(l),e.push(l))}d.push.apply(d,e)};a.qQ=B;a.aG=function(a,b,c){b=c*(b.max_z-b.min_z);if(!b)return 0;a=b*Math.tan(fa.deg_to_rad(a));return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.zS=function(a,b,c){b=c*(b.max_z-b.min_z);if(!b)return 0;
a=2*b*a;return fa.rad_to_deg(Math.atan((Math.pow(a+1,4)-Math.pow(a+1,2))/b))};a.mJ=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.BR=J;a.AR=C;a.mQ=t;a.jA=function(a,b){A(a,"CSM_SECTION1",0);A(a,"CSM_SECTION2",0);A(a,"CSM_SECTION3",0);A(a,"NUM_CAST_LAMPS",0);if(b){A(a,"NUM_CAST_LAMPS",b.Cg.length);ua.Us&&A(a,"MAC_OS_SHADOW_HACK",1);for(var c=1;c<b.csm_num;c++)A(a,"CSM_SECTION"+String(c),1);A(a,"SHADOW_TEX_RES",ea.N(b.csm_resolution));A(a,
"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);A(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else A(a,"SHADOW_TEX_RES",0),A(a,"CSM_FADE_LAST_CASCADE",0),A(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.mb=A;a.Kd=function(a,b){return ea.$M(a.ab,b)};a.yR=I;a.zR=y;a.er=G;a.Wi=E;a.GP=function(a,b,c){c=a.Ie.indexOf(c);-1<c&&(a.Sa[c]=b)};a.UK=function(a,b){var c=d("MAIN");c.yb=!0;M.set(b[0],b[1],b[2],.5,c.xd);c.tg=qa.Jn;I(c,a);G(c,"main.glslv","main_stack.glslf");A(c,"SHADELESS",1);W(c);return c};
a.vc=W;a.MM=function(a,c){for(var e=0;e<c.length;e++){var f=c[e].Ua,g=d("LINE");G(g,"line.glslv","line.glslf");g.yb=!0;g.fj=!0;var h=aa.LM();I(g,h);b(g);g.U=ba.sd();g.Pa=ba.sd();g.Z=ba.qg();g.jb=ba.qg();g.gb=ba.fh();g.va=ba.fh();L.Xn(f,a);L.oa(f,a).R.push(g);W(g)}};a.RJ=function(a){return a.ib.Lp.length?a.ib.Nx.u_cube_fog?!0:!1:!1};a.EK=function(){var a=d("DEPTH_PACK");a.Qb=!0;a.Va=!1;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");W(a);return a};
a.Kv=function(a){var b=d("POSTPROCESSING");G(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":A(b,"POST_EFFECT","POST_EFFECT_NONE");break;case "GRAYSCALE":A(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":case "Y_BLUR":A(b,"POST_EFFECT","POST_EFFECT_BLUR");break;case "X_GLOW_BLUR":case "Y_GLOW_BLUR":A(b,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case "X_DOF_BLUR":case "Y_DOF_BLUR":A(b,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case "X_ALPHA_BLUR":case "Y_ALPHA_BLUR":A(b,
"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case "X_EXTEND":case "Y_EXTEND":A(b,"POST_EFFECT","POST_EFFECT_EXTEND");break;case "FLIP_CUBEMAP_COORDS":A(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:fa.D("Wrong postprocessing effect: "+a)}b.Qb=!0;b.Va=!1;a=aa.Gc();I(b,a);W(b);return b};a.XK=function(a){var b=d("SSAO");b.Va=!1;b.Qb=!0;var c=aa.Gc();I(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf");A(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.nq);A(b,"SSAO_HEMISPHERE",a.Yt?
1:0);a={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};c=ra.Gk(ra.Vg,!1);c.source="NODE_TEX";ra.xq(c,a,0);E(b,c,"u_ssao_special_tex");W(b);return b};a.YK=function(a){var b=d("SSAO_BLUR");b.Va=!1;b.Qb=!0;var c=aa.Gc();I(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");A(b,"SSAO_BLUR_DEPTH",
a.Vt?1:0);W(b);return b};a.BK=function(a){var b=d("COC");b.Va=!1;b.Qb=!0;var c=aa.Gc();I(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");A(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":A(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":A(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":A(b,"COC_TYPE","COC_COMBINE")}W(b);return b};a.FK=function(a){var b=d("DOF");b.Va=!1;b.Qb=!0;var c=aa.Gc();I(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");
a.B.dof_bokeh?A(b,"DOF_TYPE","DOF_BOKEH"):(A(b,"DOF_TYPE","DOF_SIMPLE"),A(b,"DEPTH_RGBA",1));W(b);return b};a.OK=function(){var a=d("OUTLINE");a.Va=!1;a.Qb=!0;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");W(a);return a};a.HK=function(){var a=d("GLOW_COMBINE");a.Va=!1;a.Qb=!0;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf");W(a);return a};a.IK=function(a,b,c){var e=d("GOD_RAYS");e.Va=!1;e.Qb=!0;var f=aa.DM();
I(e,f);G(e,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");A(e,"DEPTH_RGBA",a?1:0);A(e,"WATER_EFFECTS",b?1:0);A(e,"STEPS_PER_PASS",ea.N(c,1));W(e);return e};a.JK=function(){var a=d("GOD_RAYS_COM");a.Va=!1;a.Qb=!0;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");A(a,"SAFARI_CANVAS_ALPHA_HACK",ua.$D?1:0);W(a);return a};a.DK=function(a,b){var c=d("SKY");c.Va=!1;c.Qb=!0;var e=aa.FM();I(c,e);b.procedural_skydome?(G(c,"skybox.glslv",
"proc_skybox.glslf"),A(c,"WATER_EFFECTS",1)):(G(c,"skybox.glslv","tex_skybox.glslf"),a&&(e=a.F.Gn,e.Tt&&E(c,ra.Ld(e.Tt),"u_sky_texture",e.Tt.texture.name),e.fn&&A(c,"WO_SKYTEX",1)),b.DE&&A(c,"MTEX_NEGATIVE",1),b.IE&&A(c,"MTEX_RGBTOINT",1),A(c,"BLENDTYPE",b.CE),b.EE&&A(c,"WOMAP_BLEND",1),b.FE&&A(c,"WOMAP_HORIZ",1),b.HE&&A(c,"WOMAP_ZENUP",1),b.GE&&A(c,"WOMAP_ZENDOWN",1),b.Dq&&A(c,"WO_SKYBLEND",1),b.Eq&&A(c,"WO_SKYPAPER",1),b.Fq&&A(c,"WO_SKYREAL",1));c.Z=ba.qg();c.jb=ba.qg();c.U=ba.sd();c.Pa=ba.sd();
c.va=ba.fh();c.gb=ba.fh();W(c);return c};a.GI=function(a,b){var c=ka.dc(a.F.Ja,Ba.gg);c&&(c=c.Qa[0].ra[0].qa,L.oa(b,a).R.push(c))};a.wK=function(a){var b=d("ANTIALIASING");b.Va=!1;b.Qb=!0;var c=aa.Gc();I(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");ua.KD?(A(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),A(b,"AA_QUALITY",a.NB)):A(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");W(b);return b};a.VK=function(a){var b=d("SMAA"),c=aa.Gc();I(b,c);G(b,"postprocessing/smaa.glslv","postprocessing/smaa.glslf");
A(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");A(b,"SMAA_PASS",a);A(b,"SMAA_PREDICATION",0);A(b,"SMAA_REPROJECTION",0);W(b);b.Va=!1;b.Qb=!0;return b};a.CK=function(){var a=d("COMPOSITING");a.Va=!1;a.Qb=!0;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");W(a);return a};a.NK=function(){var a=d("MOTION_BLUR");a.Qb=!0;a.Va=!1;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");W(a);return a};a.ZK=function(a){var b=
d("STEREO");b.Qb=!0;b.Va=!1;var c=aa.Gc();I(b,c);G(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");A(b,"ANAGLYPH","ANAGLYPH"===a?1:0);A(b,"DISTOR_SCALE",N.nonwebvr.AB);W(b);return b};a.KK=function(){var a=d("LUMINANCE");a.Va=!1;a.Qb=!0;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");W(a);return a};a.xK=function(){var a=d("LUMINANCE");a.Va=!1;a.Qb=!0;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");
W(a);return a};a.LK=function(){var a=d("LUMINANCE_X_BLUR");a.Va=!1;a.Qb=!0;var b=aa.Gc();I(a,b);G(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");W(a);return a};a.zK=function(){var a=d("POSTPROCESSING");a.Qb=!0;a.Va=!1;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");W(a);return a};a.AK=function(){var a=d("BLOOM");a.Va=!1;a.Qb=!0;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");
W(a);return a};a.wL=function(){var a=d("VELOCITY");a.Va=!1;a.Qb=!0;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");W(a);return a};a.vK=function(){var a=d("ANCHOR_VISIBILITY");a.Va=!0;a.Qb=!0;a.tg=qa.Jn;G(a,"anchors.glslv","anchors.glslf");var b=aa.TB(1);I(a,b);A(a,"ANCHOR_NUM",1);W(a);a.lk=new Float32Array(3);return a};a.PK=function(){var a=d("PERFORMANCE");a.Va=!1;a.Qb=!0;var b=aa.Gc();I(a,b);G(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");
W(a);return a};a.xR=function(a,b){var c=b.length/3;if(c!=a.lk.length/3){var d=aa.TB(c);I(a,d);A(a,"ANCHOR_NUM",c);W(a)}a.lk=b};a.ww=function(a){if(!a.K.length)return null;a=a.K[0];return a.R.length?a.R[0]:null};a.Oa=function(a,b,c){a=a.K[0].R;for(var d=0;d<a.length;d++)if(a[d].type==c&&!a[d].Ff&&-1!=a[d].Jb.indexOf(b))return a[d];return null};a.af=function(a,b,c){a=a.K[0].R;for(var d=0;d<a.length;d++)if(a[d].type==c&&a[d].Ff&&-1!=a[d].Jb.indexOf(b))return a[d];return null};a.Yw=function(a,b,c,d){a=
a.K[0].R;for(var e=0;e<a.length;e++){var f=a[e];if(-1!=f.Jb.indexOf(b)&&(!d||f.type==d)&&c(f))break}};a.rT=function(a,b){for(var c=a.K[0].R,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.YA=function(a){for(var b=a.Sa,c=0;c<b.length;c++);a.da&&a.da.Bf&&qa.hK(a.da);a.Bf&&a.ne.length&&T.kK(a);a.ib&&a.ib.Bf&&ea.jK(a.ib);a.Cj&&(b=da.hC(a.Cj))&&b.XA&&da.iK(a.Cj)};a.NM=V;a.set_nodemat_value=function(a,b,c,d){for(var e=0;e<a.K.length;e++)for(var f=a.K[e].R,g=0;g<f.length;g++){var h=f[g];-1!=h.Jb.indexOf(b)&&
h.Gg&&(h.Gg[c]=d)}};a.set_nodemat_rgb=function(a,b,c,d,e,f){for(var g=0;g<a.K.length;g++)for(var h=a.K[g].R,k=0;k<h.length;k++){var m=h[k];-1!=m.Jb.indexOf(b)&&m.Bd&&(m.Bd[3*c]=d,m.Bd[3*c+1]=e,m.Bd[3*c+2]=f)}};a.get_nodemat_value=function(a,b){return a.Gg[b]};a.get_nodemat_rgb=function(a,b,c){c[0]=a.Bd[3*b];c[1]=a.Bd[3*b+1];c[2]=a.Bd[3*b+2];return c};a.oh=function(a,b){var c;c=b[1];for(var d=2;d<b.length;d++)c+="%join%"+b[d];for(d=0;d<a.length;d+=2)if(a[d]==c)return a[d+1];return null};a.cleanup=
function(){Ga={}}};b4w.module.__nodemat=function(a,q){function d(a,b,e,g,h){var m=Va.get_active(),m=l(b,h,m.uuid);if(m in Ia)return Ia[m];var p={Ja:null,id:m,XA:!0};e||(La={},ga=0);if("SHADOW"!=h&&"COLOR_ID"!=h){b=U.create();for(var t=a.nodes,v=0;v<t.length;v++)if(null==V(b,t[v],0,g,h))return Ia[m]=null,p;if(e&&-1==G(a,b,"GROUP_OUTPUT","group"))return p;v=fa(b);t=e?a.links:a.links.slice();if(!va(b,t,v))return p;if(e)return p.Ja=b,p;for(v=0;v<t.length;v++){e=t[v];for(var w=z(e.from_node,b),B=z(e.to_node,b),q=0;q<w.length;q++)for(var N=
0;N<B.length;N++){var A=w[q],K=B[N],E=U.Ra(b,A),D=U.Ra(b,K);if(!ta(b,A,K,E,D,e))return Ia[m]=null,p}}r(b);v=-1;"GLOW"==h?v=G(a,b,"B4W_GLOW_OUTPUT","material",!0):(v=G(a,b,"OUTPUT","material",!1,!0),-1==v&&(v=G(a,b,"OUTPUT_MATERIAL","material",!1,!0)));-1==v&&(b=k(),v=0);J(b);a=U.mn(b,v,U.Sl);c(a,g);n(a,g);f(a);H(a);y(a);u(a,g,h);wa(a)}else g=d(a,b,e,g,"MAIN"),g=U.clone(g.Ja,function(a){var b=Ea.zo(a);b.inputs=Ea.S(a.inputs);b.outputs=Ea.S(a.outputs);return b}),v=G(a,g,"OUTPUT","material",!1,!0),-1==
v&&(v=G(a,g,"OUTPUT_MATERIAL","material",!1,!0)),x(g,v),a=U.mn(g,v,U.Sl),f(a);p.Ja=a;return Ia[m]=p}function c(a,c){var d=[];U.ha(a,function(a,b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||d.push({ol:a,node:b})});for(var e=0;e<d.length;++e){var f=d[e].ol,g=d[e].node,h=U.lj(a);U.Xg(a,h,g.data.CO);var k=U.lj(a);U.Xg(a,k,g.data.DO);U.Nc(a,h,k,[4,2]);for(var m={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},l=U.Yk(a,f),n=[],p=[],r=[],t=
{},u=0;u<l;u++){var v=U.mh(a,f,u);v in t||(t[v]=0);var w=U.yd(a,v,f,t[v]++);n.push([v,f,w]);var B=m[w[1]];if(B)switch(B[0]){case "MATERIAL_END":p.push([v,k,[w[0],B[1]]]);break;case "LIGHTING_APPLY":r.push([v,[w[0],B[1]]])}else p.push([v,h,w])}b(a,g.data.value,h,k,r,c);for(u=0;u<n.length;u++)U.Wm(a,n[u][0],n[u][1],n[u][2]);for(u=0;u<p.length;u++)U.Nc(a,p[u][0],p[u][1],p[u][2]);g=U.Ig(a,f);h=[];m=[];l={};for(u=0;u<g;u++)n=U.ph(a,f,u),n in l||(l[n]=0),w=U.yd(a,f,n,l[n]++),h.push([f,n,w]),m.push([k,n,
w]);for(u=0;u<h.length;u++)U.Wm(a,h[u][0],h[u][1],h[u][2]);for(u=0;u<m.length;u++)U.Nc(a,m[u][0],m[u][1],m[u][2]);U.Vf(a,f)}}function b(a,b,c,d,e,f){var h={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},k=V(a,h,0,f,null),m=k;g(a,c,k,"E");g(a,c,k,"A");g(a,c,k,"D");k=Va.get_active();k=Ga.Ib(k,"LAMP",Ga.DATA_ID_ALL);if(!b.le)for(var l,n,p,r=0;r<k.length;r++){p=k[r].nb;h={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};l=V(a,h,0,f,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=V(a,h,0,f,null);g(a,
m,n,"color");g(a,m,n,"specular");g(a,l,n,"ldir");g(a,c,n,"normal");g(a,c,n,"D");g(a,c,n,"S");g(a,l,n,"lcolorint");g(a,c,l,"shadow_factor");m="SPECULAR_"+b.kq;h={name:m,type:m,use_tangent_shading:b.Jl};m=V(a,h,0,f,null);g(a,l,m,"ldir");g(a,l,m,"lfac");g(a,c,m,"normal");g(a,m,n,"sfactor");g(a,l,m,"norm_fac");g(a,c,m,"sp_params");m="HEMI"==p.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.To;h={name:m,type:m,use_tangent_shading:b.Jl};p=V(a,h,0,f,null);g(a,l,p,"ldir");g(a,l,p,"lfac");g(a,c,p,"normal");g(a,l,p,"norm_fac");
g(a,p,n,"lfactor");"DIFFUSE_LAMBERT"!=m&&g(a,c,p,"dif_params");for(l=0;l<e.length;l++)U.Nc(a,e[l][0],n,e[l][1]);m=n}g(a,m,d,"color");g(a,m,d,"specular")}function g(a,b,c,d){for(var e=U.Ra(a,b),f=-1,g=U.Ra(a,c).inputs,h=0;h<g.length;h++)if(d==g[h].identifier){f=h;break}if(-1!=f){for(var k=-1,e=e.outputs,h=0;h<e.length;h++)if(d==e[h].identifier){k=h;break}-1!=k&&(U.Nc(a,b,c,[k,f]),e[k].Ka=!0,g[f].Ka=!0)}}function n(a,b){var c=[];U.ha(a,function(a,b){"OUTPUT_MATERIAL"==b.type&&c.push({ol:a,node:b})});
for(var d=0;d<c.length;++d){var e=c[d].ol,f=c[d].node,g=!1,h=U.lj(a);U.Xg(a,h,f.data.YO);for(var k=U.Yk(a,e),m=[],l=[],n={},p=0;p<k;p++){var r=U.mh(a,e,p);r in n||(n[r]=0);var t=U.yd(a,r,e,n[r]++);m.push([r,e,t]);switch(t[1]){case 0:l.push([r,h,t]);break;case 2:var g=!0,u=U.lj(a);U.Xg(a,u,f.data.KL);l.push([r,u,[t[0],0]])}}for(p=0;p<m.length;p++)U.Wm(a,m[p][0],m[p][1],m[p][2]);for(p=0;p<l.length;p++)U.Nc(a,l[p][0],l[p][1],l[p][2]);U.Vf(a,e);g&&B(a,h,u);w(a,b)}}function B(a,b,c){b=U.mn(a,b,U.Sl);var d=
v(b);if(0<d.length){c=U.mn(a,c,U.Sl);c=U.clone(c,W,ra);U.ha(c,function(a,b){b.name="displacement%join%"+b.name});U.gA(c,b,[],[]);var f=-1;U.ha(b,function(a,b){if("DISPLACEMENT_BUMP"==b.type)return f=a,1});for(c=0;c<d.length;c++){var h=d[c],k=U.Ra(b,h);g(b,f,h,"Normal");e(k)}}a.V=b.V;a.za=b.za}function e(a){a=a.hb;for(var b=0;b<a.length;b++){var c=a[b];"USE_NORMAL_IN"==c[0]&&(c[1]=1)}}function v(a){var b=[];U.ha(a,function(a,c){for(var d=!1,e=c.inputs,f=0;f<e.length;f++)if("Normal"==e[f].identifier){d=
!e[f].Ka;break}d&&b.push(a)});return b}function w(a,b){var c=[];U.ha(a,function(a,b){"OUTPUT_SURFACE"==b.type&&c.push({ol:a,node:b})});var d=[];0<c.length&&U.ha(a,function(a,b){"MIX_SHADER"==b.type&&d.push({ol:a,node:b})});for(var e=0;e<c.length;++e){var f=c[e].ol,g=c[e].node,k=U.lj(a);U.Xg(a,k,g.data.xJ);var m=U.lj(a);U.Xg(a,m,g.data.yJ);U.Nc(a,k,m,[4,2]);for(var l=U.Yk(a,f),n=[],p=[],r={},t=0;t<l;t++){var u=U.mh(a,f,t),v=U.Ra(a,u);u in r||(r[u]=0);var w=U.yd(a,u,f,r[u]++);n.push([u,f,w]);p.push([u,
k,w]);if("BSDF_GLOSSY"==v.type||"BSDF_DIFFUSE"==v.type||"MIX_SHADER"==v.type||"EMISSION"==v.type||"BSDF_TRANSPARENT"==v.type)for(p.push([u,k,[1,1]]),p.push([u,k,[2,2]]),p.push([u,k,[3,3]]),p.push([u,k,[4,4]]),p.push([u,k,[5,5]]),p.push([u,k,[6,6]]),p.push([u,k,[7,7]]),p.push([u,k,[8,8]]),p.push([u,k,[9,9]]),p.push([u,k,[10,10]]),u=0;u<d.length;++u)for(var v=d[u].ol,w=U.Yk(a,v),B=0;B<w;B++){var y=U.mh(a,v,B),q=U.Ra(a,y),N=U.yd(a,y,v,0);0==N[1]||"BSDF_GLOSSY"!=q.type&&"BSDF_DIFFUSE"!=q.type&&"MIX_SHADER"!=
q.type&&"EMISSION"!=q.type&&"BSDF_TRANSPARENT"!=q.type||(q=1==N[1]?3:13,p.push([y,v,[1,q]]),p.push([y,v,[2,q+1]]),p.push([y,v,[3,q+2]]),p.push([y,v,[4,q+3]]),p.push([y,v,[5,q+4]]),p.push([y,v,[6,q+5]]),p.push([y,v,[7,q+6]]),p.push([y,v,[8,q+7]]),p.push([y,v,[9,q+8]]),p.push([y,v,[10,q+9]]))}}h(a,g.data.value,k,m,b);p.push([m,f,[0,0]]);for(t=0;t<n.length;t++)U.Wm(a,n[t][0],n[t][1],n[t][2]);for(t=0;t<p.length;t++)U.Nc(a,p[t][0],p[t][1],p[t][2])}}function h(a,b,c,d,e){var f=[],h={name:"LIGHTING_AMBIENT",
type:"LIGHTING_AMBIENT"},k=V(a,h,0,e,null),m=k;g(a,c,k,"E");g(a,c,k,"A");g(a,c,k,"D");for(var k=Va.get_active(),k=Ga.Ib(k,"LAMP",Ga.DATA_ID_ALL),l,n,p=0;p<k.length;p++){h={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};l=V(a,h,0,e,null);h={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};n=V(a,h,0,e,null);g(a,m,n,"color");g(a,m,n,"specular");g(a,l,n,"ldir");g(a,c,n,"normal");g(a,c,n,"D");g(a,c,n,"S");g(a,l,n,"lcolorint");g(a,c,l,"shadow_factor");m=b.zJ;h={name:m,type:m};m=V(a,h,0,e,null);g(a,l,m,"ldir");
g(a,l,m,"lfac");g(a,c,m,"normal");g(a,l,m,"norm_fac");g(a,c,m,"bsdf_params");g(a,m,n,"lfactor");g(a,m,n,"sfactor");for(m=0;m<f.length;m++)U.Nc(a,f[m][0],n,f[m][1]);m=n}g(a,c,d,"s_color");g(a,c,d,"metalness");g(a,c,d,"e_color");g(a,c,d,"emission");g(a,c,d,"a_color");g(a,c,d,"alpha");g(a,m,d,"color");g(a,m,d,"specular")}function l(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function x(a,b){U.ag(a,function(c,d,e){var f=U.Ra(a,d);
d==b&&"Color"==f.inputs[e[1]].identifier&&U.Wm(a,c,d,e)})}function k(){var a=U.create();U.Xg(a,0,{data:null,hb:[],X:[],inputs:[{ya:new Float32Array([0,0,0]),identifier:"Color",Ka:!1,name:"Color"},{ya:1,identifier:"Alpha",Ka:!1,name:"Alpha"}],outputs:[],type:"OUTPUT",oe:[]});return a}function f(a){U.ha(a,function(b,c){for(var d=c.inputs,e=c.outputs,f=0;f<d.length;f++)F(a,d[f],b,f,1);for(f=0;f<e.length;f++)F(a,e[f],b,f,0)})}function F(a,b,c,d,e){if(b.Ka){var f=!0;U.ag(a,function(a,b,g){if(!e&&a==c&&
g[0]==d||e&&b==c&&g[1]==d)f=!1});f&&(b.Ka=!1)}}function u(a,b,c){var d=[];U.ag(a,function(e,f,g){var h=U.Ra(a,e),k=U.Ra(a,f),h=Ea.is_vector(h.outputs[g[0]].ya),k=Ea.is_vector(k.inputs[g[1]].ya);if(h!=k){var m,l={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},n={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};h&&!k?m=E("vector_to_scalar","B4W_VECTOSCAL",[l],[n]):!h&&k&&(m=E("scalar_to_vector","B4W_SCALTOVEC",[n],[l]));V(a,m,0,b,c);d.push([e,f,a.V[a.V.length-2],
g])}});for(var e=0;e<d.length;++e)U.Wm(a,d[e][0],d[e][1],d[e][3]),U.Nc(a,d[e][0],d[e][2],[d[e][3][0],0]),U.Nc(a,d[e][2],d[e][1],[0,d[e][3][1]])}function r(a){var b=[];U.ha(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":U.ag(a,function(e,f,g){var h=U.Ra(a,f);e==c&&"MATERIAL_EXT"==h.type&&"Translucency"==d.outputs[g[0]].name&&b.push(e,f,[g[0]+1,g[1]+1])})}});for(var c=0;c<b.length;c+=3)U.Nc(a,b[c],b[c+1],b[c+2])}function z(a,b){var c=[];U.ha(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;
Ea.D("Node not found")}function J(a){var b=[];U.ha(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type)D(a,d,e);else if("REROUTE"==e.type){for(var f=U.mh(a,d,0),g=U.Ig(a,d),h=[],k=[],m=[],l=0;l<g;l++){var n=U.ph(a,d,l),p=k.indexOf(n),r=U.yd(a,d,n,0<=p?m[p]:0);if(r){var r=r[1],t=e.inputs[0].ya,r=U.Ra(a,n).inputs[r];switch(typeof t){case "number":if("object"==typeof r.ya)for(var u=r.ya,r=0;r<u.length;r++)u[r]=
t;else"number"==typeof r.ya&&(r.ya=t);break;case "object":if("object"==typeof r.ya)for(u=r.ya,r=0;r<u.length;r++)u[r]=t[r];else"number"==typeof r.ya&&(r.ya=.35*t[0]+.45*t[1]+.2*t[2])}}t=e.outputs;for(r=0;r<t.length;r++)t[r].ya=e.inputs[0].ya;-1!=p?m[p]+=1:(k.push(n),m.push(1),h.push(d,n))}if(-1!=f)for(e=U.yd(a,f,d,0)[0],l=0;l<k.length;l++)for(r=0;r<m[l];r++)g=U.yd(a,d,k[l],r)[1],U.Nc(a,f,k[l],[e,g]);for(l=0;l<h.length;l+=2)U.Pj(a,h[l],h[l+1],-1)}}}function D(a,b,c){var d;a:{d=a.za;for(var e=0;e<d.length;e+=
3)if(d[e+1]==b&&1==d[e+2][1]){d=d[e];break a}d=-1}-1!=d&&(e=U.Ra(a,d),c.data=e.data,U.Pj(a,d,b,-1),0==U.Ig(a,d)&&(b=U.mh(a,d,0),-1!=b&&U.Pj(a,b,d,-1),U.Vf(a,d)));c.inputs.splice(1,1)}function H(a){m(a);p(a);C(a)}function C(a){var b={};U.ha(a,function(a,c){if("GEOMETRY_UV"==c.type||"UVMAP"==c.type||"TEX_COORD_UV"==c.type){var d=c.data.value;d in b||(b[d]=[]);b[d].push(a,c)}});for(var c in b){var d=b[c];if(2<d.length)for(var e=t(c),e=V(a,e,0,"",void 0),f=U.Ra(a,e),g=0;g<d.length;g+=2){for(var h=d[g],
k=d[g+1],m=[],l={},n=U.Ig(a,h),p=0;p<n;p++){var r=U.ph(a,h,p);r in l||(l[r]=0);var u=U.yd(a,h,r,l[r]);l[r]++;m.push(h,r,u);u=u.splice(0,u.length);switch(k.type){case "GEOMETRY_UV":u[0]=0;f.outputs[0].Ka=!0;break;case "UVMAP":case "TEX_COORD_UV":u[0]=1,f.outputs[1].Ka=!0}U.Nc(a,e,r,u)}for(p=0;p<m.length;p+=3)U.Pj(a,m[p],m[p+1],0);U.Vf(a,h)}}}function t(a){var b=E("merged_uv","UV_MERGED",[],[{default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},{default_value:[0,0,0],identifier:"UV_cycles",
is_linked:!1,name:"UV_cycles"}]);b.uv_layer=a;return b}function m(a){var b=[];U.ha(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type&&"GEOMETRY_BF"!=c.type&&"GEOMETRY_IN"!=c.type||b.push(a,c)});for(var c=[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],g=!0,h=0;h<c.length;h++){var k=c[h];if(Q(f,k.Ue)){for(var g=[],h=U.Ig(a,e),m=0;m<h;m++){var l=U.ph(a,e,m),n=U.yd(a,e,l,0);g.push(e,
l,n);U.Nc(a,k.id,l,n)}for(m=0;m<g.length;m+=3)U.Pj(a,g[m],g[m+1],0);U.Vf(a,e);g=!1;break}}g&&(k={id:e,Ue:f},c.push(k))}}function A(a){for(var b={},c=0;c<a.V.length;c+=2){var d=a.V[c];b[d]={$n:{},GC:!1}}for(c=0;c<a.za.length;c+=3)b[a.za[c+1]].$n[a.za[c]]=!0;for(d in b)I(d,b);for(d in b)b[d]=Object.keys(b[d].$n).map(function(a){return parseInt(a,10)});return b}function I(a,b){var c=b[a];if(!c.GC){var d=Ea.S(c),e;for(e in c.$n){I(e,b);var c=b[e],f;for(f in c.$n)d.$n[f]=!0}d.GC=!0;b[a]=d}}function p(a){var b=
[];U.ha(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=A(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],g=b[e+1],h=!0,k=0;k<d.length;k++){var m=d[k];if(!(3<=m.Km.length||!Q(g,m.Ue)||-1<c[f].indexOf(m.id)||-1<c[m.id].indexOf(f))){for(var l=!1,n=0;n<m.Km.length;n++){var p=m.Km[n].id;if(-1<c[f].indexOf(p)||-1<c[p].indexOf(f)){l=!0;break}}if(!l){for(var k=[],p=U.Yk(a,f),r={},n=0;n<p;n++)l=U.mh(a,f,n),l in r||(r[l]=0),h=U.yd(a,l,f,r[l]++),k.push(l,
f,h);for(var p=[],r=U.Ig(a,f),t={},n=0;n<r;n++)l=U.ph(a,f,n),l in t||(t[l]=0),h=U.yd(a,f,l,t[l]++),p.push(f,l,h);h=k.concat(p);for(n=0;n<h.length;n+=3)U.Pj(a,h[n],h[n+1],0);U.Vf(a,f);n={id:f,Ue:g,SL:k,TL:p};m.Km.push(n);h=!1;break}}}h&&(m={id:f,Ue:g,Km:[]},d.push(m))}for(e=0;e<d.length;e++){m=d[e];c=m.Km.length;for(k=0;k<c;k++){g=m.Km[k];n=g.Ue;f=g.SL;g=g.TL;m.Ue.inputs[k+1].Ka=n.inputs[0].Ka;m.Ue.inputs[k+1].ya=n.inputs[0].ya;m.Ue.outputs[2*(k+1)].Ka=n.outputs[0].Ka;m.Ue.outputs[2*(k+1)].ya=n.outputs[0].ya;
m.Ue.outputs[2*(k+1)+1].Ka=n.outputs[1].Ka;m.Ue.outputs[2*(k+1)+1].ya=n.outputs[1].ya;for(n=0;n<f.length;n+=3)l=f[n],h=f[n+2],h[1]+=k+1,U.Nc(a,l,m.id,h);for(n=0;n<g.length;n+=3)l=g[n+1],h=g[n+2],h[0]+=2*(k+1),U.Nc(a,m.id,l,h);m.Ue.hb.push(["USE_uv"+(k+2),1])}U.Vf(a,m.id);U.Xg(a,m.id,m.Ue)}}}function Q(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":for(var c=a.hb,d=-1,e=0;e<c.length;e++){var f=c[e];if("USE_NORMAL_IN"==f[0]){d=
f[1];break}}c=b.hb;f=-1;for(e=0;e<c.length;e++){var g=c[e];if("USE_NORMAL_IN"==g[0]){f=g[1];break}}return d===f;case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":case "GEOMETRY_BF":case "GEOMETRY_IN":return!0;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.ov==b.data.ov&&a.data.value.zm==b.data.value.zm;case "VALUE":case "RGB":return a.Cd==b.Cd;default:return!1}}function y(a){var b=[],c=[];U.ha(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d);
"GEOMETRY_VW"==d.type&&c.push(a,d)});Y(a,b);R(a,c)}function Y(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+1],f=!1,g=[],h=[],k=[[],[],[]],m=U.Ig(a,d),l=0;l<m;l++){var n=U.ph(a,d,l);if("SEPRGB"!=U.Ra(a,n).type){f=!1;break}g.push(d,n);for(var p={},r=U.Ig(a,n),f=0;f<r;f++){var t=U.ph(a,n,f);t in p||(p[t]=0);var u=U.yd(a,n,t,p[t]++);g.push(n,t);k[u[0]].push(d,t,u)}h.push(n);f=!0}if(f){for(l=d=m=0;l<k.length;l++)k[l].length&&(m++,d|=1<<2-l);if(m){e.type+=m;e.outputs=[];for(l=0;l<k.length;l++)if(k[l].length)for(e.outputs.push({ya:0,
identifier:"RGB"[l],Ka:!0,name:"RGB"[l]}),f=0;f<k[l].length;f+=3)k[l][f+2][0]=Ea.Ym(d,l);for(l=0;l<g.length;l+=2)U.Pj(a,g[l],g[l+1],0);for(l=0;l<h.length;l++)U.Vf(a,h[l]);for(l=0;l<k.length;l++)for(f=0;f<k[l].length;f+=3)U.Nc(a,k[l][f],k[l][f+1],k[l][f+2])}}}}function R(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=!0,f=[],g=U.Ig(a,d),h=0;h<g;h++){var k=U.ph(a,d,h);if("B4W_REFLECT"==U.Ra(a,k).type){var m=U.yd(a,d,k,0),l=U.yd(a,d,k,1);m&&1==m[1]||l&&1==l[1]?e=!1:f.push(d,k)}else e=!1}for(h=0;h<
f.length;h+=2)g=a,m=f[h],k=f[h+1],l=U.Ra(g,k),l.type+="_WORLD",U.Pj(g,m,k,0),l.inputs.splice(0,1),m=U.mh(g,k,0),m!=U.Pu&&(U.yd(g,m,k,0)[1]=0);e&&U.Vf(a,d)}}function G(a,b,c,d,e,f){a=a.nodes;for(var g=null,h=0;h<a.length;h++){var k=a[h];e?"GROUP"==k.type&&k.node_tree_name==c&&(g=k):k.type==c&&(g=k)}return g?z(g,b)[0]:(f||O.error('No "'+c+'" node in node '+d),-1)}function E(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}function W(a){var b={name:"",Cd:"",type:"",oe:[],inputs:[],outputs:[],X:[],data:null,
hb:[]};b.name=a.name;b.Cd=a.Cd;b.type=a.type;for(var c=b.oe,d=a.oe,e=0;e<d.length;e++)c.push(Ba(d[e]));c=b.X;d=a.X;for(e=0;e<d.length;e++)c.push(Ba(d[e]));c=b.inputs;d=a.inputs;for(e=0;e<d.length;e++)c.push(la(d[e]));c=b.outputs;d=a.outputs;for(e=0;e<d.length;e++)c.push(la(d[e]));c=b.hb;d=a.hb;for(e=0;e<d.length;e++)c.push(d[e].slice());b.data=a.data;return b}function V(a,b,c,d,e){var f=b.name,g=b.name,h=b.type,k=[],m=[],l=[],n=[],p=null,r=[];switch(h){case "BSDF_ANISOTROPIC":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "SCRIPT":m=
T(b);l=ka(b);O.warn(h+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":m=T(b);l=ka(b);break;case "MIX_SHADER":m.push(L(b,"Fac"));var t=L(b,"Shader"),l=t.Ka;m.push(t);(t=L(b,"Shader_001"))||(t=L(b,"Shader.001"));var u=t.Ka;m.push(t);m.push(P("d_color1","d_color1",[0,0,0],l));m.push(P("d_roughness1","d_roughness1",0,l));m.push(P("s_color1","s_color1",[0,0,0],l));m.push(P("s_roughness1","s_roughness1",0,l));m.push(P("metalness1","metalness1",0,l));m.push(P("normal1","normal1",
[0,0,0],l));m.push(P("e_color1","e_color1",[0,0,0],l));m.push(P("emission1","emission1",0,l));m.push(P("a_color1","a_color1",[0,0,0],l));m.push(P("alpha1","alpha1",1,l));m.push(P("d_color2","d_color2",[0,0,0],u));m.push(P("d_roughness2","d_roughness2",0,u));m.push(P("s_color2","s_color2",[0,0,0],u));m.push(P("s_roughness2","s_roughness2",0,u));m.push(P("metalness2","metalness2",0,u));m.push(P("normal2","normal2",[0,0,0],u));m.push(P("e_color2","e_color2",[0,0,0],u));m.push(P("emission2","emission2",
0,u));m.push(P("a_color2","a_color2",[0,0,0],u));m.push(P("alpha2","alpha2",1,u));l=ja(b,"Shader");t=l.Ka;l=[l,P("d_color","d_color",[0,0,0],t),P("d_roughness","d_roughness",0,t),P("s_color","s_color",[0,0,0],t),P("s_roughness","s_roughness",0,t),P("metalness","metalness",0,t),P("normal","normal",[0,0,0],t),P("e_color","e_color",[0,0,0],t),P("emission","emission",0,t),P("a_color","a_color",[0,0,0],t),P("alpha","alpha",1,t)];break;case "OBJECT_INFO":var m=T(b),l=[],t=ja(b,"Location"),u=ja(b,"Object Index"),
v=ja(b,"Material Index"),w=ja(b,"Random");l.push(t);l.push(u);l.push(v);l.push(w);r.push(["USE_LOCATION_OUT",t.Ka|0]);r.push(["USE_OBJ_IND_OUT",u.Ka|0]);r.push(["USE_MAT_IND_OUT",v.Ka|0]);r.push(["USE_RANDOM_OUT",w.Ka|0]);break;case "UVMAP":(t=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=X("param_"+h+"_a"),u=X("param_"+h+"_v"),k.push(ea(p)),k.push(ea(u)),n.push(ea(u)),p={name:p,value:t});l=ka(b);break;case "UV_MERGED":p=X("param_UV_MERGED_a");u=X("param_UV_MERGED_v");k.push(ea(p));k.push(ea(u));
l.push(ja(b,"UV_geom"));l.push(ja(b,"UV_cycles"));n.push(ea(u));p={name:p,value:b.uv_layer};break;case "CAMERA":m=[];l=ka(b);break;case "COMBRGB":case "COMBHSV":m=T(b);l=ka(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==h?(ma(b,0,0)&&r.push(["READ_R",1]),ma(b,1,0)&&r.push(["READ_G",1]),ma(b,2,0)&&r.push(["READ_B",1]),ma(b,3,0)&&r.push(["READ_A",1])):(ma(b,0,-1)&&r.push(["READ_R",1]),ma(b,1,-1)&&r.push(["READ_G",1]),ma(b,2,-1)&&r.push(["READ_B",1]));m=T(b);l=ka(b);p={value:b};break;case "PARTICLE_INFO":m=
T(b);l=ka(b);for(u=0;u<b.outputs.length;u++){var v=b.outputs[u],w=v.identifier,B=ea("v_param_PART_INFO_"+w.replace(" ",""));if(v.is_linked)switch(w){case "Size":r.push(["PART_INFO_SIZE",pa.N(1)]);break;case "Age":r.push(["PART_INFO_AGE",pa.N(1)]);break;case "Lifetime":r.push(["PART_INFO_LT",pa.N(1)]);break;case "Location":r.push(["PART_INFO_LOC",pa.N(1)]);break;case "Index":p=t=ea("a_param_PART_INFO_"+v.identifier.replace(" ",""));r.push(["PART_INFO_IND",pa.N(1)]);break;case "Velocity":r.push(["PART_INFO_VEL",
pa.N(1)]);break;case "Angular Velocity":r.push(["PART_INFO_A_VEL",pa.N(1)])}"Age"!=w&&"Lifetime"!=w&&"Size"!=w&&(k.push(B),n.push(B))}t&&k.push(t);break;case "NEW_GEOMETRY":case "GEOMETRY":if(!ha(b))return!0;h=Z(b,c);if(!h)return O.error("Geometry output is not supported"),null;switch(h){case "GEOMETRY_UV":(t=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=X("param_GEOMETRY_UV_a"),u=X("param_GEOMETRY_UV_v"),k.push(ea(p)),k.push(ea(u)),n.push(ea(u)),p={name:p,value:t});l.push(ja(b,"UV"));break;case "GEOMETRY_VC":(t=
b.color_layer)||(h="EMPTY_VC");"EMPTY_VC"!=h&&(p=X("param_GEOMETRY_VC_a"),u=X("param_GEOMETRY_VC_v"),k.push(ea(p)),k.push(ea(u)),n.push(ea(u)),p={name:p,value:t});l.push(ja(b,"Vertex Color"));break;case "GEOMETRY_NO":m.push(P("Normal","Normal",[0,0,0],!1));r.push(["USE_NORMAL_IN",0]);l.push(ja(b,"Normal"));break;case "GEOMETRY_TRN":h="GEOMETRY_NO";l.push(ja(b,"True Normal"));O.warn("Geometry True Normal output is not fully supported.");break;case "GEOMETRY_FB":l.push(ja(b,"Front/Back"));break;case "GEOMETRY_VW":l.push(ja(b,
"View"));break;case "GEOMETRY_GL":l.push(ja(b,"Global")||ja(b,"Position"));break;case "GEOMETRY_LO":l.push(ja(b,"Local"));break;case "GEOMETRY_OR":t=X("param_GEOMETRY_OR_v");k.push(ea(t));l.push(ja(b,"Orco"));n.push(ea(t));break;case "GEOMETRY_IN":l.push(ja(b,"Incoming"));break;case "GEOMETRY_BF":l.push(ja(b,"Backfacing"))}break;case "TEX_COORD":if(!ha(b))return!0;h=ca(b,c);switch(h){case "TEX_COORD_UV":(t=b.uv_layer)||(h="EMPTY_UV");"EMPTY_UV"!=h&&(p=X("param_TEX_COORD_UV_a"),u=X("param_TEX_COORD_UV_v"),
k.push(ea(p)),k.push(ea(u)),n.push(ea(u)),p={name:p,value:b.uv_layer});l.push(ja(b,"UV"));break;case "TEX_COORD_NO":l.push(ja(b,"Normal"));break;case "TEX_COORD_GE":t=X("param_TEX_COORD_GE_v");k.push(ea(t));l.push(ja(b,"Generated"));n.push(ea(t));break;case "TEX_COORD_OB":l.push(ja(b,"Object"));break;case "TEX_COORD_CA":l.push(ja(b,"Camera"));break;case "TEX_COORD_WI":l.push(ja(b,"Window"));break;case "TEX_COORD_RE":l.push(ja(b,"Reflection"))}break;case "GROUP":t=b.node_tree_name;switch(t){case "B4W_LINEAR_TO_SRGB":if(!K(b,
[1],[1])){p=ba(b,d,e);break}h="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!K(b,[1],[1])){p=ba(b,d,e);break}h="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!K(b,[1],[1])){p=ba(b,d,e);break}h="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!K(b,[1,1],[1])){p=ba(b,d,e);break}h="B4W_REFLECT";break;case "B4W_REFRACTION":if(!K(b,[1,0],[1])){p=ba(b,d,e);break}h="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!K(b,[1,1,0,0,0],[1])){p=ba(b,d,e);break}u=X("param_B4W_PARALLAX_texture");
n.push(ea(u));h="B4W_PARALLAX";break;case "B4W_CLAMP":if(!K(b,[1],[1])){p=ba(b,d,e);break}h="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!K(b,[0,0,0,0,0],[0])){p=ba(b,d,e);break}h="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!K(b,[],[0])){p=ba(b,d,e);break}h="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!K(b,[0,0,0],[0])){p=ba(b,d,e);break}h="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":h="B4W_GLOW_OUTPUT";break;default:p=ba(b,d,e)}m=T(b);l=ka(b);"B4W_TRANSLUCENCY"==t&&(t=P("TranslucencyParams","TranslucencyParams",
[0,0,0,0]),t.Ka=l[0].Ka,l.push(t));break;case "LAMP":(t=b.lamp)?(t.uuid in La?r.push(["LAMP_INDEX",String(La[t.uuid])]):(La[t.uuid]=ga,r.push(["LAMP_INDEX",String(ga++)])),p=La):(O.error("There is no lamp in node: "+b.name),r.push(["LAMP_INDEX",-1]));l.push(ja(b,"Color"));l.push(ja(b,"Light Vector"));l.push(ja(b,"Distance"));l.push(ja(b,"Visibility Factor"));break;case "LIGHTING_AMBIENT":m=[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0)];l=[P("color","color",[0,0,0],!0),P("specular",
"specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":l=[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("dif_params","dif_params",[0,0],!0),P("sp_params","sp_params",[0,0],!0),P("shadow_factor","shadow_factor",0,!0),P("translucency_color","translucency_color",0,!0),P("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":m=[P("color","color",[0,0,0],!0),P("specular","specular",[0,0,0],!0)];break;
case "LIGHTING_LAMP":m=[P("shadow_factor","shadow_factor",0,!0)];l=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("lcolorint","lcolorint",[0,0,0],!0),P("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":m=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0)];l=[P("lfactor","lfactor",0,!0)];r.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":m=
[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),P("dif_params","dif_params",[0,0],!0)];l=[P("lfactor","lfactor",0,!0)];r.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":case "SPECULAR_COOKTORR":m=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),P("sp_params","sp_params",[0,0],!0)];l=[P("sfactor","sfactor",0,
!0)];r.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":m=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),P("sp_params","sp_params",[0,0],!0)];l=[P("sfactor","sfactor",0,!0)];r.push(["MAT_USE_TBN_SHADING",b.use_tangent_shading|0]);break;case "BSDF_COMPUTE":m=[P("ldir","ldir",[0,0,0],!0),P("lfac","lfac",[0,0],!0),P("normal","normal",[0,0,0],!0),P("norm_fac","norm_fac",0,!0),
P("bsdf_params","bsdf_params",[0,0,0,0],!0)];l=[P("lfactor","lfactor",0,!0),P("sfactor","sfactor",0,!0)];break;case "LIGHTING_APPLY":m=[P("color","color",[0,0,0,0],!0),P("specular","specular",[0,0,0],!0),P("lfactor","lfactor",0,!0),P("sfactor","sfactor",0,!0),P("ldir","ldir",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("translucency_params","translucency_params",[0,0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("lcolorint","lcolorint",[0,0,0],!0),P("translucency_color","translucency_color",
0,!0)];l=[P("color","color",[0,0,0,0],!0),P("specular","specular",[0,0,0],!0)];break;case "NORMAL":m=T(b);l=ka(b);t=ja(b,"Normal");n.push(ea(X("param_NORMAL_Normal"),t.ya,3));break;case "MAPPING":t=b.vector_type;h="MAPPING";m.push(L(b,"Vector"));l.push(ja(b,"Vector"));var u=Ea.f32(b.rotation),v=Ea.f32(b.scale),w=Ea.f32(b.translation),B=sa.create(),y=Ea.$L(u);"TEXTURE"==t&&(v[0]=v[0]||1,v[1]=v[1]||1,v[2]=v[2]||1);sa.multiply(y,new Float32Array([v[0],0,0,0,v[1],0,0,0,v[2]]),B);B=Ea.BO(B,Ha.create());
switch(t){case "POINT":B[12]=w[0];B[13]=w[1];B[14]=w[2];break;case "TEXTURE":B[12]=w[0];B[13]=w[1];B[14]=w[2];B=Ha.invert(B,B);break;case "NORMAL":Ha.invert(B,B),Ha.transpose(B,B)}switch(t){case "NORMAL":r.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":r.push(["MAPPING_TRS_MATRIX_DEF",1]);r.push(["MAPPING_TRS_MATRIX",pa.N(B,16)]);break;case "POINT":0!==Ca.length(u)?(r.push(["MAPPING_TRS_MATRIX_DEF",1]),r.push(["MAPPING_TRS_MATRIX",pa.N(B,16)])):(0!==Ca.length(v)&&(r.push(["MAPPING_SCALE_DEF",1]),r.push(["MAPPING_SCALE",
pa.N(v,3)])),0!==Ca.length(w)&&(r.push(["MAPPING_TRANS_DEF",1]),r.push(["MAPPING_TRANS",pa.N(w,3)])));break;case "VECTOR":0!==Ca.length(u)?(r.push(["MAPPING_TRS_MATRIX_DEF",1]),r.push(["MAPPING_TRS_MATRIX",pa.N(B,16)])):0!==Ca.length(v)&&(r.push(["MAPPING_SCALE_DEF",1]),r.push(["MAPPING_SCALE",pa.N(v,3)]))}b.use_min&&(r.push(["MAPPING_MIN_CLIP_DEF",1]),r.push(["MAPPING_MIN_CLIP",pa.N(b.min,3)]));b.use_max&&(r.push(["MAPPING_MAX_CLIP_DEF",1]),r.push(["MAPPING_MAX_CLIP",pa.N(b.max,3)]));break;case "MATERIAL":case "MATERIAL_EXT":var p=
[],t=[],u=[],v=[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("dif_params","dif_params",[0,0],!0),P("sp_params","sp_params",[0,0],!0),P("shadow_factor","shadow_factor",0,!0)],w=[P("color","color",[0,0,0],!0),P("specular","specular",[0,0,0],!0),P("normal","normal",[0,0,0],!0)],B=[ja(b,"Color"),ja(b,"Alpha"),ja(b,"Normal")],y=[],q=L(b,"Color");q.ya.splice(3);u.push(q);m.push(q);q=L(b,"Spec");q.ya.splice(3);u.push(q);m.push(q);
(q=L(b,"DiffuseIntensity"))||(q=L(b,"Refl"));q.ya=b.diffuse_intensity;u.push(q);m.push(q);var N=L(b,"Normal");N.ya.splice(3);u.push(N);m.push(N);"MATERIAL_EXT"==h?((q=L(b,"Emit"))||(q=P("Emit","Emit",0)),u.push(q),m.push(q),(q=L(b,"Translucency"))?(q.ya=0,q.name="Translucency",q.identifier="Translucency"):q=P("Translucency","Translucency",0),m.push(q),(q=L(b,"Translucency"))?(q.ya=[0,0,0,0],q.name="TranslucencyParams",q.identifier="TranslucencyParams"):q=P("TranslucencyParams","TranslucencyParams",
[0,0,0,0]),m.push(q),l=L(b,"Reflectivity"),q=L(b,"Ray Mirror"),l?(q=l,l="Reflectivity"):q?l="Ray Mirror":(q=l,l="Reflectivity"),q||(q=P(l,l,0)),m.push(q),w.push(q),(q=L(b,"SpecTra"))||(q=P("SpecTra","SpecTra",0)),m.push(q),w.push(q),(q=L(b,"Alpha"))||(q=P("Alpha","Alpha",b.alpha)),m.push(q),w.push(q),B.push(ja(b,"Diffuse")),B.push(ja(b,"Spec")),p.push(["MATERIAL_EXT",1]),t.push(["MATERIAL_EXT",1])):(u.push(P("emit_intensity","emit_intensity",0)),w.push(P("reflect_factor","reflect_factor",0)),w.push(P("specular_alpha",
"specular_alpha",0)),w.push(P("alpha_in","alpha_in",0)),B.push(P("diffuse_out","diffuse_out",0)),B.push(P("spec_out","spec_out",0)),p.push(["MATERIAL_EXT",0]),t.push(["MATERIAL_EXT",0]));y.push(ea(X("param_MATERIAL_alpha"),b.alpha));y.push(ea(X("param_MATERIAL_spec_alpha"),b.specular_alpha));l=B;p.push(["USE_MATERIAL_NORMAL",N.Ka|0]);b.use_diffuse&&(p.push(["USE_MATERIAL_DIFFUSE",1]),t.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&t.push(["USE_MATERIAL_SPECULAR",1]);var q=[],A=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":N=
b.specular_hardness;break;case "WARDISO":N=b.specular_slope;break;case "TOON":N=b.specular_toon_size;A=b.specular_toon_smooth;break;case "BLINN":N=b.specular_ior;A=b.specular_hardness;break;default:O.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+'")'),N=b.specular_hardness}var x,z;switch(b.diffuse_shader){case "LAMBERT":z=x=0;break;case "OREN_NAYAR":x=b.roughness;z=0;break;case "FRESNEL":x=b.diffuse_fresnel;z=b.diffuse_fresnel_factor;break;case "MINNAERT":x=
b.darkness;z=0;break;case "TOON":x=b.diffuse_toon_size;z=b.diffuse_toon_smooth;break;default:O.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.material_name+'")'),z=x=0}q.push(ea(X("param_MATERIAL_diffuse"),[x,z],2));q.push(ea(X("param_MATERIAL_spec"),[b.specular_intensity,N,A],3));p.push(["SHADELESS_MAT",b.use_shadeless?1:0]);N={name:b.name,value:{kq:b.specular_shader,To:b.diffuse_shader,le:b.use_shadeless,Jl:b.use_tangent_shading}};p={name:b.name,value:{kq:b.specular_shader,
To:b.diffuse_shader,le:b.use_shadeless,Jl:b.use_tangent_shading},CO:{name:"material_begin",type:"MATERIAL_BEGIN",inputs:u,outputs:v,X:q,data:N,hb:p,oe:[]},DO:{name:"material_end",type:"MATERIAL_END",inputs:w,outputs:B,X:y,data:N,hb:t,oe:[]}};break;case "BSDF_DIFFUSE":m=T(b);r.push(["USE_NORMAL_IN",m[2].Ka|0]);l=ja(b,"BSDF");u=l.Ka;l=[l,P("d_color","d_color",[0,0,0],u),P("d_roughness","d_roughness",0,u),P("s_color","s_color",[0,0,0],u),P("s_roughness","s_roughness",0,u),P("metalness","metalness",0,
u),P("normal","normal",[0,0,0],u),P("e_color","e_color",[0,0,0],u),P("emisson","emisson",0,u),P("a_color","a_color",[0,0,0],u),P("alpha","alpha",1,u)];break;case "BSDF_GLOSSY":m=T(b);r.push(["USE_NORMAL_IN",m[2].Ka|0]);l=ja(b,"BSDF");u=l.Ka;l=[l,P("d_color","d_color",[0,0,0],u),P("d_roughness","d_roughness",0,u),P("s_color","s_color",[0,0,0],u),P("s_roughness","s_roughness",0,u),P("metalness","metalness",1,u),P("normal","normal",[0,0,0],u),P("e_color","e_color",[0,0,0],u),P("emisson","emisson",0,
u),P("a_color","a_color",[0,0,0],u),P("alpha","alpha",1,u)];break;case "BSDF_TRANSPARENT":m=T(b);l=ja(b,"BSDF");u=l.Ka;l=[l,P("d_color","d_color",[0,0,0],u),P("d_roughness","d_roughness",0,u),P("s_color","s_color",[0,0,0],u),P("s_roughness","s_roughness",0,u),P("metalness","metalness",0,u),P("normal","normal",[0,0,0],u),P("e_color","e_color",[0,0,0],u),P("emisson","emisson",0,u),P("a_color","a_color",[0,0,0],u),P("alpha","alpha",1,u)];break;case "EMISSION":m=T(b);l=ja(b,"Emission");t=l.Ka;l=[l,P("d_color",
"d_color",[0,0,0],t),P("d_roughness","d_roughness",0,t),P("s_color","s_color",[0,0,0],t),P("s_roughness","s_roughness",0,t),P("metalness","metalness",1,t),P("normal","normal",[0,0,0],t),P("e_color","e_color",[0,0,0],t),P("emisson","emisson",1,t),P("a_color","a_color",[0,0,0],u),P("alpha","alpha",1,u)];break;case "MATH":switch(b.operation){case "ADD":h="MATH_ADD";break;case "SUBTRACT":h="MATH_SUBTRACT";break;case "MULTIPLY":h="MATH_MULTIPLY";break;case "DIVIDE":h="MATH_DIVIDE";break;case "SINE":h=
"MATH_SINE";break;case "COSINE":h="MATH_COSINE";break;case "TANGENT":h="MATH_TANGENT";break;case "ARCSINE":h="MATH_ARCSINE";break;case "ARCCOSINE":h="MATH_ARCCOSINE";break;case "ARCTANGENT":h="MATH_ARCTANGENT";break;case "POWER":h="MATH_POWER";break;case "LOGARITHM":h="MATH_LOGARITHM";break;case "MINIMUM":h="MATH_MINIMUM";break;case "MAXIMUM":h="MATH_MAXIMUM";break;case "ROUND":h="MATH_ROUND";break;case "LESS_THAN":h="MATH_LESS_THAN";break;case "GREATER_THAN":h="MATH_GREATER_THAN";break;case "MODULO":h=
"MATH_MODULO";break;case "ABSOLUTE":h="MATH_ABSOLUTE";break;default:return O.error("Unsupported MATH operation: "+b.operation),null}r.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);m=T(b);l=ka(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":h="MIX_RGB_MIX";break;case "ADD":h="MIX_RGB_ADD";break;case "MULTIPLY":h="MIX_RGB_MULTIPLY";break;case "SUBTRACT":h="MIX_RGB_SUBTRACT";break;case "SCREEN":h="MIX_RGB_SCREEN";break;case "DIVIDE":h="MIX_RGB_DIVIDE";break;case "DIFFERENCE":h="MIX_RGB_DIFFERENCE";
break;case "DARKEN":h="MIX_RGB_DARKEN";break;case "LIGHTEN":h="MIX_RGB_LIGHTEN";break;case "OVERLAY":h="MIX_RGB_OVERLAY";break;case "DODGE":h="MIX_RGB_DODGE";break;case "BURN":h="MIX_RGB_BURN";break;case "HUE":h="MIX_RGB_HUE";break;case "SATURATION":h="MIX_RGB_SATURATION";break;case "VALUE":h="MIX_RGB_VALUE";break;case "COLOR":h="MIX_RGB_COLOR";break;case "SOFT_LIGHT":h="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":h="MIX_RGB_LINEAR_LIGHT";break;default:return O.error("Unsupported MIX_RGB blend type: "+
b.blend_type),null}r.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);m=T(b);l=ka(b);break;case "OUTPUT":m=T(b);l=[];break;case "OUTPUT_MATERIAL":m=T(b);l=[];p=L(b,"Surface");t=p.Ka;p={name:b.name,YO:{name:"output_surface",type:"OUTPUT_SURFACE",inputs:[p],outputs:[],X:[],data:{value:{zJ:"BSDF_COMPUTE"},xJ:{name:"bsdf_begin",type:"BSDF_BEGIN",inputs:[p,P("d_color","d_color",[0,0,0],t),P("d_roughness","d_roughness",0,t),P("s_color","s_color",[0,0,0],t),P("s_roughness","s_roughness",0,t),P("metalness",
"metalness",0,t),P("normal","normal",[0,0,0],t),P("e_color","e_color",[0,0,0],t),P("emission","emission",0,t),P("a_color","a_color",[0,0,0],t),P("alpha","alpha",0,t)],outputs:[P("E","E",[0,0,0],!0),P("A","A",[0,0,0],!0),P("D","D",[0,0,0],!0),P("S","S",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("bsdf_params","bsdf_params",[0,0,0,0],!0),P("shadow_factor","shadow_factor",0,!0),P("s_color","s_color",[0,0,0],!0),P("metalness","metalness",0,!0),P("e_color","e_color",[0,0,0],!0),P("emission","emission",
0,!0),P("a_color","a_color",[0,0,0],!0),P("alpha","alpha",0,!0)],X:[],data:null,hb:[],oe:[]},yJ:{name:"bsdf_end",type:"BSDF_END",inputs:[P("color","color",[0,0,0],!0),P("specular","specular",[0,0,0],!0),P("normal","normal",[0,0,0],!0),P("s_color","s_color",[0,0,0],!0),P("metalness","metalness",0,!0),P("e_color","e_color",[0,0,0],!0),P("emission","emission",0,!0),P("a_color","a_color",[0,0,0],!0),P("alpha","alpha",0,!0)],outputs:[P("color","color",[0,0,0],t)],X:[],data:null,hb:[],oe:[]}},hb:[],oe:[]},
KL:{name:"displacement_bump",type:"DISPLACEMENT_BUMP",inputs:[P("Height","Height",0,!0)],outputs:[P("Normal","Normal",[0,0,0],!1)],X:[],data:null,hb:[],oe:[]}};break;case "RGB":t=b.name;t={name:"-1",value:t};n.push(t);l.push(ja(b,"Color"));break;case "SEPRGB":case "SEPHSV":m=T(b);l=ka(b);break;case "TEX_ENVIRONMENT":(t=b.image)?(h="TEXTURE_ENVIRONMENT","NONE"==b.color_space?r.push(["NON_COLOR",1]):r.push(["NON_COLOR",0]),m.push(L(b,"Vector")),l.push(ja(b,"Color")),u=X("param_TEXTURE_texture"),n.push(ea(u)),
p=Ka.iB(128),p.source="ENVIRONMENT_MAP",Ka.eA(p,t),p={name:u,value:p}):h="TEXTURE_EMPTY";break;case "TEX_IMAGE":if(t=b.image){h="TEXTURE_COLOR";"NONE"==b.color_space?r.push(["NON_COLOR",1]):r.push(["NON_COLOR",0]);r.push(["CONVERT_UV",0]);for(u=0;4>u;++u)u?(q=P("Vector"+u,"Vector"+u,[0,0,0],!1),v=P("Color"+u,"Color"+u,[0,0,0],!1),w=P("Alpha"+u,"Alpha"+u,0,!1)):(q=L(b,"Vector"),v=ja(b,"Color"),w=ja(b,"Alpha")),m.push(q),l.push(v),l.push(w);u=X("param_TEXTURE_texture");n.push(ea(u));p=Ka.Gk(Ka.Vg,!1);
p.repeat="REPEAT"==b.extension;p.source="IMAGE";Ka.eA(p,t);p={nv:b.name,ov:"",name:u,value:p}}else h="TEXTURE_EMPTY";break;case "TEXTURE":h=da(b);if("TEXTURE_EMPTY"==h)l.push(ja(b,"Color")),l.push(ja(b,"Normal")),l.push(ja(b,"Value"));else if("TEXTURE_ENVIRONMENT"==h)m.push(L(b,"Vector")),l.push(ja(b,"Color")),l.push(ja(b,"Value"));else{if("TEXTURE_NORMAL"==h&&"ENVIRONMENT_MAP"==b.texture.type)return O.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;"TEXTURE_COLOR"==h&&(t=!1,(u=b.texture.image)&&
"Non-Color"==u.colorspace_settings_name&&(t=!0),r.push(["NON_COLOR",Number(t)]),r.push(["CONVERT_UV",1]));for(u=0;4>u;++u)t="TEXTURE_COLOR"==h?"Color":"Normal",u?(q=P("Vector"+u,"Vector"+u,[0,0,0],!1),v=P(t+u,t+u,[0,0,0],!1),w=P("Value"+u,"Value"+u,0,!1)):(q=L(b,"Vector"),v=ja(b,t),w=ja(b,"Value")),m.push(q),l.push(v),l.push(w)}"TEXTURE_EMPTY"!=h&&(u=X("param_TEXTURE_texture"),n.push(ea(u)),p=b.texture.F,p={nv:b.texture.name,ov:b.texture.uuid,name:u,value:p});break;case "VALTORGB":m=T(b);l=ka(b);
p={value:b};t=b.color_ramp.interpolation;"CONSTANT"!=t&&"LINEAR"!=t&&O.warn("Color Ramp node is not fully supported.");break;case "VALUE":h="VALUE";t=b.name;t={name:"-1",value:t};n.push(t);l.push(ja(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":h="VECT_MATH_ADD";break;case "SUBTRACT":h="VECT_MATH_SUBTRACT";break;case "AVERAGE":h="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":h="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":h="VECT_MATH_CROSS_PRODUCT";break;case "NORMALIZE":h=
"VECT_MATH_NORMALIZE";break;default:return O.error("Unsupported VECT_MATH operation: "+b.operation),null}m=T(b);l=ka(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":r.push(["VECTOR_TYPE",pa.N(0)]);break;case "VECTOR":r.push(["VECTOR_TYPE",pa.N(1)]);break;case "NORMAL":r.push(["VECTOR_TYPE",pa.N(2)]);break;default:return O.error("Unsupported VECT_TRANSFORM vector_type: "+b.vector_type),null}m=b.convert_from;l=b.convert_to;if("WORLD"==m)if("WORLD"==l)m=0;else if("OBJECT"==l)m=1;else if("CAMERA"==
l)m=2;else return O.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==m)if("WORLD"==l)m=3;else if("OBJECT"==l)m=4;else if("CAMERA"==l)m=5;else return O.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==m)if("WORLD"==l)m=6;else if("OBJECT"==l)m=7;else if("CAMERA"==l)m=8;else return O.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else return O.error("Unsupported VECT_TRANSFORM convert_from: "+b.convert_from),
null;r.push(["CONVERT_TYPE",pa.N(m)]);m=T(b);l=ka(b);break;case "NORMAL_MAP":switch(b.space){case "TANGENT":t=0;break;case "OBJECT":t=1;break;case "WORLD":t=2;break;case "BLENDER_OBJECT":t=3;break;case "BLENDER_WORLD":t=4;break;default:return O.error("Unsupported NORMAL_MAP space: "+b.space),null}r.push(["SPACE",pa.N(t)]);m.push(L(b,"Strength"));m.push(L(b,"Color"));m.push(P("Normal","Normal",[0,0,0],!1));r.push(["USE_NORMAL_IN",0]);l.push(ja(b,"Normal"));break;case "FRESNEL":N=L(b,"Normal");m.push(L(b,
"IOR"));m.push(N);l.push(ja(b,"Fac"));r.push(["USE_FRESNEL_NORMAL",N.Ka|0]);break;case "LAYER_WEIGHT":N=L(b,"Normal");m.push(L(b,"Blend"));m.push(N);l=ka(b);r.push(["USE_NORMAL_IN",N.Ka|0]);break;case "BUMP":N=L(b,"Normal");r.push(["INVERT",b.invert?1:0]);r.push(["USE_NORMAL_IN",N.Ka|0]);m=T(b);l=ka(b);break;default:m=T(b),l=ka(b)}g={name:f,Cd:g,type:h,oe:k,inputs:m,outputs:l,X:n,data:p,hb:r};f=U.lj(a);U.Xg(a,f,g);if(!(g="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type&&"NEW_GEOMETRY"!=b.type)){a:{g=b.outputs;
for(k=h=0;k<g.length;k++)if(g[k].is_linked&&h++>c){g=!0;break a}g=!1}g=!g}return g||null!=V(a,b,++c,d,e)?f:null}function K(a,b,c){for(var d=a.inputs,e=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var h=d[g],k=b[g];if(!h||h.default_value instanceof Array!=k)return O.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(g=0;g<c.length;g++)if(b=e[g],d=c[g],!b||b.default_value instanceof Array!=d)return O.warn('Wrong outputs for custom node group "'+
a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function ba(a,b,c){var e=a.node_group.node_tree,f={},g;for(g in e)if("links"==g||"nodes"==g){f[g]=[];for(var h=0;h<e[g].length;h++){f[g][h]={};for(var k in e[g][h])if("links"==g){f[g][h][k]={};for(var m in e[g][h][k])f[g][h][k][m]=oa(e[g][h][k][m])}else f[g][h][k]=oa(e[g][h][k])}}else f[g]=oa(e[g]);h=a.node_tree_name;if("B4W_REPLACE"==h||"B4W_LEVELS_OF_QUALITY"==h)e=E("Group input","GROUP_INPUT",[],a.inputs),g=E("Group output",
"GROUP_OUTPUT",a.outputs,[]),h="B4W_REPLACE"==h||"B4W_LEVELS_OF_QUALITY"==h&&(Fa.quality==Ma.P_LOW||Fa.KB)?{from_node:e,from_socket:e.outputs[1],to_node:g,to_socket:g.inputs[0]}:{from_node:e,from_socket:e.outputs[0],to_node:g,to_socket:g.inputs[0]},f.nodes=[e,g],f.links=[h];e=a.name;g=f.nodes;h=f.links;for(k=0;k<g.length;k++)g[k].name=qa(g[k].type,e,g[k].name);for(k=0;k<h.length;k++)h[k].from_node.name=qa(h[k].from_node.type,e,h[k].from_node.name),h[k].to_node.name=qa(h[k].to_node.type,e,h[k].to_node.name);
return{RO:d(f,a.node_group.uuid,!0,b,c).Ja,SO:f.links}}function oa(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?Ea.zo(a):a}function X(a){Ta[a]||(Ta[a]=0);var b=a+"_"+Ta[a],b=b.replace(/ /g,"_").replace(/\//g,"_");Ta[a]++;return b}function ha(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function Z(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";
case "Normal":return"GEOMETRY_NO";case "True Normal":return"GEOMETRY_TRN";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":case "Position":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";case "Incoming":return"GEOMETRY_IN";case "Backfacing":return"GEOMETRY_BF";default:return null}}}function ca(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";
case "Generated":return"TEX_COORD_GE";case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function da(a){if(!a.texture||!a.texture.F)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:Ea.D("Unknown texture output")}}if(c)return d&&
O.warn('Node "'+a.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function L(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return aa(e)}return null}function ja(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return aa(e)}return null}function aa(a){var b=
a.name,c=a.identifier,d=a.is_linked;a=a.default_value;a=Ea.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,Ka:d,ya:a}}function P(a,b,c,d){return{name:a,identifier:b,Ka:d,ya:c}}function la(a){return P(a.name,a.identifier,a.ya,a.Ka)}function T(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=aa(a.inputs[c]);d.ya.length&&d.ya.splice(3);b.push(d)}return b}function ka(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=aa(a.outputs[c]);b.push(d)}return b}function ea(a,b,c){b=null===b||void 0===b?null:
pa.N(b,c);return{name:a,value:b}}function Ba(a){return{name:a.name,value:a.value}}function ra(a){return a.slice()}function ta(a,b,c,d,e,f){var g=[],h=f.from_socket.identifier;f=f.to_socket.identifier;var k=d.outputs;for(d=0;d<k.length;d++)if(k[d].identifier==h){g.push(d);break}e=e.inputs;for(d=0;d<e.length;d++)if(e[d].identifier==f){g.push(d);break}2==g.length&&U.Nc(a,b,c,g);return!0}function qa(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function fa(a){var b=
[];U.ha(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function va(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.RO,f=c[d].data.SO;if(!e)return!1;U.ha(e,function(b,c){U.Xg(a,U.lj(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);N(c[d],b,a)}return!0}function M(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function ua(a,b,c){for(var d=[],e=0;e<c.length;e++){for(var f=
c[e],g=null,h=0;h<b.length;h++)if(f.from_socket.identifier==b[h].to_socket.identifier){g=b[h];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):d.push(f)}for(e=0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}function na(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function xa(a,b,c,d){for(var e=0;e<d.length;e++){for(var f=d[e],g,h=0;h<c.inputs.length;h++)if(f.from_socket.identifier==c.inputs[h].identifier){g=c.inputs[h].ya;
break}for(var h=f,k=b,m=g,l=z(h.to_node,k),n=0;n<l.length;n++)for(var p=U.Ra(k,l[n]),r=0;r<p.inputs.length;r++){var t=p.inputs[r];if(t.identifier==h.to_socket.identifier){p=t.ya instanceof Object?0:1;if((m instanceof Object?0:1)==p)t.ya=m;else switch(p){case 0:t=t.ya;t[0]=t[1]=t[2]=m;break;case 1:t.ya=(m[0]+m[1]+m[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function N(a,b,c){for(var d=a.name,e=[],f=[],g=[],h=[],k=0;k<b.length;k++){var m=b[k];M(m.from_node,d,m,e,g,h);M(m.to_node,d,m,f,g,h)}f=
ua(b,f,g);e=ua(b,h,e);na(b,f);xa(b,c,a,f);if(e.length){var l;U.ha(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(l=b)});xa(b,c,l,e)}}function wa(a){var b=[],c=[];U.ha(a,function(a,d){switch(d.type){case "VALTORGB":b.push(d);break;case "CURVE_VEC":case "CURVE_RGB":c.push(d)}});var d=0,e=a=null,f=b.length+c.length;if(b.length){a=Ka.eM(b,Ka.iG);for(var g=0;g<b.length;g++)b[g].hb.push(["NODE_TEX_ROW",pa.N((d+.5)/f)]),d++}if(c.length)for(e=Ka.iM(c,Ka.wz),g=0;g<c.length;g++)c[g].hb.push(["NODE_TEX_ROW",
pa.N((d+.5)/f)]),d++;g=null;a&&e?(g=new Uint8Array(a.length+e.length),g.set(a),g.set(e,a.length)):a?g=a:g=e;a=g?Ka.hB(g,Ka.wz):null;for(g=0;g<b.length;g++)b[g].data.Ya=a;for(g=0;g<c.length;g++)c[g].data.Ya=a}function ma(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var Ma=q("__config"),Aa=q("__debug"),U=q("__graph"),sa=q("__mat3"),Ha=q("__mat4"),Ga=q("__objects"),O=q("__print"),pa=q("__shaders"),Va=q("__scenes"),Ea=q("__util"),
Ca=q("__vec3"),Ka=q("__textures"),Ta={},Ia={},Ra={},La={},ga=0,Fa=Ma.H;a.eT=0;a.qI=1;a.pI=2;a.oI=3;a.dT=4;a.nI=5;a.mI=6;a.lI=7;a.cT=8;a.bH=0;a.aH=1;a.WS=2;a.$G=3;a.VS=4;a.hC=function(a){return Ia[a]};a.iK=function(a){delete Ia[a]};a.sK=d;a.Jv=function(a,c,d){var e=Va.get_active();a=l(a,"MAIN",e.uuid);if(a in Ra)return Ra[a];var e=U.create(),g={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},h=V(e,g,0,c,null),g={name:"LIGHTING_END",type:"LIGHTING_END"},g=V(e,g,0,c,null);b(e,d,h,g,[[h,[8,10]],[h,[9,6]]],
c);f(e);return Ra[a]=e};a.xr=function(a){var b=[],c={};Ta={};var d=U.Py(a);U.ha(d,function(a,d){var e;e=[];for(var f=[],g=[],h=[],k=[],m=[],l=0;l<d.inputs.length;l++){var n=d.inputs[l];if(n.Ka)e.push(null),f.push(null);else{e.push(X("in_"+d.type+"_"+n.identifier.replace(/\./g,"")));var p=pa.N(n.ya,0);Fa.py&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==n.identifier||"Color2"==n.identifier||"Fac"==n.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==n.identifier||"Value_001"==n.identifier||"Value.001"==
n.identifier)||0<=d.type.indexOf("VECT_MATH_")&&("Vector_001"==n.identifier||"Vector.001"==n.identifier)||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||0<=d.type.indexOf("MATERIAL_BEGIN"))&&(n=p,n=n.replace(/(,)/g,"$1 "),n=n.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3"),n=n.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3"),p=n=n.replace(/\s+/g,""));f.push(p)}}for(l=0;l<d.outputs.length;l++)n=d.outputs[l],n.Ka?g.push(null):g.push(X("out_"+d.type+"_"+n.identifier.replace(/\./g,
"")));for(l=0;l<d.X.length;l++)n=d.X[l],h.push(n.name),k.push(n.value);for(l=0;l<d.oe.length;l++)m.push(d.oe[l].name);e={id:d.type,inputs:e,Rw:f,outputs:g,X:h,st:k,oe:m,hb:JSON.parse(JSON.stringify(d.hb))};b.push(e);c[a]=e});U.ag(d,function(a,b,e){var f=U.Ra(d,a),g=f.outputs[e[0]];a=c[a].outputs;b=c[b].inputs;f=a[e[0]]||X("out_"+f.type+"_"+g.identifier.replace(/\./g,""));a[e[0]]=f;b[e[1]]=f});return b};a.QA=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];
if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.MU=function(a,b){O.log("\n================ MATERIAL: "+b+" ================\n"+Aa.TO(a)+"\n============================================================")};a.cleanup=function(){for(var a in Ia)delete Ia[a];for(a in Ra)delete Ra[a];for(var b in La)delete La[b];ga=0}};b4w.module.__animation=function(a,q){function d(a,b){var c=a.fa[b];c&&c.Wr&&c.$o&&(c.$o=!1,c.Wr(a,b))}function c(a,b,c){c=a.fa[c];c.type=30;var d=b.sa,e=b.Za-d+1;c.start=d;c.length=e;c.We=d;c.Rh=b.name;for(e=d=0;e<a.Kc.length;e++){var f=a.Kc[e];if(f==b)break;else d+=f.Za-f.sa+1}c.OF=d}function b(a,b){a.type=50;a.Rh=b.name;a.start=b.sa;a.length=b.Za-a.start;b.cyclic||(a.length+=b.cx)}function g(a){return a.replace(/_B4W_BAKED$/,"")}function n(a,b){return{Nm:a,action:b}}function B(a,b,c){if(a.animation_data){var d=
a.animation_data.action;d&&60==d.F.type&&b.push(n(c,d))}a=a.nodes;for(d=0;d<a.length;d++){var e=a[d];if(e.node_group){var f=e.node_group.node_tree;if(f){var g=c.slice();g.push(e.name);B(f,b,g)}}}}function e(a){return X.is_mesh(a)&&a.o.Kc?!0:!1}function v(a,b,c){var d=a.fa;if(-1==c)for(c=0;8>c;c++){var e=d[c];e&&(e.We=b,h(a,0,c,!0))}else if(e=d[c])e.We=b,h(a,0,c,!0)}function w(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function h(a,b,c,e){r(a,b,c,e);d(a,c);a.o.Qh&&(H(a,
b),J(a,b))}function l(a,b,c,d){var e=c.frame_range;if(e[0]>e[1])return ca.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;var g=c.F,h=a.fa[d];h.Rh=c.name;h.Xu=e;h.$z=g.CD;h.Yz=g.vA;h.Zh.set(g.Zh);h.start=e[0];h.length=e[1]-e[0];h.We=e[0];switch(g.type){case 10:if(X.is_armature(a)){h.type=10;var m=x(a,b,c);if(!m){for(var m=a.o.zf,e=[],l=[],n=[],p=[],r=c.F.Dx,v=0;v<r;v++){for(var w in m){var B=m[w],q=B.rq,y=c.F.lv[w];y?ka.copy(y.subarray(8*v,8*v+8),q):ka.identity(q);
B.hu=!1}B=C(m);e.push(B.trans);l.push(B.wb);n.push(B.Xh);p.push(B.Wh)}m={trans:e,wb:l,Xh:n,Wh:p};k(a,b,c,m)}h.trans=m.trans;h.wb=m.wb;h.Wh=m.Wh;h.Xh=m.Xh;b=m;h=a.o;m=h.dn;e=a.fa[d];w=e.uy;a:{l=h.Mt;for(n=0;n<l.length;n+=2)if(c==l[n]){l=l[n+1];break a}l=null}if(l)e.uy=l;else{for(e=0;e<m.length;e++){l=m[e].Vh;n=[];p=[];r=b.trans;v=b.wb;for(B=0;B<r.length;B++)q=t(r[B],v[B],l),n.push(q.trans),p.push(q.wb);w.push({trans:n,wb:p})}h.Mt.push(c,w)}h.Qh&&(c=h.tn,d>c[1]?(b=c[1],c[1]=d,c[0]=b):d>c[0]&&d<c[1]&&
(c[0]=d),f(a))}break;case 40:X.is_speaker(a)&&(h.volume=g.X.volume||null,h.pitch=g.X.pitch||null,h.type=40);break;case 70:X.is_lamp(a)&&(h.color=g.X.color||null,h.Ye=g.X.energy||null,h.type=70);break;case 60:if("MESH"==a.type){h.type=60;w=x(a,b,c);if(!w){w=[];e=[];l=[];n=[];p=[];r=c.F;v=b?b[0]:null;for(m in r.X){B=b;q=m.match(/"(.*?)"/)[1];if(B&&1<B.length){for(var y=B[1],N=2;N<B.length;N++)y=y+"%join%"+B[N];y+="%join%"+q}else y=q;B=y;for(q=0;q<a.K.length;q++)for(y=a.K[q].R,N=0;N<y.length;N++){var A=
y[N];if(!v||-1!=A.Jb.indexOf(v)){var z=A.hf,K=u(m,B,r,e,w,A.jf),z=u(m,B,r,n,l,z);(K||z)&&p.push(A)}}}w={mS:w,values:e,LP:l,MP:n,Dj:p};k(a,b,c,w)}h.jf=w.mS;h.nD=w.values;h.hf=w.LP;h.mD=w.MP;h.Dj=w.Dj}break;case 20:if(m=g.X.tsr){h.type=20;w=x(a,b,c);if(!w){w=c.F.Dx;e=[];l=[];for(n=0;n<w;n++)e.push(m.subarray(8*n,8*n+4)),l.push(m.subarray(8*n+4,8*n+8));w={trans:e,wb:l};k(a,b,c,w)}h.trans=w.trans;h.wb=w.wb;ha.Ex(a)&&ha.$R(a,h.trans[0],h.wb[0])}else return ca.warn('Incompatible action "'+c.name+'" has been applied to object "'+
a.name+'"'),!1;break;case 80:X.is_world(a)&&(h.Ye=g.X["light_settings.environment_energy"]||null,h.Md=g.X.horizon_color||null,h.Vd=g.X.zenith_color||null,h.cp=g.X["mist_settings.intensity"]||null,h.fog_depth=g.X["mist_settings.depth"]||null,h.fog_start=g.X["mist_settings.start"]||null,h.fog_height=g.X["mist_settings.height"]||null,h.JB=g.X.b4w_fog_color||null,h.type=80)}X.is_armature(a)&&10!=g.type&&F(a,d);return!0}function x(a,b,c){a=a.ar;b=b?b.join("%join%"):null;for(var d=0;d<a.length;d+=3)if(c==
a[d]&&b==a[d+1])return a[d+2];return null}function k(a,b,c,d){a.ar.push(c,b?b.join("%join%"):null,d)}function f(a){var b=a.o.tn;if(-1!=b[0]&&-1!=b[1]){var c=a.fa;a=c[b[1]].We;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.We;d=Math.floor(a);b.We=d+e}}function F(a,b){var c=a.o.tn,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var e=a.fa;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function u(a,b,c,d,e,f){if(!f)return!1;for(var g=!1,h=0;h<f.length;h+=2)b==f[h]&&(e.push(f[h+1]),
d.push(new Float32Array(c.X[a])),g=!0);return g}function r(a,b,c,d){if((c=a.fa[c])&&null!=c.type&&(c.play||d)){var e=a.o,f=c.We,g=c.start,h=c.length,f=f+c.speed*b*la.ad(),k=c.type,m=c.speed;if(0<=m&&f>=g+h||0>m&&f<g)switch(d||(c.$o=!0),c.behavior){case 10:0<=m?f=(f-g)%h+g:f=g+h-1E-6;break;case 20:0<=m?f=g:f=g+h-1E-6;c.play=!1;break;case 30:0<=m?f=g+h-1E-6:f=g,c.play=!1}c.We=f;switch(k){case 10:if(!e.Qh){d=z(c);b=d[0];var l=d[1];d=d[2];e.Pd=c.wb[b];e.he=c.wb[l];e.Td=c.trans[b];e.ke=c.trans[l];e.Be=
d;d=e.dn;c=c.uy;for(var n=0;n<d.length;n++){var p=d[n],r=c[n];p.Pd=r.wb[b];p.he=r.wb[l];p.Td=r.trans[b];p.ke=r.trans[l];p.Be=e.Be}T.L(a)}break;case 20:d=z(c);var e=fa,l=d[0],n=d[1],p=d[2],r=c.trans,t=r[l][1],f=r[l][2],g=r[n][1],h=r[n][2];e[0]=(1-p)*r[l][0]+p*r[n][0];e[1]=(1-p)*t+p*g;e[2]=(1-p)*f+p*h;l=N;f=d[0];n=d[1];p=d[2];r=c.wb;t=wa;t[0]=r[f][0];t[1]=r[f][1];t[2]=r[f][2];t[3]=r[f][3];f=ma;f[0]=r[n][0];f[1]=r[n][1];f[2]=r[n][2];f[3]=r[n][3];da.slerp(t,f,p,l);n=d[2];p=c.trans;d=(1-n)*p[d[0]][3]+
n*p[d[1]][3];a.parent&&a.wt&&(n=Aa,ka.set_sep(e,d,l,n),ka.multiply(a.wt,n,n),ka.ec(n,e),ka.Qc(n,l),d=ka.get_scale(n));c.Xy&&(n=va,T.get_translation(a,n),ea.smooth_v(e,n,b,c.Xy,e));c.Ux&&(n=wa,T.get_rotation(a,n),ea.JE(l,n,b,c.Ux,l));f=c.Zh;f[0]&&T.set_translation_rel(a,e);f[1]&&T.set_rotation_rel(a,l);f[2]&&T.set_scale_rel(a,d);T.L(a);Z.sync_transform(a);break;case 30:d=c.We-c.start;0>d&&(d=0);d>=c.length&&(d=c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=--a,d=1);c=c.OF;qa[0]=
a+c;qa[1]=b+c;qa[2]=d;d=qa;e.mu=d[0];e.nu=d[2];break;case 40:d=z(c);b=d[0];e=d[1];d=d[2];c.volume&&aa.set_volume(a,(1-d)*c.volume[b]+d*c.volume[e]);c.pitch&&aa.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:b=10==c.behavior?(f-g)/la.ad():f/la.ad();ha.AQ(a,c.Rh,b);break;case 60:d=z(c);b=d[0];e=d[1];d=d[2];r=c.nD;t=c.jf;a=c.mD;l=c.hf;n=c.Dj;for(c=0;c<t.length;c++)for(f=r[c],p=t[c],g=(1-d)*f[b]+d*f[e],f=0;f<n.length;f++)n[f].Gg[p]=g;for(c=0;c<l.length;c++)for(r=a[c],p=l[c],r=Ba.lerp(r.subarray(3*
b,3*b+3),r.subarray(3*e,3*e+3),d,fa),f=0;f<n.length;f++)n[f].Bd[3*p]=r[0],n[f].Bd[3*p+1]=r[1],n[f].Bd[3*p+2]=r[2];break;case 70:d=z(c);b=d[0];e=d[1];d=d[2];f=c.Zh;(h=c.Ye)&&f[0]&&oa.set_light_energy(a.nb,(1-d)*h[b]+d*h[e]);(c=c.color)&&f[1]&&(fa[0]=(1-d)*c[3*b]+d*c[3*e],fa[1]=(1-d)*c[3*b+1]+d*c[3*e+1],fa[2]=(1-d)*c[3*b+2]+d*c[3*e+2],oa.set_light_color(a.nb,fa));g=a.K;for(c=0;c<g.length;c++)ja.KR(a,g[c].pb);break;case 80:d=z(c);b=d[0];e=d[1];d=d[2];f=c.Zh;g=a.K;m=ja.Aa(g[0].pb,P.Db);h=c.Ye;h=f[0]?
(1-d)*h[b]+d*h[e]:m.Ye;k=c.Md;f[1]?(fa[0]=(1-d)*k[3*b]+d*k[3*e],fa[1]=(1-d)*k[3*b+1]+d*k[3*e+1],fa[2]=(1-d)*k[3*b+2]+d*k[3*e+2],k=fa):k=m.Md;var u=c.Vd;f[2]?(va[0]=(1-d)*u[3*b]+d*u[3*e],va[1]=(1-d)*u[3*b+1]+d*u[3*e+1],va[2]=(1-d)*u[3*b+2]+d*u[3*e+2],m=va):m=m.Vd;u=c.cp;f[3]&&(l=(1-d)*u[b]+d*u[e]);u=c.fog_depth;f[4]&&(n=(1-d)*u[b]+d*u[e]);u=c.fog_start;f[5]&&(p=(1-d)*u[b]+d*u[e]);u=c.fog_height;f[6]&&(r=(1-d)*u[b]+d*u[e]);c=c.JB;f[7]&&(N[0]=(1-d)*c[3*b]+d*c[3*e],N[1]=(1-d)*c[3*b+1]+d*c[3*e+1],N[2]=
(1-d)*c[3*b+2]+d*c[3*e+2],t=N);for(c=0;c<g.length;c++)b=a.K[c].pb,(f[0]||f[1]||f[2])&&ja.set_environment_colors(b,h,k,m),f[3]&&ja.hE(b,l),f[4]&&ja.fE(b,n),f[5]&&ja.iE(b,p),f[6]&&ja.gE(b,r),f[7]&&ja.set_fog_color_density(b,t);break;default:ea.D("Unknown animation type:"+k)}}}function z(a){var b=a.Xu[0],c=a.Xu[1]-b,b=a.We-b;0>b&&(b=0);b>=c&&(b=c);b/=a.$z;c=Math.floor(b);a=a.Yz[c]?b-c:0;b=Math.ceil(c+a);qa[0]=c;qa[1]=b;qa[2]=a;return qa}function J(a,b){var c=a.o,d=c.mg,e=c.tn,f=e[0],e=e[1];if(-1!=e){if(-1!=
f){var g=a.fa[f];if(g.play||0==b){var h=z(g),k=h[0],m=h[1];c.Be=h[2];var h=g.wb[k],l=g.wb[m],n=g.trans[k],p=g.trans[m]}else d=1}else d=1;e=a.fa[e];if(e.play||0==b){var f=z(e),r=f[0],t=f[1];c.Be=f[2]}else if(-1!=f&&g.play)d=0;else return;var f=e.wb[r],u=e.wb[t],v=e.trans[r],w=e.trans[t];if(1==d)c.Pd.set(f),c.he.set(u),c.Td.set(v),c.ke.set(w);else if(0==d)c.Pd.set(h),c.he.set(l),c.Td.set(n),c.ke.set(p);else{var d=c.zf,B;for(B in d)h=d[B],h.Jp||D(c,h,g,e,k,m,r,t)}T.L(a);K.WR(a)}}function D(a,b,c,d,e,
f,g,h){for(var k=b.Jp,m=a.mg,l=N,n=wa,p=M,r=ua,t=ma,u=Ma,v=na,w=xa,B=4*b.Uh,q=c.Wh[e],y=d.Wh[g],A=c.Xh[e],x=d.Xh[g],z=c.Wh[f],K=d.Wh[h],E=c.Xh[f],C=d.Xh[h],F=0;4>F;F++)l[F]=q[B+F],n[F]=y[B+F],p[F]=A[B+F],r[F]=x[B+F],t[F]=z[B+F],u[F]=K[B+F],v[F]=E[B+F],w[F]=C[B+F];da.slerp(l,n,m,l);ea.yA(p,r,m,p);ka.set_transcale(p,Aa);ka.set_quat(l,Aa);k&&ka.multiply(k.tF,Aa,Aa);ka.copy(Aa,b.tF);ka.multiply(Aa,b.$y,Aa);ka.Dw(Aa,p);ka.Qc(Aa,l);da.slerp(t,u,m,t);ea.yA(v,w,m,v);ka.set_transcale(v,Aa);ka.set_quat(t,Aa);
k&&ka.multiply(k.sF,Aa,Aa);ka.copy(Aa,b.sF);ka.multiply(Aa,b.$y,Aa);ka.Dw(Aa,v);ka.Qc(Aa,t);for(F=0;4>F;F++)a.Pd[B+F]=l[F],a.Td[B+F]=p[F],a.he[B+F]=t[F],a.ke[B+F]=v[F];b=b.Xv;for(F=0;F<b.length;F++)D(a,b[F],c,d,e,f,g,h)}function H(a,b){var c=a.o,d=c.Vn;if(0!=d){var e=c.Un-c.mg,f=d*b;ea.sign(e)==ea.sign(d)&&Math.abs(f)<Math.abs(e)?c.mg+=f:(c.mg=c.Un,c.Vn=0)}}function C(a){var b=[],c=[],d=[],e=[],f=new Float32Array(4),g=new Float32Array(4),h;for(h in a){var k=a[h],m=f,l=g,n=k.sr,p=n[n.length-1],r=p.Zy;
p.hu||ka.identity(r);for(p=n.length-1;0<=p;p--){var t=n[p],u=t.Zy;if(t.hu)r=u;else{var v=t.Mi,w=t.rq;ka.invert(v,Aa);ka.multiply(w,Aa,Aa);ka.multiply(v,Aa,Aa);ka.multiply(r,Aa,u);r=u;t.hu=!0}}n=t.Zy;m[0]=n[0];m[1]=n[1];m[2]=n[2];m[3]=n[3];l[0]=n[4];l[1]=n[5];l[2]=n[6];l[3]=n[7];da.normalize(l,l);m=k.Uh;ka.multiply(k.sn,k.rq,Aa);for(k=0;4>k;k++)l=4*m+k,b[l]=f[k],c[l]=g[k],d[l]=Aa[k],e[l]=Aa[k+4]}return{trans:b,wb:c,Xh:d,Wh:e}}function t(a,b,c){var d=[],e=[],f;for(f in c)for(var g=c[f],h=g.Uh,g=g.Vv,
k=0;4>k;k++){var m=4*g+k,l=4*h+k;d[m]=a[l];e[m]=b[l]}d=new Float32Array(d);e=new Float32Array(e);return{trans:d,wb:e}}function m(a){var b=a.F,c;if(b.lv)c=10;else if(b.X)if("volume"in b.X||"pitch"in b.X)c=40;else{var d;a:{if(d=a.F.X)for(var e in d)if(-1!=e.indexOf("nodes")){d=!0;break a}d=!1}if(d)c=60;else{var f;a:{if(a.F.X){d=a.fcurves;for(f in d)if("color"==f&&!d[f][3]){f=!0;break a}if("energy"==f){f=!0;break a}}f=!1}if(f)c=70;else if(f=a.F.X,"light_settings.environment_energy"in f||"horizon_color"in
f||"zenith_color"in f||"mist_settings.intensity"in f||"mist_settings.depth"in f||"mist_settings.start"in f||"mist_settings.height"in f||"b4w_fog_color"in f)c=80;else{a:{if(a.F.X)for(c in a=a.fcurves,a)if("location"==c||"rotation_quaternion"==c||"scale"==c){c=!0;break a}c=!1}c=c?20:0}}}else c=0;b.type=c}function A(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function I(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=
1)}function p(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==c?b[1]=1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function Q(a,b,c,d,e,f,g){var h=a+(b-a)/2,k=y(h,d,e,f,g)-c;return.02>Math.abs(k)?h:0<k?Q(a,h,c,d,e,f,g):Q(h,b,c,d,e,f,g)}function y(a,b,c,d,e){var f=1-a;return b*
f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function Y(a,b){var c={type:null,Rh:null,Xu:null,$z:0,Yz:null,Zh:new Int8Array(8),wb:null,trans:null,Wh:null,Xh:null,uy:[],play:!1,behavior:20,We:0,start:0,length:0,Xy:0,Ux:0,$o:!1,OF:null,speed:1,volume:null,pitch:null,color:null,Ye:null,Vd:null,Md:null,cp:null,fog_depth:null,fog_start:null,fog_height:null,JB:null,nD:[],jf:[],mD:[],hf:[],Dj:null};if(!a.fa.length)for(var d=0;8>d;d++)a.fa.push(null);a.fa[b]=c;-1==U.indexOf(a)&&U.push(a)}function R(a,b){T.L(a);Z.sync_transform(a);
h(a,0,b,!0)}function G(a,d,e,f){f=f||0;if(X.is_mesh(a)){var g=E(a,e);if(g)return Y(a,f),c(a,g,f),R(a,f),!0;if((g=W(a,e))&&"EMITTER"==g.qt){Y(a,f);d=g.name;e=f;for(var g=a.K,h=0;h<g.length;h++)for(var k=g[h].R,m=0;m<k.length;m++){var n=k[m].wa;n&&n.name==d&&b(a.fa[e],n)}R(a,f);return!0}}if(g=ea.keysearch("name",e,sa)||ea.keysearch("name",e+"_B4W_BAKED",sa)){Y(a,f);if(l(a,d,g,f))return R(a,f),!0;a.fa[f]=null}ca.error('Unsupported object: "'+a.name+'" or animation name: "'+e+'"');return!1}function E(a,
b){for(var c=0;c<a.Kc.length;c++){var d=a.Kc[c];if(d.name===b)return d}return null}function W(a,b){for(var c=a.K,d=0;d<c.length;d++)for(var e=c[d].R,f=0;f<e.length;f++){var g=e[f].wa;if(g&&g.name===b)return g}return null}function V(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}var K=q("__armature"),ba=q("__config"),oa=q("__lights"),X=q("__obj_util"),ha=q("__particles"),Z=q("__physics"),ca=q("__print"),da=q("__quat"),L=q("__reformer"),ja=
q("__scenes"),aa=q("__sfx"),P=q("__subscene"),la=q("__time"),T=q("__transform"),ka=q("__tsr"),ea=q("__util"),Ba=q("__vec3"),ra=ba.nk,ta=ba.pg;a.CG=1E-6;a.OBJ_ANIM_TYPE_NONE=0;a.OBJ_ANIM_TYPE_ARMATURE=10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=60;a.nH=70;a.mH=80;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=-1;a.AB_CYCLIC=10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=
30;var qa=Array(3),fa=new Float32Array(3),va=new Float32Array(3),M=new Float32Array(4),ua=new Float32Array(4),na=new Float32Array(4),xa=new Float32Array(4),N=new Float32Array(4),wa=new Float32Array(4),ma=new Float32Array(4),Ma=new Float32Array(4),Aa=ka.create(),U=[],sa=[];a.fC=function(){return ea.trunc((ta.Xs-50)/4)};a.frame_to_sec=function(a){return a/la.ad()};a.update=function(a){for(var b=0;b<U.length;b++){for(var c=U[b],e=0;8>e;e++)r(c,a,e);c.o.Qh&&(H(c,a),J(c,a))}for(b=0;b<U.length;b++)for(c=
U[b],e=0;8>e&&c.fa.length;e++)d(c,e)};a.PM=function(){return sa};a.get_anim_names=function(a){var b=[];if(e(a))for(var c=0;c<a.Kc.length;c++)b.push(a.Kc[c].name);for(var d=[],c=0;c<sa.length;c++){var f=sa[c],h=f.F;20==h.type?d.push(f):60==f.F.type&&"MESH"==a.type?d.push(f):10==h.type&&"ARMATURE"==a.type?d.push(f):40==h.type&&"SPEAKER"==a.type?d.push(f):80==h.type&&"WORLD"==a.type&&d.push(f)}for(c=0;c<d.length;c++)b.push(g(d[c].name));if(ha.Ex(a)&&ha.sD(a))for(a=a.K,c=0;c<a.length;c++)for(d=a[c].R,
f=0;f<d.length;f++)(h=d[f].wa)&&b.push(h.name);return b};a.UE=g;a.get_anim_type=function(a,b){var c=a.fa[b];return c?c.type:0};a.apply_def=function(a){for(var d=0,f=a.K,g=0;g<f.length;g++)for(var h=f[g].R,k=0;k<h.length;k++){var m=h[k].wa;m&&"EMITTER"==m.qt&&!h[k].Ff&&(Y(a,d),b(a.fa[d],m),R(a,d),m.cyclic?a.fa[d].behavior=10:a.fa[d].behavior=a.mk,d++)}f=a.sg.slice();for(g=0;g<f.length;g++)k=f[g],h=k.Nm,k=k.action,Y(a,d),l(a,h,k,d)?(R(a,d),a.fa[d].behavior=a.mk,d++):a.fa[d]=null;e(a)&&(Y(a,d),c(a,a.Kc[0],
d),R(a,d),a.fa[d].behavior=a.mk)};a.av=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:ea.D("Wrong animation behavior")}};a.TM=function(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c],e=d.node_tree;e&&B(e,b,[d.name])}return b};a.zC=n;a.play=function(a,b,c){w(a.fa,c,function(a){a.play=!0;b?a.Wr=b:a.Wr=null;a.$o=!1});a.o.Qh&&f(a)};a.stop=function(a,b){w(a.fa,b,function(a){a.play=!1;a.Wr=null;a.$o=!1})};a.is_play=
function(a,b){var c=a.fa;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.set_frame=v;a.set_first_frame=function(a,b){b=b||0;w(a.fa,b,function(c){v(a,c.start,b)})};a.sw=function(a,b){var c=a.fa[b];return c&&c.We?c.We:0};a.is_cyclic=function(a,b){var c=a.fa[b];return c&&10==c.behavior};a.set_behavior=function(a,b,c){w(a.fa,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=a.fa[b];return c&&c.behavior};a.apply_smoothing=function(a,b,c,
d){w(a.fa,d,function(a){a.Xy=b||0;a.Ux=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.fa[c]=null;else a.fa[b]=null;a.o.Qh&&F(a,b)};a.NR=h;a.uD=function(a){if("ARMATURE"==a.type||a.fr||"WORLD"==a.type)return!0;for(var b=0;b<a.sg.length;b++){var c=a.sg[b].action.F.type;if(20==c||10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==a.type||60==c&&"MESH"==a.type)return!0}return ha.Ex(a)&&ha.sD(a)||"MESH"==a.type&&a.Kc.length?!0:!1};a.DA=function(a,b){if("ARMATURE"==b.type||V(a)||
"WORLD"==b.type)return!0;for(var c=0;c<b.sg.length;c++){var d=b.sg[c].action.F.type;if(20==d||10==d||40==d&&"SPEAKER"==b.type||60==d&&"MESH"==b.type)return!0}return ha.wJ(a)&&ha.vJ(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.is_animated=function(a){return!!a.fa.length};a.FJ=C;a.hM=t;a.CI=function(a){function b(a,b){for(var c=0;c<b;c++){var d=a.subarray(8*c+4,8*c+8);da.normalize(d,d)}}function c(a,b){if(-1<a.indexOf("location"))var c=0,d=b;else-1<a.indexOf("rotation_quaternion")?(c=
4,d=0==b?3:b-1):-1<a.indexOf("scale")?(c=3,d=0):(c=0,d=b);return c+d}function d(a,b,c,d,g){if(-1<c.search(e)){a=b;c=c.split('"')[1];var h=f}else 8==g?(c="tsr",h=f):1<g?h=new Float32Array(g):h=0;if(!a[c]){g=a;b=c;if("object"==typeof h&&h.length)for(var k=h.length,m=new Float32Array(d*k),l=0;l<d;l++)for(var n=0;n<k;n++)m[l*k+n]=h[n];else if("number"==typeof h)for(m=new Float32Array(d),l=0;l<d;l++)m[l]=h;else ea.D("Wrong storage default value");g[b]=m}return a[c]}var e=new RegExp(/pose.bones\[\".+\"\]/g),
f=ka.create(),g=a.F={type:0,Dx:0,CD:0,X:null,lv:null,vA:null,Zh:new Int8Array(8)};g.CD=1/ra.Pk;var h=a.fcurves,k={},l={},n=0,r;for(r in h){var t=h[r],u;for(u in t){var v=t[u],w=v.Te;L.QJ(v,a);v=v.num_channels;n||(n=w.length);for(var v=d(k,l,r,n,v),B=v.length/n,q=c(r,u|0),y=0;y<n;y++)v[y*B+q]=w[y]}}if(ea.gi(k)){for(var N in k)"tsr"==N&&b(k[N],n);g.X=k}if(ea.gi(l)){for(var x in l)b(l[x],n);g.lv=l}g.Dx=n;g.vA=a.rI;"tsr"in k&&A(h,g.Zh);("color"in k||"energy"in k)&&I(h,g.Zh);("light_settings.environment_energy"in
k||"horizon_color"in k||"zenith_color"in k||"mist_settings.intensity"in k||"mist_settings.depth"in k||"mist_settings.start"in k||"mist_settings.height"in k||"b4w_fog_color"in k)&&p(h,g.Zh);m(a);sa.push(a)};a.SM=function(a,b){return(b-a)*ra.Pk+1};a.aJ=function(a,b,c,d,e,f){var g=new Float32Array(2),h=new Float32Array(2),k=new Float32Array(2),m=new Float32Array(2),l=b[1],n=b[2],p=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var r=0,t=0,u=null;e<=f;e++)if(e<l)for(var v=0;v<ra.Pk;v++)c[r++]=
n;else if(e>p)for(v=0;v<ra.Pk;v++)c[r++]=a;else{var w=b[t],B=3;0===w&&(B+=2);0===u&&(B+=2);var q=2===w?0:1;if(b[t+1]==b[t+B+1])u=w,t+=B;else{v=0;e==b[t+1]&&(q&&(d[r]=1),c[r]=b[t+2],r++,v++);if(e==p)for(;v<ra.Pk;v++)c[r++]=a;else for(g[0]=b[t+1],g[1]=b[t+2],0!==w?(h[0]=0,h[1]=0):0===u?(h[0]=b[t+5],h[1]=b[t+6]):(h[0]=b[t+3],h[1]=b[t+4]),0!==w?(k[0]=0,k[1]=0):(k[0]=b[t+B+3],k[1]=b[t+B+4]),m[0]=b[t+B+1],m[1]=b[t+B+2];v<ra.Pk;v++){var N=e+v/ra.Pk;switch(w){case 0:var A,x,z,K=g,E=h,F=k,D=m,C=[],ma=[];C[0]=
K[0]-E[0];C[1]=K[1]-E[1];ma[0]=D[0]-F[0];ma[1]=D[1]-F[1];A=D[0]-K[0];z=Math.abs(C[0]);x=Math.abs(ma[0]);z+x&&z+x>A&&(A/=z+x,E[0]=K[0]-A*C[0],E[1]=K[1]-A*C[1],F[0]=D[0]-A*ma[0],F[1]=D[1]-A*ma[1]);q&&(d[r]=1);c[r]=y(Q(0,1,N,g[0],h[0],k[0],m[0]),g[1],h[1],k[1],m[1]);r++;break;case 1:q&&(d[r]=1);K=g[0];E=g[1];F=(m[1]-E)/(m[0]-K);c[r]=F*N+(E-F*K);r++;break;case 2:q&&(d[r]=1);c[r]=b[t+2];r++;break;default:ea.D("Unknown keyframe interpolation mode: "+w)}}e+1==b[t+B+1]&&(u=w,t+=B)}}};a.apply=G;a.YI=function(a,
b,c,d){d=d||0;var e=ea.keysearch("uuid",c,sa);if(e){Y(a,d);if(l(a,b,e,d)){R(a,d);return}a.fa[d]=null}ca.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.PF=function(a,b){var c=ea.keysearch("name",b,sa)||ea.keysearch("name",b+"_B4W_BAKED",sa);if(c){if(0==c.F.type)return!1}else if(!(W(a,b)||X.is_mesh(a)&&E(a,b)))return!1;return!0};a.get_slot_num_by_anim=function(a,b){for(var c=a.fa,d=0;d<c.length;d++){var e=c[d];if(e&&g(e.Rh)==g(b))return d}return-1};a.RM=function(a,b){var c=
a.fa[b];return c&&c.Rh?g(c.Rh):null};a.remove=function(a){a.fa.length=0;a=U.indexOf(a);-1!=a&&U.splice(a,1)};a.vP=function(a){for(var b=sa.length-1;0<=b;b--)sa[b].sI==a&&sa.splice(b,1)};a.apply_to_first_empty_slot=function(a,b){if(!a.fa.length)return G(a,null,b,0)?0:-1;for(var c=0;c<a.fa.length;c++)if(!a.fa[c])return G(a,null,b,c)?c:-1};a.set_skel_mix_factor=function(a,b,c){a.o.Vn=(b-a.o.mg)/c;a.o.Un=b};a.set_speed=function(a,b,c){w(a.fa,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.fa[b].speed};
a.get_anim_start_frame=function(a,b){return a.fa[b].start};a.get_anim_length=function(a,b){return a.fa[b].length};a.cleanup=function(){U.length=0;sa.length=0};a.kM=function(a){var b=(a[0]||a[1]||a[2]).Te.length,c=N,d=fa,e=!!a[0];e||(a[0]={Te:new Float32Array(b),num_channels:8});var f=!!a[1];f||(a[1]={Te:new Float32Array(b),num_channels:8});var g=!!a[2];g||(a[2]={Te:new Float32Array(b),num_channels:8});a[3]={Te:new Float32Array(b),num_channels:8};for(var h=0;h<b;h++)d[0]=e?a[0].Te[h]:0,d[1]=f?a[1].Te[h]:
0,d[2]=g?a[2].Te[h]:0,ea.euler_to_quat(d,c),a[0].Te[h]=c[3],a[1].Te[h]=c[0],a[2].Te[h]=c[1],a[3].Te[h]=c[2]};a.$B=V;a.MQ=function(a,b){for(var c=7,d=0,e=0;e<sa.length;e++){var f=sa[e];if(f.name==b){d=f.F.type;break}}0==d&&(E(a,b)?d=30:(e=W(a,b))&&"EMITTER"==e.qt&&(d=50));for(e=0;8>e;e++)if(f=a.fa[e]){if(f.type==d)return e}else e<c&&(c=e);return c}};b4w.module.__time=function(a,q){function d(){return-1!==c.nk.bs?c.nk.bs:w}var c=q("__config"),b=0,g=0,n=[],B=0,e=0,v=[],w=-1;a.qE=function(a){b=a;g=performance.now();for(a=0;a<n.length;a++){var c=n[a];b>c.hw&&(n.splice(a,1),a--,c.callback())}for(a=0;a<v.length;a++){var c=v[a],d=1-(c.hw-b)/c.duration,d=Math.min(d,1);c.callback(c.from+d*(c.to-c.from));1==d&&(v.splice(a,1),a--)}};a.get_timeline=function(){return b};a.set_timeout=function(a,c){var d;B++;d=B;n.push({id:d,callback:a,hw:b+(performance.now()-
g+c)/1E3});return d};a.clear_timeout=function(a){for(var b=0;b<n.length;b++)if(n[b].id==a){n.splice(b,1);break}};a.clear_animation=function(a){for(var b=v.length;b--;)if(v[b].id==a){v.splice(b,1);break}};a.animate=function(a,c,d,g){d/=1E3;var f;e++;f=e;v.push({id:f,callback:g,from:a,to:c,hw:b+d,duration:d});g(a);return f};a.reset=function(){g=b=0;n.length=0;e=B=v.length=0};a.ad=d;a.iQ=function(a){w=a};a.get_frame=function(a){return a*d()}};b4w.module.__transform=function(a,q){function d(a,b){l.Hf(a)?r.set_trans(b,l.Gf(a)):r.set_trans(b,a.o.v)}function c(a,b){var c=a.o;if(l.Hf(a)){r.set_quat(b,c.v);var d=l.gs(a),d=r.invert(d,t);r.multiply(d,c.v,l.Gf(a))}else r.set_quat(b,c.v)}function b(a,b){l.Hf(a)?r.set_quat(b,l.Gf(a)):r.set_quat(b,a.o.v)}function g(a,b){r.Qc(a.o.v,b);return b}function n(a,b){l.Hf(a)?r.Qc(l.Gf(a),b):r.Qc(a.o.v,b);return b}function B(a,b){l.Hf(a)?r.copy(b,l.Gf(a)):r.copy(b,a.o.v)}function e(a,b){l.Hf(a)?r.copy(l.Gf(a),
b):r.copy(a.o.v,b);return b}function v(a){var b=a.o,c=a.K,d=a.type;"CAMERA"==d&&h.bz(a);l.IR(a,A);"CAMERA"==d&&h.GR(a);var e=r.ec(b.v,D),g=r.Qc(b.v,C);w.wk(b.U,b.v,b.Pa);w.lo(b.va,b.v,b.gb);if(b.wn)for(var m=0;m<c.length;m++)for(var n=c[m].R,p=0;p<n.length;p++){var B=n[p];w.wk(B.U,b.v,B.Pa);w.lo(B.va,b.v,B.gb);B.Je&&w.ko(B.Z,b.v,B.jb)}else b.Je&&w.ko(b.Z,b.v,b.jb);switch(d){case "MESH":a.kD&&r.invert(a.o.v,a.o.Bu);if(n=a.fr)r.invert(n.o.v,t),r.multiply(t,b.v,t),r.Dw(t,b.Zn),r.Qc(t,b.Yn);b.fp=!0;break;
case "CAMERA":for(m=0;m<c.length;m++)h.HR(a,c[m]);break;case "SPEAKER":u.VQ(a,A,I);break;case "LAMP":x.LR(a)}for(m=0;m<c.length;m++)if(p=c[m],p.Fs){n=p.pb;B=n.F;switch(d){case "MESH":b.ie&&F.ky(n);B=p.ai;null!=b.td&&B&&F.xF(B,e);break;case "EMPTY":k.JR(a);break;case "CAMERA":F.VP(n);if(B.Jc){(B.Jc.enable_csm||B.Jc.RL)&&F.ky(n);var q=f.oa(a,n).ea[0];F.VR(q,B.Ja)}F.get_active()==n&&F.mj(n)==a&&u.qO(n,e,g,A,I);break;case "LAMP":F.wq(a,n)}B=p.Ah;q=a.Xp;if(q.length)for(p=0;p<B.length;p++){var H=B[p].B;
F.zF(B[p],e,g);f.AF(q,H.hc);h.DQ(H,F.mj(n));z.om(H.Tc,H.lh)}}b=a.ve;for(m=0;m<b.length;m++)v(b[m]);a=a.Fv;for(m=0;m<a.length;m++)b=a[m],n=b[0],l.DR(n,b[1])}var w=q("__boundings"),h=q("__camera"),l=q("__constraints"),x=q("__lights"),k=q("__objects"),f=q("__obj_util"),F=q("__scenes"),u=q("__sfx"),r=q("__tsr"),z=q("__util"),J=q("__vec3"),D=new Float32Array(3),H=new Float32Array(3),C=new Float32Array(4),t=r.create(),m=r.create(),A=0,I=0;a.update=function(a){A=a;I++};a.set_translation=function(a,b){var c=
a.o;if(l.Hf(a)){r.set_trans(b,c.v);var d=l.gs(a),d=r.invert(d,t);r.multiply(d,c.v,l.Gf(a))}else r.set_trans(b,c.v)};a.set_translation_rel=d;a.get_translation=function(a,b){r.ec(a.o.v,b);return b};a.get_translation_rel=function(a,b){l.Hf(a)?r.ec(l.Gf(a),b):r.ec(a.o.v,b);return b};a.set_rotation=c;a.set_rotation_rel=b;a.get_rotation=g;a.get_rotation_rel=n;a.set_rotation_euler=function(a,b){var d=z.euler_to_quat(b,C);c(a,d)};a.set_rotation_euler_rel=function(a,c){var d=z.euler_to_quat(c,C);b(a,d)};a.get_rotation_euler=
function(a,b){var c=g(a,C);return b=z.quat_to_euler(c,b)};a.get_rotation_euler_rel=function(a,b){var c=n(a,C);return b=z.quat_to_euler(c,b)};a.set_scale=function(a,b){var c=a.o;if(l.Hf(a)){var c=l.Gf(a),d=r.get_scale(l.gs(a));r.set_scale(b/d,c)}else r.set_scale(b,c.v)};a.set_scale_rel=function(a,b){var c=a.o;l.Hf(a)?r.set_scale(b,l.Gf(a)):r.set_scale(b,c.v)};a.get_scale=function(a){return r.get_scale(a.o.v)};a.get_scale_rel=function(a){return l.Hf(a)?r.get_scale(l.Gf(a)):r.get_scale(a.o.v)};a.set_tsr=
function(a,b){r.copy(b,a.o.v);if(l.Hf(a)){var c=l.gs(a),c=r.invert(c,t);r.multiply(c,a.o.v,l.Gf(a))}};a.set_tsr_rel=B;a.get_tsr=function(a,b){return r.copy(a.o.v,b)};a.get_tsr_rel=e;a.get_object_size=function(a){var b=a.o;a=b.Th;var c=r.get_scale(b.v),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.get_object_center=function(a,b,c){b?(a=a.o,J.copy(a.gb.M,c)):(a=a.o,b=a.Th,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/
2,r.transform_vec3(c,a.v,c));return c};a.move_local=function(a,b,c,f){var g=e(a,t),h=D;h[0]=b;h[1]=c;h[2]=f;r.transform_vec3(h,g,h);d(a,h)};a.gy=function(a,b){var c=e(a,t),d=r.set_quat(b,r.identity(m));r.multiply(c,d,d);B(a,d)};a.L=v;a.distance=function(a,b){var c=r.ec(a.o.v,D),d=r.ec(b.o.v,H);return J.dist(c,d)};a.Ep=function(a,b){var c=r.ec(a.o.v,D);return J.dist(c,b)};a.get_object_bounding_box=function(a){return{max_x:a.o.Pa.max_x,min_x:a.o.Pa.min_x,max_y:a.o.Pa.max_y,min_y:a.o.Pa.min_y,max_z:a.o.Pa.max_z,
min_z:a.o.Pa.min_z}}};b4w.module.__tsr=function(a,q){function d(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function c(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function g(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3];return d}function n(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b}function B(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],k=b[5],l=b[6];
b=b[7];var n=a[0]*g,p=a[1]*g,r=a[2]*g;a=b*n+k*r-l*p;var g=b*p+l*n-h*r,u=b*r+h*p-k*n,n=-h*n-k*p-l*r;c[0]=a*b+n*-h+g*-l-u*-k;c[1]=g*b+n*-k+u*-h-a*-l;c[2]=u*b+n*-l+a*-k-g*-h;c[0]+=d;c[1]+=e;c[2]+=f;return c}var e=q("__mat4"),v=q("__quat"),w=q("__util"),h=q("__vec3"),l=Math.sin(-Math.PI/4),x=-l,k=new Float32Array(3),f=new Float32Array(4),F=new Float32Array(16);a.create=d;a.clone=function(a){var c=d();b(a,c);return c};a.from_values=function(a,b,c,e,f,g,h,k){var m=d();m[0]=a;m[1]=b;m[2]=c;m[3]=e;m[4]=f;
m[5]=g;m[6]=h;m[7]=k;return m};a.Ek=c;a.wT=function(a){var d=c();b(a,d);return d};a.TT=function(a,b,d,e,f,g,h,k){var m=c();m[0]=a;m[1]=b;m[2]=d;m[3]=e;m[4]=f;m[5]=g;m[6]=h;m[7]=k;return m};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.set_sep=g;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set_scale=function(a,b){b[3]=a;return b};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set_quat=function(a,
b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.get_trans_view=function(a){return a.subarray(0,3)};a.ec=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.get_scale=function(a){return a[3]};a.Dw=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.get_quat_view=function(a){return a.subarray(4,8)};a.Qc=n;a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],e=a[1],g=a[2];f[0]=a[4];f[1]=a[5];f[2]=a[6];f[3]=a[7];v.invert(f,f);var h=f[0],k=f[1],m=f[2],l=f[3],d=d*c,e=e*c,n=g*
c,g=l*d+k*n-m*e,p=l*e+m*d-h*n,r=l*n+h*e-k*d,d=-h*d-k*e-m*n;b[0]=-(g*l+d*-h+p*-m-r*-k);b[1]=-(p*l+d*-k+r*-h-g*-m);b[2]=-(r*l+d*-m+g*-k-p*-h);b[3]=c;b[4]=h;b[5]=k;b[6]=m;b[7]=l;return b};a.to_mat4=function(a,b){var c=a[3];e.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var d=0;12>d;d++)b[d]*=c;return b};a.from_mat4=function(a,b){var c=w.jx(a,k),d=w.dD(a),e=w.matrix_to_quat(a,f);g(c,d,e,b);return b};a.multiply=function(a,b,c){B(b,a,c);c[3]=a[3]*b[3];var d=a[4],e=a[5],f=a[6];a=a[7];var g=
b[4],h=b[5],k=b[6];b=b[7];c[4]=d*b+a*g+e*k-f*h;c[5]=e*b+a*h+f*g-d*k;c[6]=f*b+a*k+d*h-e*g;c[7]=a*b-d*g-e*h-f*k;return c};a.qR=function(a,b,c){var d=b[3];b=e.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),F);for(var f=0;12>f;f++)b[f]*=d;e.multiply(b,a,c);return c};a.transform_vec3=B;a.transform_vec3_inv=function(a,b,c){var d=b[3],e=a[0]-b[0],f=a[1]-b[1],g=a[2]-b[2];a=b[4];var h=b[5],k=b[6];b=b[7];var l=a*a+h*h+k*k+b*b,l=l?1/l:0;a=-a*l;h=-h*l;k=-k*l;b*=l;var l=b*e+h*g-k*f,n=b*f+k*e-a*g,p=b*
g+a*f-h*e,e=-a*e-h*f-k*g;c[0]=l*b+e*-a+n*-k-p*-h;c[1]=n*b+e*-h+p*-a-l*-k;c[2]=p*b+e*-k+l*-h-n*-a;c[0]/=d;c[1]/=d;c[2]/=d;return c};a.transform_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[0],g=b[1],h=b[2],k=b[3],l=b[4],n=b[5],p=b[6];b=b[7];for(var r=0;r<e;r+=3){var u=a[r]*k,v=a[r+1]*k,w=a[r+2]*k,B=b*u+n*w-p*v,q=b*v+p*u-l*w,x=b*w+l*v-n*u,u=-l*u-n*v-p*w;c[d+r]=B*b+u*-l+q*-p-x*-n;c[d+r+1]=q*b+u*-n+x*-l-B*-p;c[d+r+2]=x*b+u*-p+B*-n-q*-l;c[d+r]+=f;c[d+r+1]+=g;c[d+r+2]+=h}return c};a.transform_dir_vectors=
function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],h=b[5],k=b[6];b=b[7];for(var l=0;l<e;l+=3){var n=a[l]*f,p=a[l+1]*f,r=a[l+2]*f,u=b*n+h*r-k*p,v=b*p+k*n-g*r,w=b*r+g*p-h*n,n=-g*n-h*p-k*r;c[d+l]=u*b+n*-g+v*-k-w*-h;c[d+l+1]=v*b+n*-h+w*-g-u*-k;c[d+l+2]=w*b+n*-k+u*-h-v*-g}return c};a.transform_dir_vec3=function(a,b,c){var d=b[3],e=b[4],f=b[5],g=b[6];b=b[7];var h=a[0]*d,k=a[1]*d,l=a[2]*d;a=b*h+f*l-g*k;var d=b*k+g*h-e*l,n=b*l+e*k-f*h,h=-e*h-f*k-g*l;c[0]=a*b+h*-e+d*-g-n*-f;c[1]=d*b+h*-f+n*-e-a*-g;c[2]=
n*b+h*-g+a*-f-d*-e;return c};a.transform_tangents=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],h=b[5],k=b[6];b=b[7];for(var l=0;l<e;l+=4){var n=a[l]*f,p=a[l+1]*f,r=a[l+2]*f,u=b*n+h*r-k*p,v=b*p+k*n-g*r,w=b*r+g*p-h*n,n=-g*n-h*p-k*r;c[d+l]=u*b+n*-g+v*-k-w*-h;c[d+l+1]=v*b+n*-h+w*-g-u*-k;c[d+l+2]=w*b+n*-k+u*-h-v*-g;c[d+l+3]=a[l+3]}return c};a.rR=function(a,b,c){b=n(b,f);v.multiply(b,a,c)};a.pF=function(a,b,c,d){d=d||0;b=n(b,f);w.MD(a,b,c,d)};a.translate=function(a,b,c){var d=a[3],e=a[4],f=a[5],
g=a[6],h=a[7],k=b[0]*d,l=b[1]*d,n=b[2]*d;b=h*k+f*n-g*l;var d=h*l+g*k-e*n,p=h*n+e*l-f*k,k=-e*k-f*l-g*n;c[0]=a[0]+b*h+k*-e+d*-g-p*-f;c[1]=a[1]+d*h+k*-f+p*-e-b*-g;c[2]=a[2]+p*h+k*-g+b*-f-d*-e;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.interpolate=function(a,b,c,d){h.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var e=a[3];d[3]=e+c*(b[3]-e);v.slerp(a.subarray(4,8),b.subarray(4,8),c,d.subarray(4,8));return d};a.LT=function(a,b,c,d){var e=a.subarray(0,3),f=b.subarray(0,3),g=
d.subarray(0,3);g[0]=f[0]*(c+1)-e[0]*c;g[1]=f[1]*(c+1)-e[1]*c;g[2]=f[2]*(c+1)-e[2]*c;d[3]=b[3]*(c+1)-a[3]*c;a=a.subarray(4,8);b=b.subarray(4,8);e=d.subarray(4,8);e[0]=b[0]*(c+1)-a[0]*c;e[1]=b[1]*(c+1)-a[1]*c;e[2]=b[2]*(c+1)-a[2]*c;e[3]=b[3]*(c+1)-a[3]*c;v.normalize(e,e);return d};a.JN=function(a,b,c,d,e){e[0]=a[0]+b*c[0];e[1]=a[1]+b*c[1];e[2]=a[2]+b*c[2];e[3]=a[3];c=d[0];var f=d[1];d=d[2];var g=a[4],h=a[5],k=a[6],l=a[7];e[4]=.5*(c*l+f*k-d*h);e[5]=.5*(f*l+d*g-c*k);e[6]=.5*(d*l+c*h-f*g);e[7]=.5*(-c*
g-f*h-d*k);e[4]=a[4]+e[4]*b;e[5]=a[5]+e[5]*b;e[6]=a[6]+e[6]*b;e[7]=a[7]+e[7]*b;a=e[4];b=e[5];c=e[6];f=e[7];a=a*a+b*b+c*c+f*f;0<a&&(a=1/Math.sqrt(a),e[4]*=a,e[5]*=a,e[6]*=a,e[7]*=a)};a.eV=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];var c=a[4],d=a[5],e=a[6],f=a[7];b[4]=c*x+f*l;b[5]=d*x+e*l;b[6]=e*x-d*l;b[7]=f*x-c*l};a.dV=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__util=function(a,q){function d(a){return 0<a?1:0>a?-1:0}function c(a,b,c){var d=a[0],e=a[1];a=a[2];var f=Math.cos(d/2),g=Math.cos(e/2),h=Math.cos(a/2),k=Math.sin(d/2),e=Math.sin(e/2),m=Math.sin(a/2);if(-1<M.indexOf(b))var l=Math.cos((d+a)/2),n=Math.sin((d+a)/2),p=Math.cos((d-a)/2),t=Math.sin((d-a)/2),r=Math.cos((a-d)/2),u=Math.sin((a-d)/2);switch(b){case 0:c[0]=g*n;c[1]=e*p;c[2]=e*t;c[3]=g*l;break;case 1:c[0]=e*t;c[1]=g*n;c[2]=e*p;c[3]=g*l;break;case 2:c[0]=e*p;c[1]=e*t;c[2]=g*n;c[3]=
g*l;break;case 3:c[0]=g*n;c[1]=e*u;c[2]=e*r;c[3]=g*l;break;case 4:c[0]=e*r;c[1]=g*n;c[2]=e*u;c[3]=g*l;break;case 5:c[0]=e*u;c[1]=e*r;c[2]=g*n;c[3]=g*l;break;case 6:c[0]=k*g*h+f*e*m;c[1]=f*e*h-k*g*m;c[2]=f*g*m+k*e*h;c[3]=f*g*h-k*e*m;break;case 7:c[0]=f*g*m+k*e*h;c[1]=k*g*h+f*e*m;c[2]=f*e*h-k*g*m;c[3]=f*g*h-k*e*m;break;case 8:c[0]=f*e*h-k*g*m;c[1]=f*g*m+k*e*h;c[2]=k*g*h+f*e*m;c[3]=f*g*h-k*e*m;break;case 9:c[0]=k*g*h-f*e*m;c[1]=f*g*m-k*e*h;c[2]=f*e*h+k*g*m;c[3]=f*g*h+k*e*m;break;case 10:c[0]=f*e*h+k*
g*m;c[1]=k*g*h-f*e*m;c[2]=f*g*m-k*e*h;c[3]=f*g*h+k*e*m;break;case 11:c[0]=f*g*m-k*e*h,c[1]=f*e*h+k*g*m,c[2]=k*g*h-f*e*m,c[3]=f*g*h+k*e*m}return c}function b(a,b,c){var d=a[0],e=a[1],f=a[2];a=a[3];switch(b){case 0:c[0]=Math.atan2(d*e+f*a,e*a-d*f);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*e-f*a,d*f+e*a);break;case 1:c[0]=Math.atan2(d*a+e*f,f*a-d*e);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(e*f-d*a,d*e+f*a);break;case 2:c[0]=Math.atan2(d*f+e*a,d*a-e*f);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=Math.atan2(d*
f-e*a,d*a+e*f);break;case 3:c[0]=Math.atan2(d*f-e*a,d*e+f*a);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*f+e*a,f*a-d*e);break;case 4:c[0]=Math.atan2(d*e-f*a,d*a+e*f);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(d*e+f*a,d*a-e*f);break;case 5:c[0]=Math.atan2(e*f-d*a,d*f+e*a);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=Math.atan2(d*a+e*f,e*a-d*f);break;case 6:c[0]=Math.atan2(2*(d*a-e*f),1-2*(d*d+e*e));c[1]=Math.asin(2*(d*f+e*a));c[2]=Math.atan2(2*(f*a-d*e),1-2*(e*e+f*f));break;case 7:b=d*e+f*a;.499999<b?
(c[0]=0,c[1]=Math.PI/2,c[2]=2*Math.atan2(d,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=-2*Math.atan2(d,a)):(c[0]=Math.atan2(2*(e*a-d*f),1-2*(e*e+f*f)),c[1]=Math.asin(2*(d*e+f*a)),c[2]=Math.atan2(2*(d*a-e*f),1-2*(d*d+f*f)));break;case 8:c[0]=Math.atan2(2*(f*a-d*e),1-2*(d*d+f*f));c[1]=Math.asin(2*(d*a+e*f));c[2]=Math.atan2(2*(e*a-d*f),1-2*(d*d+e*e));break;case 9:c[0]=Math.atan2(2*(d*a+e*f),1-2*(d*d+f*f));c[1]=Math.asin(2*(f*a-d*e));c[2]=Math.atan2(2*(d*f+e*a),1-2*(e*e+f*f));break;case 10:c[0]=Math.atan2(2*
(d*f+e*a),1-2*(d*d+e*e));c[1]=Math.asin(2*(d*a-e*f));c[2]=Math.atan2(2*(d*e+f*a),1-2*(d*d+f*f));break;case 11:b=e*a-d*f,.499999<b?(c[0]=0,c[1]=Math.PI/2,c[2]=-2*Math.atan2(f,a)):-.499999>b?(c[0]=0,c[1]=-Math.PI/2,c[2]=2*Math.atan2(f,a)):(c[0]=Math.atan2(2*(d*e+f*a),1-2*(e*e+f*f)),c[1]=Math.asin(2*(e*a-d*f)),c[2]=Math.atan2(2*(d*a+e*f),1-2*(d*d+e*e)))}return c}function g(a,b,c){var d=b.length,e=E;e[0]=a[0];e[1]=a[1];e[2]=a[2];y.normalize(e,e);d?(a=ca,a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],b=y.cross(a,
e,K),y.normalize(b,b),y.cross(e,b,a),d=da,d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=e[0],d[4]=e[1],d[5]=e[2],d[6]=b[0],d[7]=b[1],d[8]=b[2],Q.fromMat3(d,c),c[3]=0<c[3]?c[3]+3.1E-5:c[3]-3.1E-5,(0<c[3]&&0>a[3]||0>c[3]&&0<a[3])&&Q.scale(c,-1,c),Q.normalize(c,c)):Q.rotationTo(ra,e,c);return c}function n(a,b){b||(b=new Float32Array(4));t.fromMat4(a,da);var c=da[0],d=da[3],e=da[6],f=da[1],g=da[4],h=da[7],k=da[2],m=da[5],l=da[8],c=Math.sqrt(c*c+d*d+e*e)||1,f=Math.sqrt(f*f+g*g+h*h)||1,k=Math.sqrt(k*k+m*m+l*l)||1;
da[0]/=c;da[3]/=c;da[6]/=c;da[1]/=f;da[4]/=f;da[7]/=f;da[2]/=k;da[5]/=k;da[8]/=k;Q.fromMat3(da,b);Q.normalize(b,b);return b}function B(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=Math.sqrt(b*b+c*c+d*d),f=1/f;a[0]=b*f;a[1]=c*f;a[2]=d*f;a[3]=e*f}function e(a,b){var c=b;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var d in a)c=e(a[d],c);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(d=
0;d<a.length;d++)c=v(a[d],c);break;case Array:for(d=0;d<a.length;d++)c=e(a[d],c);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:c=v(0,c);break;default:u("Wrong object constructor")}else c=v(0,c);return c;case "number":return v(a,c);case "boolean":return v(a|0,c);case "string":return w(a,c);case "function":case "undefined":return v(0,c)}}function v(a,b){var c=b;P[0]=a;c=(c<<5)-c+la[0];c&=c;c=(c<<5)-c+la[1];return c&c}function w(a,
b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),c&=c;return c}function h(a){return(34*a+1)*a%289}function l(a){return a-Math.floor(a)}function x(a){return k((34*a+5)*a)}function k(a){return a-289*Math.floor(a/289)}function f(a){return a-7*Math.floor(a/7)}function F(a,b,c){a<b&&(a=b);a>c&&(a=c);return a}function u(a){a&&I.error.apply(I,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";
}function r(a,b,c){a-=b;c-=b;return b+(a-Math.floor(a/c)*c)}function z(a){return r(a,0,2*Math.PI)}function J(a,b){if(a&&b){var c=a instanceof Array;if(c!=b instanceof Array)return!1;var d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(d!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!D(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var e in a)if(!D(a[e],b[e]))return!1;for(e in b)if(!(e in a))return!1}return!0}return!(a||b)}function D(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return J(a,b);default:return!0}}function H(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var e=a[d];""!=e&&"."!=e&&(".."!=e||!b&&!c.length||c.length&&".."==c[c.length-1]?
c.push(e):c.length&&c.pop())}a=c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}function C(){var a=[{}];a.length=0;return a}var t=q("__mat3"),m=q("__mat4"),A=q("__math"),I=q("__print"),p=q("__tsr"),Q=q("__quat"),y=q("__vec3"),Y=q("__vec4"),R=0,G={},E=new Float32Array(3),W=new Float32Array(3),V=new Float32Array(3),K=new Float32Array(3),ba=new Float32Array(3),oa=new Float32Array(3),X=new Float32Array(3),ha=new Float32Array(3),Z=new Float32Array(4),ca=new Float32Array(4),da=new Float32Array(9),L=new Float32Array(16),
ja=new Float32Array(16),aa=Q.create(),P=new Float64Array(1),la=new Uint32Array(P.buffer),T=new Float32Array([0,0,0,1]),ka=new Float32Array([0,0,0,1,0,0,0,1]),ea=new Float32Array([1,1,1]),Ba=new Float32Array([1,0,0]),ra=new Float32Array([0,1,0]),ta=new Float32Array([0,0,1]),qa=new Float32Array([-1,0,0]),fa=new Float32Array([0,-1,0]),va=new Float32Array([0,0,-1]),M=[0,1,2,4,5],ua=Math.floor(44488.07041494893),na=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,
0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.Tz=new Float32Array([0,0,0]);a.Wl=T;a.ZS=ka;a.Uu=ea;a.AXIS_X=Ba;a.AXIS_Y=ra;a.AXIS_Z=ta;a.AXIS_MX=qa;a.AXIS_MY=fa;a.AXIS_MZ=va;a.XYX=0;a.YZY=1;a.ZXZ=2;a.XZX=3;a.YXY=4;a.ZYZ=5;a.XYZ=6;a.YZX=7;a.ZXY=8;a.XZY=9;a.YXZ=10;a.ZYX=11;a.qG=na;a.Du=1;a.Pn=2;a.Nh=4;a.Az=4;a.Lf=
function(a){return"undefined"!=typeof a};a.keyfind=function(a,b,c){for(var d=[],e=c.length,f=0;f<e;f++){var g=c[f];g[a]==b&&d.push(g)}return d};a.f32=function(a){return new Float32Array(a)};a.qM=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.uR=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.XJ=function(){return 255==(new DataView((new Uint16Array([255])).buffer)).getUint16(0,!0)};a.bJ=function(a,b){var c=[],d=
{},e=b.length,f,g;for(f=0;f<e;f++)d[b[f]]=!0;e=a.length;for(f=0;f<e;f++)g=a[f],g in d&&c.push(g);return c};a.sign=d;a.CU=function(a,b,c){for(var d=c.length,e=0;e<d;e++)if(c[e][a]==b)return!0;return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[a]===b)return e}return null};a.AU=function(a,b,c,d,e){for(var f=0;f<e.length;f++){var g=e[f];if(g[a]==b&&g[c]==d)return g}return null};a.lN=function(a,b){for(var c=0;c<a.length;c++)if(a[c].uuid==b)return c;return-1};a.XI=function(a,
b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.uT=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.nR=function(a,b,c,d){d||(d=new Float32Array(16));m.identity(d);d[12]=a;d[13]=b;d[14]=c};var xa=1;a.sP=function(){xa=(69069*xa+5)%Math.pow(2,32);return Math.round(xa/65536)%32768/32767};a.bR=function(a){xa=a};a.Uf=function(a){var b=a[0]%ua*48271-3399*Math.floor(a[0]/ua);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.Ds=function(a,
b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){var d=E;d[0]=a[2];d[1]=a[1];d[2]=a[0];c(d,11,b);return b};a.ordered_angles_to_quat=c;a.quat_to_ordered_angles=b;a.$L=function(a){var b=t.create(),c=Math.cos(a[0]),d=Math.cos(a[1]),e=Math.cos(a[2]),f=Math.sin(a[0]),g=Math.sin(a[1]);a=Math.sin(a[2]);var h=c*e,k=c*a,m=f*e,l=f*a;b[0]=d*e;b[1]=d*a;b[2]=-g;b[3]=g*m-k;b[4]=g*l+h;b[5]=d*f;b[6]=g*h+l;b[7]=g*k-m;b[8]=d*c;return b};a.quat_to_euler=function(a,c){var d=b(a,11,E);c[0]=
d[2];c[1]=d[1];c[2]=d[0];return c};a.quat_to_dir=function(a,b,c){c||(c=new Float32Array(3));y.transformQuat(b,a,c);return c};a.dir_to_quat=function(a,b,c){c||(c=new Float32Array(4));a=y.normalize(a,E);var d=y.dot(b,a);a=y.cross(b,a,V);d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.oR=function(a,b,c,d){d||(d=new Float32Array(4));y.transformQuat(c,b,d);d[3]=-y.dot(a,d)};a.JL=function(a){var b=p.get_quat_view(a.o.v),c=E;switch(a.type){case "CAMERA":c[0]=
0;c[1]=-1;c[2]=0;y.transformQuat(c,b,c);V[0]=0;V[1]=0;V[2]=-1;break;case "MESH":c[0]=0;c[1]=0;c[2]=1;y.transformQuat(c,b,c);V[0]=0;V[1]=0;V[2]=1;break;case "EMPTY":c[0]=0,c[1]=1,c[2]=0,y.transformQuat(c,b,c),V[0]=0,V[1]=1,V[2]=0}c[1]=0;y.normalize(c,c);a=y.dot(c,V);return Math.acos(a)*(0<-c[0]*V[2]?-1:1)};a.yA=function(a,b,c,d){if(0!=c){d=d||[];for(var e=0;e<a.length;e++)d[e]=(1-c)*a[e]+c*b[e]}};a.uF=function(){R++;return R.toString(10)};a.tq=function(a){G[a]||(G[a]=0);var b=a+G[a];G[a]++;return b};
a.rg=function(){return{a_position:new Float32Array(0),a_tbn_quat:new Float32Array(0)}};a.gen_tbn_quats=function(a,b,c){b=b||C();var d=b.length,e=a.length/3;c=c||new Float32Array(4*e);for(var f=0;f<e;++f){var h=E;h[0]=a[3*f];h[1]=a[3*f+1];h[2]=a[3*f+2];var k;d?(k=ca,k[0]=b[4*f],k[1]=b[4*f+1],k[2]=b[4*f+2],k[3]=b[4*f+3]):k=b;g(h,k,c.subarray(4*f,4*(f+1)))}return c};a.lC=g;a.bh=function(a){return JSON.parse(JSON.stringify(a))};a.S=function(b){if(!(b instanceof Object))return b;var c;c=b.constructor;
switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:c=new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.S(b[d]);break;default:for(d in c=new c,b)c[d]=a.S(b[d])}return c};a.zo=function(a){var b=a instanceof Array?[]:{},c;for(c in a)if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[c]=
new d(a[c]);break;case Array:b[c]=a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.matrix_to_quat=n;a.jx=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.dD=function(a){Z[0]=.577350269189626;Z[1]=.577350269189626;Z[2]=.577350269189626;Z[3]=0;Y.transformMat4(Z,a,Z);return Y.length(Z)};a.om=function(a,b){var c=b.left,d=b.right,e=b.top,f=b.bottom,g=b.near,h=b.far;c[0]=a[3]+a[0];c[1]=a[7]+a[4];c[2]=a[11]+a[8];c[3]=a[15]+a[12];d[0]=a[3]-a[0];d[1]=a[7]-
a[4];d[2]=a[11]-a[8];d[3]=a[15]-a[12];e[0]=a[3]-a[1];e[1]=a[7]-a[5];e[2]=a[11]-a[9];e[3]=a[15]-a[13];f[0]=a[3]+a[1];f[1]=a[7]+a[5];f[2]=a[11]+a[9];f[3]=a[15]+a[13];g[0]=a[3]+a[2];g[1]=a[7]+a[6];g[2]=a[11]+a[10];g[3]=a[15]+a[14];h[0]=a[3]-a[2];h[1]=a[7]-a[6];h[2]=a[11]-a[10];h[3]=a[15]-a[14];B(c);B(d);B(e);B(f);B(g);B(h)};a.XQ=function(a,b,c){return c<-A.point_plane_dist(a,b.near)||c<-A.point_plane_dist(a,b.left)||c<-A.point_plane_dist(a,b.right)||c<-A.point_plane_dist(a,b.top)||c<-A.point_plane_dist(a,
b.bottom)||c<-A.point_plane_dist(a,b.far)?!0:!1};a.VL=function(a,b,c,d,e){var f=y.dot(c,b.far),g=y.dot(d,b.far),h=y.dot(e,b.far),f=Math.sqrt(f*f+g*g+h*h);if(f<-A.point_plane_dist(a,b.near)||f<-A.point_plane_dist(a,b.far))return!0;f=y.dot(c,b.left);g=y.dot(d,b.left);h=y.dot(e,b.left);if(Math.sqrt(f*f+g*g+h*h)<-A.point_plane_dist(a,b.left))return!0;f=y.dot(c,b.right);g=y.dot(d,b.right);h=y.dot(e,b.right);if(Math.sqrt(f*f+g*g+h*h)<-A.point_plane_dist(a,b.right))return!0;f=y.dot(c,b.top);g=y.dot(d,b.top);
h=y.dot(e,b.top);if(Math.sqrt(f*f+g*g+h*h)<-A.point_plane_dist(a,b.top))return!0;f=y.dot(c,b.bottom);g=y.dot(d,b.bottom);h=y.dot(e,b.bottom);return Math.sqrt(f*f+g*g+h*h)<-A.point_plane_dist(a,b.bottom)?!0:!1};a.Um=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k+b[12];c[d+f+1]=b[1]*g+b[5]*h+b[9]*k+b[13];c[d+f+2]=b[2]*g+b[6]*h+b[10]*k+b[14]}};a.lV=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+
2];c[d+f]=b[0]*g+b[4]*h+b[8]*k;c[d+f+1]=b[1]*g+b[5]*h+b[9]*k;c[d+f+2]=b[2]*g+b[6]*h+b[10]*k}return c};a.MD=function(a,b,c,d){d=d||0;for(var e=a.length,f=0;f<e;f+=4){aa[0]=a[f];aa[1]=a[f+1];aa[2]=a[f+2];aa[3]=a[f+3];var g=0<aa[3];Q.multiply(b,aa,aa);(g&&0>aa[3]||!g&&0<aa[3])&&Y.scale(aa,-1,aa);c[d+f]=aa[0];c[d+f+1]=aa[1];c[d+f+2]=aa[2];c[d+f+3]=aa[3]}};a.nS=function(a,b,c){c||(c=new Float32Array(3));Z[0]=a[0];Z[1]=a[1];Z[2]=a[2];Z[3]=0;Y.transformMat4(Z,b,Z);c[0]=Z[0];c[1]=Z[1];c[2]=Z[2]};a.NT=function(a,
b){var c=a.length;c||u("flatten(): Wrong or empty array");var d=a[0].length;d||u("flatten(): Wrong or empty subarray");b||(b=new Float32Array(c*d));for(var e=0;e<c;e++)for(var f=0;f<d;f++)b[e*d+f]=a[e][f];return b};a.oS=function(a){for(var b=[],c=0;c<a.length;c+=3)b[c/3]=new Float32Array([a[c],a[c+1],a[c+2]]);return b};a.lr=function(b,c,d,e){if(e<d)return d;var f=d+Math.floor((e-d)/2);return b[f]>c?a.lr(b,c,d,f-1):b[f]<c?a.lr(b,c,f+1,e):f};a.$i=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;
return!0};a.xT=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.QU=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.qR=function(a,b,c,d,e){e||(e=new Float32Array(16));b=m.fromRotationTranslation(c,d,L);m.multiply(b,a,e);return e};a.transform_vec3=function(a,b,c,d,e){e||(e=new Float32Array(3));c=m.fromRotationTranslation(c,d,L);1!==b&&(d=m.identity(ja),b=y.set(b,b,b,E),m.scale(d,
b,d),m.multiply(c,d,c));y.transformMat4(a,c,e);return e};a.gV=function(a,b,c,d,e){e||(e=new Float32Array(4));b=m.fromRotationTranslation(c,d,L);Y.transformMat4(a,b,e);return e};a.uU=function(a,b,c,d,e){e||(e=new Float32Array(3));b=m.fromRotationTranslation(c,d,L);m.invert(b,b);y.transformMat4(a,b,e);return e};a.fV=function(a,b,c){c||(c=new Float32Array(16));m.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.HU=function(b,c,d){a.jx(b,c);c[3]=a.dD(b);n(b,d)};a.iT=function(a){for(var b=
[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.PP=function(a,b,c,d){d||(d=new Float32Array(3));var e=E;y.subtract(b,a,e);y.transformQuat(e,c,e);y.subtract(b,e,d)};a.GM=function(){var a=E;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16),g=new Float32Array(16);m.lookAt(a,[-1,0,0],[0,-1,0],b);m.scale(b,[-1,1,1],b);m.scale(b,[-1,1,-1],c);m.lookAt(a,[0,-1,0],[0,0,-1],d);m.scale(d,[1,1,-1],d);m.scale(d,
[1,-1,-1],e);m.lookAt(a,[0,0,-1],[0,-1,0],f);m.scale(f,[-1,1,1],f);m.scale(f,[-1,1,-1],g);return[b,c,d,e,f,g]};a.KM=function(){var a=E;a[0]=0;a[1]=0;a[2]=0;var b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16),g=new Float32Array(16);m.lookAt(a,[1,0,0],[0,-1,0],b);m.scale(b,[-1,1,-1],c);m.lookAt(a,[0,1,0],[0,0,1],d);m.scale(d,[1,-1,-1],e);m.lookAt(a,[0,0,1],[0,-1,0],f);m.scale(f,[-1,1,-1],g);return[b,c,d,e,f,g]};a.HJ=function(a){return e(a,
0)};a.hash_code=e;a.pU=w;a.BO=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.deg_to_rad=function(a){return a*
Math.PI/180};a.rad_to_deg=function(a){return 180*a/Math.PI};a.wy=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),e=.211324865405187*c+.211324865405187*d,b=a[0]-c+e;a=a[1]-d+e;var f=b>a?1:0,g=1-f,e=b+.211324865405187-f,k=a+.211324865405187-g,m=b+-.577350269189626,n=a+-.577350269189626,c=c%289,d=d%289,p=Math.max(.5-(b*b+a*a),0),t=Math.max(.5-(e*e+k*k),0),r=Math.max(.5-(m*m+n*n),0),u=2*l(.024390243902439*h(h(d)+c))-1,f=2*l(.024390243902439*h(h(d+
g)+c+f))-1,v=2*l(.024390243902439*h(h(d+1)+c+1))-1,c=Math.abs(u)-.5,d=Math.abs(f)-.5,g=Math.abs(v)-.5,u=u-Math.floor(u+.5),f=f-Math.floor(f+.5),v=v-Math.floor(v+.5);return 130*(p*p*p*p*(1.79284291400159-.85373472095314*(u*u+c*c))*(u*b+c*a)+t*t*t*t*(1.79284291400159-.85373472095314*(f*f+d*d))*(f*e+d*k)+r*r*r*r*(1.79284291400159-.85373472095314*(v*v+g*g))*(v*m+g*n))};a.NA=function(a){var b=1/7,c=b/2,d=k(Math.floor(a[0])),e=k(Math.floor(a[1])),g=l(a[0]);a=l(a[1]);var h=g-.5,m=g-1.5,g=a-.5;a-=1.5;var n=
x(d),p=x(d+1),t=n,d=p,n=x(n+e),p=x(p+e),t=x(t+e+1),d=x(d+e+1),e=h+.7*(f(n)*b+c),r=m+.7*(f(p)*b+c),h=h+.7*(f(t)*b+c),m=m+.7*(f(d)*b+c),n=g+.7*(f(Math.floor(n*b))*b+c),g=g+.7*(f(Math.floor(p*b))*b+c),t=a+.7*(f(Math.floor(t*b))*b+c),b=a+.7*(f(Math.floor(d*b))*b+c);return Math.min(e*e+n*n,r*r+g*g,h*h+t*t,m*m+b*b)};a.quat_project=function(a,b,c,d,e){e||(e=new Float32Array(4));a=y.transformQuat(b,a,E);b=c[0];var f=c[1];c=c[2];var g=da;g[0]=f*f+c*c;g[1]=-f*b;g[2]=-c*b;g[3]=-b*f;g[4]=b*b+c*c;g[5]=-c*f;g[6]=
-b*c;g[7]=-f*c;g[8]=b*b+f*f;y.transformMat3(a,g,a);y.normalize(a,a);Q.rotationTo(d,a,e);return e};a.cam_quat_to_mesh_quat=function(a,b){b||(b=new Float32Array(4));var c,d;c=Q.setAxisAngle([0,0,1],Math.PI,Q.create());d=Q.setAxisAngle([1,0,0],Math.PI/2,Q.create());Q.multiply(c,d,c);Q.multiply(a,c,b);return b};a.cleanup=function(){R=0;G={}};a.clamp=F;a.smooth=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.smooth_v=function(a,b,c,d,e){e||(e=new Float32Array(a.length));c=Math.exp(-c/d);for(d=
0;d<e.length;d++)e[d]=(1-c)*a[d]+c*b[d];return e};a.JE=function(a,b,c,d,e){e||(e=new Float32Array(a.length));Q.slerp(a,b,Math.exp(-c/d),e)};a.Vw=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,b){var c=t.fromQuat(a,da),d=E;d[0]=c[6];d[1]=c[7];d[2]=c[8];d=y.cross(ta,d,d);y.normalize(d,d);var e=c[4];
!b&&0<e&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);V[0]=c[0];V[1]=c[1];V[2]=c[2];y.normalize(V,V);c=ca;Q.rotationTo(V,d,c);Q.multiply(c,a,a)};a.ZB=function(a,b,c,d){c=c*b-.5;d=d*b-.5;var e=c-Math.floor(c),f=d-Math.floor(d);c=Math.floor(c);d=Math.floor(d);var g=b-1;return(a[d*b+c]*(1-e)+a[d*b+Math.min(c+1,g)]*e)*(1-f)+(a[Math.min(d+1,g)*b+c]*(1-e)+a[Math.min(d+1,g)*b+Math.min(c+1,g)]*e)*f};a.xl=function(a){for(var b=0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.WD=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<
c)&&(b[2-c]=1);return b};a.Ym=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.nw=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.gi=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){return a.length?a[Math.floor(Math.random()*a.length)]:null};a.horizontal_direction=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-
b[0];c[1]=a[1]-b[1];c[2]=0;y.normalize(c,c)};a.pR=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1],h=b[2];b=b[3];var k=g*a-h*e,m=h*d-f*a,l=f*e-g*d;c[0]=d+2*k*b+2*(g*l-h*m);c[1]=e+2*m*b+2*(h*k-f*l);c[2]=a+2*l*b+2*(f*m-g*k)};a.assert=function(a){a||u("Assertion failed")};a.D=u;a.angle_wrap_periodic=r;a.angle_wrap_0_2pi=z;a.vw=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.eR=function(a,b){for(var c in a){var d=!0,e=a[c],f=b[c];switch(typeof e){case "number":case "string":case "boolean":d=
e==f;break;case "object":d=J(e,f)}if(!d)return!1}return!0};a.Tx=function(a,b){var c=a[0],d=a[2],e=a[3];b[0]=a[1];b[1]=d;b[2]=e;b[3]=c};a.QB=function(a){a++;132651<a&&I.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;return new Float32Array([b/51,Math.floor(a/51)/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d){Z.set(a);Z[3]=b;a=ca;E[0]=c[3];E[1]=c[4];E[2]=c[5];a.set(E);a[3]=0;a=Y.dot(Z,a);if(0==a)return null;b=ca;y.copy(c,E);b.set(E);b[3]=1;a=-Y.dot(Z,b)/a;d[0]=c[0]+a*c[3];
d[1]=c[1]+a*c[4];d[2]=c[2]+a*c[5];return d};a.rN=function(a,b,c,d){var e=b[0]-a[0],f=c[0]-a[0],g=b[1]-a[1],h=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=g*a-b*h;d[1]=f*b-e*a;d[2]=e*h-g*f;return d};a.zT=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.iy=function(a,b,c){var d=E,e=y.dot(a,b);-.9999999>e?(y.cross(Ba,a,d),1E-6>y.length(d)&&y.cross(ra,a,d),y.normalize(d,d),Q.setAxisAngle(d,Math.PI,c)):(y.cross(a,b,d),c.set(d),c[3]=1+e,Q.normalize(c,c));return c};a.xk=function(a,b,c){if(b==c)return c-
a;a=z(a);b=z(b);c=z(c);b=2*Math.PI-b;c=z(c+b);a=z(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=F(a,b,c));return a*a*(3-2*a)};a.lerp=function(a,b,c){return b+a*(c-b)};a.cJ=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.FT=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};a.SF=function(a,b){for(var c=Math.max(a.length,b.length),e=0;e<c;e++){var f=d((e>=a.length?0:a[e])-(e>=
b.length?0:b[e]));if(f)return f}return 0};a.dk=function(a){return a.join(".")};a.SE=function(a){return a.split(".").map(function(a){return a|0})};a.OE=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2)};a.ex=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.yh=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=H(b[1]),b.join("://")):H(a)};a.vo=function(a){return!!parseInt(a.toString(2).substr(1),2)};a.UL=
function(a,b,c,d){d[0]=a[0];d[1]=b[0];d[2]=c[0];d[3]=a[1];d[4]=b[1];d[5]=c[1];d[6]=a[2];d[7]=b[2];d[8]=c[2];return d};a.dj=C;a.ap=function(a){a=Math.round(32767.5*(a+1)-32768);return F(a?a:0,-32768,32767)};a.XU=function(a){return F((a+32768)/32767.5-1,-1,1)};a.tR=function(a){return F(Math.round(255*a),0,255)};a.iV=function(a){return F(a/255,0,1)};a.ML=function(a,b,c,d){var e=y.subtract(c,b,E),f=y.subtract(d,c,W),g=y.subtract(b,d,V);b=y.subtract(a,b,K);c=y.subtract(a,c,ba);a=y.subtract(a,d,oa);d=y.cross(e,
f,X);if(0<=y.dot(y.cross(d,e,ha),b)&&0<=y.dot(y.cross(d,f,ha),c)&&0<=y.dot(y.cross(d,g,ha),a))return g=y.length(d),f=y.dot(d,b),Math.abs(f/g);e=y.scale(e,F(y.dot(e,b)/y.length(e),0,1),ha);b=y.length(y.subtract(b,e,ha));f=y.scale(f,F(y.dot(f,c)/y.length(f),0,1),ha);f=y.length(y.subtract(c,f,ha));g=y.scale(g,F(y.dot(g,a)/y.length(g),0,1),ha);g=y.length(y.subtract(a,g,ha));return Math.min(Math.min(b,f),g)}};b4w.module.__sfx=function(a,q){function d(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(oa){return z.error('Unable to initialize AudioContext: "'+oa+'". The audio is disabled.'),null}if(b.createGain)return b;z.warn("deprecated WebAudio implementation");return null}z.warn("WebAudio is not supported");return null}function c(a,c,d){var f=a.Y;if("NONE"!=f.behavior){var g=f.loop,h=f.pitch;if(f.src&&(g||0<=d)){f.fv=Math.floor(5E4*Math.random());var k=R.currentTime+c,
k=Math.max(0,k);f.Ge=k;f.state=20;var m=G.Dc;"POSITIONAL"==f.behavior&&"none"==m.Vo&&(f.behavior="BACKGROUND_SOUND");b(a,G.Dc);if("POSITIONAL"==f.behavior||"BACKGROUND_SOUND"==f.behavior){c=R.createBufferSource();c.buffer=f.src;c.playbackRate.value=h;if(g){f.Xb&&f.Xb.disconnect();f.pd&&f.pd.disconnect();c.loop=!0;c.loopStart=f.aD;if(c.loopEnd=f.Ts)d=R.createBufferSource(),d.buffer=f.src,d.playbackRate.value=h,f.pd=d,d.connect(f.kd);c.start(k);f.duration=0}else g=c.buffer?c.buffer.duration:0,d>g?(g=
k+d+f.$e,c.loop=!0,c.start(k),c.stop(g),f.duration=d):(c.loop=!1,c.start(k),f.duration=g);c.connect(f.kd);f.Xb=c;n(f);B(f);e(f)}else"BACKGROUND_MUSIC"==f.behavior&&(D.clear_timeout(f.gv),D.clear_timeout(f.hv),d=function(){var b=a.Y,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.Xb=b.Xb||R.createMediaElementSource(c),b.Xb.connect(b.kd),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?d():f.gv=D.set_timeout(d,1E3*c),g?f.duration=0:f.duration=u(a));v(f,k)}}}function b(a,b){var c=a.Y;if(!c.kd){var d=
H.get_trans_view(a.o.v),e=H.get_quat_view(a.o.v);if(A.at){var f=R.createBiquadFilter();f.type="peaking"}else f=null;var g=R.createGain();switch(c.behavior){case "POSITIONAL":var h=R.createPanner();"string"!=typeof h.panningModel?(h.panningModel=h.EQUALPOWER,h.distanceModel=h.INVERSE_DISTANCE):(h.panningModel="equalpower",h.distanceModel=b.Vo);h.setPosition(d[0],d[1],d[2]);t.copy(d,c.Zw);d=I;C.quat_to_dir(e,C.AXIS_MZ,d);h.setOrientation(d[0],d[1],d[2]);h.refDistance=c.dist_ref;h.maxDistance=c.dist_max;
h.rolloffFactor=c.attenuation;h.coneInnerAngle=c.cB;h.coneOuterAngle=c.dB;h.coneOuterGain=c.eB;var k=R.createGain();k.gain.value=F(c);f?(h.connect(f),f.connect(k)):h.connect(k);k.connect(g);c.kd=h;if(c.Ml){var m=R.createGain();g.connect(m);m.connect(b.kd)}else m=null,g.connect(b.kd);break;case "BACKGROUND_SOUND":h=null;k=R.createGain();k.gain.value=F(c);f?(c.kd=f,f.connect(k)):c.kd=k;k.connect(g);c.Ml?(m=R.createGain(),g.connect(m),m.connect(b.kd)):(m=null,g.connect(b.kd));break;case "BACKGROUND_MUSIC":m=
h=null,k=R.createGain(),k.gain.value=F(c),f?(c.kd=f,f.connect(k)):c.kd=k,k.connect(g),g.connect(b.kd)}c.Kx=h;c.yg=f;c.wm=k;c.ij=g;c.Vx=m}}function g(a){var b=a.Y;c(a,b.delay+b.xB*Math.random(),b.duration)}function n(a){var b=a.pd||a.Xb;C.Lf(b.onended)&&(b.onended=function(){a.state=50})}function B(a){a.Ml&&a.Vx.gain.cancelScheduledValues(a.Ge);a.Tm&&(a.Xb.playbackRate.cancelScheduledValues(a.Ge),a.pd&&a.pd.playbackRate.cancelScheduledValues(a.Ge));a.Iq=a.Ge}function e(a){if(a.Ml||a.Tm){var b=a.Vx,
c=a.Xb,d=c.buffer?c.buffer.duration:0;if(d){var e=a.Ge;W[0]=a.fv;for(var f=0;5>f;){var g=a.pitch+a.Tm*C.Uf(W);if(e>=a.Iq){if(a.Ml){var h=1-C.clamp(a.Ml,0,1)*Math.random();b.gain.setValueAtTime(h,e)}a.Tm&&(c.playbackRate.setValueAtTime(g,e),a.pd&&a.pd.playbackRate.setValueAtTime(g,e));f++}e+=d/g}a.Iq=e-.001}}}function v(a,b){if(a.Nk||a.$e){var c=a.ij;c.gain.cancelScheduledValues(b);a.Nk?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.Nk)):c.gain.setValueAtTime(1,b);a.$e&&!a.loop&&
(c.gain.setValueAtTime(1,b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.$e))}}function w(a){"SPEAKER"!=a.type&&C.D("Wrong object type");var b=a.Y;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.ij,d=R.currentTime;b.$e&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.$e));"BACKGROUND_MUSIC"==b.behavior?b.src&&(D.clear_timeout(b.gv),D.clear_timeout(b.hv),b.hv=D.set_timeout(function(){var b=a.Y.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},
1E3*b.$e)):(c=b.Xb,b.duration<c.buffer.duration?b.$e&&20==b.state?c.stop(d+b.$e):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.Ge=0,b.Lx=0,b.pr=0);b.state=30}}function h(a){a=a.Y;if(20==a.state){var b=R.currentTime;a.Lx=b;"BACKGROUND_MUSIC"==a.behavior?(b=a.src)&&b.pause():(b>a.Ge?a.pr=l(a,b):a.pr=0,a.Xb.onended=function(){},a.Xb.stop(0),a.Xb.disconnect(),B(a));a.state=40}}function l(a,b){W[0]=a.fv;for(var c=a.Xb.buffer.duration,d=a.Ge,e;d<b;)e=a.pitch+a.Tm*C.Uf(W),d+=c/e;return(c/e-(d-
b))*e}function x(a){var b=a.Y;if(40==b.state){var c=R.currentTime;b.Ge+=c-b.Lx;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();else{a=a.Y;var d=R.createBufferSource();d.loop=a.Xb.loop;d.loopStart=a.Xb.loopStart;d.loopEnd=a.Xb.loopEnd;d.buffer=a.Xb.buffer;d.playbackRate.value=a.Xb.playbackRate.value;d.connect(a.kd);a.Xb=d;a.pd&&(d=R.createBufferSource(),d.loop=a.pd.loop,d.buffer=a.pd.buffer,d.playbackRate.value=a.pd.playbackRate.value,d.connect(a.kd),a.pd=d);b.Iq=c;c=b.Xb;n(b);c.start(b.Ge,b.pr);e(b)}v(b,
b.Ge);b.state=20}}function k(a,b,c){var d;d=b.NL;if(0<d){var e=b.WQ;if(0!=t.dot(a.pu,a.pu)||0!=t.dot(b.fl,b.fl)){var f=t.subtract(a.Zw,b.uh,I),g=t.length(f);b=t.dot(f,b.fl)/g;f=t.dot(f,a.pu)/g;g=e/d;b=Math.min(-b,g);f=Math.min(-f,g);d=(e-d*b)/(e-d*f);isFinite(d)||(d=0);d=Math.min(d,16);d=Math.max(d,.125);d=C.smooth(d,a.TC,c,.3);a.Xb.playbackRate.value=d;a.TC=d}}}function f(a){a=a.Y;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function F(a){return a.muted?0:a.volume}function u(a){a=
a.Y;return(a=a.src)?a.duration:0}var r=q("__config"),z=q("__print"),J=q("__quat"),D=q("__time"),H=q("__tsr"),C=q("__util"),t=q("__vec3"),m=r.H,A=r.Y,I=new Float32Array(3),p=new Float32Array(3),Q=J.create(),y=[],Y=[],R=null,G=null,E=[],W=[1],V=null;a.vz=10;a.Cu=20;a.uz=30;a.TK=function(){return{Oi:-1,xg:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,cB:360,dB:360,eB:1,autoplay:!1,cyclic:!1,loop:!1,aD:0,Ts:0,delay:0,xB:0,Ml:0,Tm:0,Nk:0,$e:0,Ge:0,Lx:0,pr:0,duration:0,
Iq:0,fv:1,src:null,state:10,Zw:new Float32Array(3),pu:new Float32Array(3),Sr:!1,TC:1,gv:-1,hv:-1,Mk:0,kd:null,Xb:null,pd:null,Kx:null,yg:null,wm:null,ij:null,Vx:null,ak:0}};a.init=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(y.push("ogg"),y.push("ogv"),y.push("oga")),""!=a.canPlayType("audio/mpeg")&&y.push("mp3"),""!=a.canPlayType("audio/mp4")&&(y.push("mp4"),y.push("m4v"),y.push("m4a")),""!=a.canPlayType("audio/webm")&&
y.push("webm"));b.canPlayType&&(""!=b.canPlayType("video/ogg")&&(Y.push("ogv"),Y.push("ogg"),Y.push("oga")),""!=b.canPlayType("video/mp4")&&(Y.push("m4v"),Y.push("mp4")),""!=b.canPlayType("video/webm")&&Y.push("webm"),""!=b.canPlayType("video/mpeg")&&Y.push("mp3"))};a.iJ=function(a){A.nz&&!R&&(R=d())&&z.log("%cINIT WEBAUDIO: "+R.sampleRate+"Hz","color: #00a");if(R){var b={uh:new Float32Array(3),fl:new Float32Array(3),ak:0},c=R.createGain(),e=R.createGain();b.wm=c;b.ij=e;c.connect(e);e.connect(R.destination);
if(a.b4w_enable_dynamic_compressor){var e=R.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;e.threshold.value=f.threshold;e.knee.value=f.knee;e.ratio.value=f.ratio;e.attack.value=f.attack;e.release.value=f.release;e.connect(c);b.Jo=e;b.kd=e}else b.Jo=null,b.kd=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.Vo="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.Vo="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.Vo="exponential";break;case "NONE":b.Vo=
"none";break;default:C.D("Wrong audio distance model")}b.NL=a.audio_doppler_factor;b.WQ=a.audio_doppler_speed;b.muted=!1;b.volume=a.audio_volume;c.gain.value=F(b);b.Mk=0}else b=null;a.Dc=b};a.ZP=function(a){G=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<y.indexOf(a)?a:-1<y.indexOf("m4a")?"m4a":-1<y.indexOf("oga")?"oga":""};a.detect_video_container=function(a){a||(a="webm");return-1<Y.indexOf(a)?a:-1<Y.indexOf("m4v")?"m4v":-1<Y.indexOf("webm")?"webm":""};a.bk=function(a,b){var c=a.data,
d=b.Y;if(a.data.sound){d.Oi=a.data.sound.uuid;d.xg=a.data.sound.filepath;switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=R?c.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var e;R?(window.MediaElementAudioSourceNode?e=!0:(z.warn("MediaElementAudioSourceNode not found"),e=!1),e=e&&!m.VA?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):e="NONE";d.behavior=e;break;default:C.D("Wrong speaker behavior")}c.sound||(d.behavior="NONE");d.Sr=c.b4w_enable_doppler;d.muted=c.muted;d.volume=
c.volume;d.pitch=c.pitch;d.attenuation=c.attenuation;d.dist_ref=c.distance_reference;d.dist_max=c.distance_max||1E4;d.cB=c.cone_angle_inner;d.dB=c.cone_angle_outer;d.eB=c.cone_volume_outer;d.autoplay=c.b4w_auto_play;d.cyclic=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.aD=c.b4w_loop_start;d.Ts=c.b4w_loop_end;d.delay=c.b4w_delay;d.xB=c.b4w_delay_random;d.Ml=c.b4w_volume_random;d.Tm=c.b4w_pitch_random;d.Nk=c.b4w_fade_in;d.$e=c.b4w_fade_out;E.push(b)}};a.KE=function(b){"SPEAKER"!=b.type&&C.D("Wrong object type");
switch(b.Y.behavior){case "POSITIONAL":return a.Cu;case "BACKGROUND_SOUND":return a.Cu;case "BACKGROUND_MUSIC":return a.uz;case "NONE":return a.vz;default:C.D("Wrong speaker behavior")}};a.ZR=function(a,b){var c=a.Y;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:C.D("Wrong speaker behavior")}};a.ED=function(){var a=R.createBufferSource();a.buffer=R.createBuffer(1,22050,22050);a.connect(R.destination);a.start(0)};a.GL=function(a,
b,c){R?R.decodeAudioData(a,b,c):c()};a.TQ=function(a){w(a);a.Y=null;E.splice(E.indexOf(a),1)};a.cleanup=function(){for(var a=0;a<E.length;a++){var b=E[a].Y;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():(b.Xb&&b.Xb.disconnect(),b.pd&&b.pd.disconnect())}G&&G.Dc&&(a=G.Dc,a.uh[0]=0,a.uh[1]=0,a.uh[2]=0,a.fl[0]=0,a.fl[1]=0,a.fl[2]=0);G=null;E.splice(0);V=null};a.update=function(a){if(R&&E.length){for(var b=0;b<E.length;b++){var c=E[b],d=c.Y,f=d.Xb,h=R.currentTime;!d.loop&&20==d.state&&d.duration&&
d.Ge+d.duration<h&&("BACKGROUND_MUSIC"==d.behavior||f&&!C.Lf(f.onended))&&(d.state=50);d.cyclic&&50==d.state&&g(c);20==d.state&&3>d.Iq-h&&e(d)}V&&V.Ci.length&&(-1==V.active||a>V.aA+V.BB[V.active])&&(b=V,-1<b.active&&w(b.Ci[b.active]),c=-1==b.active&&b.random?Math.round(Math.random()*(b.Ci.length-1)):b.random?(b.active+(1+Math.round(Math.random()*(b.Ci.length-2))))%b.Ci.length:(b.active+1)%b.Ci.length,g(b.Ci[c]),b.active=c,b.aA=a)}};a.play=c;a.play_def=g;a.stop=w;a.is_playing=function(a){return 20==
a.Y.state};a.SQ=h;a.UQ=x;a.loop_stop=function(a,b){var c=a.Y,d=c.pd;if(f(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==c.behavior)&&d){var e=R.currentTime+b;c.Xb.stop(e);d.start(e,c.Ts)}};a.playrate=function(a,b){var c=a.Y;c.pitch=b;!f(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.Xb.playbackRate.value=b,c.pd&&(c.pd.playbackRate.value=b),B(c),e(c))};a.get_playrate=function(a){return a.Y.pitch};a.cyclic=function(a,b){a.Y.cyclic=!!b};a.KN=function(a){return a.Y.autoplay};a.is_cyclic=
function(a){return a.Y.cyclic};a.qO=function(a,b,c,d,e){if(a=a.Dc){var g=I;g[0]=0;g[1]=0;g[2]=-1;t.transformQuat(g,c,g);p[0]=0;p[1]=1;p[2]=0;t.transformQuat(p,c,p);c=R.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(g[0],g[1],g[2],p[0],p[1],p[2]);if(d&&a.ak!=e){if(a.listener_stride)a.listener_stride=!1,t.copy(b,a.uh);else for(c=a.fl,c[0]=(b[0]-a.uh[0])/d,c[1]=(b[1]-a.uh[1])/d,c[2]=(b[2]-a.uh[2])/d,t.copy(b,a.uh),b=0;b<E.length;b++)c=E[b],g=c.Y,f(c)&&"POSITIONAL"==g.behavior&&g.Sr&&k(g,a,d);
a.ak=e}else t.copy(b,a.uh)}};a.listener_stride=function(){var a=G.Dc;a&&(a.listener_stride=!0)};a.VQ=function(a,b,c){var d=a.Y;if(f(a)&&"POSITIONAL"==d.behavior){var e=H.ec(a.o.v,I);a=H.Qc(a.o.v,Q);var g=d.Kx;g.setPosition(e[0],e[1],e[2]);C.quat_to_dir(a,C.AXIS_MZ,p);g.setOrientation(p[0],p[1],p[2]);d.Sr&&(a=d.Zw,b&&d.ak!=c?(d.Fi?(t.copy(e,a),d.Fi=!1):(g=d.pu,g[0]=(e[0]-a[0])/b,g[1]=(e[1]-a[1])/b,g[2]=(e[2]-a[2])/b,t.copy(e,a),k(d,G.Dc,b)),d.ak=c):t.copy(e,a))}};a.speaker_stride=function(a){var b=
a.Y;f(a)&&"POSITIONAL"==b.behavior&&b.Sr&&(b.Fi=!0)};a.Aw=function(a){return a.Y.behavior};a.check_active_speakers=function(){for(var a=0;a<E.length;a++)if(f(E[a]))return!0;return!1};a.sQ=function(a){var b=G.Dc;b&&(b.volume=a,R&&(b.wm.gain.value=F(b)))};a.oN=function(){var a=G.Dc;return a?a.volume:0};a.set_volume=function(a,b){var c=a.Y;c.volume=b;f(a)&&(c.wm.gain.value=F(c))};a.get_volume=function(a){return a.Y.volume};a.mute=function(a,b){a.Y.muted=!!b;f(a)&&(a.Y.wm.gain.value=F(a.Y))};a.is_muted=
function(a){return a.Y.muted};a.OO=function(a){var b=G.Dc;b&&(b.muted=!!a,R&&(b.wm.gain.value=F(b)))};a.SN=function(){var a=G.Dc;return a?a.muted:!1};a.get_speaker_objects=function(){return E};a.pause=function(){for(var a=0;a<E.length;a++)h(E[a])};a.resume=function(){for(var a=0;a<E.length;a++)x(E[a])};a.set_compressor_params=function(a,b){if(a.Dc&&a.Dc.Jo){var c=a.Dc.Jo;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};a.get_compressor_params=
function(a){if(!a.Dc||!a.Dc.Jo)return null;a=a.Dc.Jo;return{threshold:a.threshold.value,knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(f(a)){a=a.Y;var d=a.ij,e=R.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,e+c);a.Mk=c}};a.unduck=function(a){if(f(a)){a=a.Y;var b=a.ij,c=R.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Mk);a.Mk=0}};a.QL=function(a,b){if(R){var c=
G.Dc,d=c.ij,e=R.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(a,e+b);c.Mk=b}};a.vR=function(){if(R){var a=G.Dc,b=a.ij,c=R.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Mk);a.Mk=0}};a.apply_playlist=function(a,b,c){V={active:-1,aA:0,random:c,Ci:[],BB:[]};for(c=0;c<a.length;c++){var d=a[c],e=u(d);0==e?z.warn("Ignoring speaker with zero duration: "+d.name):(w(d),d.Y.cyclic=!1,V.Ci.push(d),V.BB.push(e+b))}};a.get_duration=u;a.clear_playlist=
function(){if(V)for(var a=V.Ci,b=0;b<a.length;b++)w(a[b]);V=null};a.get_positional_params=function(a){return(a=a.Y)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.Y;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var d=c.Kx;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=function(a,b){var c=
a.Y;c&&c.yg&&(c.yg.frequency.value=b.freq,c.yg.Q.value=b.Q,c.yg.gain.value=b.gain)};a.get_filter_params=function(a){return(a=a.Y)&&a.yg?{freq:a.yg.frequency.value,Q:a.yg.Q.value,gain:a.yg.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.Y;if(!a||!a.yg)return null;a.yg.getFrequencyResponse(b,c,d)};a.reset=function(){y.length=0;Y.length=0;R=null}};b4w.module.__input=function(a,q){function d(a){var b=W.detect_mobile();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b&&E())&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function c(a,b){if(!d(a))return null;var c={type:a,lf:!1,Tf:[],Hg:[],ri:[],Ad:[],si:[],ti:[],wp:[],QC:[],mi:[],Li:[],Ki:[],Ji:[],element:b,Bh:!0,Ob:[],et:new Float32Array(2),MO:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),Yp:null,Pl:null,Mh:null,Uc:null,orientation:X.create(),
position:Z.create(),kh:window.VRFrameData?new VRFrameData:null,ei:new Float32Array(4),fi:new Float32Array(4),Kf:0,Yg:0,$p:0,hk:0,qh:0,Zg:0,Rk:[],kj:[0,0,0,0,0,0,0,0,0,0,0,0],OB:[0,0,0,0,0,0,0,0,0,0,0,0],ds:[]};c.ei[0]=c.ei[1]=c.ei[2]=c.ei[3]=Math.PI/4;c.fi[0]=c.fi[1]=c.fi[2]=c.fi[3]=Math.PI/4;30==a||40==a||50==a?(c.lf=!!b,50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.Bh=!1)):10==a?c.lf=!0:20==a&&g(c);return c}function b(b,d){10==b||20==b?d=window:d||(40==b?d=document:d=V.get_container());
for(var e=0;e<Ba.length;e++)if(Ba[e].type==b&&Ba[e].element==d)return Ba[e];e=c(b,d);60!=b&&70!=b&&80!=b&&90!=b||e.ds.push(a.GMPD_BUTTON_0,a.GMPD_BUTTON_1,a.GMPD_BUTTON_2,a.GMPD_BUTTON_3,a.GMPD_BUTTON_4,a.GMPD_BUTTON_5,a.GMPD_BUTTON_6,a.GMPD_BUTTON_7,a.GMPD_BUTTON_8,a.GMPD_BUTTON_9,a.GMPD_BUTTON_10,a.GMPD_BUTTON_11,a.GMPD_BUTTON_12,a.GMPD_BUTTON_13,a.GMPD_BUTTON_14,a.GMPD_BUTTON_15,a.GMPD_BUTTON_16,a.GMPD_BUTTON_17,a.GMPD_BUTTON_18,a.GMPD_BUTTON_19,a.GMPD_BUTTON_20,a.GMPD_BUTTON_21,a.GMPD_BUTTON_22,
a.GMPD_BUTTON_23,a.GMPD_BUTTON_24,a.GMPD_BUTTON_25,a.GMPD_AXIS_0,a.GMPD_AXIS_1,a.GMPD_AXIS_2,a.GMPD_AXIS_3,a.GMPD_AXIS_4,a.GMPD_AXIS_5,a.GMPD_AXIS_6,a.GMPD_AXIS_7,a.GMPD_AXIS_8,a.GMPD_AXIS_9,a.GMPD_AXIS_10,a.GMPD_AXIS_11);e&&Ba.push(e);return e}function g(a){20==a.type&&(navigator.getVRDisplays?navigator.getVRDisplays().then(function(b){0<b.length&&(a.Uc=b[0],a.lf=!0,a.Uc.getFrameData(a.kh),a.Yp&&a.Yp())},function(){oa.ja("WebVR displays are not found.");a.lf=!1}):navigator.getVRDevices?(navigator.getVRDevices().then(function(b){v(a,
b);b.length&&(a.lf=!0);a.Yp&&a.Yp()},function(){oa.ja("WebVR devices are not found.");a.lf=!1}),B(a,L.webvr)):(n(a),a.lf=!0))}function n(a){var b=L.nonwebvr;a.hk=b.hk;a.qh=b.qh;a.Zg=b.Zg;B(a,b);a.Kf=b.Kf;a.Yg=b.Yg;a.$p=b.$p;e(a)}function B(a,b){a.distortion_coefs[0]=b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];
a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function e(a){var b=Math.atan(a.Kf/2/a.$p*L.nonwebvr.AB);b&&(a.ei[0]=a.fi[0]=Math.min(b,Math.PI/3));b&&(a.ei[1]=a.fi[3]=Math.min(b,Math.PI/3));b&&(a.ei[2]=a.fi[2]=Math.min(b,Math.PI/3));b&&(a.ei[3]=a.fi[1]=Math.min(b,Math.PI/3))}function v(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),d=null;c.length&&(d=c[0]);c=null;d&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==
d.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.Pl=d;a.Mh=c}function w(a,b,c){switch(a.type){case 20:if(l(a,0)&1)b="left"==b?a.ei:a.fi,ca.copy(b,c);else{if(a=a.Uc||a.Pl)var d=a.getEyeParameters(b);b=d.fieldOfView||d.currentFieldOfView;c[0]=ha.deg_to_rad(b.upDegrees);c[1]=ha.deg_to_rad(b.rightDegrees);c[2]=ha.deg_to_rad(b.downDegrees);c[3]=ha.deg_to_rad(b.leftDegrees)}break;default:oa.error("fov is undefined for device: ",a.type)}return c}function h(a,b,c){switch(a.type){case 20:a.Uc&&("left"==
b?ba.copy(a.kh.leftProjectionMatrix,c):"right"==b?ba.copy(a.kh.rightProjectionMatrix,c):oa.error("Unknown type of eye: ",b));break;default:oa.error("Projection matrix is undefined for device: ",a.type)}return c}function l(a,b){switch(b){case 0:var c=0;navigator.getVRDisplays&&(c|=8,a.kh&&(c|=16));navigator.getVRDevices&&(c=da.is_mobile_device?c|4:c|2);return c||1;case 23:var d=a.Uc||a.Pl;return d?(c=d.getEyeParameters("left"),d=d.getEyeParameters("right"),a.Uc?a.kh?a.Kf:d.offset[0]-c.offset[0]:d.eyeTranslation.x-
c.eyeTranslation.x):a.Kf}}function x(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.Rk[c]=a.buttons[c].value;if(a.axes)for(c=0;c<a.axes.length;c++)b.kj[c]=a.axes[c]}}function k(a){for(var b=0;b<a.Rk;b++)a.Rk[b]=0;for(b=0;b<a.kj.length;b++)a.OB[b]=a.kj[b],a.kj[b]=0}function f(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function F(a){return null===a}function u(a,b,c,d){switch(b){case 130:c&&f(a.Tf,c);if(d||a.Hg.every(F)&&a.Tf.every(F))a.Tf.length=0,a.Hg.length=0,b=a.Ob.indexOf(141),0<=b&&(a.Ob.splice(b,
1),a.element.removeEventListener("deviceorientation",z,!1));break;case 140:c&&f(a.Hg,c);if(d||a.Hg.every(F)&&a.Tf.every(F))a.Tf.length=0,a.Hg.length=0,b=a.Ob.indexOf(141),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("deviceorientation",z,!1));break;case 50:c&&f(a.ri,c);if(d||a.ri.every(F))a.ri.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("mousedown",C,!1));break;case 40:c&&f(a.Ad,c);if(d||a.Ad.every(F))a.Ad.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,
1),a.element.removeEventListener("mousemove",D,!1));break;case 41:c&&f(a.Ad,c);if(d||a.Ad.every(F))a.Ad.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("mousemove",H,!1));break;case 60:c&&f(a.si,c);if(d||a.si.every(F))a.si.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("mouseout",t,!1),a.element.removeEventListener("mouseup",m,!1));break;case 70:c&&f(a.ti,c);if(d||a.ti.every(F))a.ti.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,
1),a.element.removeEventListener("wheel",A,!1));break;case 90:c&&f(a.wp,c);if(d||a.wp.every(F))a.wp.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("keydown",I,!1));break;case 80:c&&f(a.mi,c);if(d||a.mi.every(F))a.mi.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("keyup",p,!1));break;case 100:c&&f(a.Li,c);if(d||a.Li.every(F))a.Li.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("touchstart",Q,!1));break;
case 110:c&&f(a.Ki,c);if(d||a.Ki.every(F))a.Ki.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("touchmove",y,!1));break;case 120:if(c&&f(a.Ji,c),d||a.Ji.every(F))a.Ji.length=0,b=a.Ob.indexOf(b),0<=b&&(a.Ob.splice(b,1),a.element.removeEventListener("touchend",Y,!1))}}function r(a,b){ha.ordered_angles_to_quat(a,ha.ZXY,b);if("orientation"in window)var c=ha.deg_to_rad(window.orientation);else"orientation"in window.screen?c=ha.deg_to_rad(window.screen.orientation.angle):
c=0;c=X.setAxisAngle(ha.AXIS_MZ,c,aa);X.multiply(b,c,b);return b}function z(a){var c=P;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=ha.deg_to_rad(a.alpha),c[1]=ha.deg_to_rad(a.beta),c[2]=ha.deg_to_rad(a.gamma));a=b(10,a.currentTarget);for(var d=0;d<a.Hg.length;d++){var e=a.Hg[d];e&&(Z.copy(c,T),e(T))}if(a.Tf.length)for(c=r(c,ja),d=0;d<a.Tf.length;d++)if(e=a.Tf[d])X.copy(c,ka),e(ka);for(d=0;d<a.Tf.length;d++)a.Tf[d]||a.Tf.splice(d,1);for(d=0;d<a.Hg.length;d++)a.Hg[d]||a.Hg.splice(d,
1)}function J(a,b){switch(a.type){case 30:a.et[0]=b.clientX,a.et[1]=b.clientY,a.MO=b.which}}function D(a){if(!ea||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);J(c,a);for(var d=0;d<c.Ad.length;d++){var e=c.Ad[d];e&&(la[0]=a.clientX,la[1]=a.clientY,e(la))}c.Bh&&a.preventDefault();for(d=0;d<c.Ad.length;d++)c.Ad[d]||c.Ad.splice(d,1)}}function H(a){if(!ea||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=
b(30,a.currentTarget);J(c,a);for(var d=0;d<c.Ad.length;d++){var e=c.Ad[d];if(e){if("number"==typeof a.movementX)var f=a.movementX,g=a.movementY;else"number"==typeof a.webkitMovementX?(f=a.webkitMovementX,g=a.webkitMovementY):"number"==typeof a.mozMovementX?(f=a.mozMovementX,g=a.mozMovementY):g=f=0;la[0]=f;la[1]=g;e(la)}}c.Bh&&a.preventDefault();for(d=0;d<c.Ad.length;d++)c.Ad[d]||c.Ad.splice(d,1)}}function C(a){if(!ea||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=
b(30,a.currentTarget);J(c,a);for(var d=0;d<c.ri.length;d++){var e=c.ri[d];e&&e(a.which)}c.Bh&&a.preventDefault();for(d=0;d<c.ri.length;d++)c.ri[d]||c.ri.splice(d,1)}}function t(a){!V.FC(a.relatedTarget)&&a.which&&m(a)}function m(a){if(!ea||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);J(c,a);for(var d=0;d<c.si.length;d++){var e=c.si[d];e&&e(a.which)}c.Bh&&a.preventDefault();for(d=0;d<c.si.length;d++)c.si[d]||c.si.splice(d,1)}}function A(a){for(var c=
b(30,a.currentTarget),d=0;d<c.ti.length;d++){var e=c.ti[d];e&&e(-a.deltaY)}c.Bh&&a.preventDefault();for(d=0;d<c.ti.length;d++)c.ti[d]||c.ti.splice(d,1)}function I(a){for(var c=b(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.QC:c.wp,e=0;e<d.length;e++){var f=d[e];f?f(a.keyCode):d.splice(e--,1)}c.Bh&&a.preventDefault()}function p(a){for(var c=b(40,a.currentTarget),d=0;d<c.mi.length;d++){var e=c.mi[d];e&&e(a.keyCode)}c.Bh&&a.preventDefault();for(d=0;d<c.mi.length;d++)c.mi[d]||c.mi.splice(d,
1)}function Q(a){for(var c=b(50,a.currentTarget),d=0;d<c.Li.length;d++){var e=c.Li[d];e&&e(a.targetTouches)}for(d=0;d<c.Li.length;d++)c.Li[d]||c.Li.splice(d,1)}function y(a){for(var c=b(50,a.currentTarget),d=0;d<c.Ki.length;d++){var e=c.Ki[d];e&&e(a.targetTouches)}c.Bh&&a.preventDefault();for(d=0;d<c.Ki.length;d++)c.Ki[d]||c.Ki.splice(d,1)}function Y(a){for(var c=b(50,a.currentTarget),d=0;d<c.Ji.length;d++){var e=c.Ji[d];e&&e(a.targetTouches)}for(d=0;d<c.Ji.length;d++)c.Ji[d]||c.Ji.splice(d,1)}function R(a){switch(a){case 0:a=
60;break;case 1:a=70;break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}function G(a){function b(){document.pointerLockElement===c||document.webkitPointerLockElement===c||document.mozPointerLockElement===c?a.value=1:(a.value=0,document.removeEventListener("pointerlockchange",b,!1),document.removeEventListener("webkitpointerlockchange",b,!1),document.removeEventListener("mozpointerlockchange",b,!1))}var c=a.element;document.addEventListener("pointerlockchange",b,!1);document.addEventListener("webkitpointerlockchange",
b,!1);document.addEventListener("mozpointerlockchange",b,!1);var d=c.requestPointerLock||c.webkitRequestPointerLock||c.mozRequestPointerLock;"function"===typeof d&&d.apply(c)}function E(){return window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1}var W=q("__compat"),V=q("__container"),K=q("__config"),ba=q("__mat4"),oa=q("__print"),X=q("__quat"),ha=q("__util"),Z=q("__vec3"),ca=q("__vec4"),da=K.H,
L=K.wC;a.DEVICE_GYRO=10;a.DEVICE_HMD=20;a.DEVICE_MOUSE=30;a.DEVICE_KEYBOARD=40;a.DEVICE_TOUCH=50;a.Nq=60;a.Ju=70;a.Ku=80;a.Lu=90;a.HMD_WEBVR_DESKTOP=2;a.HMD_WEBVR_MOBILE=4;a.HMD_NON_WEBVR=1;a.HMD_WEBVR1=8;a.HMD_WEBVR1_1=16;a.HMD_WEBVR_TYPE=0;a.HMD_ORIENTATION_QUAT=10;a.HMD_POSITION=20;a.yz=21;a.zz=22;a.HMD_EYE_DISTANCE=23;a.HMD_DISTORTION=24;a.HMD_BASELINE_DIST=25;a.HMD_SCREEN_LENSE_DIST=26;a.HMD_SCREEN_WIDTH=27;a.HMD_SCREEN_HEIGHT=28;a.HMD_BEVEL_SIZE=29;a.TS=30;a.US=31;a.MOUSE_LOCATION=40;a.Hz=41;
a.MOUSE_DOWN_WHICH=50;a.MOUSE_UP_WHICH=60;a.MOUSE_WHEEL=70;a.KEYBOARD_UP=80;a.KEYBOARD_DOWN=90;a.Gz=91;a.TOUCH_START=100;a.TOUCH_MOVE=110;a.TOUCH_END=120;a.GYRO_ORIENTATION_QUAT=130;a.GYRO_ORIENTATION_ANGLES=140;a.GMPD_BUTTON_0=300;a.GMPD_BUTTON_1=301;a.GMPD_BUTTON_2=302;a.GMPD_BUTTON_3=303;a.GMPD_BUTTON_4=304;a.GMPD_BUTTON_5=305;a.GMPD_BUTTON_6=306;a.GMPD_BUTTON_7=307;a.GMPD_BUTTON_8=308;a.GMPD_BUTTON_9=309;a.GMPD_BUTTON_10=310;a.GMPD_BUTTON_11=311;a.GMPD_BUTTON_12=312;a.GMPD_BUTTON_13=313;a.GMPD_BUTTON_14=
314;a.GMPD_BUTTON_15=315;a.GMPD_BUTTON_16=316;a.GMPD_BUTTON_17=317;a.GMPD_BUTTON_18=318;a.GMPD_BUTTON_19=319;a.GMPD_BUTTON_20=320;a.GMPD_BUTTON_21=321;a.GMPD_BUTTON_22=322;a.GMPD_BUTTON_23=323;a.GMPD_BUTTON_24=324;a.GMPD_BUTTON_25=325;a.GMPD_AXIS_0=326;a.GMPD_AXIS_1=327;a.GMPD_AXIS_2=328;a.GMPD_AXIS_3=329;a.GMPD_AXIS_4=330;a.GMPD_AXIS_5=331;a.GMPD_AXIS_6=332;a.GMPD_AXIS_7=333;a.GMPD_AXIS_8=334;a.GMPD_AXIS_9=335;a.GMPD_AXIS_10=336;a.GMPD_AXIS_11=337;var ja=X.create(),aa=X.create();ba.create();var P=
Z.create(),la=new Float32Array(2),T=Z.create(),ka=X.create(),ea="ontouchstart"in document.documentElement,Ba=[];a.can_use_device=d;a.init=function(){if("HMD"==da.stereo||"NONE"==da.stereo&&da.is_mobile_device){var a=b(20);a&&document.addEventListener("onvrdisplayconnect",function(b){a.Uc=b.display;a.lf=!0;a.Uc.getFrameData(a.kh)})}};a.get_device_by_type_element=b;a.JP=g;a.switch_prevent_default=function(a,b){a.Bh=b};a.reset_device=function(a){switch(a.type){case 20:if(a.lf)if(a.Uc)a.Uc.resetPose();
else if(a.Mh)for(var b=0;b<a.Mh.length;b++)a.Mh[b].resetSensor();break;default:oa.error("reset_device() is undefined for device: ",a.type)}};a.get_vector_param=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:Z.copy(ha.Wl,c);if(a.Uc)c[0]=a.orientation[0],c[1]=a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.Mh)for(b=0;b<a.Mh.length;b++){var d=a.Mh[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState();d.orientation&&(c[0]=d.orientation.x,c[1]=d.orientation.y,
c[2]=d.orientation.z,c[3]=d.orientation.w)}X.normalize(c,c);a=X.setAxisAngle(ha.AXIS_X,Math.PI/2,aa);X.multiply(a,c,c);break a;default:oa.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:Z.copy(ha.Uu,c);if(a.Uc)c[0]=a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.Mh)for(b=0;b<a.Mh.length;b++)d=a.Mh[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState(),d.position&&(c[0]=d.position.x,c[1]=-d.position.z,c[2]=d.position.y);
break a;default:oa.error("position is undefined for device: ",a.type)}return c;case 21:return w(a,"left",c);case 22:return w(a,"right",c);case 30:return h(a,"left",c);case 31:return h(a,"right",c);case 40:case 41:return c[0]=a.et[0],c[1]=a.et[1],c}};a.get_value_param=l;a.set_config=function(a,b,c){switch(a.type){case 20:if(l(a,0)&8)break;switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.Kf=c;e(a);break;case 25:a.Yg=c;e(a);break;case 26:a.$p=c;e(a);break;case 27:a.hk=
c;e(a);break;case 28:a.qh=c;e(a);break;case 29:a.Zg=c,e(a)}break;case 60:case 70:case 80:case 90:a.ds[b]=c}};a.jN=function(a,b){var c=b-300;return c<a.Rk.length?a.Rk[a.ds[c]-300]:!1};a.iN=function(a,b){return b-326<a.kj.length?a.kj[a.ds[b-300]-326]:0};a.update=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<Ba.length;b++){var c=Ba[b];switch(c.type){case 60:k(c);x(a[0],c);break;case 70:k(c);x(a[1],c);break;case 80:k(c);
x(a[2],c);break;case 90:k(c);x(a[3],c);break;case 20:if(c.Uc){var d=c.Uc,e=d.capabilities;if(c.kh&&d.getFrameData(c.kh)){var d=c.kh.pose,f=ha.jx(c.kh.leftViewMatrix,P);c.Kf=2*Z.length(f)}else d=d.getPose();d&&(e.hasOrientation&&d.orientation&&(c.orientation[0]=d.orientation[0],c.orientation[1]=d.orientation[1],c.orientation[2]=d.orientation[2],c.orientation[3]=d.orientation[3]),e.hasPosition&&d.position&&(c.position[0]=d.position[0],c.position[1]=-d.position[2],c.position[2]=d.position[1]))}}}};a.attach_param_cb=
function(a,b,c){switch(b){case 130:a.Tf.push(c);b=141;break;case 140:a.Hg.push(c);b=141;break;case 50:a.ri.push(c);break;case 40:case 41:a.Ad.push(c);break;case 60:a.si.push(c);break;case 70:a.ti.push(c);break;case 90:a.wp.push(c);break;case 91:a.QC.push(c);b=90;break;case 80:a.mi.push(c);break;case 100:a.Li.push(c);break;case 110:a.Ki.push(c);break;case 120:a.Ji.push(c)}if(-1==a.Ob.indexOf(b)&&(a.Ob.push(b),a.lf))switch(b){case 50:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",
C,!1);break;case 40:a.element.addEventListener("mousemove",D,!1);break;case 41:a.element.addEventListener("mousemove",H,!1);break;case 60:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=window&&a.element.addEventListener("mouseout",t,!1),a.element.addEventListener("mouseup",m,!1));break;case 70:a.element.addEventListener("wheel",A,!1);break;case 90:a.element.addEventListener("keydown",I,!1);break;case 80:a.element.addEventListener("keyup",p,!1);break;case 100:a.element.addEventListener("touchstart",
Q,!1);break;case 110:a.element.addEventListener("touchmove",y,!1);break;case 120:a.element.addEventListener("touchend",Y,!1);break;case 141:a.element.addEventListener("deviceorientation",z,!1)}};a.detach_param_cb=function(a,b,c){u(a,b,c,!1)};a.AN=r;a.cleanup=function(){for(var a=0;a<Ba.length;a++)for(var b=Ba[a],c=0;c<b.Ob.length;c++)u(b,b.Ob[c],null,!0);Ba.length=0};a.get_pressed_gmpd_btn=function(a){a=b(R(a));for(var c=0;c<a.Rk.length;c++)if(a.Rk[c])return c+300;return-1};a.get_moved_gmpd_axis=
function(a){a=b(R(a));for(var c=0;c<a.kj.length;c++)if(a.OB[c]-a.kj[c])return c+326;return-1};a.dC=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.xN=function(){var a=b(20);return a&&a.Uc};a.xI=function(a){a.element.addEventListener("mousedown",function(){a.value||G(a)},!1)};a.add_click_listener=function(a,b){da.is_mobile_device?a.addEventListener("touchend",b):a.addEventListener("mouseup",
b)};a.remove_click_listener=function(a,b){da.is_mobile_device?a.removeEventListener("touchend",b):a.removeEventListener("mouseup",b)};a.check_fullscreen=E};b4w.module.__vec3=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array,d=Math.random;a.create=function(){var a=new q(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new q(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,d){var c=new q(3);c[0]=a;c[1]=b;c[2]=d;return c};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,d,n){n[0]=a;n[1]=b;n[2]=d;return n};a.add=function(a,b,d){d[0]=a[0]+b[0];d[1]=a[1]+b[1];d[2]=a[2]+b[2];
return d};a.subtract=function(a,b,d){d[0]=a[0]-b[0];d[1]=a[1]-b[1];d[2]=a[2]-b[2];return d};a.sub=a.subtract;a.multiply=function(a,b,d){d[0]=a[0]*b[0];d[1]=a[1]*b[1];d[2]=a[2]*b[2];return d};a.mul=a.multiply;a.divide=function(a,b,d){d[0]=a[0]/b[0];d[1]=a[1]/b[1];d[2]=a[2]/b[2];return d};a.div=a.divide;a.min=function(a,b,d){d[0]=Math.min(a[0],b[0]);d[1]=Math.min(a[1],b[1]);d[2]=Math.min(a[2],b[2]);return d};a.max=function(a,b,d){d[0]=Math.max(a[0],b[0]);d[1]=Math.max(a[1],b[1]);d[2]=Math.max(a[2],
b[2]);return d};a.scale=function(a,b,d){d[0]=a[0]*b;d[1]=a[1]*b;d[2]=a[2]*b;return d};a.scaleAndAdd=function(a,b,d,n){n[0]=a[0]+b[0]*d;n[1]=a[1]+b[1]*d;n[2]=a[2]+b[2]*d;return n};a.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],B=b[2]-a[2];return Math.sqrt(c*c+d*d+B*B)};a.dist=a.distance;a.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],B=b[2]-a[2];return c*c+d*d+B*B};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var c=a[0],d=a[1],B=a[2],c=c*c+d*d+B*B;0<c&&(c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,d){var c=a[0],g=a[1];a=a[2];var e=b[0],v=b[1];b=b[2];
d[0]=g*b-a*v;d[1]=a*e-c*b;d[2]=c*v-g*e;return d};a.lerp=function(a,b,d,n){var c=a[0],e=a[1];a=a[2];n[0]=c+d*(b[0]-c);n[1]=e+d*(b[1]-e);n[2]=a+d*(b[2]-a);return n};a.qU=function(a,b,d,n,B,e){var c=B*B,g=c*(2*B-3)+1,h=c*(B-2)+B,l=c*(B-1);B=c*(3-2*B);e[0]=a[0]*g+b[0]*h+d[0]*l+n[0]*B;e[1]=a[1]*g+b[1]*h+d[1]*l+n[1]*B;e[2]=a[2]*g+b[2]*h+d[2]*l+n[2]*B;return e};a.uA=function(a,b,d,n,B,e){var c=1-B,g=c*c,h=B*B,l=g*c,g=3*B*g,c=3*h*c;B=h*B;e[0]=a[0]*l+b[0]*g+d[0]*c+n[0]*B;e[1]=a[1]*l+b[1]*g+d[1]*c+n[1]*B;e[2]=
a[2]*l+b[2]*g+d[2]*c+n[2]*B;return e};a.random=function(a,b){a=a||1;var c=2*d()*Math.PI,n=2*d()-1,B=Math.sqrt(1-n*n)*a;b[0]=Math.cos(c)*B;b[1]=Math.sin(c)*B;b[2]=n*a;return b};a.transformMat4=function(a,b,d){var c=a[0],g=a[1];a=a[2];var e=b[3]*c+b[7]*g+b[11]*a+b[15],e=e||1;d[0]=(b[0]*c+b[4]*g+b[8]*a+b[12])/e;d[1]=(b[1]*c+b[5]*g+b[9]*a+b[13])/e;d[2]=(b[2]*c+b[6]*g+b[10]*a+b[14])/e;return d};a.transformMat3=function(a,b,d){var c=a[0],g=a[1];a=a[2];d[0]=c*b[0]+g*b[3]+a*b[6];d[1]=c*b[1]+g*b[4]+a*b[7];
d[2]=c*b[2]+g*b[5]+a*b[8];return d};a.transformQuat=function(a,b,d){var c=a[0],g=a[1],e=a[2];a=b[0];var v=b[1],w=b[2];b=b[3];var h=b*c+v*e-w*g,l=b*g+w*c-a*e,q=b*e+a*g-v*c,c=-a*c-v*g-w*e;d[0]=h*b+c*-a+l*-w-q*-v;d[1]=l*b+c*-v+q*-a-h*-w;d[2]=q*b+c*-w+h*-v-l*-a;return d};a.rotateX=function(a,b,d,n){var c=[],e=[];c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];e[0]=c[0];e[1]=c[1]*Math.cos(d)-c[2]*Math.sin(d);e[2]=c[1]*Math.sin(d)+c[2]*Math.cos(d);n[0]=e[0]+b[0];n[1]=e[1]+b[1];n[2]=e[2]+b[2];return n};a.rotateY=
function(a,b,d,n){var c=[],e=[];c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];e[0]=c[2]*Math.sin(d)+c[0]*Math.cos(d);e[1]=c[1];e[2]=c[2]*Math.cos(d)-c[0]*Math.sin(d);n[0]=e[0]+b[0];n[1]=e[1]+b[1];n[2]=e[2]+b[2];return n};a.rotateZ=function(a,b,d,n){var c=[],e=[];c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];e[0]=c[0]*Math.cos(d)-c[1]*Math.sin(d);e[1]=c[0]*Math.sin(d)+c[1]*Math.cos(d);e[2]=c[2];n[0]=e[0]+b[0];n[1]=e[1]+b[1];n[2]=e[2]+b[2];return n};a.forEach=function(){var c=a.create();return function(a,
d,n,B,e,v){var b;d||(d=3);n||(n=0);for(B?b=Math.min(B*d+n,a.length):b=a.length;n<b;n+=d)c[0]=a[n],c[1]=a[n+1],c[2]=a[n+2],e(c,v,c),a[n]=c[0],a[n+1]=c[1],a[n+2]=c[2];return a}}();a.angle=function(c,b){var d=a.fromValues(c[0],c[1],c[2]),n=a.fromValues(b[0],b[1],b[2]);a.normalize(d,d);a.normalize(n,n);d=a.dot(d,n);return 1<d?0:Math.acos(d)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array,d=Math.random;a.create=function(){var a=new q(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new q(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,d,n){var c=new q(4);c[0]=a;c[1]=b;c[2]=d;c[3]=n;return c};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,d,n,B){B[0]=a;B[1]=b;B[2]=d;B[3]=n;return B};a.add=function(a,b,d){d[0]=
a[0]+b[0];d[1]=a[1]+b[1];d[2]=a[2]+b[2];d[3]=a[3]+b[3];return d};a.subtract=function(a,b,d){d[0]=a[0]-b[0];d[1]=a[1]-b[1];d[2]=a[2]-b[2];d[3]=a[3]-b[3];return d};a.sub=a.subtract;a.multiply=function(a,b,d){d[0]=a[0]*b[0];d[1]=a[1]*b[1];d[2]=a[2]*b[2];d[3]=a[3]*b[3];return d};a.mul=a.multiply;a.divide=function(a,b,d){d[0]=a[0]/b[0];d[1]=a[1]/b[1];d[2]=a[2]/b[2];d[3]=a[3]/b[3];return d};a.div=a.divide;a.min=function(a,b,d){d[0]=Math.min(a[0],b[0]);d[1]=Math.min(a[1],b[1]);d[2]=Math.min(a[2],b[2]);d[3]=
Math.min(a[3],b[3]);return d};a.max=function(a,b,d){d[0]=Math.max(a[0],b[0]);d[1]=Math.max(a[1],b[1]);d[2]=Math.max(a[2],b[2]);d[3]=Math.max(a[3],b[3]);return d};a.scale=function(a,b,d){d[0]=a[0]*b;d[1]=a[1]*b;d[2]=a[2]*b;d[3]=a[3]*b;return d};a.scaleAndAdd=function(a,b,d,n){n[0]=a[0]+b[0]*d;n[1]=a[1]+b[1]*d;n[2]=a[2]+b[2]*d;n[3]=a[3]+b[3]*d;return n};a.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],B=b[2]-a[2],e=b[3]-a[3];return Math.sqrt(c*c+d*d+B*B+e*e)};a.dist=a.distance;a.squaredDistance=
function(a,b){var c=b[0]-a[0],d=b[1]-a[1],B=b[2]-a[2],e=b[3]-a[3];return c*c+d*d+B*B+e*e};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var c=a[0],d=a[1],B=a[2],e=a[3],v=c*c+d*d+B*B+e*e;0<v&&(v=1/Math.sqrt(v),b[0]=c*v,b[1]=d*v,b[2]=B*v,b[3]=e*v);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,d,n){var c=a[0],e=a[1],g=a[2];a=a[3];n[0]=c+d*(b[0]-c);n[1]=e+d*(b[1]-e);n[2]=g+d*(b[2]-g);n[3]=a+d*(b[3]-a);return n};a.random=function(c,b){c=c||1;b[0]=d();b[1]=d();b[2]=d();b[3]=d();a.normalize(b,b);a.scale(b,c,b);return b};a.transformMat4=function(a,b,d){var c=a[0],g=a[1],e=
a[2];a=a[3];d[0]=b[0]*c+b[4]*g+b[8]*e+b[12]*a;d[1]=b[1]*c+b[5]*g+b[9]*e+b[13]*a;d[2]=b[2]*c+b[6]*g+b[10]*e+b[14]*a;d[3]=b[3]*c+b[7]*g+b[11]*e+b[15]*a;return d};a.transformQuat=function(a,b,d){var c=a[0],g=a[1],e=a[2],v=b[0],w=b[1],h=b[2];b=b[3];var l=b*c+w*e-h*g,q=b*g+h*c-v*e,k=b*e+v*g-w*c,c=-v*c-w*g-h*e;d[0]=l*b+c*-v+q*-h-k*-w;d[1]=q*b+c*-w+k*-v-l*-h;d[2]=k*b+c*-h+l*-w-q*-v;d[3]=a[3];return d};a.forEach=function(){var c=a.create();return function(a,d,n,B,e,v){var b;d||(d=4);n||(n=0);for(B?b=Math.min(B*
d+n,a.length):b=a.length;n<b;n+=d)c[0]=a[n],c[1]=a[n+1],c[2]=a[n+2],c[3]=a[n+3],e(c,v,c),a[n]=c[0],a[n+1]=c[1],a[n+2]=c[2],a[n+3]=c[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,q){var d=q("__vec3"),c=q("__vec4"),b=q("__mat3"),g="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new g(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=d.create(),c=d.fromValues(1,0,0),e=d.fromValues(0,1,0);return function(g,n,h){var l=d.dot(g,n);if(-.9999999>l)return d.cross(c,g,b),1E-6>d.length(b)&&d.cross(e,g,b),d.normalize(b,b),a.setAxisAngle(b,Math.PI,h),h;if(.9999999<l)return h[0]=0,h[1]=0,h[2]=0,h[3]=1,h;d.cross(g,
n,b);h[0]=b[0];h[1]=b[1];h[2]=b[2];h[3]=1+l;return a.normalize(h,h)}}();a.setAxes=function(){var c=b.create();return function(b,d,g,n){c[0]=d[0];c[3]=d[1];c[6]=d[2];c[1]=g[0];c[4]=g[1];c[7]=g[2];c[2]=-b[0];c[5]=-b[1];c[8]=-b[2];return a.normalize(a.fromMat3(c,n),n)}}();a.clone=c.clone;a.fromValues=c.fromValues;a.copy=c.copy;a.set=c.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var d=Math.sin(b);c[0]=d*a[0];c[1]=d*a[1];c[2]=d*a[2];c[3]=Math.cos(b);
return c};a.add=c.add;a.multiply=function(a,b,c){var d=a[0],e=a[1],g=a[2];a=a[3];var l=b[0],n=b[1],k=b[2];b=b[3];c[0]=d*b+a*l+e*k-g*n;c[1]=e*b+a*n+g*l-d*k;c[2]=g*b+a*k+d*n-e*l;c[3]=a*b-d*l-e*n-g*k;return c};a.mul=a.multiply;a.scale=c.scale;a.rotateX=function(a,b,c){b*=.5;var d=a[0],e=a[1],g=a[2];a=a[3];var l=Math.sin(b);b=Math.cos(b);c[0]=d*b+a*l;c[1]=e*b+g*l;c[2]=g*b-e*l;c[3]=a*b-d*l;return c};a.rotateY=function(a,b,c){b*=.5;var d=a[0],e=a[1],g=a[2];a=a[3];var l=Math.sin(b);b=Math.cos(b);c[0]=d*
b-g*l;c[1]=e*b+a*l;c[2]=g*b+d*l;c[3]=a*b-e*l;return c};a.rotateZ=function(a,b,c){b*=.5;var d=a[0],e=a[1],g=a[2];a=a[3];var l=Math.sin(b);b=Math.cos(b);c[0]=d*b+e*l;c[1]=e*b-d*l;c[2]=g*b+a*l;c[3]=a*b-g*l;return c};a.calculateW=function(a,b){var c=a[0],d=a[1],g=a[2];b[0]=c;b[1]=d;b[2]=g;b[3]=Math.sqrt(Math.abs(1-c*c-d*d-g*g));return b};a.dot=c.dot;a.lerp=c.lerp;a.slerp=function(a,b,c,d){var e=a[0],g=a[1],l=a[2];a=a[3];var n=b[0],k=b[1],f=b[2];b=b[3];var v,u,r;u=e*n+g*k+l*f+a*b;0>u&&(u=-u,n=-n,k=-k,
f=-f,b=-b);1E-6<1-u?(v=Math.acos(u),r=Math.sin(v),u=Math.sin((1-c)*v)/r,c=Math.sin(c*v)/r):u=1-c;d[0]=u*e+c*n;d[1]=u*g+c*k;d[2]=u*l+c*f;d[3]=u*a+c*b;return d};a.aV=function(){var b=a.create(),c=a.create();return function(d,g,n,h,l,B){a.slerp(d,h,l,b);a.slerp(g,n,l,c);a.slerp(b,c,2*l*(1-l),B);return B}}();a.invert=function(a,b){var c=a[0],d=a[1],g=a[2],h=a[3],l=c*c+d*d+g*g+h*h,l=l?1/l:0;b[0]=-c*l;b[1]=-d*l;b[2]=-g*l;b[3]=h*l;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=c.length;a.len=a.length;a.squaredLength=c.squaredLength;a.sqrLen=a.squaredLength;a.normalize=c.normalize;a.fromMat3=function(a,b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var d=0;a[4]>a[0]&&(d=1);a[8]>a[3*d+d]&&(d=2);var g=(d+1)%3,h=(d+2)%3,c=Math.sqrt(a[3*d+d]-a[3*g+g]-a[3*h+h]+1);b[d]=.5*c;c=.5/c;b[3]=(a[3*g+h]-a[3*h+g])*c;b[g]=(a[3*g+d]+a[3*d+g])*c;b[h]=(a[3*h+d]+a[3*d+h])*c}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new q(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c};a.clone=function(a){var c=new q(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=
a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],d=a[2],n=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=d;c[7]=n}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c};a.invert=function(a,c){var b=a[0],d=a[1],n=a[2],q=a[3],e=a[4],v=a[5],w=a[6],h=a[7],l=a[8],x=l*e-v*h,k=-l*q+v*w,f=
h*q-e*w,F=b*x+d*k+n*f;if(!F)return null;F=1/F;c[0]=x*F;c[1]=(-l*d+n*h)*F;c[2]=(v*d-n*e)*F;c[3]=k*F;c[4]=(l*b-n*w)*F;c[5]=(-v*b+n*q)*F;c[6]=f*F;c[7]=(-h*b+d*w)*F;c[8]=(e*b-d*q)*F;return c};a.adjoint=function(a,c){var b=a[0],d=a[1],n=a[2],q=a[3],e=a[4],v=a[5],w=a[6],h=a[7],l=a[8];c[0]=e*l-v*h;c[1]=n*h-d*l;c[2]=d*v-n*e;c[3]=v*w-q*l;c[4]=b*l-n*w;c[5]=n*q-b*v;c[6]=q*h-e*w;c[7]=d*w-b*h;c[8]=b*e-d*q;return c};a.determinant=function(a){var c=a[3],b=a[4],d=a[5],n=a[6],q=a[7],e=a[8];return a[0]*(e*b-d*q)+a[1]*
(-e*c+d*n)+a[2]*(q*c-b*n)};a.multiply=function(a,c,b){var d=a[0],n=a[1],q=a[2],e=a[3],v=a[4],w=a[5],h=a[6],l=a[7];a=a[8];var x=c[0],k=c[1],f=c[2],F=c[3],u=c[4],r=c[5],z=c[6],J=c[7];c=c[8];b[0]=x*d+k*e+f*h;b[1]=x*n+k*v+f*l;b[2]=x*q+k*w+f*a;b[3]=F*d+u*e+r*h;b[4]=F*n+u*v+r*l;b[5]=F*q+u*w+r*a;b[6]=z*d+J*e+c*h;b[7]=z*n+J*v+c*l;b[8]=z*q+J*w+c*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var d=a[0],n=a[1],q=a[2],e=a[3],v=a[4],w=a[5],h=a[6],l=a[7];a=a[8];var x=c[0];c=c[1];b[0]=d;b[1]=n;b[2]=q;
b[3]=e;b[4]=v;b[5]=w;b[6]=x*d+c*e+h;b[7]=x*n+c*v+l;b[8]=x*q+c*w+a;return b};a.rotate=function(a,c,b){var d=a[0],n=a[1],q=a[2],e=a[3],v=a[4],w=a[5],h=a[6],l=a[7];a=a[8];var x=Math.sin(c);c=Math.cos(c);b[0]=c*d+x*e;b[1]=c*n+x*v;b[2]=c*q+x*w;b[3]=c*e-x*d;b[4]=c*v-x*n;b[5]=c*w-x*q;b[6]=h;b[7]=l;b[8]=a;return b};a.scale=function(a,c,b){var d=c[0];c=c[1];b[0]=d*a[0];b[1]=d*a[1];b[2]=d*a[2];b[3]=c*a[3];b[4]=c*a[4];b[5]=c*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.AM=function(a,c){c[0]=1;c[1]=0;c[2]=
0;c[3]=0;c[4]=1;c[5]=0;c[6]=a[0];c[7]=a[1];c[8]=1;return c};a.yM=function(a,c){var b=Math.sin(a),d=Math.cos(a);c[0]=d;c[1]=b;c[2]=0;c[3]=-b;c[4]=d;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.zM=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.fromMat2d=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};a.fromQuat=function(a,c){var b=a[0],d=a[1],n=a[2],q=a[3],e=b+b,v=d+d,w=n+n,b=b*e,h=d*e,d=d*v,l=n*e,x=
n*v,n=n*w,e=q*e,v=q*v,q=q*w;c[0]=1-d-n;c[3]=h-q;c[6]=l+v;c[1]=h+q;c[4]=1-b-n;c[7]=x-e;c[2]=l-v;c[5]=x+e;c[8]=1-b-d;return c};a.normalFromMat4=function(a,c){var b=a[0],d=a[1],n=a[2],q=a[3],e=a[4],v=a[5],w=a[6],h=a[7],l=a[8],x=a[9],k=a[10],f=a[11],F=a[12],u=a[13],r=a[14],z=a[15],J=b*v-d*e,D=b*w-n*e,H=b*h-q*e,C=d*w-n*v,t=d*h-q*v,m=n*h-q*w,A=l*u-x*F,I=l*r-k*F,l=l*z-f*F,p=x*r-k*u,x=x*z-f*u,k=k*z-f*r,f=J*k-D*x+H*p+C*l-t*I+m*A;if(!f)return null;f=1/f;c[0]=(v*k-w*x+h*p)*f;c[1]=(w*l-e*k-h*I)*f;c[2]=(e*x-v*
l+h*A)*f;c[3]=(n*x-d*k-q*p)*f;c[4]=(b*k-n*l+q*I)*f;c[5]=(d*l-b*x-q*A)*f;c[6]=(u*m-r*t+z*C)*f;c[7]=(r*H-F*m-z*D)*f;c[8]=(F*t-u*H+z*J)*f;return c};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.xM=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var q="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new q(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var c=new q(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.copy=function(a,c){c[0]=a[0];
c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],d=a[2],n=a[3],q=a[6],e=a[7],v=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=d;c[9]=q;c[11]=a[14];c[12]=n;c[13]=
e;c[14]=v}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};a.invert=function(a,c){var b=a[0],d=a[1],n=a[2],q=a[3],e=a[4],v=a[5],w=a[6],h=a[7],l=a[8],x=a[9],k=a[10],f=a[11],F=a[12],u=a[13],r=a[14],z=a[15],J=b*v-d*e,D=b*w-n*e,H=b*h-q*e,C=d*w-n*v,t=d*h-q*v,m=n*h-q*w,A=l*u-x*F,I=l*r-k*F,p=l*z-f*F,Q=x*r-k*u,y=x*z-f*u,Y=k*z-f*r,R=J*Y-D*y+H*Q+C*p-t*I+m*A;if(!R)return null;
R=1/R;c[0]=(v*Y-w*y+h*Q)*R;c[1]=(n*y-d*Y-q*Q)*R;c[2]=(u*m-r*t+z*C)*R;c[3]=(k*t-x*m-f*C)*R;c[4]=(w*p-e*Y-h*I)*R;c[5]=(b*Y-n*p+q*I)*R;c[6]=(r*H-F*m-z*D)*R;c[7]=(l*m-k*H+f*D)*R;c[8]=(e*y-v*p+h*A)*R;c[9]=(d*p-b*y-q*A)*R;c[10]=(F*t-u*H+z*J)*R;c[11]=(x*H-l*t-f*J)*R;c[12]=(v*I-e*Q-w*A)*R;c[13]=(b*Q-d*I+n*A)*R;c[14]=(u*D-F*C-r*J)*R;c[15]=(l*C-x*D+k*J)*R;return c};a.adjoint=function(a,c){var b=a[0],d=a[1],n=a[2],q=a[3],e=a[4],v=a[5],w=a[6],h=a[7],l=a[8],x=a[9],k=a[10],f=a[11],F=a[12],u=a[13],r=a[14],z=a[15];
c[0]=v*(k*z-f*r)-x*(w*z-h*r)+u*(w*f-h*k);c[1]=-(d*(k*z-f*r)-x*(n*z-q*r)+u*(n*f-q*k));c[2]=d*(w*z-h*r)-v*(n*z-q*r)+u*(n*h-q*w);c[3]=-(d*(w*f-h*k)-v*(n*f-q*k)+x*(n*h-q*w));c[4]=-(e*(k*z-f*r)-l*(w*z-h*r)+F*(w*f-h*k));c[5]=b*(k*z-f*r)-l*(n*z-q*r)+F*(n*f-q*k);c[6]=-(b*(w*z-h*r)-e*(n*z-q*r)+F*(n*h-q*w));c[7]=b*(w*f-h*k)-e*(n*f-q*k)+l*(n*h-q*w);c[8]=e*(x*z-f*u)-l*(v*z-h*u)+F*(v*f-h*x);c[9]=-(b*(x*z-f*u)-l*(d*z-q*u)+F*(d*f-q*x));c[10]=b*(v*z-h*u)-e*(d*z-q*u)+F*(d*h-q*v);c[11]=-(b*(v*f-h*x)-e*(d*f-q*x)+l*
(d*h-q*v));c[12]=-(e*(x*r-k*u)-l*(v*r-w*u)+F*(v*k-w*x));c[13]=b*(x*r-k*u)-l*(d*r-n*u)+F*(d*k-n*x);c[14]=-(b*(v*r-w*u)-e*(d*r-n*u)+F*(d*w-n*v));c[15]=b*(v*k-w*x)-e*(d*k-n*x)+l*(d*w-n*v);return c};a.determinant=function(a){var c=a[0],b=a[1],d=a[2],n=a[3],q=a[4],e=a[5],v=a[6],w=a[7],h=a[8],l=a[9],x=a[10],k=a[11],f=a[12],F=a[13],u=a[14];a=a[15];return(c*e-b*q)*(x*a-k*u)-(c*v-d*q)*(l*a-k*F)+(c*w-n*q)*(l*u-x*F)+(b*v-d*e)*(h*a-k*f)-(b*w-n*e)*(h*u-x*f)+(d*w-n*v)*(h*F-l*f)};a.multiply=function(a,c,b){var d=
a[0],n=a[1],q=a[2],e=a[3],v=a[4],w=a[5],h=a[6],l=a[7],x=a[8],k=a[9],f=a[10],F=a[11],u=a[12],r=a[13],z=a[14];a=a[15];var J=c[0],D=c[1],H=c[2],C=c[3];b[0]=J*d+D*v+H*x+C*u;b[1]=J*n+D*w+H*k+C*r;b[2]=J*q+D*h+H*f+C*z;b[3]=J*e+D*l+H*F+C*a;J=c[4];D=c[5];H=c[6];C=c[7];b[4]=J*d+D*v+H*x+C*u;b[5]=J*n+D*w+H*k+C*r;b[6]=J*q+D*h+H*f+C*z;b[7]=J*e+D*l+H*F+C*a;J=c[8];D=c[9];H=c[10];C=c[11];b[8]=J*d+D*v+H*x+C*u;b[9]=J*n+D*w+H*k+C*r;b[10]=J*q+D*h+H*f+C*z;b[11]=J*e+D*l+H*F+C*a;J=c[12];D=c[13];H=c[14];C=c[15];b[12]=J*d+
D*v+H*x+C*u;b[13]=J*n+D*w+H*k+C*r;b[14]=J*q+D*h+H*f+C*z;b[15]=J*e+D*l+H*F+C*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var d=c[0],n=c[1];c=c[2];var q,e,v,w,h,l,x,k,f,F,u,r;a===b?(b[12]=a[0]*d+a[4]*n+a[8]*c+a[12],b[13]=a[1]*d+a[5]*n+a[9]*c+a[13],b[14]=a[2]*d+a[6]*n+a[10]*c+a[14],b[15]=a[3]*d+a[7]*n+a[11]*c+a[15]):(q=a[0],e=a[1],v=a[2],w=a[3],h=a[4],l=a[5],x=a[6],k=a[7],f=a[8],F=a[9],u=a[10],r=a[11],b[0]=q,b[1]=e,b[2]=v,b[3]=w,b[4]=h,b[5]=l,b[6]=x,b[7]=k,b[8]=f,b[9]=F,b[10]=u,b[11]=r,
b[12]=q*d+h*n+f*c+a[12],b[13]=e*d+l*n+F*c+a[13],b[14]=v*d+x*n+u*c+a[14],b[15]=w*d+k*n+r*c+a[15]);return b};a.scale=function(a,c,b){var d=c[0],n=c[1];c=c[2];b[0]=a[0]*d;b[1]=a[1]*d;b[2]=a[2]*d;b[3]=a[3]*d;b[4]=a[4]*n;b[5]=a[5]*n;b[6]=a[6]*n;b[7]=a[7]*n;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,c,b,g){var d=b[0],q=b[1];b=b[2];var e=Math.sqrt(d*d+q*q+b*b),v,w,h,l,x,k,f,F,u,r,z,J,D,H,C,t,m,A,I,p;if(1E-7>Math.abs(e))return null;
e=1/e;d*=e;q*=e;b*=e;v=Math.sin(c);w=Math.cos(c);h=1-w;c=a[0];e=a[1];l=a[2];x=a[3];k=a[4];f=a[5];F=a[6];u=a[7];r=a[8];z=a[9];J=a[10];D=a[11];H=d*d*h+w;C=q*d*h+b*v;t=b*d*h-q*v;m=d*q*h-b*v;A=q*q*h+w;I=b*q*h+d*v;p=d*b*h+q*v;d=q*b*h-d*v;q=b*b*h+w;g[0]=c*H+k*C+r*t;g[1]=e*H+f*C+z*t;g[2]=l*H+F*C+J*t;g[3]=x*H+u*C+D*t;g[4]=c*m+k*A+r*I;g[5]=e*m+f*A+z*I;g[6]=l*m+F*A+J*I;g[7]=x*m+u*A+D*I;g[8]=c*p+k*d+r*q;g[9]=e*p+f*d+z*q;g[10]=l*p+F*d+J*q;g[11]=x*p+u*d+D*q;a!==g&&(g[12]=a[12],g[13]=a[13],g[14]=a[14],g[15]=a[15]);
return g};a.rotateX=function(a,c,b){var d=Math.sin(c);c=Math.cos(c);var n=a[4],q=a[5],e=a[6],v=a[7],w=a[8],h=a[9],l=a[10],x=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=n*c+w*d;b[5]=q*c+h*d;b[6]=e*c+l*d;b[7]=v*c+x*d;b[8]=w*c-n*d;b[9]=h*c-q*d;b[10]=l*c-e*d;b[11]=x*c-v*d;return b};a.rotateY=function(a,c,b){var d=Math.sin(c);c=Math.cos(c);var n=a[0],q=a[1],e=a[2],v=a[3],w=a[8],h=a[9],l=a[10],x=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=n*c-w*d;b[1]=q*c-h*d;b[2]=e*c-l*d;b[3]=v*c-x*d;b[8]=n*d+w*c;b[9]=q*d+h*c;b[10]=e*d+l*c;b[11]=v*d+x*c;return b};a.rotateZ=function(a,c,b){var d=Math.sin(c);c=Math.cos(c);var n=a[0],q=a[1],e=a[2],v=a[3],w=a[4],h=a[5],l=a[6],x=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=n*c+w*d;b[1]=q*c+h*d;b[2]=e*c+l*d;b[3]=v*c+x*d;b[4]=w*c-n*d;b[5]=h*c-q*d;b[6]=l*c-e*d;b[7]=x*c-v*d;return b};
a.AM=function(a,c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};a.zM=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.yM=function(a,c,b){var d=c[0],n=c[1];c=c[2];var q=Math.sqrt(d*d+n*n+c*c),e;if(1E-7>Math.abs(q))return null;q=1/q;d*=q;n*=q;c*=q;q=Math.sin(a);a=Math.cos(a);e=1-a;b[0]=d*d*e+a;b[1]=n*d*e+c*
q;b[2]=c*d*e-n*q;b[3]=0;b[4]=d*n*e-c*q;b[5]=n*n*e+a;b[6]=c*n*e+d*q;b[7]=0;b[8]=d*c*e+n*q;b[9]=n*c*e-d*q;b[10]=c*c*e+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.QT=function(a,c){var b=Math.sin(a),d=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=d;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=d;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.RT=function(a,c){var b=Math.sin(a),d=Math.cos(a);c[0]=d;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=d;c[11]=0;c[12]=0;c[13]=0;
c[14]=0;c[15]=1;return c};a.ST=function(a,c){var b=Math.sin(a),d=Math.cos(a);c[0]=d;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=d;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotationTranslation=function(a,c,b){var d=a[0],n=a[1],q=a[2],e=a[3],v=d+d,w=n+n,h=q+q;a=d*v;var l=d*w,d=d*h,x=n*w,n=n*h,q=q*h,v=e*v,w=e*w,e=e*h;b[0]=1-(x+q);b[1]=l+e;b[2]=d-w;b[3]=0;b[4]=l-e;b[5]=1-(a+q);b[6]=n+v;b[7]=0;b[8]=d+w;b[9]=n-v;b[10]=1-(a+x);b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];
b[15]=1;return b};a.OT=function(a,c,b,g){var d=a[0],q=a[1],e=a[2],v=a[3],w=d+d,h=q+q,l=e+e;a=d*w;var x=d*h,d=d*l,k=q*h,q=q*l,e=e*l,w=v*w,h=v*h,v=v*l,l=b[0],f=b[1];b=b[2];g[0]=(1-(k+e))*l;g[1]=(x+v)*l;g[2]=(d-h)*l;g[3]=0;g[4]=(x-v)*f;g[5]=(1-(a+e))*f;g[6]=(q+w)*f;g[7]=0;g[8]=(d+h)*b;g[9]=(q-w)*b;g[10]=(1-(a+k))*b;g[11]=0;g[12]=c[0];g[13]=c[1];g[14]=c[2];g[15]=1;return g};a.PT=function(a,c,b,g,n){var d=a[0],e=a[1],v=a[2],q=a[3],h=d+d,l=e+e,x=v+v;a=d*h;var k=d*l,d=d*x,f=e*l,e=e*x,v=v*x,h=q*h,l=q*l,q=
q*x,x=b[0],F=b[1];b=b[2];var u=g[0],r=g[1];g=g[2];n[0]=(1-(f+v))*x;n[1]=(k+q)*x;n[2]=(d-l)*x;n[3]=0;n[4]=(k-q)*F;n[5]=(1-(a+v))*F;n[6]=(e+h)*F;n[7]=0;n[8]=(d+l)*b;n[9]=(e-h)*b;n[10]=(1-(a+f))*b;n[11]=0;n[12]=c[0]+u-(n[0]*u+n[4]*r+n[8]*g);n[13]=c[1]+r-(n[1]*u+n[5]*r+n[9]*g);n[14]=c[2]+g-(n[2]*u+n[6]*r+n[10]*g);n[15]=1;return n};a.fromQuat=function(a,c){var b=a[0],d=a[1],n=a[2],q=a[3],e=b+b,v=d+d,w=n+n,b=b*e,h=d*e,d=d*v,l=n*e,x=n*v,n=n*w,e=q*e,v=q*v,q=q*w;c[0]=1-d-n;c[1]=h+q;c[2]=l-v;c[3]=0;c[4]=h-
q;c[5]=1-b-n;c[6]=x+e;c[7]=0;c[8]=l+v;c[9]=x-e;c[10]=1-b-d;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.frustum=function(a,c,b,g,n,q,e){var d=1/(c-a),w=1/(g-b),h=1/(n-q);e[0]=2*n*d;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=2*n*w;e[6]=0;e[7]=0;e[8]=(c+a)*d;e[9]=(g+b)*w;e[10]=(q+n)*h;e[11]=-1;e[12]=0;e[13]=0;e[14]=q*n*2*h;e[15]=0;return e};a.perspective=function(a,c,b,g,n){a=1/Math.tan(a/2);var d=1/(b-g);n[0]=a/c;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=a;n[6]=0;n[7]=0;n[8]=0;n[9]=0;n[10]=(g+b)*d;n[11]=-1;n[12]=
0;n[13]=0;n[14]=2*g*b*d;n[15]=0;return n};a.LU=function(a,c,b,g){var d=Math.tan(a.upDegrees*Math.PI/180),q=Math.tan(a.downDegrees*Math.PI/180),e=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var v=2/(e+a),w=2/(d+q);g[0]=v;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=w;g[6]=0;g[7]=0;g[8]=-((e-a)*v*.5);g[9]=(d-q)*w*.5;g[10]=b/(c-b);g[11]=-1;g[12]=0;g[13]=0;g[14]=b*c/(c-b);g[15]=0;return g};a.ortho=function(a,c,b,g,n,q,e){var d=1/(a-c),w=1/(b-g),h=1/(n-q);e[0]=-2*d;e[1]=0;e[2]=0;e[3]=
0;e[4]=0;e[5]=-2*w;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=2*h;e[11]=0;e[12]=(a+c)*d;e[13]=(g+b)*w;e[14]=(q+n)*h;e[15]=1;return e};a.lookAt=function(d,c,b,g){var n,q,e,v,w,h,l,x,k=d[0],f=d[1];d=d[2];e=b[0];v=b[1];q=b[2];l=c[0];b=c[1];n=c[2];if(1E-7>Math.abs(k-l)&&1E-7>Math.abs(f-b)&&1E-7>Math.abs(d-n))return a.identity(g);c=k-l;b=f-b;l=d-n;x=1/Math.sqrt(c*c+b*b+l*l);c*=x;b*=x;l*=x;n=v*l-q*b;q=q*c-e*l;e=e*b-v*c;(x=Math.sqrt(n*n+q*q+e*e))?(x=1/x,n*=x,q*=x,e*=x):e=q=n=0;v=b*e-l*q;w=l*n-c*e;h=c*q-b*n;(x=Math.sqrt(v*
v+w*w+h*h))?(x=1/x,v*=x,w*=x,h*=x):h=w=v=0;g[0]=n;g[1]=v;g[2]=c;g[3]=0;g[4]=q;g[5]=w;g[6]=b;g[7]=0;g[8]=e;g[9]=h;g[10]=l;g[11]=0;g[12]=-(n*k+q*f+e*d);g[13]=-(v*k+w*f+h*d);g[14]=-(c*k+b*f+l*d);g[15]=1;return g};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.xM=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__md5=function(a){function q(a,e){var n=a[0],q=a[1],h=a[2],l=a[3],n=c(n,q,h,l,e[0],7,-680876936),l=c(l,n,q,h,e[1],12,-389564586),h=c(h,l,n,q,e[2],17,606105819),q=c(q,h,l,n,e[3],22,-1044525330),n=c(n,q,h,l,e[4],7,-176418897),l=c(l,n,q,h,e[5],12,1200080426),h=c(h,l,n,q,e[6],17,-1473231341),q=c(q,h,l,n,e[7],22,-45705983),n=c(n,q,h,l,e[8],7,1770035416),l=c(l,n,q,h,e[9],12,-1958414417),h=c(h,l,n,q,e[10],17,-42063),q=c(q,h,l,n,e[11],22,-1990404162),n=c(n,q,h,l,e[12],7,1804603682),l=c(l,n,q,h,
e[13],12,-40341101),h=c(h,l,n,q,e[14],17,-1502002290),q=c(q,h,l,n,e[15],22,1236535329),n=b(n,q,h,l,e[1],5,-165796510),l=b(l,n,q,h,e[6],9,-1069501632),h=b(h,l,n,q,e[11],14,643717713),q=b(q,h,l,n,e[0],20,-373897302),n=b(n,q,h,l,e[5],5,-701558691),l=b(l,n,q,h,e[10],9,38016083),h=b(h,l,n,q,e[15],14,-660478335),q=b(q,h,l,n,e[4],20,-405537848),n=b(n,q,h,l,e[9],5,568446438),l=b(l,n,q,h,e[14],9,-1019803690),h=b(h,l,n,q,e[3],14,-187363961),q=b(q,h,l,n,e[8],20,1163531501),n=b(n,q,h,l,e[13],5,-1444681467),l=
b(l,n,q,h,e[2],9,-51403784),h=b(h,l,n,q,e[7],14,1735328473),q=b(q,h,l,n,e[12],20,-1926607734),n=d(q^h^l,n,q,e[5],4,-378558),l=d(n^q^h,l,n,e[8],11,-2022574463),h=d(l^n^q,h,l,e[11],16,1839030562),q=d(h^l^n,q,h,e[14],23,-35309556),n=d(q^h^l,n,q,e[1],4,-1530992060),l=d(n^q^h,l,n,e[4],11,1272893353),h=d(l^n^q,h,l,e[7],16,-155497632),q=d(h^l^n,q,h,e[10],23,-1094730640),n=d(q^h^l,n,q,e[13],4,681279174),l=d(n^q^h,l,n,e[0],11,-358537222),h=d(l^n^q,h,l,e[3],16,-722521979),q=d(h^l^n,q,h,e[6],23,76029189),n=
d(q^h^l,n,q,e[9],4,-640364487),l=d(n^q^h,l,n,e[12],11,-421815835),h=d(l^n^q,h,l,e[15],16,530742520),q=d(h^l^n,q,h,e[2],23,-995338651),n=g(n,q,h,l,e[0],6,-198630844),l=g(l,n,q,h,e[7],10,1126891415),h=g(h,l,n,q,e[14],15,-1416354905),q=g(q,h,l,n,e[5],21,-57434055),n=g(n,q,h,l,e[12],6,1700485571),l=g(l,n,q,h,e[3],10,-1894986606),h=g(h,l,n,q,e[10],15,-1051523),q=g(q,h,l,n,e[1],21,-2054922799),n=g(n,q,h,l,e[8],6,1873313359),l=g(l,n,q,h,e[15],10,-30611744),h=g(h,l,n,q,e[6],15,-1560198380),q=g(q,h,l,n,e[13],
21,1309151649),n=g(n,q,h,l,e[4],6,-145523070),l=g(l,n,q,h,e[11],10,-1120210379),h=g(h,l,n,q,e[2],15,718787259),q=g(q,h,l,n,e[9],21,-343485551);a[0]=n+a[0]&4294967295;a[1]=q+a[1]&4294967295;a[2]=h+a[2]&4294967295;a[3]=l+a[3]&4294967295}function d(a,b,c,d,g,l){b=(b+a&4294967295)+(d+l&4294967295)&4294967295;return(b<<g|b>>>32-g)+c&4294967295}function c(a,b,c,g,h,l,n){return d(b&c|~b&g,a,b,h,l,n)}function b(a,b,c,g,h,l,n){return d(b&g|c&~g,a,b,h,l,n)}function g(a,b,c,g,h,l,n){return d(c^(b|~g),a,b,h,
l,n)}var n="0123456789abcdef".split("");a.vC=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var d;for(d=64;d<=b.length;d+=64){var g,l=b.substring(d-64,d),x=[];for(g=0;64>g;g+=4)x[g>>2]=l.charCodeAt(g)+(l.charCodeAt(g+1)<<8)+(l.charCodeAt(g+2)<<16)+(l.charCodeAt(g+3)<<24);q(a,x)}b=b.substring(d-64);g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(d=0;d<b.length;d++)g[d>>2]|=b.charCodeAt(d)<<(d%4<<3);g[d>>2]|=128<<(d%4<<3);if(55<d)for(q(a,g),d=0;16>d;d++)g[d]=0;g[14]=8*c;q(a,
g);for(b=0;b<a.length;b++){c=a[b];d="";for(g=0;4>g;g++)d+=n[c>>8*g+4&15]+n[c>>8*g&15];a[b]=d}return a.join("")}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANCHOR_NUM",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; uniform vec2 u_texel_size ; GLSL_IN float a_index ; void main ( ) { int c = int ( mod ( a_index , 3.0 ) ) ; int d = int ( a_index / 3.0 ) ; vec2 e ; if ( c == 0 ) { e = vec2 ( - 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else if ( c == 1 ) { e = vec2 ( 4.0 * u_texel_size [ 0 ] , - u_texel_size [ 1 ] ) ; } else { e = vec2 ( 0.0 , 5.0 * u_texel_size [ 1 ] ) ; } vec4 f = u_view_proj_matrix * vec4 ( u_position [ d ] , 1.0 ) ; f . xy += e * f . w ; gl_Position = f ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_OUTLINE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",
c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},
{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_DERIVATIVES_EXT"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"math.glslv"}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",
l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],
j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_OUTLINE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",f:[{a:"if",i:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",
";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map1 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map2 ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_OUTLINE"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",f:[{a:"txt",
b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec4 i ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",
i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 n ; GLSL_IN vec4 o ; GLSL_IN vec4 u ; GLSL_IN vec4 v ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],
j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_sampler , A ) ) . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",
f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_OUTLINE"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",
b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",
b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",
A:"to_world.glslv"},{a:"include",A:"scale_texcoord.glslv"},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",
i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",i:["NODES",
"ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",
f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec4 i ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",
"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},{a:"logical_or_expr",l:6},{a:"logical_and_expr",l:3},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",l:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:7}],j:{a:"grp",f:[{a:"txt",b:"vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ; vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","S","=","u_model_tsr",";"]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],
j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN"],j:{a:"grp",f:[{a:"txt",b:"vec3 U = normalize ( T ( u_model_tsr , P ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",
l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",
j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 an = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",
j:{a:"grp",f:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"h = al . N ;".split(" ")},
{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:12}],j:{a:"grp",f:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"txt",b:"i = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * i ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"m = - i . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIREFRAME_QUALITY",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DEBUG_SPHERE_DYNAMIC",b:["0"]},{a:"include",
A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 at ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float au = 1.0 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE_DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"const vec3 av = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"const vec3 av = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"const vec3 aw = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 ax = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 ay = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 az = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 aA = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"float aF ( ) { float aB = 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["WIREFRAME_QUALITY",0,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) aB = 0.0 ;".split(" ")}]}},{a:"elif",i:["WIREFRAME_QUALITY",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GLSL1"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; aB = min ( min ( aE . x , aE . y ) , aE . z ) ; aB = clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","aB",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 aG = vec3 ( 0.0 ) ; float J = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE"],j:{a:"grp",f:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) { aG = av ; J = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float aB = aF ( ) ; aG = vec3 ( mix ( u_wireframe_edge_color , ay , aB ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float aB = aF ( ) ; aG = u_wireframe_edge_color ; J = mix ( 1.0 , 0.0 , aB ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float aB = aF ( ) ; if ( gl_FrontFacing ) aG = mix ( u_wireframe_edge_color , aw , aB ) ; else aG = mix ( u_wireframe_edge_color , ax , aB ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float aH = u_cluster_id + u_debug_colors_seed + 2.0 ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float aH = u_batch_debug_id_color + u_debug_colors_seed ; aG = vec3 ( fract ( aH * 19.73 ) , fract ( aH * 6.34 ) , fract ( aH * 1.56 ) ) ; J = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float aI ; if ( u_debug_render_time_threshold > 0.0 ) aI = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else aI = 1.0 ; float aJ = clamp ( 2.0 * aI , 0.0 , 1.0 ) ; float aK = clamp ( 2.0 * aI - 1.0 , 0.0 , 1.0 ) ; float aL = aI ; aG = mix ( az , aA , vec3 ( aJ , aK , aL ) ) ; J = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"DEBUG_VIEW_SPECIAL_SKYDOME",b:["0"]},{a:"var",c:"DEBUG_SPHERE",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",
c:"BILLBOARD",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",
A:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",
";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",
i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","at",";"]},{a:"cond",f:[{a:"if",
i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")},
{a:"cond",f:[{a:"if",i:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",
f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},{a:"include",A:"dynamic_grass.glslv"}]}}]},{a:"txt",b:"void main ( ) { if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_VIEW_SPECIAL_SKYDOME"],j:{a:"grp",f:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["STATIC_BATCH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]},{a:"txt",
b:"mat3 M = u_view_tsr ; vec3 N = a_position ; vec3 P = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEBUG_SPHERE"],j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",
f:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ; _ ( N , Q , R , P ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",i:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",f:[{a:"if",
i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},
{a:"txt",b:"aj al = ak ( N - ac , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( N , ac , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"am ( al . N , al . ac , P , mat4 ( 0.0 ) ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * aR ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};
a["grass_map.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","aS",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","aS",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",
i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","aS",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aS",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aS , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],
j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , aS ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DYNAMIC_GRASS_SIZE",b:["0"]},{a:"var",c:"DYNAMIC_GRASS_COLOR",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"include",
A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT",
"vec4","aS",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","aS",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","aS",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 ae = ad ( S , vec3 ( 0.0 ) ) ; mat3 S = ah ( u_camera_eye , ae , M ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , S ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_SIZE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:"aS = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["aS","=","a_grass_size",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS_COLOR"],j:{a:"grp",f:[{a:"txt",b:["aS","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","f",";","}"]}]};a["halo.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:["uniform",
"vec3","u_sun_intensity",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN float aU ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},
{a:"include",A:"color_util.glslf"},{a:"include",A:"halo_color.glslf"},{a:"txt",b:"void main ( ) { vec4 aW = aV ( ) ; vec3 aG = aW . rgb ; float aC = aW . a ; aM ( aG ) ; aN ( aG , aC ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , aC ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"include",A:"std.glsl"},
{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 A ; GLSL_OUT float aU ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","aT",";"]}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; vec3 N = ad ( S , a_position ) ; A = a_halo_bb_vertex * 2.0 - 1.0 ; aU = a_random_vals ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"mat3 aY = aX ( N , M ) ; mat3 aZ = M ; aZ [ 0 ] [ 0 ] = 0.0 ; aZ [ 0 ] [ 1 ] = 0.0 ; aZ [ 0 ] [ 2 ] = 0.0 ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat3 aY = aX ( N , M ) ;".split(" ")}]}}]},{a:"txt",b:"vec2 a_ = ( a_halo_bb_vertex * 2.0 - 1.0 ) * u_halo_size ; vec3 bc = vec3 ( a_ [ 0 ] , 0.0 , a_ [ 1 ] ) ; vec3 bd = ad ( aY , bc ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( aZ , bd ) , 1.0 ) ; f . z = 0.99999 * f . w ;".split(" ")},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"aT = vec4 ( bd , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 f = u_proj_matrix * vec4 ( ad ( M , bd ) , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["lens_flares.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_sampler , A ) ; aM ( aG . rgb ) ; aN ( aG . rgb , aG . a ) ; GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};
a["lens_flares.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"define",c:"LIGHT_INDEX",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 A ; void main ( ) { A = a_texcoord ; vec3 be = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 f = u_proj_matrix * vec4 ( T ( u_view_tsr , be ) , 0.0 ) ; f . x /= f . w ; f . y /= f . w ; f += 99999.0 * step ( f . z , 0.0 ) ; f += 100.0 * ( step ( 1.0 , abs ( f . x ) ) + step ( 1.0 , abs ( f . y ) ) ) ; f . x = a_lf_dist * f . x ; f . y = a_lf_dist * f . y ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bh = vec2 ( a_lf_bb_vertex . x / bf , a_lf_bb_vertex . y ) ; if ( a_lf_dist < 0.999 ) { const float bi = 1.9 ; bh *= ( 1.0 + bi * length ( f . xy ) ) ; } gl_Position = vec4 ( f . xy + bh , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["line.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ALPHA",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 aG = u_diffuse_color . xyz ; float J = u_diffuse_color . a ; aM ( aG ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["line.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat3 M = u_view_tsr ; mat3 S = u_model_tsr ; aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , S ) ; vec4 bj = u_proj_matrix * vec4 ( ad ( M , al . N ) , 1.0 ) ; bj . xyz /= bj . w ; vec4 bk = u_proj_matrix * vec4 ( ad ( M , al . N + al . P ) , 1.0 ) ; bk . xyz /= bk . w ; float bf = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 bl = ( bk - bj ) . xy ; bl . x *= bf ; float bm = M_PI / 2.0 ; mat2 bn = mat2 ( cos ( bm ) , sin ( bm ) , - sin ( bm ) , cos ( bm ) ) ; bl = bn * bl ; bl = normalize ( bl ) ; vec2 bo = ( u_line_width / u_height ) * vec2 ( 1.0 / bf , 1.0 ) ; gl_Position = vec4 ( bj . xy + bl . xy * bo / 2.0 , bj . z , 1.0 ) ; gl_Position *= bj . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},
{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",
c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_DERIVATIVES_EXT"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"include",
A:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:"uniform float u_time ; uniform vec2 u_texel_size ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",
";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},
{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",
f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",
";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},
{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",
l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP","NUM_LAMP_LIGHTS",0,{a:"non_equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",
f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
l:2},{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",A:"nodes.glslf"},{a:"cond",
f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ; vec3 P = F ; vec4 bs = G ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1},"WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WETTABLE"],j:{a:"grp",f:[{a:"txt",
b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},
{a:"txt",b:"aG = max ( vec3 ( 0.0 ) , aG ) ; aM ( aG ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",
c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",
b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},
{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},
{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",
"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{a:"logical_or_expr",l:9}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",
f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]},{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",
3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","NODES",{a:"logic_negative_expr",l:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2},{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],
j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],
j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",
b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",
b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",
";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",A:"dynamic_grass.glslv"},{a:"include",A:"shadow.glslv"},{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},
{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"include",A:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["mat3","M","=","u_view_tsr",";"]},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["STATIC_BATCH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"txt",b:["vec3","N","=","a_position",";"]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL",
"DETAIL_BEND",{a:"logical_and_expr",l:3},"NODES",{a:"logic_negative_expr",l:1},"USE_TBN_SHADING","CALC_TBN",{a:"logical_and_expr",l:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:14}],j:{a:"grp",f:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"NODES",{a:"logic_negative_expr",l:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:13}],j:{a:"grp",f:[{a:"txt",b:["vec3","P","=","bz",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO",
"TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"elif",i:["NODES",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 bA = ad ( S , N ) ; vec3 U = normalize ( T ( S , bz ) ) ; vec3 C = bA - u_camera_eye ; vec3 R = cross ( C , U ) ; vec3 Q = cross ( U , R ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN"],j:{a:"grp",f:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{a:"logical_or_expr",l:10}],j:{a:"grp",f:[{a:"txt",b:"vec3 bB = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{a:"logical_or_expr",l:8}],j:{a:"grp",f:[{a:"txt",b:"P = mix ( P , bB , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( bB , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",i:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},{a:"else",
j:{a:"grp",f:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"aj al = aP ( N , Q , W , R , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"N = ( by * vec4 ( N , 1.0 ) ) . xyz ; ac = ( by * vec4 ( ac , 1.0 ) ) . xyz ; ae = ( by * vec4 ( ae , 1.0 ) ) . xyz ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = af ( u_camera_eye , ae , M , S ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"S = ah ( u_camera_eye , ae , M ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 aQ = ae ; S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , aQ , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",
{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"am ( al . N , al . ac , P , by ) ;".split(" ")}]}}]},{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"USE_NODE_MATERIAL_BEGIN",
"USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:13}],j:{a:"grp",f:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"bw = u_camera_eye - al . N ;".split(" ")},{a:"cond",f:[{a:"if",
i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"bx = al . aG ;".split(" ")}]}},{a:"elif",i:["VERTEX_COLOR"],j:{a:"grp",f:[{a:"txt",b:["bx","=","a_color",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 bC = by * vec4 ( al . N , 1.0 ) ; bC . xyz = ad ( M , bC . xyz ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",
l:6}],j:{a:"grp",f:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","NODES",{a:"logic_negative_expr",l:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"txt",b:["I","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["main_stack.glslf"]=
{a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_SPEC_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"TEXTURE_COLOR0_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"TEXTURE_COLOR1_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"PARALLAX",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_PASS",
b:["REFL_PASS_PLANE"]},{a:"var",c:"TEXTURE_SPEC",b:["0"]},{a:"var",c:"ALPHA_AS_SPEC",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK",b:["0"]},{a:"var",c:"TEXTURE_STENCIL_ALPHA_MASK_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"TEXCOORD",b:["0"]},{a:"var",c:"VERTEX_COLOR",b:["0"]},{a:"var",c:"WETTABLE",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},
{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"PARALLAX_LOD_DIST",b:["5.0"]},{a:"var",c:"PARALLAX_STEPS",b:["5.0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",
b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"SSAO_ONLY",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",
l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"include",A:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_STENCIL_ALPHA_MASK"],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",i:["SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",
";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",
";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO",
"TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_SPEC"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},
{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_parallax_scale",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},
"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS",{a:"logical_and_expr",l:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",
";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bw",";"]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN",
"vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"shadow.glslf"}]}}]},
{a:"include",A:"mirror.glslf"},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"include",A:"refraction.glslf"}]}}]},{a:"include",A:"environment.glslf"},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"lighting_nodes.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",
l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2},"SHADELESS",{a:"logic_negative_expr",l:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",l:3},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float bp = length ( i ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:["vec2","bE","=","A",
";"]}]}}]},{a:"txt",b:"vec3 bF = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],
j:{a:"grp",f:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 bG = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["mat3","M","=","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"vec2 bH = normalize ( T ( M , j ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"PARALLAX",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( bp < PARALLAX_LOD_DIST ) { float bI = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bp ) , 0.0 , 1.0 ) ; float bJ = u_parallax_scale * bI ; vec3 bK = normalize ( bw * bG ) ; float bL = 1.0 / PARALLAX_STEPS ; vec2 bM = bK . xy * bJ / ( PARALLAX_STEPS * bK . z ) ; float bN = 1.0 ; float bO ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec2","bP","=","bH",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec2","bP","=","bE",";"]}]}}]},{a:"txt",b:"bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; for ( float bQ = 1.0 ; bQ <= PARALLAX_STEPS ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bP -= bM ; bO = GLSL_TEXTURE ( u_normalmap0 , bP ) . a ; } } vec2 bR = bP + bM ; float bS = GLSL_TEXTURE ( u_normalmap0 , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bP = bU * bR + ( 1.0 - bU ) * bP ;".split(" ")},
{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"bE += bP - bH ;".split(" ")}]}}]},{a:"txt",b:["bH","=","bP",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"bH += bP - bE ;".split(" ")}]}}]},{a:"txt",b:["bE","=","bP",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["vec4","bV",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bH ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"bV = GLSL_TEXTURE ( u_normalmap0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 bW = bV . rgb - 0.5 ; bW = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , bW , u_normal_factor ) ; vec3 P = bG * bW ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","P",
"=","bF",";"]}]}}]},{a:"txt",b:"P = normalize ( P ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD"],j:{a:"grp",f:[{a:"txt",b:"bH = normalize ( T ( M , P ) ) . st ; bH = bH * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 bX = bx ; bY ( bX ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 bZ = vec4 ( bX , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec4","bZ","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","b_","=","1.0",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bH ) ;".split(" ")}]}},{a:"elif",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_colormap0 , bE ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bY ( ca . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_STENCIL_ALPHA_MASK"],j:{a:"grp",f:[{a:"txt",b:["vec4","cb",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bH ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"cb = GLSL_TEXTURE ( u_colormap1 , bE ) ;".split(" ")}]}}]},
{a:"txt",b:"bY ( cb . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bH ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 cc = GLSL_TEXTURE ( u_stencil0 , bE ) ;".split(" ")}]}}]},{a:"txt",b:"ca = mix ( ca , cb , cc . r ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ; float L = u_alpha_factor * ca . a ; L += ( 1.0 - step ( 0.0 , L ) ) ; bZ . a = mix ( L , 1.0 , u_diffuse_color . a ) ; b_ = ca . a ;".split(" ")}]}},{a:"elif",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ; bZ . a = ca . a ; b_ = ca . a ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADELESS"],j:{a:"grp",
f:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec4 bs = ch ( cd ) ; vec3 ci = u_emit * bZ . rgb ; vec3 cj = u_specular_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_SPEC"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_AS_SPEC"],j:{a:"grp",f:[{a:"txt",b:"vec3 ck = vec3 ( b_ ) ;".split(" ")}]}},{a:"elif",i:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bH ) . rgb ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ck = GLSL_TEXTURE ( u_specmap0 , bE ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bY ( ck . rgb ) ; cj = mix ( cj , ck , u_specular_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * cj ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , bs , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , M ) ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cq ( aG , C , P , u_reflect_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cq ( aG , C , P , u_mirror_factor , mat3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["aG","+=","co",";"]}]}}]},{a:"txt",b:"float J = bZ . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1},"WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WETTABLE"],j:{a:"grp",f:[{a:"txt",b:"aG = max ( aG - sqrt ( 0.01 * - min ( bq , 0.0 ) ) , 0.5 * aG ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CAUSTICS"],j:{a:"grp",f:[{a:"txt",b:"bt ( aG , bq , u_time , bs , P , u_sun_direction , u_sun_intensity , u_sun_quaternion , h , bp ) ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"float t = max ( max ( co . r , co . g ) , co . b ) * u_specular_alpha ; J = bZ . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],
j:{a:"grp",f:[{a:"txt",b:"vec2 cr = - ( T ( M , P ) ) . xy ; aG = mix ( cs ( l , cr * u_refr_bump ) , aG , J ) ; J = 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"bu ( aG , bp , C , bq ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"bu ( aG , bp , C , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",
l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float bv = GLSL_TEXTURE_PROJ ( u_shadow_mask , l ) . a ; aG = vec3 ( bv ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["particle_system.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",b:["0"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"NORMAL_TEXCOORD",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",
b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},
{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_DERIVATIVES_EXT"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",
f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],
j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC",
"USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES",
"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:7}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"NODES",{a:"logical_or_expr",
l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"include",A:"math.glslv"},{a:"include",A:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; vec3 aG = D ; float J = H ;".split(" ")},
{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"J = min ( 1.0 , J ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",
f:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};
a["particle_system.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"TEXTURE_NORM_CO",b:["TEXTURE_COORDS_NONE"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"SOFT_PARTICLES",
b:["0"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"WIND_BEND",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ; GLSL_IN vec2 a_p_bb_vertex ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bx",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR",
"HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:8}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","h",";"]},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","bw",";"]}]}}]},{a:"cond",f:[{a:"if",
i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"NODES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","aU",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","j",";"]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",i:["WORLD_SPACE",{a:"logic_negative_expr",l:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_COLOR_RAMP"],
j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"particles.glslv"},{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"include",A:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float cC ( vec2 cA , vec2 cB ) { return ( atan ( cB . y , cB . x ) - atan ( cA . y , cA . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:["mat4","by","=","u_view_refl_matrix",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat4 by = mat4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"mat3 M = u_view_tsr ; cD pp ; pp = cE ( ) ; float cF ; mat3 aY = cG ( ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 cH = ( by * vec4 ( pp . N , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 cH = pp . N ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = vec3 ( 0.0 , - 1.0 , 0.0 ) ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { cF = pp . bm ; aY = aX ( cH , M ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { cF = cC ( vec2 ( EPSILON , 1.0 ) , vec2 ( P . x , - P . y ) ) + pp . bm ; aY [ 0 ] = cH ; vec4 cJ = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ; aY = cK ( cJ , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { cF = pp . bm ; aY [ 0 ] = cH ; vec4 cL = cI ( UP_VECTOR , M_PI / 2.0 ) ; aY = cK ( cL , aY ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { cF = pp . bm ; aY [ 0 ] = cH ; } vec3 bc = vec3 ( ( a_p_bb_vertex [ 0 ] * 2.0 - 1.0 ) * pp . cM * u_p_size , 0.0 , ( a_p_bb_vertex [ 1 ] * 2.0 - 1.0 ) * pp . cM * u_p_size ) ; float cN = a_p_data [ 2 ] ; float cO = u_p_tilt * u_p_tilt_rand * ( 2.0 * cN - 1.0 ) ; float cP = ( cO + u_p_tilt ) * M_PI ; vec4 cQ = cI ( TOWARD_VECTOR , cP + cF ) ; vec3 bd = ad ( aY , O ( cQ , bc ) ) ; vec4 bC = vec4 ( ad ( M , bd ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},
{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["aU","=","cN",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 cR = cG ( ) ; cQ = cI ( TOWARD_VECTOR , cF ) ; cR = cK ( cQ , cR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",l:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",
l:2},{a:"logical_and_expr",l:2},"USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ; vec3 R = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , Q , vec3 ( 0.0 ) , R , P , aO ( aY , cR ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{a:"non_equal_expr",l:2},"CALC_TBN_SPACE",
"USE_TBN_SHADING",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"txt",b:"I ( pp . N , pp . cS , pp . cT , pp . cU , pp . cM , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , aO ( aY , cR ) ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["A","=","a_p_bb_vertex",";"]}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"A = a_p_bb_vertex * 2.0 - 1.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"cz = pp . J ;".split(" ")}]}}]},{a:"txt",b:"bx = pp . aG ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1},"PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO",
"CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:11}],j:{a:"grp",f:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",
l:1},"NODES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"txt",b:"gl_Position = f ; h = bd ;".split(" ")},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bw = u_camera_eye - bd ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",
c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"ALPHA_CLIP",b:["0"]},{a:"var",c:"SOFT_STRENGTH",b:["0.25"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"HALO_PARTICLES",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},
{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"PARTICLES_SHADELESS",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",
f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",
";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",
l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",
";"]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:8}],j:{a:"grp",f:[{a:"txt",
b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","h",";"]},{a:"cond",f:[{a:"if",i:["NODES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","cz",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bx",";"]}]}}]},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN",
"vec3","bw",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",l:1},"NODES",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","aU",";"]},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","aT",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",
b:"GLSL_IN vec3 j ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"include",A:"lighting_nodes.glslf"},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"environment.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"include",A:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",
i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1},"DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["HALO_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"vec4 aW = aV ( ) ; vec3 aG = aW . rgb * bx ; float cV = 0.9 * length ( A ) ; float cW = smoothstep ( u_p_alpha_start , u_p_alpha_end , cV ) ; float J = aW . a * ( 1.0 - cW ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec4",
"bZ","=","u_diffuse_color",";"]},{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"vec4 ca = GLSL_TEXTURE ( u_sampler , A ) ; bY ( ca . rgb ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bZ . rgb = mix ( bZ . rgb , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bZ . rgb *= mix ( vec3 ( 1.0 ) , ca . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"bZ . a = ca . a ;".split(" ")}]}}]},{a:"txt",b:"bZ . rgb *= bx ;".split(" ")},{a:"cond",f:[{a:"if",i:["PARTICLES_SHADELESS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ . rgb ; vec3 ci = u_emit * bZ . rgb ; vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",l:1},"SKY_COLOR",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( vec3 ( 0.0 ) ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 cf = u_environment_energy * ce ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cg = u_ambient * cf ; float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 aG ; vec3 co ; cp ( ci , cg , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 aG = bZ . rgb ;".split(" ")}]}}]},{a:"txt",
b:"float J = bZ . a * cz ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["ALPHA_CLIP"],j:{a:"grp",f:[{a:"txt",b:"if ( J < 0.5 ) discard ; J = 1.0 ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"bu ( aG , length ( i ) , C , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES"],j:{a:"grp",f:[{a:"txt",b:"float ct = - i . z / u_view_max_depth ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = cw - ct ; float cy = u_view_max_depth / SOFT_STRENGTH * cx ; J = J * min ( cy , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",f:[{a:"if",i:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["proc_skybox.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 cX ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float cY = 0.99 ; const float cZ = 1.8 ; const int c_ = 8 ; float de ( vec3 N , vec3 be ) { float a = dot ( be , be ) ; float b = 2.0 * dot ( be , N ) ; float da = dot ( N , N ) - 1.0 ; float db = b * b - 4.0 * a * da ; float dc = sqrt ( db ) ; float q = ( - b - dc ) / 2.0 ; float dd = da / q ; return dd ; } float dg ( float J , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float da = 1.0 + J * J ; float df = pow ( 1.0 + g * g - 2.0 * g * J , 1.5 ) ; df = max ( df , 0.00001 ) ; return ( a / b ) * ( da / df ) ; } float dl ( vec3 N , vec3 be , float dh ) { float di = dot ( be , - N ) ; if ( di < 0.0 ) { return 1.0 ; } vec3 dj = N + di * be ; if ( length ( dj ) < dh ) { return 0.0 ; } else if ( length ( dj ) >= dh ) { vec3 cB = normalize ( dj ) * dh - N ; float dk = acos ( dot ( normalize ( cB ) , be ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( dk * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 dm ( float aC , vec3 aG , float aB ) { return aG - aG * pow ( u_sky_color , vec3 ( aB / aC ) ) ; } void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dp = u_sun_direction ; float J = dot ( dn , dp ) ; float dq = dg ( J , - 0.01 ) * u_rayleigh_brightness * dp . z ; float dr = dg ( J - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - dp . z ) ; float ds = smoothstep ( 0.0 , 100.0 , dg ( J , 0.9995 ) ) * u_spot_brightness ; vec3 dt = vec3 ( 0.0 , 0.0 , cY ) ; float du = de ( dt , dn ) ; float dv = du / float ( c_ ) ; float dw = dl ( dt , dn , cY - 0.3 ) ; vec3 dx = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 dy = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < c_ ; bQ ++ ) { float dz = dv * float ( bQ ) ; vec3 N = dt + dn * dz ; float dA = dl ( N , dp , cY - 0.2 ) ; float dB = de ( N , dp ) ; vec3 dC = dm ( dB , vec3 ( cZ ) , u_scatter_strength ) * dA ; dx += dm ( sqrt ( dz ) , u_sky_color * dC , u_rayleigh_strength ) ; dy += dm ( dz , dC , u_mie_strength ) ; } dx = dx * dw * pow ( du , u_rayleigh_collection_power ) / float ( c_ ) ; dy = ( dy * dw * pow ( du , u_mie_collection_power ) ) / float ( c_ ) ; vec3 aG = vec3 ( ds * dy + dr * dy + dq * dx ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , 1.0 ) ; }".split(" ")}]};
a["shadow.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"SHADELESS",b:["0"]},{a:"var",c:"USE_VIEW_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_MODEL_TSR_INVERSE",b:["0"]},{a:"var",c:"USE_VIEW_TSR",b:["0"]},{a:"var",c:"USE_MODEL_TSR",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"SKY_COLOR",
b:["0"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"NUM_LAMP_LIGHTS",b:["0"]},{a:"var",c:"TEXTURE_BLEND_TYPE",b:["TEXTURE_BLEND_TYPE_MIX"]},{a:"var",c:"NUM_VALUES",b:["0"]},{a:"var",c:"NUM_RGBS",
b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_DERIVATIVES_EXT"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"include",A:"math.glslv"}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3",
"u_camera_eye_frag",";"]},{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_direction",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_VIEW_TSR",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_VIEW_TSR_INVERSE"],
j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_MODEL_TSR_INVERSE"],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT",
"SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_LAMP"],
j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_VALUE"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_RGB"],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",
f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{a:"txt",b:"uniform vec4 u_csm_center_dists ; uniform PRECISION GLSL_SMPLR2D_SHDW u_shadow_map0 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",f:[{a:"if",i:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform",
"PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_OBJECT_INFO"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_obj_info",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},
{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","k",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],
j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["SHADELESS",{a:"logic_negative_expr",l:1},"NODES","ALPHA",{a:"logical_and_expr",l:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"shadow.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslf"}]}}]},{a:"txt",b:["void","main",
"(",")","{"]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NODES"],j:{a:"grp",f:[{a:"txt",b:"vec3 C = normalize ( u_camera_eye_frag - h ) ; vec3 D ; vec3 E ; vec3 F ; vec4 G ; float H ; I ( C , D , E , F , G , H ) ; float J = H ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"float J = ( GLSL_TEXTURE ( u_colormap0 , A ) ) . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"float L = u_alpha_factor * J ; L += ( 1.0 - step ( 0.0 , L ) ) ; J = mix ( L , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( J < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},
{a:"elif",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = dD ( i . z ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( k . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},
{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"CALC_TBN",b:["0"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"NODES",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"SMAA_JITTER",b:["0"]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"AU_QUALIFIER",b:["GLSL_IN"]},
{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"HAIR_BILLBOARD",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"VERTEX_ANIM",b:["0"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"TEXTURE_COLOR",b:["0"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"VERTEX_ANIM_MIX_NORMALS_FACTOR",b:["u_va_frame_factor"]},{a:"var",c:"MAX_BONES",b:["0"]},{a:"var",
c:"WIND_BEND",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"scale_texcoord.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec4 a_tbn_quat ;".split(" ")},{a:"cond",
f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat_next",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logic_negative_expr",l:1},"TEXTURE_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",
i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","i",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","n",";"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","o",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","u",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],
j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],
j:{a:"grp",f:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logic_negative_expr",l:1},"TEXTURE_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec3","u_texture_scale",
";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},
{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",
";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",A:"dynamic_grass.glslv"},{a:"include",A:"shadow.glslv"},{a:"include",A:"skin.glslv"},{a:"include",A:"wind_bending.glslv"},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat3 M = u_view_tsr ; vec3 N = a_position ;".split(" ")},{a:"cond",f:[{a:"if",
i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",l:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:13}],j:{a:"grp",f:[{a:"txt",b:"vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; vec3 P = bz ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 P = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 R = sign ( a_tbn_quat [ 3 ] ) * cross ( P , Q ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 0.0 ) ; vec3 R = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["VERTEX_ANIM"],j:{a:"grp",f:[{a:"txt",b:"N = mix ( N , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"vec3 X = O ( a_tbn_quat_next , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; P = mix ( P , X , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 Y = O ( a_tbn_quat_next , vec3 ( 1.0 , 0.0 , 0.0 ) ) ; vec3 Z = sign ( a_tbn_quat_next [ 3 ] ) * cross ( X , Y ) ; Q = mix ( Q , Y , u_va_frame_factor ) ; R = mix ( R , Z , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"txt",b:"_(N,Q,R,P);".split("")}]}}]},{a:"cond",f:[{a:"if",i:["USE_INSTANCED_PARTCLS"],j:{a:"grp",f:[{a:"txt",b:"mat3 S = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["STATIC_BATCH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"S = aO ( u_model_tsr , S ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",
f:[{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["mat3","S","=","u_model_tsr",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",l:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","ac","=","au_center_pos",";"]}]}},{a:"elif",i:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ac = a_part_ts . xyz ; N = ad ( S , N ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 ac = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["CALC_TBN"],j:{a:"grp",f:[{a:"txt",b:"vec3 U = normalize ( T ( S , bz ) ) ; vec3 V = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , U ) ; vec3 W = cross ( U , V ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","W","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 W = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"txt",b:"aj al = aP ( N , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , P , ac , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , M ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"vec3 ae = ad ( S , ac ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["HAIR_BILLBOARD",{a:"logic_negative_expr",l:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2},{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["mat3","dE","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["mat3","dE","=","M",";"]}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = af ( u_camera_eye , ae , dE , S ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"S = ah ( u_camera_eye , ae , dE ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"S = ai ( u_wind , u_time , u_jitter_amp , u_jitter_freq , ae , S ) ;".split(" ")}]}}]},{a:"txt",b:"aj al = ak ( N - ac , ac , Q , W , R , P , S ) ; al . ac = ae ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"aj al = ak ( N , ac , Q , W , R , P , S ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:["vec3","an","=","bz",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 an = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"am ( al . N , al . ac , an , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"h = al . N ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",
{a:"logical_and_expr",l:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:12}],j:{a:"grp",f:[{a:"txt",b:"j = al . P ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"float ap = ( dot ( cross ( al . P , al . Q ) , al . R ) < 0.0 ) ? - 1.0 : 1.0 ; k = vec4 ( al . Q , ap ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:"B = al . aq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"vec4 bC = vec4 ( ad ( M , al . N ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_JITTER"],j:{a:"grp",f:[{a:"txt",b:"f . xy += u_subpixel_jitter * f . w ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NODES","ALPHA",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"USE_POSITION_CLIP",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"l = as ( f ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",
i:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["I","(",")",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["TEXTURE_COLOR"],j:{a:"grp",f:[{a:"txt",b:"A = ao ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bD ( al . N , al . P ) ;".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"NODES","ALPHA",{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["i","=","bC",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 dF = ( u_proj_matrix * vec4 ( M [ 0 ] , 1.0 ) ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; f . xy += dF ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",
";","}"]}]};a["sky.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},
{a:"txt",b:["uniform","samplerCube","u_sky",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"sky_blending.glslf"}]}}]},{a:"txt",b:["GLSL_IN","vec3","cX",";"]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 dH ; vec3 dn = normalize ( cX ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WO_SKYBLEND","WO_SKYPAPER",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["float","dI","=","0.0",";"]},{a:"cond",f:[{a:"if",i:["WO_SKYREAL"],j:{a:"grp",f:[{a:"txt",b:"dI = abs ( A . y ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dI = ( A . y + 1.0 ) * 0.5 ;".split(" ")}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:"vec3 dL = vec3 ( A , 0.0 ) ; vec4 dM = GLSL_TEXTURE_CUBE ( u_sky , dn ) ; bY ( dM . rgb ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky , dn ) . rgb ; bY ( dH ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float dO = WATER_LEVEL - u_camera_eye_frag . z ; vec3 dP = vec3 ( 0.0 ) ; vec3 dQ = mix ( u_underwater_fog_color_density . rgb , dP , min ( - dn . z , 1.0 ) ) ; dQ *= min ( 1.0 - min ( 0.03 * dO , 0.8 ) , 1.0 ) ; float aB = clamp ( sign ( 0.01 * dO - dn . z ) , 0.0 , 1.0 ) ; dH = mix ( dH , dQ , aB ) ;".split(" ")}]}}]},
{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["sky.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",
l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 dn = u_sky_vp_inverse * N ; cX = dn . xyz ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};
a["skybox.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PROCEDURAL_SKYDOME",b:["0"]},{a:"var",c:"WO_SKYTEX",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 cX ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",
";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 N = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 dn = u_cube_view_matrix * N ; cX = dn . xyz ;".split(" ")},{a:"cond",f:[{a:"if",i:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",l:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"A = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","N",";","}"]}]};a["tex_skybox.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"WO_SKYTEX",
b:["0"]},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"WO_SKYPAPER",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; GLSL_IN vec3 cX ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"include",A:"sky_blending.glslf"}]}}]},{a:"txt",b:"void main ( ) { vec3 dn = normalize ( cX ) ; vec3 dH ; float dI = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYPAPER"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:"dH = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) . xyz ; bY ( dH ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dH = vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",
i:["WO_SKYBLEND"],j:{a:"grp",f:[{a:"txt",b:"float J = acos ( dn . z ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYREAL"],j:{a:"grp",f:[{a:"txt",b:"dI = abs ( J * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dI = 1.0 - J * INV_PI ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec3 dJ = u_horizon_color ; vec3 dK = u_zenith_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["WO_SKYTEX"],j:{a:"grp",f:[{a:"txt",b:"vec4 dM = GLSL_TEXTURE_CUBE ( u_sky_texture , dn ) ; bY ( dM . rgb ) ; vec3 dL = vec3 ( cX . xy , 0.0 ) ; dH = dN ( dJ , dK , dM , dI , dL ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WO_SKYBLEND"],j:{a:"grp",f:[{a:"txt",b:"dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["dH","=","dJ",";"]}]}}]}]}}]}]}}]},{a:"txt",b:"aM ( dH ) ; GLSL_OUT_FRAG_COLOR = vec4 ( dH , 1.0 ) ; }".split(" ")}]};a["water.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},{a:"var",c:"NORM_FOAM0",b:["0"]},{a:"var",c:"NORM_FOAM1",
b:["0"]},{a:"var",c:"NORM_FOAM2",b:["0"]},{a:"var",c:"NORM_FOAM3",b:["0"]},{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"ABSORB",b:["6.0"]},{a:"var",c:"SSS_STRENGTH",b:["1.0"]},{a:"var",c:"SSS_WIDTH",b:["0.45"]},{a:"var",c:"ALPHA",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_LEVEL",
b:["0.0"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",c:"DYNAMIC",b:["0"]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"include",
A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.002"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",i:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform",
"float","u_environment_energy",";"]},{a:"cond",f:[{a:"if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec4 u_light_color_intensities [ NUM_LIGHTS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform",
"mat4","u_cube_fog",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D",
"u_plane_reflection",";"]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",3,{a:"g_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],
j:{a:"grp",f:[{a:"txt",b:"const float au = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 bw ; GLSL_IN vec3 h ; GLSL_IN vec3 j ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 k ; GLSL_IN vec3 dR ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","dS",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","dT",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","l",";"]}]}}]},{a:"cond",
f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","at",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","B",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",
A:"environment.glslf"},{a:"cond",f:[{a:"if",i:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"refraction.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"include",A:"fog.glslf"}]}}]},{a:"txt",b:"vec3 ed ( in vec2 dU , in vec3 P , in vec3 C , in vec3 dV , out float dW ) { dW = 0.0 ; vec3 dX = reflect ( - C , P ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 dY = dU . xy + P . xy * REFL_BUMP / m ; dW = u_reflect_factor ; vec3 dZ ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_FOG",{a:"logic_negative_expr",l:1},"WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"dZ = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"txt",b:"} else { dZ = GLSL_TEXTURE ( u_plane_reflection , dY ) . rgb ; bY ( dZ ) ; }".split(" ")}]}},
{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"dW = u_mirror_factor ; vec3 dZ = dV * GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . rgb ; bY ( dZ ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"dW = u_reflect_factor ; vec3 dZ = dV * vec3 ( 0.3 , 0.5 , 1.0 ) ; bY ( dZ ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float eb = u_fresnel_params [ 3 ] ; float ec = u_fresnel_params [ 2 ] ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; dW = min ( dW * r , 1.0 ) ; return dZ ; }".split(" ")},
{a:"include",A:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 bG = mat3 ( k , dR , j ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 P = normalize ( j ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC","FOAM",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",b:"float bq = h . z - WATER_LEVEL ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float bq = h . z ;".split(" ")}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"vec2 bE = vec2 ( dS . x , - dS . y ) + 0.5 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec2 bE = vec2 ( h . x , - h . y ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec2","bE","=","A",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,
{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ee = vec3 ( 0.0 ) ; vec3 ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:"vec3 eg = vec3 ( 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NORM_FOAM0"],j:{a:"grp",f:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NORM_FOAM1"],j:{a:"grp",f:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NORM_FOAM2"],j:{a:"grp",f:[{a:"txt",b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"ef = GLSL_TEXTURE ( u_normalmap0 , bE * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; ee += ef ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NORM_FOAM3"],j:{a:"grp",f:[{a:"txt",
b:["eg","+=","ef",";"]}]}}]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:"vec3 eh = bG * eg ; if ( ! ei ( eh , vec3 ( 0.0 ) ) ) eh = normalize ( eh ) ; vec3 ej = mix ( P , eh , 0.2 ) ; ej = normalize ( ej ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.3 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"P = mix ( P , normalize ( bG * ee ) , 0.5 ) ;".split(" ")}]}}]},
{a:"txt",b:"P = normalize ( P ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 C = normalize ( bw ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 dU = l . xy / l . z ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"vec2 ek = dU + P . xy * u_refr_bump / m ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ; vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , l ) ; float cw = cv ( cu ) ; float cx = max ( cw - m , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"float em = el ( cw , ek , dU ) ; float en = max ( em - m , 0.0 ) ; float eo = u_view_max_depth / ABSORB * en ; float ep = min ( J * eo , 1.0 ) ; J = min ( 15.0 * J * u_view_max_depth * cx , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float cy = u_view_max_depth / ABSORB * cx ; if ( u_cam_water_depth > 0.0 ) J = min ( J * cy , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:["float","ep","=","J",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) ep = 0.0 ; vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"float er = pow ( min ( dT . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 bZ = mix ( u_shallow_water_col , u_diffuse_color . rgb , er ) ; er = pow ( min ( dT . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; bZ = mix ( u_shore_water_col , bZ , er ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 bZ = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING"],j:{a:"grp",f:[{a:"txt",b:"float es = max ( 1.0 - u_view_max_depth * cx , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float es = 1.0 - J ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"float et = max ( bq / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],
j:{a:"grp",f:[{a:"txt",b:"vec3 eu = normalize ( vec3 ( dT . rg , 0.0 ) ) ; vec3 ev = normalize ( mix ( UP_VECTOR , eu , 0.8 ) ) ; float ew = 1.25 * max ( dot ( ej , ev ) - 0.2 , 0.0 ) ; ew += max ( dot ( ej , - UP_VECTOR ) , 0.0 ) ; es += ew * ( 1.0 - dT . b ) ; et *= ( 1.0 - 0.95 * pow ( dT . b , 0.1 ) ) ;".split(" ")}]}}]},{a:"txt",b:"es += et ; es = min ( u_foam_factor * es , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 ex = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bE * u_foam_scale ) ;".split(" ")}]}}]},
{a:"txt",b:"float cl = u_specular_params [ 0 ] ; vec2 cm = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 cn = cl * u_specular_color ; vec3 cf = u_environment_energy * ce ( P ) ; vec3 cg = u_ambient * cf ; vec3 dV = cg + u_sun_intensity ; float dW ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 dZ = ed ( dU , P , C , dV , dW ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 dZ = ed ( vec2 ( 0.0 ) , P , C , dV , dW ) ;".split(" ")}]}}]},
{a:"txt",b:"vec3 cd = u_diffuse_intensity * bZ ; vec3 aG ; vec3 co ; cp ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cd , cn , h , P , C , cm , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , aG , co ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"float ey = max ( dot ( u_sun_direction , - j ) + SSS_WIDTH , 0.0 ) * max ( dot ( - C , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; ey = clamp ( SSS_STRENGTH * ey , 0.0 , 1.0 ) ; aG = mix ( aG , u_shallow_water_col , ey ) ; aG = mix ( aG , u_shore_water_col , ey ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"txt",b:"aG = mix ( eq , aG , ep ) ;".split(" ")}]}}]},{a:"txt",b:"aG = mix ( aG , dZ , dW ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:"float ez = mix ( ex . g , ex . r , max ( 4.0 * ( es - 0.75 ) , 0.0 ) ) ; ez = mix ( ex . b , ez , max ( 2.0 * es - 1.0 , 0.0 ) ) ; ez = mix ( 0.0 , ez , es ) ; aG = mix ( aG , dV , ez ) ;".split(" ")}]}}]},{a:"txt",b:["aG","+=","co",";"]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",
{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float eA = m * u_view_max_depth ; float eB = 1.0 ; if ( u_cam_water_depth > 1.0 ) eB = 2.0 ; bu ( aG , eA , C , eB ) ;".split(" ")}]}}]},{a:"txt",b:["aM","(","aG",")",";"]},{a:"cond",f:[{a:"if",i:["REFRACTIVE",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"J = max ( J , co . r ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["FOAM"],j:{a:"grp",f:[{a:"txt",b:["J","+=","ez",";"]}]}}]}]}},{a:"elif",i:["SHORE_SMOOTHING",
{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:["J","=","1.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aN ( aG , J ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GLSL1"],j:{a:"grp",f:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 aD = fwidth ( at ) ; vec3 aE = smoothstep ( vec3 ( 0.0 ) , aD * au , at ) ; float eC = min ( min ( aE . x , aE . y ) , aE . z ) ; eC = clamp ( eC , 0.0 , 1.0 ) ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}},
{a:"elif",i:["DEBUG_WIREFRAME",2,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 aC = sign ( at - vec3 ( 0.02 * au ) ) ; float eC = 1.0 ; if ( aC . x < 0.0 || aC . y < 0.0 || aC . z < 0.0 ) eC = 0.0 ; aG = mix ( u_wireframe_edge_color , aG , eC ) ; J = mix ( 1.0 , J , eC ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG , J ) ; }".split(" ")}]};a["water.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"USE_TBN_SHADING",b:["0"]},
{a:"var",c:"DEBUG_WIREFRAME",b:["0"]},{a:"var",c:"NUM_NORMALMAPS",b:["0"]},{a:"var",c:"FOAM",b:["0"]},{a:"var",c:"SHORE_PARAMS",b:["0"]},{a:"var",c:"MAX_SHORE_DIST",b:["100.0"]},{a:"var",c:"SHORE_MAP_SIZE_X",b:["1.0"]},{a:"var",c:"SHORE_MAP_SIZE_Y",b:["1.0"]},{a:"var",c:"SHORE_MAP_CENTER_X",b:["0.0"]},{a:"var",c:"SHORE_MAP_CENTER_Y",b:["0.0"]},{a:"var",c:"GENERATED_MESH",b:["0"]},{a:"var",c:"DST_NOISE_SCALE_0",b:["0.05"]},{a:"var",c:"DST_NOISE_SCALE_1",b:["0.03"]},{a:"var",c:"DST_NOISE_FREQ_0",b:["1.3"]},
{a:"var",c:"DST_NOISE_FREQ_1",b:["1.0"]},{a:"var",c:"DIR_MIN_SHR_FAC",b:["0.4"]},{a:"var",c:"DIR_FREQ",b:["0.5"]},{a:"var",c:"DIR_NOISE_SCALE",b:["0.05"]},{a:"var",c:"DIR_NOISE_FREQ",b:["0.07"]},{a:"var",c:"DIR_MIN_NOISE_FAC",b:["0.5"]},{a:"var",c:"DST_MIN_FAC",b:["0.2"]},{a:"var",c:"WAVES_HOR_FAC",b:["5.0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WAVES_LENGTH",b:["10.0"]},{a:"var",c:"WATER_LEVEL",b:["0.0"]},{a:"var",c:"SHORE_SMOOTHING",b:["0"]},{a:"var",
c:"DYNAMIC",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"include",A:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH",{a:"logic_negative_expr",l:1},"DYNAMIC",{a:"logic_negative_expr",l:1},"NUM_NORMALMAPS",0,{a:"g_expr",l:2},{a:"logical_or_expr",
l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","a_tbn_quat",";"]}]}}]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH",{a:"logic_negative_expr",l:1},"NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 bw ; GLSL_OUT vec3 h ; GLSL_OUT vec3 j ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","A",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec3 k ; GLSL_OUT vec3 dR ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",
l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","dS",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","dT",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","l",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",
l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","float","m",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","at",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_TBN_SHADING"],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec3","B",";"]}]}}]},{a:"cond",f:[{a:"if",i:["STATIC_BATCH"],j:{a:"grp",f:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["uniform",
"mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:["uniform","PRECISION","float",
"u_view_max_depth",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"vec3 eJ ( in vec2 eD ) { vec2 eE = 0.5 + vec2 ( ( eD . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , ( eD . y - SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 eF = GLSL_TEXTURE ( u_shore_dist_map , eE ) ; const vec2 eG = vec2 ( 1.0 / 255.0 , 1.0 ) ; float eH = dot ( eF . ba , eG ) ; vec2 eI = normalize ( eF . rg * 2.0 - 1.0 ) ; return vec3 ( eI , eH ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"define",c:"SMALL_WAVES_FAC",b:["0.2"]},{a:"txt",b:"void eY ( inout vec3 eD , in float eK , in vec3 eF ) { float eM = eL ( DST_NOISE_SCALE_0 * ( eD . xy + DST_NOISE_FREQ_0 * eK ) ) * eL ( DST_NOISE_SCALE_1 * ( eD . yx - DST_NOISE_FREQ_1 * eK ) ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"float eN = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float eH = eF . b ; float eO = sqrt ( eH ) ; float eP = max ( eH , DIR_MIN_SHR_FAC ) * sin ( eO / eN + DIR_FREQ * eK ) ; float eQ = max ( eL ( DIR_NOISE_SCALE * ( eD . xy + DIR_NOISE_FREQ * eK ) ) , DIR_MIN_NOISE_FAC ) ; eP *= eQ ; float eR = WAVES_HEIGHT * mix ( eP , eM , max ( eO , DST_MIN_FAC ) ) ; vec2 eI = eF . rg ; float eS = WAVES_HOR_FAC * eP * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - eH ) , 0.0 ) ; vec2 eT = eS * eI ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"float eR = WAVES_HEIGHT * eM ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"txt",b:"vec2 eU = 1.0 * ( eD . xy - 0.3 * eK ) ; vec2 eV = 0.7 * ( eD . yx + 0.07 * eK ) ; float eX = eW ( eU ) . x + eW ( eV ) . x - 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"eD . xy += eT ; eX *= eH ;".split(" ")}]}}]},{a:"txt",b:"eR += SMALL_WAVES_FAC * eX ;".split(" ")}]}}]},{a:"txt",b:"eD . z += eR ; }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["DEBUG_WIREFRAME"],j:{a:"grp",f:[{a:"txt",b:"if ( a_polyindex == 0.0 ) at = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) at = vec3 ( 0.0 , 0.0 , 1.0 ) ; else at = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"txt",b:"vec3 N = a_position ; float eZ = abs ( N . z ) ; vec2 e_ = u_camera_eye . xy - mod ( u_camera_eye . xy , eZ ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],
j:{a:"grp",f:[{a:"txt",b:"N . z = WATER_LEVEL ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"N . z = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"N . xy += e_ ; vec3 bA = N ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2},"FOAM",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["A","=","a_texcoord",";"]}]}}]},{a:"txt",b:"aj al = ak ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , u_model_tsr ) ; vec3 bA = al . N ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"dT = eJ ( bA . xy ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DYNAMIC"],j:{a:"grp",f:[{a:"txt",b:"float fa = length ( u_wind ) ; if ( fa == 0.0 ) fa = 1.0 ; float fb = u_time ; fb *= fa ;".split(" ")},{a:"cond",f:[{a:"if",i:["GENERATED_MESH"],j:{a:"grp",f:[{a:"txt",b:"float fc = eZ ; vec3 fd = bA + vec3 ( fc , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , fc , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",
l:2},"FOAM",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["dS","=","bA",";"]}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 fd = bA + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 fe = bA + vec3 ( 0.0 , 0.05 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SHORE_PARAMS"],j:{a:"grp",f:[{a:"txt",b:"vec3 ff = eJ ( fd . xy ) ; vec3 fg = eJ ( fe . xy ) ; eY ( fd , fb , ff ) ; eY ( fe , fb , fg ) ; eY ( bA , fb , dT ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"eY ( fd , fb , vec3 ( 0.0 ) ) ; eY ( fe , fb , vec3 ( 0.0 ) ) ; eY ( bA , fb , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( a_position . z < 0.0 ) { bA . z = WATER_LEVEL - 1.0 ; fd . z = bA . z ; fe . z = bA . z ; }".split(" ")}]}}]},{a:"txt",b:"vec3 fh = normalize ( fd - bA ) ; vec3 Q = normalize ( fe - bA ) ; j = normalize ( cross ( fh , Q ) ) ; float fi = dot ( j , UP_VECTOR ) ; float aB = clamp ( 0.8 - fi , 0.0 , 1.0 ) ; j = mix ( j , UP_VECTOR , aB ) ;".split(" ")}]}},{a:"elif",i:["GENERATED_MESH",{a:"logic_negative_expr",
l:1}],j:{a:"grp",f:[{a:"txt",b:"j = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"j = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_NORMALMAPS",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DYNAMIC",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["GENERATED_MESH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = O ( a_tbn_quat , vec3 ( 1.0 , 0.0 , 0.0 ) ) ;".split(" ")}]}},
{a:"elif",i:["DYNAMIC",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec3 Q = vec3 ( 1.0 , 0.0 , 0.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"k = Q ; dR = cross ( j , k ) ;".split(" ")}]}}]},{a:"txt",b:"h = bA ; bw = u_camera_eye - bA ; vec4 bC = vec4 ( ad ( u_view_tsr , bA ) , 1.0 ) ; vec4 f = u_proj_matrix * bC ;".split(" ")},{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"float fj = f . x ; float fk = f . y ; float fl = f . w ; l . x = ( fj + fl ) / 2.0 ; l . y = ( fk + fl ) / 2.0 ; l . z = fl ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_or_expr",l:4}],j:{a:"grp",f:[{a:"txt",b:"m = - bC . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["postprocessing/antialiasing.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_FXAA_LIGHT"]},{a:"var",c:"AA_QUALITY",b:["AA_QUALITY_LOW"]},{a:"include",A:"precision_statement.glslf"},
{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",c:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",c:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 fn ( float x , float y ) { vec2 fm = A + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , fm ) ; } vec4 fG ( ) { vec4 fo = fn ( - 1.0 , - 1.0 ) ; vec4 fp = fn ( 1.0 , - 1.0 ) ; vec4 fq = fn ( - 1.0 , 1.0 ) ; vec4 fr = fn ( 1.0 , 1.0 ) ; vec4 fs = fn ( 0.0 , 0.0 ) ; float fu = ft ( fs ) ; float fv = ft ( fo ) ; float fw = ft ( fp ) ; float fx = ft ( fq ) ; float fy = ft ( fr ) ; float fz = min ( fu , min ( min ( fv , fw ) , min ( fx , fy ) ) ) ; float fA = max ( fu , max ( max ( fv , fw ) , max ( fx , fy ) ) ) ; vec2 be ; be . x = - ( ( fv + fw ) - ( fx + fy ) ) ; be . y = ( ( fv + fx ) - ( fw + fy ) ) ; float fB = max ( ( fv + fw + fx + fy ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float fC = 1.0 / ( min ( abs ( be . x ) , abs ( be . y ) ) + fB ) ; be = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , be * fC ) ) * u_texel_size ; vec4 fD = 0.5 * ( GLSL_TEXTURE ( u_color , A + be * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , A + be * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 fE = fD * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , A + be * - 0.5 ) + GLSL_TEXTURE ( u_color , A + be * 0.5 ) ) ; float fF = ft ( fE ) ; if ( ( fF < fz ) || ( fF > fA ) ) return fD ; else return fE ; }".split(" ")}]}},
{a:"elif",i:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"include",A:"fxaa.glslf"},{a:"cond",f:[{a:"if",i:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},{a:"elif",i:["AA_QUALITY","AA_QUALITY_MEDIUM",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",i:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",c:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",c:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",
b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fG ( ) ;".split(" ")}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 fH = u_texel_size ; GLSL_OUT_FRAG_COLOR = fI ( A , u_color , fH , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},{a:"txt",
b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 fJ = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = fJ * 0.0875447373698 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0858112354248 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0808139781061 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0731235112908 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0635705267419 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0530985673112 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0426125984122 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0328565115809 ; eY += cx ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A + eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , A - eY ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * fJ , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_main , A ) ; vec4 fL = GLSL_TEXTURE ( u_bloom , A ) ; GLSL_OUT_FRAG_COLOR = fK + fL ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",
c:"PRECISION",b:["highp"]},{a:"var",c:"COC_TYPE",b:["COC_ALL"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_COMBINE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = GLSL_TEXTURE ( u_color , A ) ; if ( u_dof_dist > 0.0 ) { float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fO = 0.0 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_COMBINE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 fP = GLSL_TEXTURE ( u_coc_fg , A ) ; float fQ = fP . a ;".split(" ")}]}}]},{a:"txt",b:"if ( fN < u_dof_dist ) fO = ( u_dof_dist - fN - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"else fO = ( fN - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"fO = clamp ( fO , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_COMBINE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"fO = max ( fO , fQ ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fO ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz * fO , fO ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( aG . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fR = GLSL_TEXTURE ( u_color , A ) ; vec3 aG = fR . rgb ; if ( u_brightness < 0.0 ) aG = aG * ( 1.0 + u_brightness ) ; else aG = aG + ( ( 1.0 - aG ) * u_brightness ) ; aG = ( aG - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * M_PI_4 ) ) + 0.5 ; aG *= u_exposure ; float cZ = ft ( vec4 ( aG , 0.0 ) ) ; aG = mix ( vec3 ( cZ ) , aG , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , fR . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = fS ( clamp ( fM ( u_depth , A , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};
a["postprocessing/dof.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DOF_TYPE",b:["DOF_SIMPLE"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fT = GLSL_TEXTURE ( u_sharp , A ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",
i:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float fO ; vec4 fU = GLSL_TEXTURE ( u_blurred1 , A ) ; vec4 fV = GLSL_TEXTURE ( u_blurred2 , A ) ; vec4 fW = min ( fU . rgba , fV . rgba ) ; fO = fW . a ; if ( fO > 0.0 ) { fW = vec4 ( fW . rgb / fO , fT . a ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fW , min ( fO * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = fT ;".split(" ")}]}},{a:"elif",i:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float fN = fM ( u_depth , A , u_camera_range ) ; fN *= u_view_max_depth ; float fX ; if ( fN < u_dof_dist ) fX = ( u_dof_dist - fN ) / u_dof_front_end ; else fX = ( fN - u_dof_dist ) / u_dof_rear_end ; fX = clamp ( fX , 0.0 , 1.0 ) ; vec4 fY = GLSL_TEXTURE ( u_blurred , A ) ; GLSL_OUT_FRAG_COLOR = mix ( fT , fY , fX ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","fT",";"]}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = fT ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fZ = GLSL_TEXTURE ( u_src_color , A ) ; vec4 f_ = GLSL_TEXTURE ( u_glow_mask_small , A ) ; vec4 gc = GLSL_TEXTURE ( u_glow_mask_large , A ) ; GLSL_OUT_FRAG_COLOR = fZ ; if ( gc . a != 0.0 ) { float gd = u_glow_mask_large_coeff * gc . a ; gd = clamp ( gd , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , gc . rgb / gc . a , gd ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , gd ) ; } if ( f_ . a != 0.0 ) { float ge = u_glow_mask_small_coeff * f_ . a ; ge = clamp ( ge , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , f_ . rgb / f_ . a , ge ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , ge ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"STEPS_PER_PASS",b:["10.0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"depth_fetch.glslf"},{a:"include",A:"procedural.glslf"},{a:"include",A:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},
{a:"cond",f:[{a:"if",i:["DEPTH_RGBA"],j:{a:"grp",f:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN float gf ; GLSL_IN vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_IN vec4 gi ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cx = ( gi . xy - A ) ; float aC = length ( cx ) ; vec2 gj = u_radial_blur_step * cx / aC ; float gk = aC / u_radial_blur_step ; gj *= min ( gk , STEPS_PER_PASS ) / STEPS_PER_PASS ; gk = max ( gk , STEPS_PER_PASS ) ; vec2 gl = A ; float gm = 0.0 ; const int gn = int ( STEPS_PER_PASS ) ; int go = int ( gk + 0.5 ) ; for ( int bQ = 0 ; bQ < gn ; bQ += 1 ) { if ( bQ <= go ) {".split(" ")},
{a:"cond",f:[{a:"if",i:["DEPTH_RGBA"],j:{a:"grp",f:[{a:"txt",b:"float fN = fM ( u_input , gl , u_camera_range ) ; gm += max ( ( 1.0 - pow ( aC , 0.3 ) ) * step ( 0.9 , fN ) , 0.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 gp = GLSL_TEXTURE ( u_input , gl ) ; gm += cv ( gp ) ;".split(" ")}]}}]},{a:"txt",b:"} gl += gj ; }".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 bE = A + gh ; float gq = eW ( vec2 ( 2.5 * ( bE . x ) , 2.5 * ( bE . y ) + 1.0 * u_time ) ) . x + 0.75 * eW ( vec2 ( 5.0 * ( bE . x ) - 0.66 * u_time , 5.0 * ( bE . y ) + 0.66 * u_time ) ) . x + 0.5 * eL ( vec2 ( 7.5 * ( bE . x ) + 0.33 * u_time , 7.5 * ( bE . y ) - 0.33 * u_time ) ) ; gq *= clamp ( 1.2 - sqrt ( 0.2 * aC ) , 0.0 , 1.0 ) * gf ; gm = max ( gq , gm ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = fS ( gm / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"DEPTH_RGBA",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",";"]},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT float gf ; GLSL_OUT vec2 gh ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 A ; GLSL_OUT vec4 gi ; void main ( ) { A = a_bb_vertex ; vec3 be = normalize ( u_sun_direction ) ; gi = u_view_proj_matrix * vec4 ( be , 0.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:"if ( u_cam_water_depth < 0.0 ) { gf = 1.0 ; vec3 gs = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 gt = O ( u_camera_quat , gs ) ; gt = normalize ( gt ) ; float gu = dot ( gt , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float gv = atan ( gt . x , gt . z ) ; gh = vec2 ( - gv , acos ( gu ) ) ; } else { gf = 0.0 ; }".split(" ")}]}}]},{a:"txt",b:"gi . xy = 0.5 * ( gi . xy / gi . w + 1.0 ) ; gi += 99999.0 * step ( gi . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy - 1.0 , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]=
{a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SAFARI_CANVAS_ALPHA_HACK",b:["0"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"include",A:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gw = GLSL_TEXTURE ( u_main , A ) ; vec3 gx = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bY ( gw . rgb ) ; float gy = cv ( GLSL_TEXTURE ( u_god_rays , A ) ) ; vec3 gz = gw . rgb + u_god_rays_intensity * vec3 ( gy ) * gx ; aM ( gz ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SAFARI_CANVAS_ALPHA_HACK"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , max ( 0.01 , gw . a ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( gz , gw . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 fK = GLSL_TEXTURE ( u_input , A ) ; float gA = dot ( fK . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gA ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gA ; float gB = 0.0 ; float w = 0.025 ; float bO = 0.025 ; for ( int bQ = 0 ; bQ < 20 ; bQ += 1 ) { bO = 0.025 ; for ( int gC = 0 ; gC < 20 ; gC += 1 ) { gA = max ( GLSL_TEXTURE ( u_input , vec2 ( w , bO ) ) . r , 0.01 ) ; gB += log ( gA ) ; bO += 0.05 ; } w += 0.05 ; } float gD = exp ( gB / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( gD ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 A ; GLSL_IN float gE ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float gD = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float gF = GLSL_TEXTURE ( u_luminance , A ) . r ; vec4 aG = GLSL_TEXTURE ( u_main , A ) ; float gG = gF / gD ; float gH = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = aG * max ( gG - gH , 0.0 ) * gE ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; GLSL_OUT float gE ; void gP ( in vec4 gI , in vec3 gJ , out vec3 gK ) { float gL = gI . w * gJ . x + gI . y * gJ . z - gI . z * gJ . y ; float gM = gI . w * gJ . y + gI . z * gJ . x - gI . x * gJ . z ; float gN = gI . w * gJ . z + gI . x * gJ . y - gI . y * gJ . x ; float gO = - gI . x * gJ . x - gI . y * gJ . y - gI . z * gJ . z ; gK . x = gL * gI . w - gO * gI . x - gM * gI . z + gN * gI . y ; gK . y = gM * gI . w - gO * gI . y - gN * gI . x + gL * gI . z ; gK . z = gN * gI . w - gO * gI . z - gL * gI . y + gM * gI . x ; } void main ( ) { A = 2.0 * a_position ; vec3 gt ; gP ( u_camera_quat , UP_VECTOR , gt ) ; gE = dot ( - gt , u_sun_direction ) * u_bloom_key ; gE *= max ( sign ( u_sun_direction . z ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float gQ = 0.0042 ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gR = GLSL_TEXTURE ( u_mb_tex_curr , A ) ; vec4 gS = GLSL_TEXTURE ( u_mb_tex_accum , A ) ; if ( length ( gR - gS ) > u_motion_blur_decay_threshold ) { vec4 gT = ( 1.0 - u_motion_blur_exp ) * gR + u_motion_blur_exp * gS ; vec4 gU = gT - gS ; vec4 gV = gR - gS ; vec4 cx = min ( max ( abs ( gU ) , vec4 ( gQ ) ) , abs ( gV ) ) * sign ( gU ) ; GLSL_OUT_FRAG_COLOR = gS + cx ; } else { GLSL_OUT_FRAG_COLOR = gR ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 gW = GLSL_TEXTURE ( u_outline_src , A ) ; GLSL_OUT_FRAG_COLOR = gW ; if ( u_draw_outline != 0.0 ) { vec4 gX = GLSL_TEXTURE ( u_outline_mask , A ) ; vec4 gY = GLSL_TEXTURE ( u_outline_mask_blurred , A ) ; float gZ = gY . a - gX . a ; if ( gZ != 0.0 ) { float g_ = smoothstep ( 0.0 , 1.0 , gY . a ) ; if ( gX . a == 0.0 ) { vec3 ha = u_outline_color ; aM ( ha ) ; vec4 hb = vec4 ( clamp ( ha , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( gW , hb , g_ ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 aG = vec4 ( 0.0 ) ; for ( int bQ = 0 ; bQ < 10 ; bQ ++ ) { vec2 hc = vec2 ( fract ( A * vec2 ( bQ ) * vec2 ( 1.431 , 3.921 ) ) ) ; aG += 0.01 * GLSL_TEXTURE ( u_color , hc ) ; } GLSL_OUT_FRAG_COLOR = aG ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]=
{a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"POST_EFFECT",b:["POST_EFFECT_NONE"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",f:[{a:"if",i:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",l:2}],
j:{a:"grp",f:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",f:[{a:"if",i:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}},{a:"elif",i:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 da = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( da . r + da . g + da . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},
{a:"elif",i:["POST_EFFECT","POST_EFFECT_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * 0.0162162162 ;".split(" ")}]}},
{a:"elif",i:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.152507 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.141763 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.113861 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.079019 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.047383 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.024549 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.01099 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00425 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; GLSL_OUT_FRAG_COLOR += aG * ( 1.0 - step ( 0.0 , - aG . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",i:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; float fO ; float hf = u_dof_bokeh_intensity ; aG = GLSL_TEXTURE ( u_color , A ) ; hd = aG ; he = aG ; fO = aG . a ; cx = fO * cx ; for ( int bQ = 0 ; bQ < 12 ; bQ += 2 ) { eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; hd += aG ; he = max ( he , aG ) ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; hd += aG ; he = max ( he , aG ) ; } hd /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , hf ) ;".split(" ")}]}},
{a:"elif",i:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 eY = vec2 ( 0.0 , 0.0 ) ; vec2 cx = u_texel_size ; vec4 aG ; vec4 hd ; vec4 he ; aG = GLSL_TEXTURE ( u_color , A ) ; he = max ( he , aG ) ; hd = aG ; hd . a = aG . a * 0.2270270270 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1945945946 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.1216216216 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0540540541 ; eY += cx ; aG = GLSL_TEXTURE ( u_color , A + eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; aG = GLSL_TEXTURE ( u_color , A - eY ) ; he . a = max ( he . a , aG . a ) ; hd . a += aG . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( hd , he , 0.5 ) ;".split(" ")}]}},
{a:"elif",i:["POST_EFFECT","POST_EFFECT_EXTEND",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 cx = u_texel_size ; vec4 aG = GLSL_TEXTURE ( u_color , A ) ; GLSL_OUT_FRAG_COLOR = aG ; if ( aG . a == 0.0 ) { aG = GLSL_TEXTURE ( u_color , A + cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; else { aG = GLSL_TEXTURE ( u_color , A - cx ) ; if ( aG . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , aG . a ) ; } }".split(" ")}]}},{a:"elif",i:["POST_EFFECT",
"FLIP_CUBEMAP_COORDS",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float hg = u_delta [ 0 ] ; float hh = u_delta [ 1 ] ; float hi = 1.0 / 3.0 ; float hj = 0.5 ; vec2 hk = vec2 ( hi , hj ) ; if ( u_tex_number == 0 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = max ( bE [ 1 ] , hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , hj - bE [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bE = mat2 ( 0.0 , - 1.0 , 1.0 , 0.0 ) * A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bE = A * hk + vec2 ( 2.0 * hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , 2.0 * hi + hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 1.5 - bE [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bE = A * hk + vec2 ( hi , 0.0 ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , hj - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bE [ 0 ] , bE [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bE = A * hk + vec2 ( hi , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hi + hg ) ; bE [ 0 ] = min ( bE [ 0 ] , 2.0 * hi - hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bE [ 0 ] , 3.0 * hj - bE [ 1 ] ) ) ; } else { vec2 bE = A * hk + vec2 ( 0.0 , hj ) ; bE [ 0 ] = max ( bE [ 0 ] , hg ) ; bE [ 1 ] = min ( bE [ 1 ] , 1.0 - hh ) ; bE [ 1 ] = max ( bE [ 1 ] , hj + hh ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( hi - bE [ 0 ] , bE [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"std.glsl"},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ; void main ( ) { A = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"SMAA_REPROJECTION",b:["0"]},{a:"var",c:"SMAA_PREDICATION",
b:["0"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_color_prev",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},
{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2},"SMAA_PREDICATION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},
{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec4","hl",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec4 hm ; GLSL_IN vec4 hn ; GLSL_IN vec4 ho ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec2","hp",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4",
"GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",c:"SMAA_DISABLE_CORNER_DETECTION",
b:["1"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",c:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",
b:["16"]},{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_THRESHOLD",j:{a:"grp",f:[{a:"define",c:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_DEPTH_THRESHOLD",j:{a:"grp",f:[{a:"define",c:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS_DIAG",j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_CORNER_ROUNDING",j:{a:"grp",
f:[{a:"define",c:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",j:{a:"grp",f:[{a:"define",c:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION",j:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_THRESHOLD",j:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_SCALE",j:{a:"grp",
f:[{a:"define",c:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_PREDICATION_STRENGTH",j:{a:"grp",f:[{a:"define",c:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_REPROJECTION",j:{a:"grp",f:[{a:"define",c:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_REPROJECTION_WEIGHT_SCALE",j:{a:"grp",f:[{a:"define",c:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",j:{a:"grp",f:[{a:"define",
c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",c:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",c:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",c:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",c:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},{a:"define",c:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",c:"SMAA_CORNER_ROUNDING_NORM",
b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 ht ( vec2 bE , sampler2D hq ) { float p = GLSL_TEXTURE ( hq , bE ) . r ; float hr = GLSL_TEXTURE ( hq , hm . xy ) . r ; float hs = GLSL_TEXTURE ( hq , hm . zw ) . r ; return vec3 ( p , hr , hs ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 hx ( vec2 bE , sampler2D hu ) { vec3 hv = ht ( bE , hu ) ; vec2 cx = abs ( hv . xx - hv . yz ) ; vec2 hw = step ( SMAA_PREDICATION_THRESHOLD , cx ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * hw ) ; }".split(" ")}]}}]},
{a:"txt",b:"void hB ( bvec2 hy , inout vec2 hz , vec2 hA ) { if ( hy . x ) hz . x = hA . x ; if ( hy . y ) hz . y = hA . y ; } void hB ( bvec4 hy , inout vec4 hz , vec4 hA ) { hB ( hy . xy , hz . xy , hA . xy ) ; hB ( hy . zw , hz . zw , hA . zw ) ; } vec2 hC ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 hC ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:"vec2 hP ( vec2 bE , sampler2D hD".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PREDICATION"],j:{a:"grp",f:[{a:"txt",b:[",","sampler2D","hu"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",f:[{a:"if",i:["SMAA_PREDICATION"],j:{a:"grp",f:[{a:"txt",b:"vec2 hE = hx ( bE , hu ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec2 hE = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 hF = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float hG = dot ( GLSL_TEXTURE ( hD , bE ) . rgb , hF ) ; float hH = dot ( GLSL_TEXTURE ( hD , hm . xy ) . rgb , hF ) ; float hI = dot ( GLSL_TEXTURE ( hD , hm . zw ) . rgb , hF ) ; vec4 cx ; cx . xy = abs ( hG - vec2 ( hH , hI ) ) ; vec2 hw = step ( hE , cx . xy ) ; if ( dot ( hw , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float hJ = dot ( GLSL_TEXTURE ( hD , hn . xy ) . rgb , hF ) ; float hK = dot ( GLSL_TEXTURE ( hD , hn . zw ) . rgb , hF ) ; cx . zw = abs ( hG - vec2 ( hJ , hK ) ) ; vec2 hL = max ( cx . xy , cx . zw ) ; float hM = dot ( GLSL_TEXTURE ( hD , ho . xy ) . rgb , hF ) ; float hN = dot ( GLSL_TEXTURE ( hD , ho . zw ) . rgb , hF ) ; cx . zw = abs ( vec2 ( hH , hI ) - vec2 ( hM , hN ) ) ; hL = max ( hL . xy , cx . zw ) ; float hO = max ( hL . x , hL . y ) ; hw . xy *= step ( hO , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * cx . xy ) ; return hw ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec2 hR ( vec2 hQ ) { hQ . r = hQ . r * abs ( 5.0 * hQ . r - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec4 hR ( vec4 hQ ) { hQ . rb = hQ . rb * abs ( 5.0 * hQ . rb - 5.0 * 0.75 ) ; return hC ( hQ ) ; } vec2 hT ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz += t * vec3 ( be , 1.0 ) ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hU ( sampler2D hS , vec2 bE , vec2 be , out vec2 hQ ) { vec4 fm = vec4 ( bE , - 1.0 , 1.0 ) ; fm . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS_DIAG ; bQ ++ ) { if ( fm . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && fm . w > 0.9 ) { fm . xyz = t * vec3 ( be , 1.0 ) + fm . xyz ; hQ = GLSL_TEXTURE ( hS , fm . xy , 0.0 ) . rg ; hQ = hR ( hQ ) ; fm . w = dot ( hQ , vec2 ( 0.5 , 0.5 ) ) ; } } return fm . zw ; } vec2 hW ( sampler2D hV , vec2 aC , vec2 hQ , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * hQ + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . x += 0.5 ; bE . y += SMAA_AREATEX_SUBTEX_SIZE * eY ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } vec2 ia ( sampler2D hS , sampler2D hV , vec2 bE , vec2 hQ , vec4 hX ) { vec2 hF = vec2 ( 0.0 , 0.0 ) ; vec4 df ; vec2 hY ; if ( hQ . r > 0.0 ) { df . xz = hT ( hS , bE , vec2 ( - 1.0 , 1.0 ) , hY ) ; df . x += float ( hY . y > 0.9 ) ; } else df . xz = vec2 ( 0.0 , 0.0 ) ; df . yw = hT ( hS , bE , vec2 ( 1.0 , - 1.0 ) , hY ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x + 0.25 , df . x , df . y , - df . y - 0.25 ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . xy = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; da . yxwz = hR ( da . xyzw ) ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0.0 , 0.0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . z ) ; } df . xz = hU ( hS , bE , vec2 ( - 1 , - 1 ) , hY ) ; if ( GLSL_TEXTURE ( hS , bE + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { df . yw = hU ( hS , bE , vec2 ( 1 , 1 ) , hY ) ; df . y += float ( hY . y > 0.9 ) ; } else df . yw = vec2 ( 0.0 , 0.0 ) ; if ( df . x + df . y > 2.0 ) { vec4 hZ = vec4 ( - df . x , - df . x , df . y , df . y ) * u_texel_size . xyxy + bE . xyxy ; vec4 da ; da . x = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; da . y = GLSL_TEXTURE ( hS , hZ . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; da . zw = GLSL_TEXTURE ( hS , hZ . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 h_ = vec2 ( 2.0 , 2.0 ) * da . xz + da . yw ; hB ( bvec2 ( step ( 0.9 , df . zw ) ) , h_ , vec2 ( 0 , 0 ) ) ; hF += hW ( hV , df . xy , h_ , hX . w ) . gr ; } return hF ; }".split(" ")}]}}]},
{a:"txt",b:"float id ( sampler2D ib , vec2 hQ , float eY ) { vec2 hk = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 ic = SMAA_SEARCHTEX_SIZE * vec2 ( eY , 1.0 ) ; hk += vec2 ( - 1.0 , 1.0 ) ; ic += vec2 ( 0.5 , - 0.5 ) ; hk *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; ic *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( ib , hk * hQ + ic , 0.0 ) . r ; } float ie ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x > hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.0 ) + 3.25 ; return u_texel_size . x * eY + bE . x ; } float ig ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 0.0 , 1.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . x < hY && hQ . g > 0.8281 && hQ . r == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 2.0 , 0.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ , 0.5 ) + 3.25 ; return - u_texel_size . x * eY + bE . x ; } float ih ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y > hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.0 ) + 3.25 ; return u_texel_size . y * eY + bE . y ; } float ii ( sampler2D hS , sampler2D ib , vec2 bE , float hY ) { vec2 hQ = vec2 ( 1.0 , 0.0 ) ; for ( int bQ = 0 ; bQ < SMAA_MAX_SEARCH_STEPS ; bQ ++ ) { if ( bE . y < hY && hQ . r > 0.8281 && hQ . g == 0.0 ) { hQ = GLSL_TEXTURE ( hS , bE , 0.0 ) . rg ; bE = vec2 ( 0.0 , 2.0 ) * u_texel_size + bE ; } } float eY = - ( 255.0 / 127.0 ) * id ( ib , hQ . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * eY + bE . y ; } vec2 il ( sampler2D hV , vec2 aC , float ij , float ik , float eY ) { vec2 bE = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * hC ( 4.0 * vec2 ( ij , ik ) ) + aC ; bE = SMAA_AREATEX_PIXEL_SIZE * bE + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bE . y = SMAA_AREATEX_SUBTEX_SIZE * eY + bE . y ; return GLSL_TEXTURE ( hV , bE , 0.0 ) . rg ; } void ip ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},
{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void iq ( sampler2D hS , inout vec2 hF , vec4 bE , vec2 df ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"vec2 im = step ( df . xy , df . yx ) ; vec2 io = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * im ; io /= im . x + im . y ; vec2 aB = vec2 ( 1.0 , 1.0 ) ; aB . x -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; aB . x -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; aB . y -= io . x * GLSL_TEXTURE ( hS , bE . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; aB . y -= io . y * GLSL_TEXTURE ( hS , bE . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; hF *= clamp ( aB , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 it ( vec2 bE , vec2 ir , sampler2D hS , sampler2D hV , sampler2D ib , vec4 hX ) { vec4 hF = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 hQ = GLSL_TEXTURE ( hS , bE ) . rg ; if ( hQ . g > 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"hF . rg = ia ( hS , hV , bE , hQ , hX ) ; if ( hF . r == - hF . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 df ; vec3 hZ ; hZ . x = ie ( hS , ib , hm . xy , ho . x ) ; hZ . y = hn . y ; df . x = hZ . x ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . r ; hZ . z = ig ( hS , ib , hm . zw , ho . y ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . xx - ir . xx ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; hF . rg = il ( hV , is , ij , ik , hX . y ) ; hZ . y = bE . y ; ip ( hS , hF . rg , hZ . xyzy , df ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"} else hQ . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( hQ . r > 0.0 ) { vec2 df ; vec3 hZ ; hZ . y = ih ( hS , ib , hn . xy , ho . z ) ; hZ . x = hm . x ; df . x = hZ . y ; float ij = GLSL_TEXTURE ( hS , hZ . xy , 0.0 ) . g ; hZ . z = ii ( hS , ib , hn . zw , ho . w ) ; df . y = hZ . z ; df = abs ( hC ( df / u_texel_size . yy - ir . yy ) ) ; vec2 is = sqrt ( df ) ; float ik = GLSL_TEXTURE ( hS , hZ . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; hF . ba = il ( hV , is , ij , ik , hX . x ) ; hZ . x = bE . x ; iq ( hS , hF . ba , hZ . xyxz , df ) ; } return hF ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 iC ( vec2 bE , sampler2D hD , sampler2D iu".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( iu , hl . xy ) . a ; a . y = GLSL_TEXTURE ( iu , hl . zw ) . g ; a . wz = GLSL_TEXTURE ( iu , bE ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 aG = GLSL_TEXTURE ( hD , bE , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS = 2.0 * ix ( iw ) - 1.0 ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:"return aG ; } else { bool bO = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 iy = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 iz = a . yw ; hB ( bvec4 ( bO , bO , bO , bO ) , iy , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; hB ( bvec2 ( bO , bO ) , iz , a . xz ) ; iz /= dot ( iz , vec2 ( 1.0 , 1.0 ) ) ; vec4 iA = iy * vec4 ( u_texel_size , - u_texel_size ) + bE . xyxy ; vec4 aG = iz . x * GLSL_TEXTURE ( hD , iA . xy , 0.0 ) ; aG += iz . y * GLSL_TEXTURE ( hD , iA . zw , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , iA . xy ) ; vec2 iB = 2.0 * ix ( iw ) - 1.0 ; vec2 cS = iz . x * iB ; iw = GLSL_TEXTURE ( iv , iA . zw ) ; iB = 2.0 * ix ( iw ) - 1.0 ; cS += iz . y * iB ; aG . a = sqrt ( 2.0 * length ( cS ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}","}"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 iH ( vec2 bE , sampler2D iD , sampler2D iE".split(" ")},
{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","sampler2D","iv"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 iw = GLSL_TEXTURE ( iv , A ) ; vec2 cS ; cS = 2.0 * ix ( iw ) - 1.0 ; vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE - cS ) ; float cx = abs ( iF . a * iF . a - iG . a * iG . a ) / 2.0 ; float bU = 0.5 * clamp ( 1.0 - sqrt ( cx ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 aG = mix ( iF , iG , bU ) ; aG . a = 1.0 ; return aG ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 iF = GLSL_TEXTURE ( iD , bE ) ; vec4 iG = GLSL_TEXTURE ( iE , bE ) ; return mix ( iF , iG , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aG = vec4 ( hP ( A , u_color".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PREDICATION"],j:{a:"grp",f:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aG = it ( A , hp , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aG = iC ( A , u_color , u_blend".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",i:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 aG = vec4 ( iH ( A , u_color , u_color_prev".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_REPROJECTION"],j:{a:"grp",f:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 aG = GLSL_TEXTURE ( u_color , A ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","aG",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",
b:["highp"]},{a:"var",c:"SMAA_PASS",b:["SMAA_RESOLVE"]},{a:"var",c:"AA_METHOD",b:["AA_METHOD_SMAA_LOW"]},{a:"include",A:"std.glsl"},{a:"txt",b:"uniform PRECISION vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 A ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec4","hl",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT vec4 hm ; GLSL_OUT vec4 hn ; GLSL_OUT vec4 ho ;".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_OUT","vec2","hp",";"]}]}}]},{a:"cond",f:[{a:"if",i:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",l:2}],j:{a:"grp",
f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",i:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"SMAA_MAX_SEARCH_STEPS",j:{a:"grp",f:[{a:"define",c:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"void iI ( vec2 bE ) { hm = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; ho = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bE . xyxy ; }".split(" ")}]}},
{a:"elif",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"void iJ ( vec2 bE , out vec2 ir ) { ir = bE / u_texel_size ; hm = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bE . xyxy ; hn = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bE . xyxy ; ho = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( hm . xz , hn . yw ) ; }".split(" ")}]}},{a:"elif",i:["SMAA_PASS",
"SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"void iK ( vec2 bE ) { hl = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bE . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { A = 2.0 * a_position ;".split(" ")},{a:"cond",f:[{a:"if",i:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["iI","(","A",")",";"]}]}},{a:"elif",i:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"iJ ( A , hp ) ;".split(" ")}]}},
{a:"elif",i:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["iK","(","A",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_WHITE",b:["0"]},{a:"var",c:"SSAO_QUALITY",b:["SSAO_QUALITY_8"]},{a:"var",c:"SSAO_HEMISPHERE",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",
";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; } void main ( ) { vec3 fR = GLSL_TEXTURE ( u_color , A ) . rgb ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SSAO_WHITE"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( fR , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 iM = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , A * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float fN = iL ( A ) ; float iN = fN * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iO = 8.0 ; const int iP = 1 ;".split(" ")}]}},
{a:"elif",i:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iO = 16.0 ; const int iP = 2 ;".split(" ")}]}},{a:"elif",i:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iO = 24.0 ; const int iP = 3 ;".split(" ")}]}},{a:"elif",i:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float iO = 32.0 ; const int iP = 4 ;".split(" ")}]}}]},{a:"txt",b:"float iQ = u_ssao_radius_increase * 0.001 ; const float iR = 1.0 + 2.4 / iO ; float iS = 0.0 ; for ( int bQ = 0 ; bQ < iP ; bQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 iT = reflect ( normalize ( vec3 ( x , y , z ) ) , iM ) * ( iQ *= iR ) ; vec3 iU = vec3 ( A , iN ) ; iU += vec3 ( iT . xy , iT . z * iN * 2.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SSAO_HEMISPHERE"],j:{a:"grp",f:[{a:"txt",b:"iU . z -= 1.4 * ( iU . z - iN ) * step ( iN , iU . z ) ;".split(" ")}]}}]},{a:"txt",b:"float iV = iL ( iU . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float iW = clamp ( ( iN - iV ) / iV , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_HEMISPHERE"],j:{a:"grp",f:[{a:"txt",b:"iS += mix ( 1.0 , iW , step ( iV , iU . z ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"iS += mix ( step ( iU . z , iV ) , 0.5 , iW ) ;".split(" ")}]}}]},
{a:"txt",b:"} iS = iS / iO ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_HEMISPHERE"],j:{a:"grp",f:[{a:"txt",b:"iS = clamp ( iS * iS + 0.6 * iS , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"iS = clamp ( iS * iS + iS , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float iX = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * fN ) ; iS = mix ( 1.0 , iS , iX ) ; GLSL_OUT_FRAG_COLOR = vec4 ( fR , iS ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},
{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SSAO_BLUR_DEPTH",b:["0"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"include",A:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",
b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float iL ( in vec2 fm ) { return fM ( u_depth , fm , u_camera_range ) ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { float iY = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",b:"float iZ = iL ( A ) ; float bU = 0.0 ; float i_ = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 ja = vec2 ( - 2.0 ) ; for ( int bQ = 0 ; bQ < 4 ; ++ bQ ) { for ( int gC = 0 ; gC < 4 ; ++ gC ) { vec2 eY = ( ja + vec2 ( float ( bQ ) , float ( gC ) ) ) * u_texel_size ; float jb = GLSL_TEXTURE ( u_ssao_mask , A + eY ) . a ;".split(" ")},
{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",b:"float jc = iL ( A + eY ) ; float jd = 1.0 - clamp ( abs ( jc - iZ ) * i_ , 0.0 , 1.0 ) ; iY += jb * jd ; bU += jd ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["iY","+=","jb",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",f:[{a:"if",i:["SSAO_BLUR_DEPTH"],j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / bU ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , A ) . rgb , iY / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"var",c:"ANAGLYPH",b:["0"]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"DISTOR_SCALE",b:["0.8"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ; uniform vec2 u_texel_size ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",f:[{a:"if",
i:["ANAGLYPH",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void jn ( vec2 bE , vec2 ac , float cM , sampler2D je ) { vec2 jf = ( bE - ac ) * 4.0 * u_texel_size [ 0 ] / u_texel_size [ 1 ] / cM ; float jg = jf . x * jf . x + jf . y * jf . y ; vec2 jh = jf * ( 1.0 + u_distortion_params [ 0 ] * jg + u_distortion_params [ 1 ] * jg * jg ) ; vec2 ji = jh * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 jj = ji * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + jg * u_chromatic_aberration_coefs [ 1 ] ) + 0.5 ; vec2 jk = ji + 0.5 ; vec2 jl = ji * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + jg * u_chromatic_aberration_coefs [ 3 ] ) + 0.5 ; if ( clamp ( jl , 0.0 , 1.0 ) != jl ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 jm = GLSL_TEXTURE ( je , jk ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( je , jj ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = jm . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( je , jl ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = jm . w ; } } else { ji += 0.5 ; if ( clamp ( ji , 0.0 , 1.0 ) != ji ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( je , ji ) ; } } }".split(" ")}]}}]},
{a:"txt",b:["void","main","(",")","{"]},{a:"cond",f:[{a:"if",i:["ANAGLYPH"],j:{a:"grp",f:[{a:"txt",b:"vec4 jo = GLSL_TEXTURE ( u_sampler_left , A ) ; vec4 jp = GLSL_TEXTURE ( u_sampler_right , A ) ; vec3 jq = vec3 ( jo [ 0 ] , jo [ 1 ] , jo [ 2 ] ) ; bY ( jq ) ; vec3 jr = vec3 ( jp [ 0 ] , jp [ 1 ] , jp [ 2 ] ) ; bY ( jr ) ; mat3 js = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 jt = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 aG = clamp ( js * jq , 0.0 , 1.0 ) + clamp ( jt * jr , 0.0 , 1.0 ) ; aM ( aG ) ; GLSL_OUT_FRAG_COLOR = vec4 ( aG , jo [ 3 ] + jp [ 3 ] ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( abs ( u_distortion_params [ 0 ] ) > EPSILON || abs ( u_distortion_params [ 1 ] ) > EPSILON ) if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] * DISTOR_SCALE ; jn ( bE , ac , cM , u_sampler_left ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; vec2 ac = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float cM = 2.0 * u_distortion_params [ 3 ] * DISTOR_SCALE ; jn ( bE , ac , cM , u_sampler_right ) ; } else if ( A [ 0 ] < 0.5 ) { vec2 bE = vec2 ( 2.0 * A [ 0 ] , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , bE ) ; } else { vec2 bE = vec2 ( 2.0 * ( A [ 0 ] - 0.5 ) , A [ 1 ] ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_right , bE ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , A ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",f:[{a:"version",b:["GLSL_VERSION"]},{a:"include",A:"precision_statement.glslf"},{a:"include",A:"std.glsl"},{a:"include",A:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 A ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float fN = GLSL_TEXTURE ( u_depth , A ) . x ; vec4 ju = vec4 ( A * 2.0 - 1.0 , 2.0 * fN - 1.0 , 1.0 ) ; vec4 cd = u_view_proj_inverse * ju ; vec4 jv = cd / cd . w ; vec4 jw = u_view_proj_prev * jv ; jw /= jw . w ; vec2 cS = ( ju . xy - jw . xy ) / 4.0 + 0.5 ; cS = clamp ( cS , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = fS ( cS ) ; }".split(" ")}]};
a["include/blending.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"BLENDING_GLSLF",j:{a:"grp",f:[{a:"define",c:"BLENDING_GLSLF",b:[""]},{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; } vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; } vec3 jE ( vec3 jB , vec3 jC , float jD ) { return mix ( jB , jC , jD ) ; } vec3 jF ( vec3 jB , vec3 jC , float jD ) { return jD * jB + jC ; } vec3 jG ( vec3 jB , vec3 jC , float jD ) { return jC - jD * jB ; } vec3 jI ( vec3 jB , vec3 jC , float jD ) { float jH = _1_0 - jD ; return ( vec3 ( jH ) + jD * jB ) * jC ; } vec3 jJ ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return vec3 ( _1_0 ) - ( jH + jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) ; } vec3 jK ( vec3 jB , vec3 jC , float jD ) { vec3 jH = vec3 ( _1_0 - jD ) ; return mix ( jC * ( jH + 2.0 * jD * jB ) , vec3 ( _1_0 ) - ( jH + 2.0 * jD * ( vec3 ( _1_0 ) - jB ) ) * ( vec3 ( _1_0 ) - jC ) , step ( 0.5 , jC ) ) ; } vec3 jL ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , abs ( jB - jC ) , jD ) ; } vec3 jM ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , jC / ( jB + step ( jB , vec3 ( _0_0 ) ) ) , jD ) ; } vec3 jN ( vec3 jB , vec3 jC , float jD ) { return mix ( jC , min ( jB , jC ) , jD ) ; } vec3 jO ( vec3 jB , vec3 jC , float jD ) { return max ( jD * jB , jC ) ; } vec3 jS ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . x , jQ . yz ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jT ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . x , mix ( jP . y , jQ . y , jD ) , jP . z ) ) ; } return jB ; } vec3 jU ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jB ) ; vec3 jQ = jy ( jC ) ; return jA ( vec3 ( jP . xy , mix ( jP . z , jQ . z , jD ) ) ) ; } vec3 jV ( vec3 jB , vec3 jC , float jD ) { vec3 jP = jy ( jC ) ; if ( jP . y != _0_0 ) { vec3 jQ = jy ( jB ) ; vec3 jR = jA ( vec3 ( jP . xy , jQ . z ) ) ; return mix ( jB , jR , jD ) ; } return jB ; } vec3 jX ( vec3 jB , vec3 jC , float jD ) { vec3 jW = vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - jC ) * ( vec3 ( _1_0 ) - jB ) ; return mix ( jB , ( ( vec3 ( _1_0 ) - jB ) * jC * jB ) + jB * jW , jD ) ; } vec3 jY ( vec3 jB , vec3 jC , float jD ) { return jB + jD * ( 2.0 * jC - _1_0 ) ; } float kb ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return ( jH + jD * jZ ) * j_ ; } float kc ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return _1_0 - ( jH + jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) ; } float kd ( float jZ , float j_ , float jD , float ka ) { float jH = _1_0 - ka ; return mix ( j_ * ( jH + 2.0 * jD * jZ ) , _1_0 - ( jH + 2.0 * jD * ( _1_0 - jZ ) ) * ( _1_0 - j_ ) , step ( 0.5 , j_ ) ) ; }".split(" ")}]}}]}]};
a["include/caustics.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"CAUSTICS_GLSLF",j:{a:"grp",f:[{a:"define",c:"CAUSTICS_GLSLF",b:[""]},{a:"var",c:"SUN_NUM",b:["0"]},{a:"var",c:"CAUST_SCALE",b:["0.25"]},{a:"var",c:"CAUST_SPEED",b:["vec2","(","0.0",")"]},{a:"var",c:"CAUST_BRIGHT",b:["0.5"]},{a:"include",A:"procedural.glslf"},{a:"include",A:"math.glslv"},{a:"define",c:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bt ( inout vec3 aG , float ke , float eK , vec4 bs , vec3 P , vec3 kf , vec3 kg , vec4 kh , vec3 bd , float bp ) { if ( bp > CAUSTICS_VIEW_DISTANCE ) return ; vec3 ki = bd + P ; ki . xz = 10.0 * sin ( 0.1 * ki . xz ) ; vec3 kk = O ( kj ( kh ) , ki ) ; vec2 bE = kk . xz ; vec3 kl = kf ; float km = max ( dot ( P , kl ) , 0.0 ) ; float kn = 0.025 ; vec2 ko = CAUST_SPEED * eK ; bE . s += 0.25 * sin ( dot ( bd + eK , vec3 ( 1.0 ) ) ) ; bE . t += 0.35 * ( - sin ( dot ( bd - eK , vec3 ( - 0.7 ) ) ) ) ; bE . st += 0.15 * cos ( 4.0 * ke - ko . x ) + 1.5 * sin ( ke - 0.3 * ko . y ) ; float hk = CAUST_SCALE * ( 1.0 + max ( 0.1 * ke , 0.0 ) ) ; vec3 kq = kp ( ( bE / hk ) , kn ) ; kq *= CAUST_BRIGHT ; kq *= kq ; float kr = min ( 0.25 * ke , - ke ) + 1.0 ; kr = max ( kr , 0.0 ) ; float ks = bs [ SUN_NUM ] * km ; float kt = max ( sign ( ke ) , 0.0 ) ; ks = ks + max ( 0.5 * sign ( - P . y ) * kt , 0.0 ) ; ks = min ( ks , 1.0 ) ; aG += kg * kq * kr * ks ; }".split(" ")}]}}]}]};
a["include/color_util.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"COLOR_UTIL_GLSLF",j:{a:"grp",f:[{a:"define",c:"COLOR_UTIL_GLSLF",b:[""]},{a:"define",c:"PREMULTIPLY_ALPHA",b:["1"]},{a:"var",c:"SRGB",b:["SRGB_NONE"]},{a:"include",A:"std.glsl"},{a:"txt",b:"void bY ( inout float aG ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aG = pow ( aG , 2.2 ) ;".split(" ")}]}},{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:"if ( aG < 0.04045 ) aG = aG / 12.92 ; else aG = pow ( aG * ( 1.0 / 1.055 ) + 0.0521327 , 2.4 ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout float aG ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aG = pow ( aG , 1.0 / 2.2 ) ;".split(" ")}]}},{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( aG < 0.0031308 ) aG = aG * 12.92 ; else aG = 1.055 * pow ( aG , 1.0 / 2.4 ) - 0.055 ;".split(" ")}]}}]},
{a:"txt",b:"} void bY ( inout vec3 aG ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aG = pow ( aG , vec3 ( 2.2 ) ) ;".split(" ")}]}},{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"bY ( aG . r ) ; bY ( aG . g ) ; bY ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aM ( inout vec3 aG ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SRGB","SRGB_SIMPLE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aG = pow ( aG , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}},
{a:"elif",i:["SRGB","SRGB_PROPER",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"aM ( aG . r ) ; aM ( aG . g ) ; aM ( aG . b ) ;".split(" ")}]}}]},{a:"txt",b:"} void aN ( inout vec3 aG , in float J ) {".split(" ")},{a:"cond",f:[{a:"if",i:["PREMULTIPLY_ALPHA"],j:{a:"grp",f:[{a:"txt",b:"aG = aG * J ;".split(" ")}]}}]},{a:"txt",b:"} float ft ( vec4 aG ) { vec3 ku = vec3 ( 0.299 , 0.587 , 0.114 ) ; float kv = dot ( aG . rgb , ku ) ; return kv ; }".split(" ")}]}}]}]};a["include/depth_fetch.glslf"]={a:"grp",
f:[{a:"cond",f:[{a:"ifndef",c:"DEPTH_FETCH_GLSLF",j:{a:"grp",f:[{a:"define",c:"DEPTH_FETCH_GLSLF",b:[""]},{a:"txt",b:"float fM ( in sampler2D kw , in vec2 fm , in vec2 kx ) { float fN = GLSL_TEXTURE ( kw , fm ) . r ; float dj = kx . x ; float ky = kx . y ; float kz = 2.0 * dj / ( dj + ky - ( 2.0 * fN - 1.0 ) * ( ky - dj ) ) ; return kz ; }".split(" ")}]}}]}]};a["include/dynamic_grass.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"DYNAMIC_GRASS_GLSLV",j:{a:"grp",f:[{a:"define",c:"DYNAMIC_GRASS_GLSLV",
b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"DYNAMIC_GRASS",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"GRASS_TEXTURE_SIZE",b:["1024.0"]},{a:"cond",f:[{a:"if",i:["DYNAMIC_GRASS"],j:{a:"grp",f:[{a:"include",A:"math.glslv"},{a:"include",A:"to_world.glslv"},{a:"txt",b:"vec2 kD ( vec3 N , float kA , vec2 kB ) { vec2 kC = vec2 ( ( N . x - kB . x ) / kA , ( N . y - kB . y ) / kA ) ; return fract ( kC ) ; } vec2 kE ( vec2 gl , float kA , vec2 kB ) { return vec2 ( gl . x * kA , gl . y * kA ) + kB ; } aj kF ( ) { return aj ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; }".split(" ")},
{a:"cond",f:[{a:"if",i:["GLSL3"],j:{a:"grp",f:[{a:"txt",b:"vec4 kP ( sampler2D kG , vec2 kH ) { float kI = 1.0 / GRASS_TEXTURE_SIZE ; vec4 kJ = GLSL_TEXTURE ( kG , kH ) ; vec4 kK = GLSL_TEXTURE ( kG , kH + vec2 ( kI , 0.0 ) ) ; vec4 kL = GLSL_TEXTURE ( kG , kH + vec2 ( 0.0 , kI ) ) ; vec4 kM = GLSL_TEXTURE ( kG , kH + vec2 ( kI , kI ) ) ; float a = fract ( kH . x * GRASS_TEXTURE_SIZE ) ; vec4 kN = mix ( kJ , kK , a ) ; vec4 kO = mix ( kL , kM , a ) ; float b = fract ( kH . y * GRASS_TEXTURE_SIZE ) ; return mix ( kN , kO , b ) ; }".split(" ")}]}}]},
{a:"txt",b:"aj aP ( vec3 N , vec3 Q , vec3 kQ , vec3 R , vec3 P , vec3 ac , PRECISION sampler2D kR , sampler2D kS , vec3 kT , float kU , vec3 kV , vec4 kW , mat3 M ) { vec3 kX = O ( kW , vec3 ( 0.0 , 0.0 , - 1.0 ) ) ; float kY = - kX . x ; float kZ = kX . y ; vec2 kB = vec2 ( kV . x - kU * ( 1.0 + kY ) / 2.0 , kV . y - kU * ( 1.0 - kZ ) / 2.0 ) ; vec2 k_ = kD ( ac , kU , kB ) ; float la = kU / 2.0 ; vec2 lb = abs ( kE ( k_ - vec2 ( 0.5 ) , kU , vec2 ( 0.0 ) ) ) ; float lc = la * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( lb ) > lc ) return kF ( ) ; float ld = kU / kT . z ; vec2 le = ( k_ - vec2 ( 0.5 ) ) * ld + vec2 ( 0.5 ) ; vec3 lf = kX * ( kU / kT . z - 1.0 ) / 2.0 ; le . x += lf . x ; le . y += lf . y ; vec4 lg = GLSL_TEXTURE ( kS , le ) ; float hk = lg . r ; if ( hk < u_scale_threshold ) return kF ( ) ; float lh = kT . y - kT . x ;".split(" ")},
{a:"cond",f:[{a:"if",i:["GLSL3"],j:{a:"grp",f:[{a:"txt",b:"float bN = kT . y - ( kP ( kR , le ) ) . r * lh ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"float bN = kT . y - ( GLSL_TEXTURE ( kR , le ) ) . r * lh ;".split(" ")}]}}]},{a:"txt",b:"vec2 li = N . xy - ac . xy ; ac . xy = kE ( k_ , kU , kB ) ; ac . z = bN ; N . xy = ac . xy + li ; N . z *= hk ; N . z += bN ; vec3 aG = lg . gba ;".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD"],j:{a:"grp",f:[{a:"txt",b:"N -= ac ; mat3 lj = ah ( kV , ac , M ) ; aj al = ak ( N , ac , Q , kQ , R , P , lj ) ; al . ac = ac ; al . aG = aG ; return lk ( al ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"return lk ( aj ( N , ac , Q , kQ , R , P , aG ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/environment.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"ENVIRONMENT_GLSLF",j:{a:"grp",f:[{a:"define",c:"ENVIRONMENT_GLSLF",b:[""]},{a:"var",c:"USE_ENVIRONMENT_LIGHT",b:["0"]},{a:"var",c:"SKY_COLOR",b:["0"]},{a:"var",c:"SKY_TEXTURE",b:["0"]},{a:"txt",b:"vec3 ce ( vec3 P ) {".split(" ")},{a:"cond",f:[{a:"if",i:["USE_ENVIRONMENT_LIGHT"],j:{a:"grp",f:[{a:"cond",
f:[{a:"if",i:["SKY_TEXTURE"],j:{a:"grp",f:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , P ) . rgb ;".split(" ")}]}},{a:"elif",i:["SKY_COLOR"],j:{a:"grp",f:[{a:"txt",b:"float ll = 0.5 * P . z + 0.5 ; return mix ( u_horizon_color , u_zenith_color , ll ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fog.glslf"]={a:"grp",f:[{a:"cond",
f:[{a:"ifndef",c:"FOG_GLSLF",j:{a:"grp",f:[{a:"define",c:"FOG_GLSLF",b:[""]},{a:"var",c:"USE_FOG",b:["0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"FOG_TYPE",b:["QUADRATIC"]},{a:"var",c:"PROCEDURAL_FOG",b:["0"]},{a:"include",A:"std.glsl"},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"txt",b:"void lq ( inout vec3 aG , in float lm , in float bN , in vec4 ln ) { float lo = clamp ( ( lm - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FOG_TYPE","QUADRATIC",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["lo","*=","lo",";"]}]}},{a:"elif",i:["FOG_TYPE","LINEAR",{a:"equal_expr",l:2}],j:{a:"grp",f:[]}},{a:"elif",i:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"lo = sqrt ( lo ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( bN > u_fog_params . w ) lo = 0.0 ; else { float lp = ( u_fog_params . w - max ( bN , 0.0 ) ) / u_fog_params . w ; lo *= lp * lp ; } } ln . a = 1.0 - ( 1.0 - lo ) * ( 1.0 - u_fog_params . x ) ; aG = mix ( aG , ln . rgb , ln . a ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:"vec3 lv ( in mat4 lr , in vec3 C ) { vec3 ls = mix ( lr [ 0 ] . rgb , lr [ 1 ] . rgb , max ( sign ( C . x ) , 0.0 ) ) ; vec3 lt = mix ( lr [ 2 ] . rgb , lr [ 3 ] . rgb , max ( sign ( C . z ) , 0.0 ) ) ; vec3 lu = vec3 ( lr [ 0 ] . a , lr [ 1 ] . a , lr [ 2 ] . a ) ; vec3 aG = mix ( ls , lt , abs ( C . z ) ) ; aG = mix ( aG , lu , abs ( C . y ) ) ; bY ( aG ) ; return aG ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],
j:{a:"grp",f:[{a:"txt",b:"void lx ( inout float lw ) { lw -= 0.5 ; lw = 4.0 * ( lw * lw * lw ) + 0.5 ; } void lD ( inout vec3 aG , in float lm , in vec3 C , in float dO , in vec4 ly , in float eB ) { float lz = max ( C . z , 0.0 ) ; float lA = max ( lm - max ( dO / lz , 0.0 ) , 0.0 ) ; float lB = ly . w * lA ; vec3 dP = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 lC = ly . rgb ; lB = min ( lB , 1.0 ) ; lx ( lB ) ; lB *= clamp ( 2.0 - eB , 0.0 , 1.0 ) ; vec3 dQ = mix ( lC , dP , min ( lz , 1.0 ) ) ; dO = clamp ( - dO * 0.03 , 0.0 , 0.8 ) ; dQ *= 1.0 - dO ; aG = mix ( aG , dQ , lB ) ; }".split(" ")}]}}]},
{a:"txt",b:"void bu ( inout vec3 aG , float lm , vec3 C , float bq ) {".split(" ")},{a:"cond",f:[{a:"if",i:["USE_FOG"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["PROCEDURAL_FOG"],j:{a:"grp",f:[{a:"txt",b:"vec3 lr = lv ( u_cube_fog , C ) ; vec4 dQ = vec4 ( lr , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec4","dQ","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"lq ( aG , lm , h . z , dQ ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WATER_EFFECTS"],j:{a:"grp",f:[{a:"txt",
b:"lD ( aG , lm , C , u_cam_water_depth , u_underwater_fog_color_density , bq ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/fxaa.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSLF",j:{a:"grp",f:[{a:"define",c:"FXAA_GLSLF",b:[""]},{a:"var",c:"FXAA_BLEND4WEB",b:["1"]},{a:"var",c:"FXAA_QUALITY_P12",b:["0.0"]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PS3",j:{a:"grp",f:[{a:"define",c:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_360",j:{a:"grp",f:[{a:"define",c:"FXAA_360",b:["0"]}]}}]},
{a:"cond",f:[{a:"ifndef",c:"FXAA_360_OPT",j:{a:"grp",f:[{a:"define",c:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PC",j:{a:"grp",f:[{a:"define",c:"FXAA_PC",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_PC_CONSOLE",j:{a:"grp",f:[{a:"define",c:"FXAA_PC_CONSOLE",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSL_120",j:{a:"grp",f:[{a:"define",c:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GLSL_130",j:{a:"grp",f:[{a:"define",c:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",
f:[{a:"ifndef",c:"FXAA_HLSL_3",j:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_HLSL_4",j:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_HLSL_5",j:{a:"grp",f:[{a:"define",c:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GREEN_AS_LUMA",j:{a:"grp",f:[{a:"define",c:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_EARLY_EXIT",j:{a:"grp",f:[{a:"define",c:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",
f:[{a:"ifndef",c:"FXAA_DISCARD",j:{a:"grp",f:[{a:"define",c:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",j:{a:"grp",f:[{a:"cond",f:[{a:"ifdef",c:"GL_EXT_gpu_shader4",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_NV_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_ARB_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",
f:[{a:"ifndef",c:"FXAA_FAST_PIXEL_OFFSET",j:{a:"grp",f:[{a:"define",c:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["FXAA_HLSL_5",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_ARB_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",f:[{a:"ifdef",c:"GL_NV_gpu_shader5",j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",
b:["1"]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_GATHER4_ALPHA",j:{a:"grp",f:[{a:"define",c:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:[1],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:[0],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",f:[{a:"if",i:[0],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",
b:["2.0"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:[1],j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",j:{a:"grp",f:[{a:"define",c:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",f:[{a:"ifndef",c:"FXAA_QUALITY_PRESET",j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",
c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",
12,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",
b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["3"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["4"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",
c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["5"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",
23,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["6"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["7"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["8"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["9"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["10"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["11"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",
b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",
f:[{a:"if",i:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"define",c:"FXAA_QUALITY_PS",b:["12"]},{a:"define",c:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P3",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",c:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",c:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P8",b:["2.0"]},
{a:"define",c:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",c:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",c:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"include",A:"color_util.glslf"},{a:"txt",b:"float lE ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_BLEND4WEB",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 lF ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 lH ( sampler2D t , vec2 p , vec2 lG , vec2 r ) { return GLSL_TEXTURE ( t , p + ( lG * r ) ) ; }".split(" ")}]}}]},
{a:"txt",b:"vec4 fI ( vec2 eD , sampler2D hq , vec2 lI , float lJ , float lK , float lL ) { vec2 lM ; lM . x = eD . x ; lM . y = eD . y ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",l:2}],j:{a:"grp",f:[]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 lN = lF ( hq , lM ) ; float fu = ft ( lN ) ; float lO = ft ( lH ( hq , lM , vec2 ( 0 , 1 ) , lI . xy ) ) ; float lP = ft ( lH ( hq , lM , vec2 ( 1 , 0 ) , lI . xy ) ) ; float lQ = ft ( lH ( hq , lM , vec2 ( 0 , - 1 ) , lI . xy ) ) ; float lR = ft ( lH ( hq , lM , vec2 ( - 1 , 0 ) , lI . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float lS = max ( lO , fu ) ; float lT = min ( lO , fu ) ; float lU = max ( lP , lS ) ; float lV = min ( lP , lT ) ; float lW = max ( lQ , lR ) ; float lX = min ( lQ , lR ) ; float lY = max ( lW , lU ) ; float lZ = min ( lX , lV ) ; float l_ = lY * lK ; float ma = lY - lZ ; float mb = max ( lL , l_ ) ; bool mc = ma < mb ; if ( mc ) return lN ;".split(" ")},{a:"cond",f:[{a:"if",i:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float fv = ft ( lH ( hq , lM , vec2 ( - 1 , - 1 ) , lI . xy ) ) ; float fy = ft ( lH ( hq , lM , vec2 ( 1 , 1 ) , lI . xy ) ) ; float fw = ft ( lH ( hq , lM , vec2 ( 1 , - 1 ) , lI . xy ) ) ; float fx = ft ( lH ( hq , lM , vec2 ( - 1 , 1 ) , lI . xy ) ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[]}}]},{a:"txt",b:"float md = lQ + lO ; float me = lR + lP ; float mf = 1.0 / ma ; float mg = md + me ; float mh = ( - 2.0 * fu ) + md ; float mi = ( - 2.0 * fu ) + me ; float mj = fw + fy ; float mk = fv + fw ; float ml = ( - 2.0 * lP ) + mj ; float mm = ( - 2.0 * lQ ) + mk ; float mn = fv + fx ; float mo = fx + fy ; float mp = ( abs ( mh ) * 2.0 ) + abs ( ml ) ; float mq = ( abs ( mi ) * 2.0 ) + abs ( mm ) ; float mr = ( - 2.0 * lR ) + mn ; float ms = ( - 2.0 * lO ) + mo ; float mt = abs ( mr ) + mp ; float mu = abs ( ms ) + mq ; float mv = mn + mj ; float mw = lI . x ; bool mx = mt >= mu ; float my = mg * 2.0 + mv ; if ( ! mx ) lQ = lR ; if ( ! mx ) lO = lP ; if ( mx ) mw = lI . y ; float mz = ( my * ( 1.0 / 12.0 ) ) - fu ; float mA = lQ - fu ; float mB = lO - fu ; float mC = lQ + fu ; float mD = lO + fu ; bool mE = abs ( mA ) >= abs ( mB ) ; float mF = max ( abs ( mA ) , abs ( mB ) ) ; if ( mE ) mw = - mw ; float mG = lE ( abs ( mz ) * mf ) ; vec2 mH ; mH . x = lM . x ; mH . y = lM . y ; vec2 mI ; mI . x = ( ! mx ) ? 0.0 : lI . x ; mI . y = ( mx ) ? 0.0 : lI . y ; if ( ! mx ) mH . x += mw * 0.5 ; if ( mx ) mH . y += mw * 0.5 ; vec2 mJ ; mJ . x = mH . x - mI . x * FXAA_QUALITY_P0 ; mJ . y = mH . y - mI . y * FXAA_QUALITY_P0 ; vec2 mK ; mK . x = mH . x + mI . x * FXAA_QUALITY_P0 ; mK . y = mH . y + mI . y * FXAA_QUALITY_P0 ; float mL = ( ( - 2.0 ) * mG ) + 3.0 ; float mM = ft ( lF ( hq , mJ ) ) ; float mN = mG * mG ; float mO = ft ( lF ( hq , mK ) ) ; if ( ! mE ) mC = mD ; float mP = mF * 1.0 / 4.0 ; float mQ = fu - mC * 0.5 ; float mR = mL * mN ; bool mS = mQ < 0.0 ; mM -= mC * 0.5 ; mO -= mC * 0.5 ; bool mT = abs ( mM ) >= mP ; bool mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P1 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P1 ; bool mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P1 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P1 ; if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P2 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P2 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P2 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P3 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P3 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P3 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",4,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P4 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P4 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P4 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",5,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P5 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P5 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P5 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",6,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P6 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P6 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P6 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",7,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P7 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P7 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P7 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",8,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P8 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P8 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P8 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",9,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P9 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P9 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P9 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",10,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P10 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P10 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P10 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",11,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P11 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P11 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P11 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_QUALITY_PS",12,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( mV ) { if ( ! mT ) mM = ft ( lF ( hq , mJ . xy ) ) ; if ( ! mU ) mO = ft ( lF ( hq , mK . xy ) ) ; if ( ! mT ) mM = mM - mC * 0.5 ; if ( ! mU ) mO = mO - mC * 0.5 ; mT = abs ( mM ) >= mP ; mU = abs ( mO ) >= mP ; if ( ! mT ) mJ . x -= mI . x * FXAA_QUALITY_P12 ; if ( ! mT ) mJ . y -= mI . y * FXAA_QUALITY_P12 ; mV = ( ! mT ) || ( ! mU ) ; if ( ! mU ) mK . x += mI . x * FXAA_QUALITY_P12 ; if ( ! mU ) mK . y += mI . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float mW = lM . x - mJ . x ; float mX = mK . x - lM . x ; if ( ! mx ) mW = lM . y - mJ . y ; if ( ! mx ) mX = mK . y - lM . y ; bool mY = ( mM < 0.0 ) != mS ; float mZ = ( mX + mW ) ; bool m_ = ( mO < 0.0 ) != mS ; float na = 1.0 / mZ ; bool nb = mW < mX ; float nc = min ( mW , mX ) ; bool nd = nb ? mY : m_ ; float ne = mR * mR ; float nf = ( nc * ( - na ) ) + 0.5 ; float ng = ne * lJ ; float nh = nd ? nf : 0.0 ; float ni = max ( nh , ng ) ; if ( ! mx ) lM . x += ni * mw ; if ( mx ) lM . y += ni * mw ;".split(" ")},
{a:"cond",f:[{a:"if",i:["FXAA_DISCARD",1,{a:"equal_expr",l:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return lF ( hq , lM ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec4 ( lF ( hq , lM ) . xyz , fu ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"HALO_COLOR_GLSLF",j:{a:"grp",f:[{a:"define",c:"HALO_COLOR_GLSLF",b:[""]},{a:"var",c:"NUM_RINGS",b:["0"]},{a:"var",
c:"NUM_LINES",b:["0"]},{a:"var",c:"NUM_STARS",b:["0"]},{a:"var",c:"SKY_STARS",b:["0"]},{a:"var",c:"WAVES_HEIGHT",b:["1.0"]},{a:"var",c:"WATER_EFFECTS",b:["0"]},{a:"var",c:"DISABLE_FOG",b:["0"]},{a:"cond",f:[{a:"if",i:["NUM_RINGS","NUM_LINES",{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const int nj = NUM_RINGS ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"const int nj = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float nk ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},
{a:"cond",f:[{a:"if",i:["NUM_RINGS"],j:{a:"grp",f:[{a:"txt",b:"void nr ( inout float nl , in float nm [ nj ] , in float nn ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float no = 40.0 * nm [ a ] ; float np = 300.0 * ( nk ( no ) - 0.005 ) ; float nq = no ; float lo = abs ( nq * ( u_halo_size * np - nn ) ) ; nl += 1.0 - min ( lo , 1.0 ) ; } }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_LINES"],j:{a:"grp",f:[{a:"txt",b:"void nw ( inout float ns , in float nm [ nj ] , in float aC ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float nt = nm [ a ] ; float nu = nt ; float nv = 1000.0 * ( nk ( nt ) - 0.005 ) ; float lo = 20.0 * abs ( nu * A . x + nv * A . y ) ; ns += 1.0 - min ( lo , 1.0 ) ; } ns *= aC ; }".split(" ")}]}}]},
{a:"txt",b:"void nA ( inout float aC , in vec2 bE ) { float nx , bm ; bm = atan ( bE . y , bE . x ) ; bm *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float ny = cos ( bm ) ; float nz = sin ( bm ) ; bm = ( ny * bE . x + nz * bE . y ) * ( ny * bE . y - nz * bE . x ) ; nx = abs ( bm ) ; if ( nx < 1.0 ) { nx = ( 0.01 * u_halo_size ) / ( nx ) ; aC *= sqrt ( min ( nx , 1.0 ) ) ; } } vec4 aV ( ) { float aC = ( A . x * A . x + A . y * A . y ) ; float nn = sqrt ( aC ) ; aC = max ( 1.0 - aC , 0.0 ) ; aC = pow ( aC , u_halo_hardness ) ; float J = u_diffuse_color . a ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float nm [ nj ] ; for ( int bQ = 0 ; bQ < nj ; bQ ++ ) { nm [ bQ ] = fract ( aU / float ( bQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_RINGS"],j:{a:"grp",f:[{a:"txt",b:"float nl = 0.0 ; nr ( nl , nm , nn ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_LINES"],j:{a:"grp",f:[{a:"txt",b:"float ns = 0.0 ; nw ( ns , nm , aC ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_STARS"],
j:{a:"grp",f:[{a:"txt",b:"nA ( aC , A ) ;".split(" ")}]}}]},{a:"txt",b:"aC *= J ; vec3 aG = u_diffuse_color . rgb ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_RINGS"],j:{a:"grp",f:[{a:"txt",b:"nl *= aC ; aG += u_halo_rings_color * nl ; aC += nl ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_LINES"],j:{a:"grp",f:[{a:"txt",b:"ns *= J ; aG += u_halo_lines_color * ns ; aC += ns ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["SKY_STARS"],j:{a:"grp",f:[{a:"txt",b:"aC *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float kr = u_halo_stars_blend * ( aT . y - u_halo_stars_height ) ; aC *= clamp ( kr , 0.0 , 1.0 ) ; aC *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 nB = vec4 ( aG , aC ) ; return nB ; }".split(" ")}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"LIGHTING_NODES_GLSLF",j:{a:"grp",
f:[{a:"define",c:"LIGHTING_NODES_GLSLF",b:[""]},{a:"include",A:"std.glsl"},{a:"node",c:"LIGHTING_BEGIN",u:[],s:[{a:"node_out",c:"nP",h:["vec3"],g:!1},{a:"node_out",c:"nQ",h:["vec3"],g:!1},{a:"node_out",c:"nR",h:["vec3"],g:!1},{a:"node_out",c:"nS",h:["vec3"],g:!0},{a:"node_out",c:"nT",h:["vec3"],g:!0},{a:"node_out",c:"nU",h:["vec2"],g:!0},{a:"node_out",c:"nV",h:["vec2"],g:!0},{a:"node_out",c:"nW",h:["vec4"],g:!0},{a:"node_out",c:"nX",h:["float"],g:!0},{a:"node_out",c:"nY",h:["vec4"],g:!0}],m:[{a:"txt",
b:"nP = nC ; nQ = nD ; nR = nE ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nS"],m:[{a:"txt",b:["nS","=","nF",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nT"],m:[{a:"txt",b:["nT","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nV"],m:[{a:"txt",b:["nV","=","nJ",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nU"],m:[{a:"txt",b:["nU","=","nK",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nW"],m:[{a:"txt",b:["nW","=","nL",";"]}]}]},{a:"node_cond",f:[{a:"node_if",
i:["USE_OUT_nX"],m:[{a:"txt",b:["nX","=","nM",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_nY"],m:[{a:"txt",b:["nY","=","nN",";"]}]}]}]},{a:"node",c:"LIGHTING_AMBIENT",u:[],s:[{a:"node_in",c:"nZ",h:["vec3"],g:!1},{a:"node_in",c:"n_",h:["vec3"],g:!1},{a:"node_in",c:"oa",h:["vec3"],g:!1},{a:"node_out",c:"ob",h:["vec4"],g:!1},{a:"node_out",c:"oc",h:["vec3"],g:!1}],m:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",u:[{a:"node_var",
c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],s:[{a:"node_in",c:"od",h:["vec4"],g:!1},{a:"node_out",c:"oe",h:["vec3"],g:!1},{a:"node_out",c:"of",h:["vec2"],g:!1},{a:"node_out",c:"og",h:["vec3"],g:!1},{a:"node_out",c:"oh",h:["float"],g:!1}],m:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","HEMI",{a:"equal_expr",l:2}],m:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",m:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE",
"POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; float oj = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; oj *= ol ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"oj *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]},{a:"txt",b:["og","*=","oj",";"]}]},{a:"node_else",m:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"om",h:["vec3"],g:!1},{a:"node_in",c:"on",h:["vec2"],g:!1},{a:"node_in",c:"oo",h:["vec3"],g:!1},{a:"node_in",c:"op",h:["float"],g:!1},
{a:"node_in",c:"oq",h:["vec2"],g:!1},{a:"node_out",c:"or",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; oo = cross ( os , B . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ou",h:["vec3"],g:!1},{a:"node_in",c:"ov",h:["vec2"],g:!1},{a:"node_in",c:"ow",h:["vec3"],g:!1},{a:"node_in",c:"ox",h:["float"],g:!1},{a:"node_out",c:"oy",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; ow = cross ( os , B . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_OREN_NAYAR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oz",h:["vec3"],g:!1},{a:"node_in",c:"oA",h:["vec2"],g:!1},{a:"node_in",c:"oB",h:["vec3"],g:!1},{a:"node_in",c:"oC",h:["float"],g:!1},{a:"node_in",c:"oD",h:["vec2"],g:!1},{a:"node_out",c:"oE",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; oB = cross ( os , B . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",
b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oO",h:["vec3"],g:!1},{a:"node_in",c:"oP",h:["vec2"],g:!1},{a:"node_in",c:"oQ",h:["vec3"],g:!1},{a:"node_in",c:"oR",h:["float"],g:!1},{a:"node_in",c:"oS",h:["vec2"],g:!1},{a:"node_out",c:"oT",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; oQ = cross ( os , B . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oU",h:["vec3"],g:!1},{a:"node_in",c:"oV",h:["vec2"],g:!1},{a:"node_in",c:"oW",h:["vec3"],g:!1},
{a:"node_in",c:"oX",h:["float"],g:!1},{a:"node_in",c:"oY",h:["vec2"],g:!1},{a:"node_out",c:"oZ",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; oW = cross ( os , B . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pa",h:["vec3"],g:!1},{a:"node_in",c:"pb",h:["vec2"],g:!1},{a:"node_in",c:"pc",h:["vec3"],g:!1},{a:"node_in",c:"pd",h:["float"],g:!1},{a:"node_in",c:"pe",h:["vec2"],g:!1},{a:"node_out",c:"pf",h:["float"],g:!1}],m:[{a:"txt",b:"pf = _0_0 ; if ( pb . g != _0_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ph",h:["vec3"],g:!1},{a:"node_in",c:"pi",h:["vec2"],g:!1},{a:"node_in",c:"pj",h:["vec3"],g:!1},{a:"node_in",c:"pk",h:["float"],g:!1},{a:"node_in",c:"pl",h:["vec2"],g:!1},{a:"node_out",c:"pm",h:["float"],g:!1}],m:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pn",h:["vec3"],g:!1},{a:"node_in",c:"po",h:["vec2"],g:!1},{a:"node_in",c:"pr",h:["vec3"],g:!1},{a:"node_in",c:"pu",h:["float"],g:!1},{a:"node_in",c:"pv",h:["vec2"],g:!1},{a:"node_out",c:"pw",h:["float"],g:!1}],m:[{a:"txt",b:"pw = _0_0 ; if ( po . g != _0_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pz",h:["vec3"],g:!1},{a:"node_in",c:"pA",h:["vec2"],g:!1},{a:"node_in",c:"pB",h:["vec3"],g:!1},{a:"node_in",c:"pC",h:["float"],g:!1},{a:"node_in",c:"pD",h:["vec2"],g:!1},{a:"node_out",c:"pE",h:["float"],
g:!1}],m:[{a:"txt",b:"pE = _0_0 ; if ( pA . g != _0_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pG",h:["vec3"],g:!1},{a:"node_in",c:"pH",h:["vec2"],g:!1},{a:"node_in",c:"pI",h:["vec3"],g:!1},{a:"node_in",c:"pJ",h:["float"],g:!1},{a:"node_in",c:"pK",h:["vec2"],g:!1},{a:"node_out",c:"pL",h:["float"],g:!1}],m:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g != _0_0 ) { if ( pM < 1.0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( 1.0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = 0.0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",u:[],s:[{a:"node_in",c:"pQ",h:["vec4"],g:!1},{a:"node_in",c:"pR",h:["vec3"],g:!1},{a:"node_in",c:"pS",h:["float"],g:!1},{a:"node_in",c:"pT",h:["float"],g:!1},{a:"node_in",c:"pU",h:["vec3"],g:!1},{a:"node_in",c:"pV",h:["vec3"],g:!1},{a:"node_in",c:"pW",h:["vec4"],g:!1},{a:"node_in",c:"pX",h:["vec3"],g:!1},{a:"node_in",c:"pY",h:["vec3"],g:!1},{a:"node_in",c:"pZ",h:["vec3"],g:!1},{a:"node_in",c:"p_",h:["float"],g:!1},{a:"node_out",c:"qa",h:["vec4"],g:!1},{a:"node_out",c:"qb",
h:["vec3"],g:!1}],m:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]},{a:"node",c:"LIGHTING_END",u:[],s:[{a:"node_in",c:"qc",h:["vec4"],g:!1},{a:"node_in",c:"qd",h:["vec3"],g:!1}],m:[{a:"txt",b:"D = qc . rgb ; nO = qd ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void cp ( vec3 nC , vec3 nD , vec3 nE , vec3 nF , vec3 nG , vec3 nH , vec3 nI , vec2 nJ , vec2 nK , vec4 nL , float nM , vec4 nN , out vec3 D , out vec3 nO ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]}}]}]};a["include/math.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"MATH_GLSLV",j:{a:"grp",f:[{a:"define",c:"MATH_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"USE_POSITION_CLIP",b:["0"]},{a:"var",c:"SOFT_PARTICLES",b:["0"]},{a:"include",A:"std.glsl"},{a:"txt",b:"struct aj { vec3 N ; vec3 ac ; vec3 Q ; vec3 aq ; vec3 R ; vec3 P ; vec3 aG ; } ; bool ei ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 O ( in vec4 q , in vec3 ki ) { return ki + 2.0 * cross ( q . xyz , cross ( q . xyz , ki ) + q . w * ki ) ; } vec4 kj ( in vec4 gI ) { return vec4 ( - gI . xyz , gI . w ) ; } vec4 qe ( in vec4 a , in vec4 b ) { vec4 gK ; gK . x = a . x * b . w + a . w * b . x + a . y * b . z - a . z * b . y ; gK . y = a . y * b . w + a . w * b . y + a . z * b . x - a . x * b . z ; gK . z = a . z * b . w + a . w * b . z + a . x * b . y - a . y * b . x ; gK . w = a . w * b . w - a . x * b . x - a . y * b . y - a . z * b . z ; return gK ; } vec4 cI ( in vec3 qf , in float qg ) { vec4 gK ; qg = qg * 0.5 ; float s = sin ( qg ) ; gK . x = s * qf [ 0 ] ; gK . y = s * qf [ 1 ] ; gK . z = s * qf [ 2 ] ; gK . w = cos ( qg ) ; return gK ; } vec4 qj ( in vec3 be , in vec3 qh ) { vec4 gK ; float df = dot ( qh , be ) ; vec3 qi = cross ( qh , be ) ; gK . xyz = qi . xyz ; gK . w = 1.0 + df ; return normalize ( gK ) ; } vec3 ql ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ * qk . w ; gK = O ( gI , gK ) ; gK += qk . xyz ; return gK ; } vec3 ad ( mat3 qm , vec3 gJ ) { vec3 gK = gJ * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; gK += qm [ 0 ] ; return gK ; } vec3 qn ( vec4 qk , vec4 gI , vec3 be ) { vec3 gK = be * qk . w ; gK = O ( gI , gK ) ; return gK ; } vec3 T ( mat3 qm , vec3 be ) { vec3 gK = be * qm [ 1 ] [ 0 ] ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK = O ( gI , gK ) ; return gK ; } vec3 qo ( vec4 qk , vec4 gI , vec3 gJ ) { vec3 gK = gJ - qk . xyz ; gK = O ( kj ( gI ) , gK ) ; gK /= qk . w ; return gK ; } vec3 qr ( vec4 qk , vec4 gI , vec3 be ) { return O ( kj ( gI ) , be ) / qk . w ; } mat4 qu ( ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qv ( float bm ) { return mat4 ( _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qw ( float bm ) { return mat4 ( cos ( bm ) , _0_0 , - sin ( bm ) , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , sin ( bm ) , _0_0 , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } mat4 qx ( float bm ) { return mat4 ( cos ( bm ) , sin ( bm ) , _0_0 , _0_0 , - sin ( bm ) , cos ( bm ) , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _0_0 , _1_0 ) ; } aj lk ( in aj ki ) { return aj ( ki . N , ki . ac , normalize ( ki . Q ) , normalize ( ki . aq ) , normalize ( ki . R ) , normalize ( ki . P ) , ki . aG ) ; }".split(" ")},
{a:"cond",f:[{a:"if",i:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2},"REFRACTIVE","USE_POSITION_CLIP",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"vec3 as ( vec4 f ) { float fj = f . x ; float fk = f . y ; float fl = f . w ; vec3 qy ; qy . x = ( fj + fl ) / 2.0 ; qy . y = ( fk + fl ) / 2.0 ; qy . z = fl ; return qy ; }".split(" ")}]}}]},{a:"txt",b:"mat3 cG ( ) { return mat3 ( _0_0 , _0_0 , _0_0 , _1_0 , _0_0 , _0_0 , _0_0 , _1_0 , _0_0 ) ; } mat4 aR ( mat3 t ) { mat4 qz ; qz [ 0 ] [ 0 ] = ( _1_0 - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 0 ] [ 3 ] = _0_0 ; qz [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 1 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 1 ] [ 3 ] = _0_0 ; qz [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 2 ] = ( _1_0 - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; qz [ 2 ] [ 3 ] = _0_0 ; qz [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; qz [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; qz [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; qz [ 3 ] [ 3 ] = 1.0 ; return qz ; } mat3 aO ( in mat3 qm , in mat3 qA ) { mat3 gK ; vec3 gJ = qA [ 0 ] ; vec4 qk = vec4 ( qm [ 0 ] , qm [ 1 ] [ 0 ] ) ; vec4 gI = vec4 ( qm [ 1 ] [ 1 ] , qm [ 1 ] [ 2 ] , qm [ 2 ] [ 0 ] , qm [ 2 ] [ 1 ] ) ; gK [ 0 ] = ql ( qk , gI , gJ ) ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] * qA [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = qm [ 1 ] [ 1 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 1 ] + qm [ 1 ] [ 2 ] * qA [ 2 ] [ 0 ] - qm [ 2 ] [ 0 ] * qA [ 1 ] [ 2 ] ; gK [ 1 ] [ 2 ] = qm [ 1 ] [ 2 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 1 ] [ 2 ] + qm [ 2 ] [ 0 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 2 ] [ 0 ] ; gK [ 2 ] [ 0 ] = qm [ 2 ] [ 0 ] * qA [ 2 ] [ 1 ] + qm [ 2 ] [ 1 ] * qA [ 2 ] [ 0 ] + qm [ 1 ] [ 1 ] * qA [ 1 ] [ 2 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 1 ] ; gK [ 2 ] [ 1 ] = qm [ 2 ] [ 1 ] * qA [ 2 ] [ 1 ] - qm [ 1 ] [ 1 ] * qA [ 1 ] [ 1 ] - qm [ 1 ] [ 2 ] * qA [ 1 ] [ 2 ] - qm [ 2 ] [ 0 ] * qA [ 2 ] [ 0 ] ; return gK ; } mat3 cK ( in vec4 gI , in mat3 qm ) { mat3 gK ; gK [ 0 ] = qm [ 0 ] ; gK [ 1 ] [ 0 ] = qm [ 1 ] [ 0 ] ; gK [ 1 ] [ 1 ] = gI [ 0 ] ; gK [ 1 ] [ 2 ] = gI [ 1 ] ; gK [ 2 ] [ 0 ] = gI [ 2 ] ; gK [ 2 ] [ 1 ] = gI [ 3 ] ; return gK ; }".split(" ")}]}}]}]};
a["include/mirror.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"MIRROR_GLSLF",j:{a:"grp",f:[{a:"define",c:"MIRROR_GLSLF",b:[""]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2},{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"include",A:"color_util.glslf"},
{a:"include",A:"math.glslv"},{a:"define",c:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float qB ( in vec3 C , vec3 dX , float ec , float eb ) { vec3 d_ = normalize ( dX + C ) ; float ea = 1.0 - dot ( C , d_ ) ; float r = eb + ( 1.0 - eb ) * pow ( ea , ec ) ; return r ; } void cq ( inout vec3 qC , vec3 C , vec3 P , float qD , mat3 M ) { vec3 dX = reflect ( - C , P ) ; float ec = u_fresnel_params [ 2 ] ; float eb = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( ec != 0.0 ) r = qB ( C , dX , ec , eb ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 dZ = vec3 ( 1.0 ) ; qD = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 dZ = GLSL_TEXTURE_CUBE ( u_mirrormap , dX ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bY ( dZ . rgb ) ; qC = mix ( qC , dZ , qD * r ) ; } vec3 qK ( vec3 qC , vec3 qI , vec3 C , vec3 P , float qJ , mat3 M ) {".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",
b:"vec3 dX = reflect ( - C , P ) ; vec3 dZ = GLSL_TEXTURE_CUBE ( u_cube_reflection , dX ) . xyz ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},{a:"elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2},"REFLECTION_PASS","REFL_PASS_NONE",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 qE = u_refl_plane . xyz * dot ( P , u_refl_plane . xyz ) ; vec3 qF = P - qE ; vec2 qG = T ( M , qF ) . xy ; vec2 qH = l . xy / l . z ; qH += qG * REFL_BUMP ; vec3 dZ = GLSL_TEXTURE ( u_plane_reflection , qH ) . rgb ; bY ( dZ ) ; dZ *= qI ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","dZ","=","qI",";"]}]}}]},{a:"txt",b:"return mix ( qC , dZ , qJ ) ; }".split(" ")}]}}]}]}}]}]};a["include/nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"NODES_GLSLF",j:{a:"grp",f:[{a:"define",c:"NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"USE_REFRACTION",b:["0"]},{a:"var",c:"HAS_REFRACT_TEXTURE",b:["0"]},
{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"REFLECTION_TYPE",b:["REFL_NONE"]},{a:"var",c:"USE_DERIVATIVES_EXT",b:["0"]},{a:"var",c:"CAMERA_TYPE",b:["CAM_TYPE_PERSP"]},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"mirror.glslf"},{a:"include",A:"shadow.glslf"},{a:"include",A:"environment.glslf"}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"include",
A:"refraction.glslf"}]}}]},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["GLSL_IN","vec3","qL",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_B4W_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:"vec3 qO ( in vec3 qM , in float qN ) { vec3 eq = vec3 ( _0_0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_REFRACTION"],j:{a:"grp",f:[{a:"txt",b:"eq = cs ( l , qM . xy * qN ) ;".split(" ")}]}},
{a:"elif",i:["HAS_REFRACT_TEXTURE"],j:{a:"grp",f:[{a:"txt",b:"eq = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( eq ) ;".split(" ")}]}}]},{a:"txt",b:["return","eq",";","}"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{a:"logical_or_expr",l:5}],j:{a:"grp",f:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float qV ( vec3 qR , vec3 qS , float qT ) { float da = abs ( dot ( qR , qS ) ) ; float g = qT * qT - _1_0 + da * da ; float qU ; if ( g > _0_0 ) { g = sqrt ( g ) ; float cg = ( g - da ) / ( g + da ) ; float oN = ( da * ( g + da ) - _1_0 ) / ( da * ( g - da ) + _1_0 ) ; qU = _0_5 * cg * cg * ( _1_0 + oN * oN ) ; } else { qU = _1_0 ; } return qU ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
u:[],s:[{a:"node_out",c:"rq",h:["vec3"],g:!0},{a:"node_out",c:"rs",h:["float"],g:!0},{a:"node_out",c:"rt",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rq"],m:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rs"],m:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rt"],m:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",u:[],s:[{a:"node_in",c:"ru",h:["float"],
g:!1},{a:"node_in",c:"rv",h:["float"],g:!1},{a:"node_in",c:"rw",h:["float"],g:!1},{a:"node_out",c:"rx",h:["vec3"],g:!1}],m:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",u:[],s:[{a:"node_in",c:"ry",h:["float"],g:!1},{a:"node_in",c:"rz",h:["float"],g:!1},{a:"node_in",c:"rA",h:["float"],g:!1},{a:"node_out",c:"rB",h:["vec3"],g:!1}],m:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",u:[],s:[{a:"node_out",c:"rC",h:["vec3"],g:!1}],m:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",u:[],s:[{a:"node_out",c:"rD",h:["vec3"],g:!1}],m:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[{a:"node_out",c:"rE",h:["vec3"],g:!1},{a:"node_param",c:"qW",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",b:"rE = qP ( qW ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",u:[],s:[{a:"node_out",c:"rF",h:["vec3"],g:!1}],m:[{a:"txt",b:"rF = 2.0 * qL - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",
u:[],s:[{a:"node_out",c:"rG",h:["vec3"],g:!1},{a:"node_param",c:"qX",h:["GLSL_IN","vec3"],g:!1}],m:[{a:"txt",b:"rG = max ( vec3 ( _0_0 ) , qX ) ; bY ( rG ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",u:[],s:[{a:"node_out",c:"rH",h:["float"],g:!1},{a:"node_param",c:"qY",h:["GLSL_IN","float"],g:!1}],m:[{a:"txt",b:"rH = max ( _0_0 , qY ) ; bY ( rH ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC2",u:[],s:[{a:"node_out",c:"rI",h:["float"],g:!1},{a:"node_out",c:"rJ",h:["float"],g:!1},{a:"node_param",c:"qZ",
h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",b:"rI = max ( _0_0 , qZ [ 0 ] ) ; rJ = max ( _0_0 , qZ [ 1 ] ) ; bY ( rI ) ; bY ( rJ ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",u:[],s:[{a:"node_out",c:"rK",h:["float"],g:!1},{a:"node_out",c:"rL",h:["float"],g:!1},{a:"node_out",c:"rM",h:["float"],g:!1},{a:"node_param",c:"q_",h:["GLSL_IN","vec3"],g:!1}],m:[{a:"txt",b:"rK = max ( _0_0 , q_ [ 0 ] ) ; rL = max ( _0_0 , q_ [ 1 ] ) ; rM = max ( _0_0 , q_ [ 2 ] ) ; bY ( rK ) ; bY ( rL ) ; bY ( rM ) ;".split(" ")}]},
{a:"node",c:"GEOMETRY_NO",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"rN",h:["vec3"],g:!1},{a:"node_out",c:"rO",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["rO","=","rN",";"]}]},{a:"node_else",m:[{a:"txt",b:"rO = rl . xyz ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_FB",u:[],s:[{a:"node_out",c:"rP",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_BF",u:[],s:[{a:"node_out",c:"rQ",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"rQ = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"rQ = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",u:[],s:[{a:"node_out",c:"rR",h:["vec3"],g:!1}],m:[{a:"txt",
b:"rR = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",u:[],s:[{a:"node_out",c:"rS",h:["vec3"],g:!1}],m:[{a:"txt",b:"rS = rn . xyz ;".split(" ")}]},{a:"node",c:"GEOMETRY_GL",u:[],s:[{a:"node_out",c:"rT",h:["vec3"],g:!1}],m:[{a:"txt",b:["rT","=","nG",";"]}]},{a:"node",c:"GEOMETRY_IN",u:[],s:[{a:"node_out",c:"rU",h:["vec3"],g:!1}],m:[{a:"txt",b:["rU","=","nI",";"]}]},{a:"node",c:"NEW_GEOMETRY",u:[],s:[{a:"node_out",c:"rV",h:["vec3"],g:!1},{a:"node_out",c:"rW",h:["vec3"],g:!1},
{a:"node_out",c:"rX",h:["vec3"],g:!1},{a:"node_out",c:"rY",h:["vec3"],g:!1},{a:"node_out",c:"rZ",h:["vec3"],g:!1},{a:"node_out",c:"r_",h:["vec3"],g:!1},{a:"node_out",c:"sa",h:["float"],g:!1},{a:"node_out",c:"sb",h:["float"],g:!1}],m:[{a:"txt",b:"rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = vec3 ( _0_0 ) ; sa = _0_0 ; sb = _0_0 ;".split(" ")}]},{a:"node",c:"HUE_SAT",u:[],s:[{a:"node_in",c:"sc",h:["float"],g:!1},{a:"node_in",c:"sd",h:["float"],
g:!1},{a:"node_in",c:"se",h:["float"],g:!1},{a:"node_in",c:"sf",h:["float"],g:!1},{a:"node_in",c:"sg",h:["vec3"],g:!1},{a:"node_out",c:"sh",h:["vec3"],g:!1}],m:[{a:"txt",b:"vec3 jz = jy ( sg ) ; jz [ 0 ] += ( sc - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sd , se ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sh = mix ( sg , jA ( jz ) , sf ) ;".split(" ")}]},
{a:"node",c:"INVERT",u:[],s:[{a:"node_in",c:"si",h:["float"],g:!1},{a:"node_in",c:"sj",h:["vec3"],g:!1},{a:"node_out",c:"sk",h:["vec3"],g:!1}],m:[{a:"txt",b:"sk = mix ( sj , vec3 ( _1_0 ) - sj , si ) ;".split(" ")}]},{a:"node",c:"LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],s:[{a:"node_out",
c:"sl",h:["vec3"],g:!0},{a:"node_out",c:"sm",h:["vec3"],g:!1},{a:"node_out",c:"sn",h:["float"],g:!1},{a:"node_out",c:"so",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["LAMP_INDEX",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sl"],m:[{a:"txt",b:"sl = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 sr = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 su = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"sm = - h + su ; sn = length ( sm ) ; sm = normalize ( sm ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_so"],m:[{a:"txt",b:"so = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sn * sn ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"float ol = dot ( sm , sr ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; so *= ol ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"so *= max ( LAMP_LIGHT_DIST - sn , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sm"],m:[{a:"txt",b:["sm","=","sr",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sn"],m:[{a:"txt",b:"sn = length ( su - h ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_so"],m:[{a:"txt",b:["so","=","_1_0",";"]}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",
i:["USE_OUT_sl"],m:[{a:"txt",b:"sl = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:"sm = vec3 ( _0_0 ) ; sn = 0.0 ;".split(" ")}]}]}]},{a:"node",c:"NORMAL",u:[],s:[{a:"node_in",c:"sv",h:["vec3"],g:!1},{a:"node_out",c:"sw",h:["vec3"],g:!0},{a:"node_out",c:"sx",h:["float"],g:!0},{a:"node_param",c:"rc",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sw"],m:[{a:"txt",b:["sw","=","rc",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sx"],m:[{a:"txt",b:"sx = - dot ( sv , rc ) ;".split(" ")}]}]}]},
{a:"node",c:"B4W_VECTOR_VIEW",u:[],s:[{a:"node_in",c:"sy",h:["vec3"],g:!1},{a:"node_out",c:"sz",h:["vec3"],g:!1}],m:[{a:"txt",b:"sz = - T ( u_view_tsr_frag , sy ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",u:[],s:[{a:"node_in",c:"sA",h:["vec3"],g:!1},{a:"node_in",c:"sB",h:["vec3"],g:!1},{a:"node_in",c:"sC",h:["float"],g:!1},{a:"node_in",c:"sD",h:["vec3"],g:!1},{a:"node_in",c:"sE",h:["float"],g:!1},{a:"node_in",c:"sF",h:["float"],g:!1},{a:"node_in",c:"sG",h:["vec3"],g:!1},{a:"node_in",c:"sH",h:["vec3"],
g:!1},{a:"node_in",c:"sI",h:["float"],g:!1},{a:"node_in",c:"sJ",h:["vec3"],g:!1},{a:"node_in",c:"sK",h:["float"],g:!1},{a:"node_out",c:"sL",h:["vec3"],g:!1},{a:"node_out",c:"sM",h:["vec3"],g:!1},{a:"node_out",c:"sN",h:["vec3"],g:!1},{a:"node_out",c:"sO",h:["vec3"],g:!1},{a:"node_out",c:"sP",h:["vec3"],g:!1},{a:"node_out",c:"sQ",h:["vec4"],g:!1},{a:"node_out",c:"sR",h:["vec4"],g:!1},{a:"node_out",c:"sS",h:["vec3"],g:!1},{a:"node_out",c:"sT",h:["float"],g:!1},{a:"node_out",c:"sU",h:["vec3"],g:!1},{a:"node_out",
c:"sV",h:["float"],g:!1},{a:"node_out",c:"sW",h:["vec3"],g:!1},{a:"node_out",c:"sX",h:["float"],g:!1}],m:[{a:"txt",b:"sN = sB ; sO = sD ; sP = sG ; sS = sD ; sT = sF ; sU = sH ; sV = sI ; sW = sJ ; sX = sK ; sL = ro * sN ; sM = rp * u_environment_energy * ce ( sP ) ; sR = ch ( sN ) ; G = sR ; sQ [ 0 ] = sC ; sQ [ 1 ] = sE ; sQ [ 2 ] = sF ;".split(" ")}]},{a:"node",c:"BSDF_END",u:[],s:[{a:"node_in",c:"sY",h:["vec4"],g:!1},{a:"node_in",c:"sZ",h:["vec3"],g:!1},{a:"node_in",c:"s_",h:["vec3"],g:!1},{a:"node_in",
c:"ta",h:["vec3"],g:!1},{a:"node_in",c:"tb",h:["float"],g:!1},{a:"node_in",c:"tc",h:["vec3"],g:!1},{a:"node_in",c:"td",h:["float"],g:!1},{a:"node_in",c:"te",h:["vec3"],g:!1},{a:"node_in",c:"tf",h:["float"],g:!1},{a:"node_out",c:"tg",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"tg = qK ( sY . rgb , ta , nI , s_ , tb , mat3 ( _0_0 ) ) ;".split(" ")}]},{a:"node_elif",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",
b:"tg = qK ( sY . rgb , ta , nI , s_ , tb , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"tg = sY . rgb ;".split(" ")}]}]},{a:"txt",b:"tg += sZ ; tg = mix ( tg , tc , td ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_BSDF_TRANSPARENT"],m:[{a:"txt",b:"vec3 th = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( th ) ; te = te * th ; tg += te ;".split(" ")}]}]},{a:"txt",b:["s_",";"]}]},{a:"node",c:"BSDF_COMPUTE",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],
s:[{a:"node_in",c:"ti",h:["vec3"],g:!1},{a:"node_in",c:"tj",h:["vec2"],g:!1},{a:"node_in",c:"tk",h:["vec3"],g:!1},{a:"node_in",c:"tl",h:["float"],g:!1},{a:"node_in",c:"tm",h:["vec4"],g:!1},{a:"node_out",c:"tn",h:["float"],g:!1},{a:"node_out",c:"to",h:["float"],g:!1}],m:[{a:"txt",b:"vec3 qS = tk ; float tr = clamp ( tm [ 0 ] , _0_0 , _1_0 ) ; float tu = clamp ( tm [ 1 ] , _0_0 , _1_0 ) ; float qJ = tm [ 2 ] ; vec3 pg = normalize ( nI + ti ) ; float ot = ( _1_0 - tl ) * dot ( qS , ti ) + tl ; float tv = ( _1_0 - tl ) * max ( dot ( ti , pg ) , _0_0 ) + tl ; float tw = ( _1_0 - tl ) * max ( dot ( tk , pg ) , _0_0 ) + tl ; tn = _0_0 ; if ( tj . r != _0_0 ) { if ( tr > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tr * tr ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = ti - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) tn = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; tn = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else tn = ot ; tn = max ( tn , _0_0 ) ; } float J = tu ; float tx = J * J ; float ty = ( tw * tx - tw ) * tw + _1_0 ; float cd = tx / ( M_PI * ty * ty ) ; float tz ; float tA ; float tB = pow ( _1_0 - tv , 5.0 ) ; tz = _1_0 ; tA = tB ; float jx = J / 2.0 ; float tC = jx * jx ; float tD = _1_0 - tC ; float tE = _1_0 / ( tv * tv * tD + tC ) ; tz *= tE ; tA *= tE ; float tF = mix ( 0.04 , _1_0 , qJ ) ; float tG = mix ( tA , tz , tF ) ; to = max ( ot * cd * tG , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",u:[],s:[{a:"node_in",c:"tH",h:["vec3"],g:!1},{a:"node_in",c:"tI",h:["float"],g:!1},{a:"node_in",c:"tJ",h:["float"],g:!1},{a:"node_in",c:"tK",h:["float"],g:!1},{a:"node_in",c:"tL",h:["vec3"],g:!1},{a:"node_in",c:"tM",h:["vec3"],g:!1},{a:"node_out",c:"tN",h:["vec3"],g:!1}],m:[{a:"txt",b:"tN = tH ; tI ; tJ ; tK ; tL ; tM ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"tO",h:["vec3"],g:!1},{a:"node_in",c:"tP",h:["float"],
g:!1},{a:"node_in",c:"tQ",h:["vec3"],g:!1},{a:"node_out",c:"tR",h:["vec3"],g:!1},{a:"node_out",c:"tS",h:["vec3"],g:!1},{a:"node_out",c:"tT",h:["float"],g:!1},{a:"node_out",c:"tU",h:["vec3"],g:!1},{a:"node_out",c:"tV",h:["float"],g:!1},{a:"node_out",c:"tW",h:["float"],g:!1},{a:"node_out",c:"tX",h:["vec3"],g:!1},{a:"node_out",c:"tY",h:["vec3"],g:!1},{a:"node_out",c:"tZ",h:["float"],g:!1},{a:"node_out",c:"t_",h:["vec3"],g:!1},{a:"node_out",c:"ua",h:["float"],g:!1}],m:[{a:"txt",b:"tS = tO ; tT = tP ; tW = _0_0 ; tZ = _0_0 ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["tX","=","tQ",";"]}]},{a:"node_else",m:[{a:"txt",b:["tX","=","nH",";"]}]}]},{a:"txt",b:"tR ; tU ; tV ; tY ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",u:[],s:[{a:"node_in",c:"ub",h:["vec3"],g:!1},{a:"node_in",c:"uc",h:["float"],g:!1},{a:"node_in",c:"ud",h:["float"],g:!1},{a:"node_in",c:"ue",h:["vec3"],g:!1},{a:"node_out",c:"uf",h:["vec3"],g:!1}],m:[{a:"txt",b:"uf = ub ; uc ; ud ; ue ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",
u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"ug",h:["vec3"],g:!1},{a:"node_in",c:"uh",h:["float"],g:!1},{a:"node_in",c:"ui",h:["vec3"],g:!1},{a:"node_out",c:"uj",h:["vec3"],g:!1},{a:"node_out",c:"uk",h:["vec3"],g:!1},{a:"node_out",c:"ul",h:["float"],g:!1},{a:"node_out",c:"um",h:["vec3"],g:!1},{a:"node_out",c:"un",h:["float"],g:!1},{a:"node_out",c:"uo",h:["float"],g:!1},{a:"node_out",c:"up",h:["vec3"],g:!1},{a:"node_out",c:"uq",h:["vec3"],g:!1},{a:"node_out",c:"ur",h:["float"],g:!1},
{a:"node_out",c:"us",h:["vec3"],g:!1},{a:"node_out",c:"ut",h:["float"],g:!1}],m:[{a:"txt",b:"um = ug ; un = uh ; uo = _1_0 ; ur = _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["up","=","ui",";"]}]},{a:"node_else",m:[{a:"txt",b:["up","=","nH",";"]}]}]},{a:"txt",b:"uj ; uk ; ul ; uq ; us ; ut ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",u:[],s:[{a:"node_in",c:"uu",h:["vec3"],g:!1},{a:"node_in",c:"uv",h:["float"],g:!1},{a:"node_in",c:"uw",h:["float"],g:!1},{a:"node_in",
c:"ux",h:["float"],g:!1},{a:"node_out",c:"uy",h:["vec3"],g:!1}],m:[{a:"txt",b:"uy = uu ; uv ; uw ; ux ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",u:[],s:[{a:"node_in",c:"uz",h:["vec3"],g:!1},{a:"node_out",c:"uA",h:["vec3"],g:!1},{a:"node_out",c:"uB",h:["vec3"],g:!1},{a:"node_out",c:"uC",h:["float"],g:!1},{a:"node_out",c:"uD",h:["vec3"],g:!1},{a:"node_out",c:"uE",h:["float"],g:!1},{a:"node_out",c:"uF",h:["float"],g:!1},{a:"node_out",c:"uG",h:["vec3"],g:!1},{a:"node_out",c:"uH",h:["vec3"],g:!1},
{a:"node_out",c:"uI",h:["float"],g:!1},{a:"node_out",c:"uJ",h:["vec3"],g:!1},{a:"node_out",c:"uK",h:["float"],g:!1}],m:[{a:"txt",b:"uJ = uz ; uF = _0_0 ; uI = _0_0 ; uK = _0_0 ; uG = nH ; uA ; uB ; uC ; uD ; uE ; uH ;".split(" ")}]},{a:"node",c:"BSDF_TRANSLUCENT",u:[],s:[{a:"node_in",c:"uL",h:["vec3"],g:!1},{a:"node_in",c:"uM",h:["vec3"],g:!1},{a:"node_out",c:"uN",h:["vec3"],g:!1}],m:[{a:"txt",b:"uN = uL ; uM ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",u:[],s:[{a:"node_in",c:"uO",h:["vec3"],g:!1},
{a:"node_in",c:"uP",h:["float"],g:!1},{a:"node_in",c:"uQ",h:["float"],g:!1},{a:"node_in",c:"uR",h:["vec3"],g:!1},{a:"node_out",c:"uS",h:["vec3"],g:!1}],m:[{a:"txt",b:"uS [ 0 ] = uS [ 1 ] = uS [ 2 ] = _0_0 ; uO ; uP ; uQ ; uR ;".split(" ")}]},{a:"node",c:"BSDF_TOON",u:[],s:[{a:"node_in",c:"uT",h:["vec3"],g:!1},{a:"node_in",c:"uU",h:["float"],g:!1},{a:"node_in",c:"uV",h:["float"],g:!1},{a:"node_in",c:"uW",h:["vec3"],g:!1},{a:"node_out",c:"uX",h:["vec3"],g:!1}],m:[{a:"txt",b:"uX = uT ; uU ; uV ; uW ;".split(" ")}]},
{a:"node",c:"BSDF_VELVET",u:[],s:[{a:"node_in",c:"uY",h:["vec3"],g:!1},{a:"node_in",c:"uZ",h:["float"],g:!1},{a:"node_in",c:"u_",h:["vec3"],g:!1},{a:"node_out",c:"va",h:["vec3"],g:!1}],m:[{a:"txt",b:"va = uY ; uZ ; u_ ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",u:[],s:[{a:"node_in",c:"vb",h:["vec3"],g:!1},{a:"node_in",c:"vc",h:["float"],g:!1},{a:"node_in",c:"vd",h:["vec3"],g:!1},{a:"node_in",c:"ve",h:["float"],g:!1},{a:"node_in",c:"vf",h:["float"],g:!1},{a:"node_in",c:"vg",h:["vec3"],g:!1},
{a:"node_out",c:"vh",h:["vec3"],g:!1}],m:[{a:"txt",b:"vh [ 0 ] = vh [ 1 ] = vh [ 2 ] = _0_0 ; vb ; vd ; ve ; vf ; vg ; vc ;".split(" ")}]},{a:"node",c:"EMISSION",u:[],s:[{a:"node_in",c:"vi",h:["vec3"],g:!1},{a:"node_in",c:"vj",h:["float"],g:!1},{a:"node_out",c:"vk",h:["vec3"],g:!1},{a:"node_out",c:"vl",h:["vec3"],g:!1},{a:"node_out",c:"vm",h:["float"],g:!1},{a:"node_out",c:"vn",h:["vec3"],g:!1},{a:"node_out",c:"vo",h:["float"],g:!1},{a:"node_out",c:"vp",h:["float"],g:!1},{a:"node_out",c:"vq",h:["vec3"],
g:!1},{a:"node_out",c:"vr",h:["vec3"],g:!1},{a:"node_out",c:"vs",h:["float"],g:!1},{a:"node_out",c:"vt",h:["vec3"],g:!1},{a:"node_out",c:"vu",h:["float"],g:!1}],m:[{a:"txt",b:"vr = vj * vi ; vp = _0_0 ; vs = _1_0 ; vq = nH ; vk ; vl ; vm ; vn ; vo ; vu ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",u:[],s:[{a:"node_in",c:"vv",h:["vec3"],g:!1},{a:"node_out",c:"vw",h:["vec3"],g:!1}],m:[{a:"txt",b:"vw [ 0 ] = vw [ 1 ] = vw [ 2 ] = _0_0 ; vv ;".split(" ")}]},{a:"node",c:"HOLDOUT",u:[],s:[{a:"node_out",
c:"vx",h:["vec3"],g:!1}],m:[{a:"txt",b:"vx [ 0 ] = vx [ 1 ] = vx [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",u:[],s:[{a:"node_in",c:"vy",h:["vec3"],g:!1},{a:"node_in",c:"vz",h:["float"],g:!1},{a:"node_out",c:"vA",h:["vec3"],g:!1}],m:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vy ; vz ;".split(" ")}]},{a:"node",c:"VOLUME_SCATTER",u:[],s:[{a:"node_in",c:"vB",h:["vec3"],g:!1},{a:"node_in",c:"vC",h:["float"],g:!1},{a:"node_in",c:"vD",h:["float"],g:!1},{a:"node_out",c:"vE",h:["vec3"],
g:!1}],m:[{a:"txt",b:"vE [ 0 ] = vE [ 1 ] = vE [ 2 ] = _0_0 ; vB ; vC ; vD ;".split(" ")}]},{a:"node",c:"BUMP",u:[{a:"node_var",c:"INVERT",b:["0"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"vF",h:["float"],g:!1},{a:"node_in",c:"vG",h:["float"],g:!1},{a:"node_in",c:"vH",h:["float"],g:!1},{a:"node_in",c:"vI",h:["vec3"],g:!1},{a:"node_out",c:"vJ",h:["vec3"],g:!1}],m:[{a:"txt",b:"float aC = vG ; float fX = vF ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["INVERT"],m:[{a:"txt",b:["aC",
"=","-","_1_0",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["vec3","P","=","vI",";"]}]},{a:"node_else",m:[{a:"txt",b:["vec3","P","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_DERIVATIVES_EXT"],m:[{a:"txt",b:"vec3 vK = dFdx ( nG ) ; vec3 vL = dFdy ( nG ) ; vec3 vM = cross ( vL , P ) ; vec3 vN = cross ( P , vK ) ; float db = dot ( vK , vM ) ; float vO = abs ( db ) ; vec3 vP = dFdx ( vH ) * vM + dFdy ( vH ) * vN ; fX = max ( fX , _0_0 ) ; vJ = normalize ( vO * P - aC * sign ( db ) * vP ) ; vJ = normalize ( fX * vJ + ( _1_0 - fX ) * P ) ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:["vJ","=","P",";"]}]}]}]},{a:"node",c:"DISPLACEMENT_BUMP",u:[],s:[{a:"node_in",c:"vQ",h:["float"],g:!1},{a:"node_out",c:"vR",h:["vec3"],g:!1}],m:[{a:"txt",b:"float aC = 0.1 ; vec3 P = nH ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_DERIVATIVES_EXT"],m:[{a:"txt",b:"vec3 vK = dFdx ( nG ) ; vec3 vL = dFdy ( nG ) ; vec3 vM = cross ( vL , P ) ; vec3 vN = cross ( P , vK ) ; float db = dot ( vK , vM ) ; float vO = abs ( db ) ; vec3 vP = dFdx ( vQ ) * vM + dFdy ( vQ ) * vN ; vR = normalize ( vO * P - aC * sign ( db ) * vP ) ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:["vR","=","P",";"]}]}]}]},{a:"node",c:"NORMAL_MAP",u:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"vS",h:["float"],g:!1},{a:"node_in",c:"vT",h:["vec4"],g:!1},{a:"node_in",c:"vU",h:["vec3"],g:!1},{a:"node_out",c:"vV",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:"vec3 vW = normalize ( vU ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","vW","=","nH",";"]}]}]},{a:"node_cond",
f:[{a:"node_if",i:["SPACE","NM_TANGENT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV = rm * vV ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_OBJECT",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV . yz *= - _1_0 ; vV = T ( u_model_tsr , vV ) ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_WORLD",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",l:2},{a:"logical_or_expr",
l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV . yz *= - _1_0 ;".split(" ")}]}]},{a:"txt",b:"vV = normalize ( mix ( vW , vV , vS ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",u:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],s:[{a:"node_in",c:"vX",h:["vec3"],g:!1},{a:"node_out",c:"vY",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",l:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",
{a:"equal_expr",l:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",l:2},{a:"logical_or_expr",l:3}],m:[{a:"txt",b:["vY","=","vX",";"]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_frag , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr_inverse , vX ) ;".split(" ")}]},
{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr , vX ) ; vY = ad ( u_view_tsr_frag , vY ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",
{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_inverse , vX ) ; vY = ad ( u_model_tsr_inverse , vY ) ;".split(" ")}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_frag , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",
{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr , vX ) ; vY = T ( u_view_tsr_frag , vY ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_inverse , vX ) ; vY = T ( u_model_tsr_inverse , vY ) ;".split(" ")}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = normalize ( vY ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",u:[],s:[{a:"node_in",c:"vZ",h:["float"],g:!1},{a:"node_out",c:"v_",h:["vec3"],g:!1}],m:[{a:"txt",b:"v_ [ 0 ] = v_ [ 1 ] = v_ [ 2 ] = _0_0 ; vZ ;".split(" ")}]},{a:"node",c:"WAVELENGTH",u:[],s:[{a:"node_in",c:"wa",h:["float"],g:!1},{a:"node_out",c:"wb",h:["vec3"],g:!1}],m:[{a:"txt",b:"wb [ 0 ] = wb [ 1 ] = wb [ 2 ] = _0_0 ; wa ;".split(" ")}]},
{a:"node",c:"SEPXYZ",u:[],s:[{a:"node_in",c:"wc",h:["vec3"],g:!1},{a:"node_out",c:"wd",h:["float"],g:!1},{a:"node_out",c:"we",h:["float"],g:!1},{a:"node_out",c:"wf",h:["float"],g:!1}],m:[{a:"txt",b:"wd = wc [ 0 ] ; we = wc [ 1 ] ; wf = wc [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",u:[],s:[{a:"node_in",c:"wg",h:["float"],g:!1},{a:"node_in",c:"wh",h:["float"],g:!1},{a:"node_in",c:"wi",h:["float"],g:!1},{a:"node_out",c:"wj",h:["vec3"],g:!1}],m:[{a:"txt",b:"wj [ 0 ] = wg ; wj [ 1 ] = wh ; wj [ 2 ] = wi ;".split(" ")}]},
{a:"node",c:"BRIGHTCONTRAST",u:[],s:[{a:"node_in",c:"wk",h:["vec3"],g:!1},{a:"node_in",c:"wl",h:["float"],g:!1},{a:"node_in",c:"wm",h:["float"],g:!1},{a:"node_out",c:"wn",h:["vec3"],g:!1}],m:[{a:"txt",b:"float b = wl - wm * _0_5 ; wn = max ( ( _1_0 + wm ) * wk + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",u:[],s:[{a:"node_in",c:"wo",h:["float"],g:!1},{a:"node_in",c:"wp",h:["float"],g:!1},{a:"node_out",c:"wq",h:["float"],g:!1},{a:"node_out",c:"wr",h:["float"],g:!1},{a:"node_out",
c:"ws",h:["float"],g:!1}],m:[{a:"txt",b:"wq = wr = ws = _0_0 ; wo ; wp ;".split(" ")}]},{a:"node",c:"TEX_SKY",u:[],s:[{a:"node_in",c:"wt",h:["vec3"],g:!1},{a:"node_out",c:"wu",h:["vec3"],g:!1}],m:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_NOISE",u:[],s:[{a:"node_in",c:"wv",h:["vec3"],g:!1},{a:"node_in",c:"wA",h:["float"],g:!1},{a:"node_in",c:"wB",h:["float"],g:!1},{a:"node_in",c:"wC",h:["float"],g:!1},{a:"node_out",c:"wD",h:["vec3"],g:!1},{a:"node_out",
c:"wE",h:["float"],g:!1}],m:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wv ; wA ; wB ; wC ;".split(" ")}]},{a:"node",c:"TEX_WAVE",u:[],s:[{a:"node_in",c:"wF",h:["vec3"],g:!1},{a:"node_in",c:"wG",h:["float"],g:!1},{a:"node_in",c:"wH",h:["float"],g:!1},{a:"node_in",c:"wI",h:["float"],g:!1},{a:"node_in",c:"wJ",h:["float"],g:!1},{a:"node_out",c:"wK",h:["vec3"],g:!1},{a:"node_out",c:"wL",h:["float"],g:!1}],m:[{a:"txt",b:"wK [ 0 ] = wK [ 1 ] = wK [ 2 ] = _0_0 ; wL = _1_0 ; wF ; wG ; wH ; wI ; wJ ;".split(" ")}]},
{a:"node",c:"TEX_VORONOI",u:[],s:[{a:"node_in",c:"wM",h:["vec3"],g:!1},{a:"node_in",c:"wN",h:["float"],g:!1},{a:"node_out",c:"wO",h:["vec3"],g:!1},{a:"node_out",c:"wP",h:["float"],g:!1}],m:[{a:"txt",b:"wO [ 0 ] = wO [ 1 ] = wO [ 2 ] = _0_0 ; wP = _1_0 ; wM ; wN ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",u:[],s:[{a:"node_in",c:"wQ",h:["vec3"],g:!1},{a:"node_in",c:"wR",h:["float"],g:!1},{a:"node_in",c:"wS",h:["float"],g:!1},{a:"node_in",c:"wT",h:["float"],g:!1},{a:"node_in",c:"wU",h:["float"],g:!1},
{a:"node_in",c:"wV",h:["float"],g:!1},{a:"node_in",c:"wW",h:["float"],g:!1},{a:"node_out",c:"wX",h:["vec3"],g:!1},{a:"node_out",c:"wY",h:["float"],g:!1}],m:[{a:"txt",b:"wX [ 0 ] = wX [ 1 ] = wX [ 2 ] = _0_0 ; wY = _1_0 ; wQ ; wR ; wS ; wT ; wU ; wV ; wW ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",u:[],s:[{a:"node_in",c:"wZ",h:["vec3"],g:!1},{a:"node_out",c:"w_",h:["vec3"],g:!1},{a:"node_out",c:"xa",h:["float"],g:!1}],m:[{a:"txt",b:"w_ [ 0 ] = w_ [ 1 ] = w_ [ 2 ] = _0_0 ; xa = _1_0 ; wZ ;".split(" ")}]},
{a:"node",c:"TEX_MAGIC",u:[],s:[{a:"node_in",c:"xb",h:["vec3"],g:!1},{a:"node_in",c:"xc",h:["float"],g:!1},{a:"node_in",c:"xd",h:["float"],g:!1},{a:"node_out",c:"xe",h:["vec3"],g:!1},{a:"node_out",c:"xf",h:["float"],g:!1}],m:[{a:"txt",b:"xe [ 0 ] = xe [ 1 ] = xe [ 2 ] = _0_0 ; xf = _1_0 ; xb ; xc ; xd ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",u:[],s:[{a:"node_in",c:"xg",h:["vec3"],g:!1},{a:"node_in",c:"xh",h:["vec3"],g:!1},{a:"node_in",c:"xi",h:["vec3"],g:!1},{a:"node_in",c:"xj",h:["float"],g:!1},
{a:"node_out",c:"xk",h:["vec3"],g:!1},{a:"node_out",c:"xl",h:["float"],g:!1}],m:[{a:"txt",b:"xk [ 0 ] = xk [ 1 ] = xk [ 2 ] = _0_0 ; xl = _1_0 ; xg ; xh ; xi ; xj ;".split(" ")}]},{a:"node",c:"TEX_BRICK",u:[],s:[{a:"node_in",c:"xm",h:["vec3"],g:!1},{a:"node_in",c:"xn",h:["vec3"],g:!1},{a:"node_in",c:"xo",h:["vec3"],g:!1},{a:"node_in",c:"xp",h:["vec3"],g:!1},{a:"node_in",c:"xq",h:["float"],g:!1},{a:"node_in",c:"xr",h:["float"],g:!1},{a:"node_in",c:"xs",h:["float"],g:!1},{a:"node_in",c:"xt",h:["float"],
g:!1},{a:"node_in",c:"xu",h:["float"],g:!1},{a:"node_out",c:"xv",h:["vec3"],g:!1},{a:"node_out",c:"xA",h:["float"],g:!1}],m:[{a:"txt",b:"xv [ 0 ] = xv [ 1 ] = xv [ 2 ] = _0_0 ; xA = _1_0 ; xm ; xn ; xo ; xp ; xq ; xr ; xs ; xt ; xu ;".split(" ")}]},{a:"node",c:"ADD_SHADER",u:[],s:[{a:"node_in",c:"xB",h:["vec3"],g:!1},{a:"node_in",c:"xC",h:["vec3"],g:!1},{a:"node_out",c:"xD",h:["vec3"],g:!1}],m:[{a:"txt",b:"xD = clamp ( xB + xC , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",
u:[],s:[{a:"node_in",c:"xE",h:["float"],g:!1},{a:"node_in",c:"xF",h:["vec3"],g:!1},{a:"node_in",c:"xG",h:["vec3"],g:!1},{a:"node_in",c:"xH",h:["vec3"],g:!1},{a:"node_in",c:"xI",h:["float"],g:!1},{a:"node_in",c:"xJ",h:["vec3"],g:!1},{a:"node_in",c:"xK",h:["float"],g:!1},{a:"node_in",c:"xL",h:["float"],g:!1},{a:"node_in",c:"xM",h:["vec3"],g:!1},{a:"node_in",c:"xN",h:["vec3"],g:!1},{a:"node_in",c:"xO",h:["float"],g:!1},{a:"node_in",c:"xP",h:["vec3"],g:!1},{a:"node_in",c:"xQ",h:["float"],g:!1},{a:"node_in",
c:"xR",h:["vec3"],g:!1},{a:"node_in",c:"xS",h:["float"],g:!1},{a:"node_in",c:"xT",h:["vec3"],g:!1},{a:"node_in",c:"xU",h:["float"],g:!1},{a:"node_in",c:"xV",h:["float"],g:!1},{a:"node_in",c:"xW",h:["vec3"],g:!1},{a:"node_in",c:"xX",h:["vec3"],g:!1},{a:"node_in",c:"xY",h:["float"],g:!1},{a:"node_in",c:"xZ",h:["vec3"],g:!1},{a:"node_in",c:"x_",h:["float"],g:!1},{a:"node_out",c:"ya",h:["vec3"],g:!1},{a:"node_out",c:"yb",h:["vec3"],g:!1},{a:"node_out",c:"yc",h:["float"],g:!1},{a:"node_out",c:"yd",h:["vec3"],
g:!1},{a:"node_out",c:"ye",h:["float"],g:!1},{a:"node_out",c:"yf",h:["float"],g:!1},{a:"node_out",c:"yg",h:["vec3"],g:!1},{a:"node_out",c:"yh",h:["vec3"],g:!1},{a:"node_out",c:"yi",h:["float"],g:!1},{a:"node_out",c:"yj",h:["vec3"],g:!1},{a:"node_out",c:"yk",h:["float"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( xE , _0_0 , _1_0 ) ; yb = mix ( xH , xR , yl ) ; yc = mix ( xI , xS , yl ) ; if ( xL > _0_0 ) { if ( xV > _0_0 ) { yd = mix ( xJ , xT , yl ) ; ye = mix ( xK , xU , yl ) ; } else { yd = xJ ; ye = xK ; } } else { yd = xT ; ye = xU ; } if ( xO > _0_0 ) { if ( xY > _0_0 ) { yh = mix ( xN , xX , yl ) ; } else { yh = xN ; } } else { yh = xX ; } yf = mix ( xL , xV , yl ) ; yg = mix ( xM , xW , yl ) ; yi = mix ( xO , xY , yl ) ; yj = mix ( xP , xZ , yl ) ; yk = mix ( xQ , x_ , yl ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",u:[],s:[{a:"node_out",c:"ym",h:["vec3"],g:!1},{a:"node_out",c:"yn",h:["vec3"],g:!1},{a:"node_param",c:"rd",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_ym"],m:[{a:"txt",b:"ym = qP ( rd ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yn"],m:[{a:"txt",b:"yn = vec3 ( rd , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",u:[],s:[{a:"node_out",c:"yo",h:["vec3"],g:!1},{a:"node_param",c:"re",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",
b:"yo = vec3 ( re , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",u:[],s:[{a:"node_out",c:"yp",h:["vec3"],g:!1}],m:[{a:"txt",b:["yp","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",u:[],s:[{a:"node_out",c:"yq",h:["vec3"],g:!1}],m:[{a:"txt",b:["yq","=","qL",";"]}]},{a:"node",c:"TEX_COORD_OB",u:[],s:[{a:"node_out",c:"yr",h:["vec3"],g:!1}],m:[{a:"txt",b:"yr = ad ( u_model_tsr_inverse , nG ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",u:[],s:[{a:"node_out",c:"ys",h:["vec3"],g:!1}],m:[{a:"txt",b:"ys . xy = rn . xy ; ys . z = _1_0 ;".split(" ")}]},
{a:"node",c:"TEX_COORD_WI",u:[],s:[{a:"node_out",c:"yt",h:["vec3"],g:!1}],m:[{a:"txt",b:"yt . xy = l . xy / l . z ; yt . z = _0_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",u:[],s:[{a:"node_out",c:"yu",h:["vec3"],g:!1}],m:[{a:"txt",b:"yu = reflect ( - nI , nH ) ;".split(" ")}]},{a:"node",c:"UVMAP",u:[],s:[{a:"node_out",c:"yv",h:["vec3"],g:!1},{a:"node_param",c:"rf",h:["GLSL_IN","vec2"],g:!1}],m:[{a:"txt",b:"yv = vec3 ( rf , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",u:[],s:[{a:"node_out",
c:"yA",h:["float"],g:!1},{a:"node_out",c:"yB",h:["float"],g:!1},{a:"node_out",c:"yC",h:["float"],g:!1},{a:"node_out",c:"yD",h:["vec3"],g:!1},{a:"node_out",c:"yE",h:["float"],g:!1},{a:"node_out",c:"yF",h:["vec3"],g:!1},{a:"node_out",c:"yG",h:["vec3"],g:!1}],m:[{a:"txt",b:"yA = _0_0 ; yB = _0_0 ; yC = _0_0 ; yD = vec3 ( _0_0 ) ; yE = _0_0 ; yF = yD ; yG = yD ;".split(" ")}]},{a:"node",c:"HAIR_INFO",u:[],s:[{a:"node_out",c:"yH",h:["float"],g:!1},{a:"node_out",c:"yI",h:["float"],g:!1},{a:"node_out",c:"yJ",
h:["float"],g:!1},{a:"node_out",c:"yK",h:["vec3"],g:!1}],m:[{a:"txt",b:"yH = _0_0 ; yI = _0_0 ; yJ = _0_0 ; yK = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",u:[{a:"node_var",c:"USE_LOCATION_OUT",b:["0"]},{a:"node_var",c:"USE_OBJ_IND_OUT",b:["0"]},{a:"node_var",c:"USE_MAT_IND_OUT",b:["0"]},{a:"node_var",c:"USE_RANDOM_OUT",b:["0"]}],s:[{a:"node_out",c:"yL",h:["vec3"],g:!1},{a:"node_out",c:"yM",h:["float"],g:!1},{a:"node_out",c:"yN",h:["float"],g:!1},{a:"node_out",c:"yO",h:["float"],g:!1}],
m:[{a:"node_cond",f:[{a:"node_if",i:["USE_LOCATION_OUT"],m:[{a:"txt",b:"yL = u_model_tsr [ 0 ] . xyz ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OBJ_IND_OUT"],m:[{a:"txt",b:"yM = u_obj_info . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MAT_IND_OUT"],m:[{a:"txt",b:"yN = u_obj_info . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_RANDOM_OUT"],m:[{a:"txt",b:"yO = u_obj_info . b ;".split(" ")}]}]}]},{a:"node",c:"WIREFRAME",u:[],s:[{a:"node_in",c:"yP",h:["float"],
g:!1},{a:"node_out",c:"yQ",h:["float"],g:!1}],m:[{a:"txt",b:["yQ","=","yP",";"]}]},{a:"node",c:"TANGENT",u:[],s:[{a:"node_out",c:"yR",h:["vec3"],g:!1}],m:[{a:"txt",b:"yR = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LAYER_WEIGHT",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"yS",h:["float"],g:!1},{a:"node_in",c:"yT",h:["vec3"],g:!1},{a:"node_out",c:"yU",h:["float"],g:!1},{a:"node_out",c:"yV",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:"vec3 bW = normalize ( yT ) ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 yW = normalize ( nI ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","yW","=","u_camera_direction",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yU"],m:[{a:"txt",b:"float qT = max ( _1_0 - yS , 0.00001 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"non_equal_expr",l:2}],m:[{a:"txt",
b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"yU = qV ( yW , bW , qT ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["yU","=","_0_0",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yV"],m:[{a:"txt",b:"yV = abs ( dot ( yW , bW ) ) ; float dI = yS ; if ( dI != _0_5 ) { dI = clamp ( dI , _0_0 , 0.99999 ) ; dI = ( dI < _0_5 ) ? 2.0 * dI : _0_5 / ( _1_0 - dI ) ; yV = pow ( yV , dI ) ; } yV = _1_0 - yV ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:["yV","=","_0_0",";"]}]}]}]},{a:"node",c:"LIGHT_PATH",u:[],s:[{a:"node_out",c:"yX",h:["float"],g:!1},{a:"node_out",c:"yY",h:["float"],g:!1},{a:"node_out",c:"yZ",h:["float"],g:!1},{a:"node_out",c:"y_",h:["float"],g:!1},{a:"node_out",c:"za",h:["float"],g:!1},{a:"node_out",c:"zb",h:["float"],g:!1},{a:"node_out",c:"zc",h:["float"],g:!1},{a:"node_out",c:"zd",h:["float"],g:!1},{a:"node_out",c:"ze",h:["float"],g:!1},{a:"node_out",c:"zf",h:["float"],g:!1},{a:"node_out",c:"zg",
h:["float"],g:!1}],m:[{a:"txt",b:"yX = yY = yZ = _0_0 ; y_ = za = zb = _0_0 ; zc = zg = ze = zf = _0_0 ; zd = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",u:[],s:[{a:"node_out",c:"zh",h:["vec3"],g:!1},{a:"node_out",c:"zi",h:["vec3"],g:!1},{a:"node_out",c:"zj",h:["float"],g:!1}],m:[{a:"txt",b:"zh = zi = vec3 ( _0_0 ) ; zj = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",u:[],s:[],m:[]},{a:"node",c:"CURVE_VEC",u:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",
b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zk",h:["float"],g:!1},{a:"node_in",c:"zl",h:["vec3"],g:!1},{a:"node_out",c:"zm",h:["vec3"],g:!1}],m:[{a:"txt",b:["zm","=","zl",";"]},{a:"node_cond",f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zm . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . r + _0_5 , NODE_TEX_ROW ) ) . r - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zm . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . g + _0_5 , NODE_TEX_ROW ) ) . g - _0_5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zm . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . b + _0_5 , NODE_TEX_ROW ) ) . b - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"zm = mix ( zl , zm , zk ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",u:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zn",h:["float"],g:!1},{a:"node_in",
c:"zo",h:["vec3"],g:!1},{a:"node_out",c:"zp",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["READ_A"],m:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float r = zo . r ; float g = zo . g ; float b = zo . b ;".split(" ")}]}]},{a:"node_cond",
f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zp . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zp . r = r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zp . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zp . g = g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zp . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"zp . b = b ;".split(" ")}]}]},{a:"txt",b:"zp = mix ( zo , zp , zn ) ;".split(" ")}]},{a:"node",c:"VALTORGB",u:[{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zq",h:["float"],g:!1},{a:"node_out",c:"zr",h:["vec3"],g:!1},{a:"node_out",c:"zs",h:["float"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zq , NODE_TEX_ROW ) ) ; zr = zt . rgb ; zs = zt . a ;".split(" ")}]},{a:"node",c:"MAPPING",u:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","_1_0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","_1_0",")"]},{a:"node_var",
c:"MAPPING_IS_NORMAL",b:["0"]}],s:[{a:"node_in",c:"zu",h:["vec3"],g:!1},{a:"node_out",c:"zv",h:["vec3"],g:!1}],m:[{a:"txt",b:["zv","=","zu",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_SCALE_DEF"],m:[{a:"txt",b:"zv = zv * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRANS_DEF"],m:[{a:"txt",b:"zv = zv + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRS_MATRIX_DEF"],m:[{a:"txt",b:"zv = ( MAPPING_TRS_MATRIX * vec4 ( zv , _1_0 ) ) . xyz ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MIN_CLIP_DEF"],m:[{a:"txt",b:"zv = max ( zv , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MAX_CLIP_DEF"],m:[{a:"txt",b:"zv = min ( zv , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_IS_NORMAL"],m:[{a:"txt",b:"zv = normalize ( zv ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zA",h:["float"],g:!1},{a:"node_in",c:"zB",h:["float"],
g:!1},{a:"node_out",c:"zC",h:["float"],g:!1}],m:[{a:"txt",b:"zC = zA + zB ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zC = clamp ( zC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zD",h:["float"],g:!1},{a:"node_in",c:"zE",h:["float"],g:!1},{a:"node_out",c:"zF",h:["float"],g:!1}],m:[{a:"txt",b:"zF = zD - zE ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",
b:"zF = clamp ( zF , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zG",h:["float"],g:!1},{a:"node_in",c:"zH",h:["float"],g:!1},{a:"node_out",c:"zI",h:["float"],g:!1}],m:[{a:"txt",b:"zI = zG * zH ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zI = clamp ( zI , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zJ",
h:["float"],g:!1},{a:"node_in",c:"zK",h:["float"],g:!1},{a:"node_out",c:"zL",h:["float"],g:!1}],m:[{a:"txt",b:"zL = ( zK != _0_0 ) ? zJ / zK : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zL = clamp ( zL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zM",h:["float"],g:!1},{a:"node_in",c:"zN",h:["float"],g:!1},{a:"node_out",c:"zO",h:["float"],g:!1}],m:[{a:"txt",b:"zO = sin ( zM ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zO = clamp ( zO , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zN",";"]}]},{a:"node",c:"MATH_COSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zP",h:["float"],g:!1},{a:"node_in",c:"zQ",h:["float"],g:!1},{a:"node_out",c:"zR",h:["float"],g:!1}],m:[{a:"txt",b:"zR = cos ( zP ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zR = clamp ( zR , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",
b:["zQ",";"]}]},{a:"node",c:"MATH_TANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zS",h:["float"],g:!1},{a:"node_in",c:"zT",h:["float"],g:!1},{a:"node_out",c:"zU",h:["float"],g:!1}],m:[{a:"txt",b:"zU = tan ( zS ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zU = clamp ( zU , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zT",";"]}]},{a:"node",c:"MATH_ARCSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zV",h:["float"],
g:!1},{a:"node_in",c:"zW",h:["float"],g:!1},{a:"node_out",c:"zX",h:["float"],g:!1}],m:[{a:"txt",b:"zX = ( zV <= _1_0 && zV >= - _1_0 ) ? asin ( zV ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zX = clamp ( zX , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zW",";"]}]},{a:"node",c:"MATH_ARCCOSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zY",h:["float"],g:!1},{a:"node_in",c:"zZ",h:["float"],g:!1},{a:"node_out",c:"z_",h:["float"],
g:!1}],m:[{a:"txt",b:"z_ = ( zY <= _1_0 && zY >= - _1_0 ) ? acos ( zY ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zZ",";"]}]},{a:"node",c:"MATH_ARCTANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Aa",h:["float"],g:!1},{a:"node_in",c:"Ab",h:["float"],g:!1},{a:"node_out",c:"Ac",h:["float"],g:!1}],m:[{a:"txt",b:"Ac = atan ( Aa ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ac = clamp ( Ac , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ab",";"]}]},{a:"node",c:"MATH_POWER",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ad",h:["float"],g:!1},{a:"node_in",c:"Ae",h:["float"],g:!1},{a:"node_out",c:"Af",h:["float"],g:!1}],m:[{a:"txt",b:"if ( Ad < _0_0 && Ae != floor ( Ae ) ) Af = _0_0 ; else if ( Ae == _0_0 ) Af = _1_0 ; else if ( Ad < _0_0 ) Af = mix ( _1_0 , - _1_0 , sign ( mod ( - Ae , 2.0 ) ) ) * pow ( - Ad , Ae ) ; else if ( Ad == _0_0 ) Af = _0_0 ; else Af = pow ( Ad , Ae ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Af = clamp ( Af , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ag",h:["float"],g:!1},{a:"node_in",c:"Ah",h:["float"],g:!1},{a:"node_out",c:"Ai",h:["float"],g:!1}],m:[{a:"txt",b:"Ai = ( Ag > _0_0 && Ah > _0_0 ) ? log2 ( Ag ) / log2 ( Ah ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ai = clamp ( Ai , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Aj",h:["float"],g:!1},{a:"node_in",c:"Ak",h:["float"],g:!1},{a:"node_out",c:"Al",h:["float"],g:!1}],m:[{a:"txt",b:"Al = min ( Aj , Ak ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Am",h:["float"],g:!1},{a:"node_in",c:"An",h:["float"],
g:!1},{a:"node_out",c:"Ao",h:["float"],g:!1}],m:[{a:"txt",b:"Ao = max ( Am , An ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ao = clamp ( Ao , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ap",h:["float"],g:!1},{a:"node_in",c:"Aq",h:["float"],g:!1},{a:"node_out",c:"Ar",h:["float"],g:!1}],m:[{a:"txt",b:"Ar = floor ( Ap + _0_5 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],
m:[{a:"txt",b:"Ar = clamp ( Ar , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Aq",";"]}]},{a:"node",c:"MATH_LESS_THAN",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"As",h:["float"],g:!1},{a:"node_in",c:"At",h:["float"],g:!1},{a:"node_out",c:"Au",h:["float"],g:!1}],m:[{a:"txt",b:"Au = ( As < At ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",u:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Av",h:["float"],g:!1},{a:"node_in",c:"Aw",h:["float"],g:!1},{a:"node_out",c:"Ax",h:["float"],g:!1}],m:[{a:"txt",b:"Ax = ( Av > Aw ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ax = clamp ( Ax , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ay",h:["float"],g:!1},{a:"node_in",c:"Az",h:["float"],g:!1},{a:"node_out",c:"AA",
h:["float"],g:!1}],m:[{a:"txt",b:"AA = abs ( Az ) > 0.000001 ? mod ( Ay , Az ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AA = clamp ( AA , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AB",h:["float"],g:!1},{a:"node_in",c:"AC",h:["float"],g:!1},{a:"node_out",c:"AD",h:["float"],g:!1}],m:[{a:"txt",b:"AD = abs ( AB ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],
m:[{a:"txt",b:"AD = clamp ( AD , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AC",";"]}]},{a:"node",c:"MIX_RGB_MIX",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AE",h:["float"],g:!1},{a:"node_in",c:"AF",h:["vec3"],g:!1},{a:"node_in",c:"AG",h:["vec3"],g:!1},{a:"node_out",c:"AH",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AE , _0_0 , _1_0 ) ; AH = mix ( AF , AG , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AH = clamp ( AH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AI",h:["float"],g:!1},{a:"node_in",c:"AJ",h:["vec3"],g:!1},{a:"node_in",c:"AK",h:["vec3"],g:!1},{a:"node_out",c:"AL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AI , _0_0 , _1_0 ) ; AL = mix ( AJ , AJ + AK , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AL = clamp ( AL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",u:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AM",h:["float"],g:!1},{a:"node_in",c:"AN",h:["vec3"],g:!1},{a:"node_in",c:"AO",h:["vec3"],g:!1},{a:"node_out",c:"AP",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AM , _0_0 , _1_0 ) ; AP = mix ( AN , AN * AO , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",
c:"AQ",h:["float"],g:!1},{a:"node_in",c:"AR",h:["vec3"],g:!1},{a:"node_in",c:"AS",h:["vec3"],g:!1},{a:"node_out",c:"AT",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AQ , _0_0 , _1_0 ) ; AT = mix ( AR , AR - AS , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AT = clamp ( AT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AU",h:["float"],g:!1},{a:"node_in",c:"AV",
h:["vec3"],g:!1},{a:"node_in",c:"AW",h:["vec3"],g:!1},{a:"node_out",c:"AX",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AU , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; AX = vec3 ( _1_0 ) - ( vec3 ( AY ) + yl * ( vec3 ( _1_0 ) - AW ) ) * ( vec3 ( _1_0 ) - AV ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AX = clamp ( AX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AZ",
h:["float"],g:!1},{a:"node_in",c:"A_",h:["vec3"],g:!1},{a:"node_in",c:"Ba",h:["vec3"],g:!1},{a:"node_out",c:"Bb",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AZ , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; Ba += step ( Ba , vec3 ( _0_0 ) ) ; Bb = AY * A_ + yl * A_ / Ba ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bb = clamp ( Bb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",
c:"Bc",h:["float"],g:!1},{a:"node_in",c:"Bd",h:["vec3"],g:!1},{a:"node_in",c:"Be",h:["vec3"],g:!1},{a:"node_out",c:"Bf",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bc , _0_0 , _1_0 ) ; Bf = mix ( Bd , abs ( Bd - Be ) , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bf = clamp ( Bf , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bg",h:["float"],g:!1},{a:"node_in",
c:"Bh",h:["vec3"],g:!1},{a:"node_in",c:"Bi",h:["vec3"],g:!1},{a:"node_out",c:"Bj",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bg , _0_0 , _1_0 ) ; Bj = min ( Bh . rgb , Bi . rgb * yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bj = clamp ( Bj , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bk",h:["float"],g:!1},{a:"node_in",c:"Bl",h:["vec3"],g:!1},{a:"node_in",
c:"Bm",h:["vec3"],g:!1},{a:"node_out",c:"Bn",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bk , _0_0 , _1_0 ) ; Bn = max ( Bl . rgb , Bm . rgb * yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bn = clamp ( Bn , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bo",h:["float"],g:!1},{a:"node_in",c:"Bp",h:["vec3"],g:!1},{a:"node_in",c:"Bq",h:["vec3"],g:!1},{a:"node_out",
c:"Br",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bo , _0_0 , _1_0 ) ; vec3 Bs = vec3 ( _1_0 - yl ) ; Br = mix ( Bp * ( Bs + 2.0 * yl * Bq ) , vec3 ( _1_0 ) - ( Bs + 2.0 * yl * ( vec3 ( _1_0 ) - Bq ) ) * ( vec3 ( _1_0 ) - Bp ) , step ( _0_5 , Bp ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Br = clamp ( Br , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bt",h:["float"],
g:!1},{a:"node_in",c:"Bu",h:["vec3"],g:!1},{a:"node_in",c:"Bv",h:["vec3"],g:!1},{a:"node_out",c:"Bw",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bt , _0_0 , _1_0 ) ; vec3 Bx = vec3 ( _1_0 ) - yl * Bv ; vec3 By = clamp ( Bu / Bx , _0_0 , _1_0 ) ; Bw = mix ( mix ( By , vec3 ( _1_0 ) , step ( Bx , vec3 ( _0_0 ) ) ) , Bu , step ( Bu , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bw = clamp ( Bw , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bz",h:["float"],g:!1},{a:"node_in",c:"BA",h:["vec3"],g:!1},{a:"node_in",c:"BB",h:["vec3"],g:!1},{a:"node_out",c:"BC",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bz , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - yl ) ; vec3 Bx = jH + yl * BB ; vec3 By = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - BA ) / Bx , _0_0 , _1_0 ) ; BC = mix ( By , vec3 ( _0_0 ) , step ( Bx , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BC = clamp ( BC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BD",h:["float"],g:!1},{a:"node_in",c:"BE",h:["vec3"],g:!1},{a:"node_in",c:"BF",h:["vec3"],g:!1},{a:"node_out",c:"BG",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BD , _0_0 , _1_0 ) ; vec3 jz , BH , Bx ; BG = BE ; BH = jy ( BF ) ; if ( BH . y != _0_0 ) { jz = jy ( BG ) ; jz . x = BH . x ; Bx = jA ( jz ) ; BG = mix ( BG , Bx , yl ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BG = clamp ( BG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BI",h:["float"],g:!1},{a:"node_in",c:"BJ",h:["vec3"],g:!1},{a:"node_in",c:"BK",h:["vec3"],g:!1},{a:"node_out",c:"BL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BI , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; BL = BJ ; vec3 jz , BH ; jz = jy ( BL ) ; if ( jz . y != _0_0 ) { BH = jy ( BK ) ; jz . y = AY * jz . y + yl * BH . y ; BL = jA ( jz ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BL = clamp ( BL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BM",h:["float"],g:!1},{a:"node_in",c:"BN",h:["vec3"],g:!1},{a:"node_in",c:"BO",h:["vec3"],g:!1},{a:"node_out",c:"BP",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BM , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; vec3 jz , BH ; jz = jy ( BN ) ; BH = jy ( BO ) ; jz . z = AY * jz . z + yl * BH . z ; BP = jA ( jz ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BP = clamp ( BP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BQ",h:["float"],g:!1},{a:"node_in",c:"BR",h:["vec3"],g:!1},{a:"node_in",c:"BS",h:["vec3"],g:!1},{a:"node_out",c:"BT",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BQ , _0_0 , _1_0 ) ; vec3 jz , BH , Bx ; BT = BR ; BH = jy ( BS ) ; if ( BH . y != _0_0 ) { jz = jy ( BT ) ; jz . x = BH . x ; jz . y = BH . y ; Bx = jA ( jz ) ; BT = mix ( BT , Bx , yl ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BT = clamp ( BT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BU",h:["float"],g:!1},{a:"node_in",c:"BV",h:["vec3"],g:!1},{a:"node_in",c:"BW",h:["vec3"],g:!1},{a:"node_out",c:"BX",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BU , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; vec3 BY = BW + BV - BW * BV ; BX = BV * ( vec3 ( AY ) + vec3 ( yl ) * ( ( vec3 ( _1_0 ) - BV ) * BW + BY ) ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BX = clamp ( BX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BZ",h:["float"],g:!1},{a:"node_in",c:"B_",h:["vec3"],g:!1},{a:"node_in",c:"Ca",h:["vec3"],g:!1},{a:"node_out",c:"Cb",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BZ , _0_0 , _1_0 ) ; Cb = B_ + yl * ( 2.0 * Ca - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Cb = clamp ( Cb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",u:[],s:[{a:"node_in",c:"Cc",h:["vec3"],g:!1},{a:"node_in",c:"Cd",h:["float"],g:!1}],m:[{a:"txt",b:"D = Cc ; H = Cd ;".split(" ")}]},{a:"node",c:"OUTPUT_SURFACE",u:[],s:[{a:"node_in",c:"Ce",h:["vec3"],g:!1}],m:[{a:"txt",b:"D = Ce ; H = _1_0 ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",
c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],s:[{a:"node_in",c:"Cf",h:["vec3"],g:!1},{a:"node_in",c:"Cg",h:["vec3"],g:!1},{a:"node_in",c:"Ch",h:["float"],g:!1},{a:"node_in",c:"Ci",h:["vec3"],g:!0},{a:"node_in",c:"Cj",h:["float"],g:!0},{a:"node_out",c:"Ck",h:["vec3"],g:!1},{a:"node_out",c:"Cl",h:["vec3"],g:!1},{a:"node_out",c:"Cm",h:["vec3"],g:!1},{a:"node_out",c:"Cn",h:["vec3"],g:!1},{a:"node_out",c:"Co",h:["vec3"],g:!1},{a:"node_out",c:"Cp",h:["vec2"],g:!1},{a:"node_out",
c:"Cq",h:["vec2"],g:!1},{a:"node_out",c:"Cr",h:["vec4"],g:!1},{a:"node_param",c:"rh",h:["const","vec2"],g:!1},{a:"node_param",c:"ri",h:["const","vec3"],g:!1}],m:[{a:"txt",b:"Cm = clamp ( Cf , _0_0 , _1_0 ) ; Cn = ri [ 0 ] * clamp ( Cg , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_NORMAL"],m:[{a:"txt",b:"Co = normalize ( Ci ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["Co","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["SHADELESS_MAT",{a:"logic_negative_expr",
l:1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"txt",b:"Ck = Cj * Cm ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Ck = ro * Cm ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:["Cm","*=","Ch",";"]}]}]},{a:"txt",b:"Cl = rp * u_environment_energy * ce ( Co ) ; Cr = ch ( Cm ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],m:[{a:"txt",b:"Cp = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; Cq = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","Cr",";"]}]},{a:"node_else",m:[{a:"txt",b:"Ck = vec3 ( _0_0 ) ; Cl = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],s:[{a:"node_in",c:"Cs",h:["vec4"],g:!1},{a:"node_in",c:"Ct",h:["vec3"],g:!1},{a:"node_in",c:"Cu",h:["vec3"],g:!1},{a:"node_in",c:"Cv",h:["float"],g:!0},{a:"node_in",c:"Cw",h:["float"],g:!0},{a:"node_in",c:"Cx",
h:["float"],g:!0},{a:"node_out",c:"Cy",h:["vec3"],g:!0},{a:"node_out",c:"Cz",h:["float"],g:!0},{a:"node_out",c:"CA",h:["vec3"],g:!0},{a:"node_out",c:"CB",h:["vec3"],g:!0},{a:"node_out",c:"CC",h:["vec3"],g:!0},{a:"node_param",c:"rj",h:["float"],g:!1},{a:"node_param",c:"rk",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cy"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:"Cy = Cs . rgb ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Cy = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",l:2},{a:"logical_and_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"cq ( Cy , nI , Cu , Cv , u_view_tsr_frag ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"cq ( Cy , nI , Cu , Cv , mat3 ( _0_0 ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["Cy","+=","Ct",";"]}]}]}]}]},{a:"node_cond",
f:[{a:"node_if",i:["USE_OUT_CA"],m:[{a:"txt",b:["CA","=","Cu",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CB"],m:[{a:"txt",b:"CB = Cs . rgb ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CC"],m:[{a:"txt",b:["CC","=","Ct",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cz"],m:[{a:"txt",b:"Cz = clamp ( Cx , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( Ct . r , Ct . g ) , Ct . b ) * Cw ; Cz = clamp ( Cx * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cz"],m:[{a:"txt",b:"Cz = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( Ct . r , Ct . g ) , Ct . b ) * rk ; Cz = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["E","=","Ct",";"]}]},{a:"node_else",m:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","Cu",
";"]}]},{a:"node",c:"LIGHTING_AMBIENT",u:[],s:[{a:"node_in",c:"nZ",h:["vec3"],g:!1},{a:"node_in",c:"n_",h:["vec3"],g:!1},{a:"node_in",c:"oa",h:["vec3"],g:!1},{a:"node_out",c:"ob",h:["vec4"],g:!1},{a:"node_out",c:"oc",h:["vec3"],g:!1}],m:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"LIGHTING_LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",
b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]}],s:[{a:"node_in",c:"od",h:["vec4"],g:!1},{a:"node_out",c:"oe",h:["vec3"],g:!1},{a:"node_out",c:"of",h:["vec2"],g:!1},{a:"node_out",c:"og",h:["vec3"],g:!1},{a:"node_out",c:"oh",h:["float"],g:!1}],m:[{a:"txt",b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
i:["LAMP_TYPE","HEMI",{a:"equal_expr",l:2}],m:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",m:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",
l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"og *= max ( LAMP_LIGHT_DIST - aC , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]},{a:"node_else",m:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"om",h:["vec3"],g:!1},{a:"node_in",c:"on",h:["vec2"],g:!1},{a:"node_in",c:"oo",h:["vec3"],g:!1},{a:"node_in",c:"op",h:["float"],g:!1},{a:"node_in",c:"oq",h:["vec2"],
g:!1},{a:"node_out",c:"or",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","qS","=","oo",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( om , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( qS , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_LAMBERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ou",h:["vec3"],g:!1},{a:"node_in",c:"ov",h:["vec2"],g:!1},{a:"node_in",c:"ow",h:["vec3"],g:!1},{a:"node_in",c:"ox",h:["float"],g:!1},{a:"node_out",c:"oy",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","qS","=","ow",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( ou , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",
b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( qS , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oz",h:["vec3"],g:!1},{a:"node_in",c:"oA",h:["vec2"],g:!1},{a:"node_in",c:"oB",h:["vec3"],g:!1},{a:"node_in",c:"oC",h:["float"],g:!1},{a:"node_in",c:"oD",h:["vec2"],g:!1},{a:"node_out",c:"oE",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","qS","=","oB",";"]},{a:"node_cond",
f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oz , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( qS , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oO",h:["vec3"],g:!1},{a:"node_in",c:"oP",h:["vec2"],g:!1},{a:"node_in",c:"oQ",h:["vec3"],g:!1},{a:"node_in",c:"oR",h:["float"],g:!1},{a:"node_in",c:"oS",h:["vec2"],g:!1},{a:"node_out",c:"oT",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","qS","=","oQ",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oO , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},
{a:"txt",b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( qS , oO ) + oR ; float oF = max ( dot ( qS , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oU",h:["vec3"],g:!1},{a:"node_in",c:"oV",h:["vec2"],g:!1},{a:"node_in",c:"oW",h:["vec3"],
g:!1},{a:"node_in",c:"oX",h:["float"],g:!1},{a:"node_in",c:"oY",h:["vec2"],g:!1},{a:"node_out",c:"oZ",h:["float"],g:!1}],m:[{a:"txt",b:["vec3","qS","=","oW",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oU , B . xyz ) ; qS = cross ( os , B . xyz ) ; qS = - normalize ( qS ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( qS , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pa",h:["vec3"],g:!1},{a:"node_in",c:"pb",h:["vec2"],g:!1},{a:"node_in",c:"pc",h:["vec3"],g:!1},{a:"node_in",c:"pd",h:["float"],g:!1},{a:"node_in",c:"pe",h:["vec2"],g:!1},{a:"node_out",c:"pf",h:["float"],g:!1}],m:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( B . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ph",h:["vec3"],g:!1},{a:"node_in",c:"pi",h:["vec2"],g:!1},{a:"node_in",c:"pj",h:["vec3"],g:!1},{a:"node_in",c:"pk",h:["float"],g:!1},{a:"node_in",c:"pl",h:["vec2"],g:!1},{a:"node_out",c:"pm",h:["float"],g:!1}],m:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pn",h:["vec3"],g:!1},{a:"node_in",c:"po",h:["vec2"],g:!1},{a:"node_in",c:"pr",h:["vec3"],g:!1},{a:"node_in",c:"pu",h:["float"],g:!1},{a:"node_in",c:"pv",h:["vec2"],g:!1},{a:"node_out",c:"pw",h:["float"],g:!1}],m:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( B . xyz , pg ) ; oF = dot ( B . xyz , nI ) ; py = dot ( B . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pz",h:["vec3"],g:!1},{a:"node_in",c:"pA",h:["vec2"],g:!1},{a:"node_in",c:"pB",h:["vec3"],g:!1},{a:"node_in",c:"pC",h:["float"],g:!1},{a:"node_in",c:"pD",h:["vec2"],g:!1},{a:"node_out",c:"pE",h:["float"],
g:!1}],m:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float pF = dot ( bO , B . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pG",h:["vec3"],g:!1},{a:"node_in",c:"pH",h:["vec2"],g:!1},{a:"node_in",c:"pI",h:["vec3"],g:!1},{a:"node_in",c:"pJ",h:["float"],g:!1},{a:"node_in",c:"pK",h:["vec2"],g:!1},{a:"node_out",c:"pL",h:["float"],g:!1}],m:[{a:"txt",b:"float pM = pK [ 0 ] ; float pN = pK [ 1 ] ; pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pM < _1_0 || pN == _0_0 ) pL = _0_0 ; else { if ( pN < 100.0 ) pN = sqrt ( _1_0 / pN ) ; else pN = 10.0 / pN ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = _0_0 ; if ( pJ == _0_0 ) { float pO = dot ( B . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pM , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pN , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",u:[],s:[{a:"node_in",c:"pQ",h:["vec4"],g:!1},{a:"node_in",c:"pR",h:["vec3"],g:!1},{a:"node_in",c:"pS",h:["float"],g:!1},{a:"node_in",c:"pT",h:["float"],g:!1},{a:"node_in",c:"pU",h:["vec3"],g:!1},{a:"node_in",c:"pV",h:["vec3"],g:!1},{a:"node_in",c:"pW",h:["vec4"],g:!1},{a:"node_in",c:"pX",h:["vec3"],g:!1},{a:"node_in",c:"pY",h:["vec3"],g:!1},{a:"node_in",c:"pZ",h:["vec3"],g:!1},{a:"node_in",c:"p_",h:["float"],g:!1},{a:"node_out",c:"qa",h:["vec4"],g:!1},{a:"node_out",c:"qb",
h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_B4W_TRANSLUCENCY"],m:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float CD = pW . x ; float CE = pW . y ; float CF = pW . z ; float CG = pW . w ; float CH = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float CI = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float CJ = pow ( CI , CE ) ; qa = pQ + p_ * vec4 ( pZ * CH * pow ( pX , vec3 ( CD ) ) , _1_0 ) ; qa += CF * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , CG ) * p_ * vec4 ( pZ * CH * vec3 ( CJ ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",u:[{a:"node_var",c:"RGB_IND",b:["0"]}],s:[{a:"node_out",c:"CK",h:["vec3"],g:!1}],m:[{a:"txt",b:"CK = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",u:[],s:[{a:"node_in",c:"CL",h:["vec3"],g:!1},{a:"node_out",c:"CM",h:["float"],g:!1}],m:[{a:"txt",b:"CM = dot ( CL , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",u:[],s:[{a:"node_in",c:"CN",
h:["vec3"],g:!1},{a:"node_out",c:"CO",h:["float"],g:!0},{a:"node_out",c:"CP",h:["float"],g:!0},{a:"node_out",c:"CQ",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CO"],m:[{a:"txt",b:"CO = CN . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CP"],m:[{a:"txt",b:"CP = CN . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CQ"],m:[{a:"txt",b:"CQ = CN . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",u:[],s:[{a:"node_in",c:"CR",h:["vec3"],g:!1},{a:"node_out",
c:"CS",h:["float"],g:!0},{a:"node_out",c:"CT",h:["float"],g:!0},{a:"node_out",c:"CU",h:["float"],g:!0}],m:[{a:"txt",b:"vec3 CV = jy ( CR ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CS"],m:[{a:"txt",b:"CS = CV . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CT"],m:[{a:"txt",b:"CT = CV . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CU"],m:[{a:"txt",b:"CU = CV . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",u:[],s:[{a:"node_in",c:"CW",h:["float"],g:!1},
{a:"node_in",c:"CX",h:["float"],g:!1},{a:"node_in",c:"CY",h:["float"],g:!1},{a:"node_out",c:"CZ",h:["float"],g:!1}],m:[{a:"txt",b:"CZ = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( CW - CY ) * CX ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",u:[],s:[{a:"node_in",c:"C_",h:["vec3"],g:!1},{a:"node_in",c:"Da",h:["float"],g:!1},{a:"node_out",c:"Db",h:["vec3"],g:!1}],m:[{a:"txt",b:"Db = C_ ; if ( Db . x > _0_0 ) Db . x = pow ( C_ . x , Da ) ; if ( Db . y > _0_0 ) Db . y = pow ( C_ . y , Da ) ; if ( Db . z > _0_0 ) Db . z = pow ( C_ . z , Da ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",u:[],s:[{a:"node_in",c:"Dc",h:["vec3"],g:!1},{a:"node_out",c:"Dd",h:["vec3"],g:!1}],m:[{a:"txt",b:"Dd = max ( vec3 ( _0_0 ) , Dc ) ; Dd = pow ( Dd , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",u:[],s:[{a:"node_in",c:"De",h:["vec3"],g:!1},{a:"node_out",c:"Df",h:["vec3"],g:!1}],m:[{a:"txt",b:"Df = max ( vec3 ( _0_0 ) , De ) ; Df = pow ( Df , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",u:[],s:[{a:"node_out",c:"Dg",h:["vec3"],
g:!1},{a:"node_out",c:"Dh",h:["vec3"],g:!1},{a:"node_out",c:"Di",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dg"],m:[{a:"txt",b:"Dg [ 2 ] = Dg [ 1 ] = Dg [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dh"],m:[{a:"txt",b:"Dh [ 2 ] = Dh [ 1 ] = Dh [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Di"],m:[{a:"txt",b:["Di","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",u:[],s:[{a:"node_in",c:"Dj",h:["vec3"],g:!1},{a:"node_out",
c:"Dk",h:["vec3"],g:!0},{a:"node_out",c:"Dl",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",h:["uniform","samplerCube"],g:!1}],m:[{a:"txt",b:"vec3 Dm = vec3 ( Dj . x , Dj . y , Dj . z ) ; vec4 zt = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , Dm ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dk"],m:[{a:"txt",b:"Dk = zt . xyz ; bY ( Dk ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dl"],m:[{a:"txt",b:"Dl = zt . w ;".split(" ")}]}]}]},
{a:"node",c:"TEXTURE_COLOR",u:[{a:"node_var",c:"NON_COLOR",b:["0"]},{a:"node_var",c:"CONVERT_UV",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"Dn",h:["vec3"],g:!0},{a:"node_in",c:"Do",h:["vec3"],g:!0},{a:"node_in",c:"Dp",h:["vec3"],g:!0},{a:"node_in",c:"Dq",h:["vec3"],g:!0},{a:"node_out",c:"Dr",h:["vec3"],g:!0},{a:"node_out",c:"Ds",h:["float"],g:!0},{a:"node_out",c:"Dt",h:["vec3"],g:!0},{a:"node_out",c:"Du",h:["float"],
g:!0},{a:"node_out",c:"Dv",h:["vec3"],g:!0},{a:"node_out",c:"Dw",h:["float"],g:!0},{a:"node_out",c:"Dx",h:["vec3"],g:!0},{a:"node_out",c:"Dy",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_UV"],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dn ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , Dn . xy ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dr"],m:[{a:"txt",b:"Dr = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dr",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ds"],m:[{a:"txt",b:"Ds = zt . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_UV"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Do ) ) ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , Do . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dt"],m:[{a:"txt",b:"Dt = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dt",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Du"],m:[{a:"txt",b:"Du = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],m:[{a:"node_cond",f:[{a:"node_if",
i:["CONVERT_UV"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dp ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , Dp . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dv"],m:[{a:"txt",b:"Dv = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dv",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dw"],m:[{a:"txt",
b:"Dw = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_UV"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dq ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , Dq . xy ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dx"],m:[{a:"txt",b:"Dx = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",
l:1}],m:[{a:"txt",b:["bY","(","Dx",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dy"],m:[{a:"txt",b:"Dy = zt . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",u:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"Dz",h:["vec3"],g:!0},{a:"node_in",c:"DA",h:["vec3"],g:!0},{a:"node_in",c:"DB",h:["vec3"],g:!0},{a:"node_in",c:"DC",h:["vec3"],g:!0},{a:"node_out",c:"DD",h:["vec3"],g:!0},{a:"node_out",c:"DE",
h:["float"],g:!0},{a:"node_out",c:"DF",h:["vec3"],g:!0},{a:"node_out",c:"DG",h:["float"],g:!0},{a:"node_out",c:"DH",h:["vec3"],g:!0},{a:"node_out",c:"DI",h:["float"],g:!0},{a:"node_out",c:"DJ",h:["vec3"],g:!0},{a:"node_out",c:"DK",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_NORMAL_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( Dz ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DD"],m:[{a:"txt",b:"DD = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DE"],m:[{a:"txt",b:"DE = zt . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DA ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DF"],m:[{a:"txt",b:"DF = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DG"],m:[{a:"txt",b:"DG = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],
m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DB ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DH"],m:[{a:"txt",b:"DH = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DI"],m:[{a:"txt",b:"DI = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DC ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DJ"],
m:[{a:"txt",b:"DJ = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DK"],m:[{a:"txt",b:"DK = zt . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",u:[{a:"node_var",c:"VALUE_IND",b:["0"]}],s:[{a:"node_out",c:"DL",h:["float"],g:!1}],m:[{a:"txt",b:"DL = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",u:[],s:[{a:"node_in",c:"DM",h:["vec3"],g:!1},{a:"node_in",c:"DN",h:["vec3"],g:!1},{a:"node_out",c:"DO",h:["vec3"],g:!1},{a:"node_out",
c:"DP",h:["float"],g:!0}],m:[{a:"txt",b:"DO = DM + DN ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DP"],m:[{a:"txt",b:"DP = ( abs ( DO [ 0 ] ) + abs ( DO [ 1 ] ) + abs ( DO [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_SUBTRACT",u:[],s:[{a:"node_in",c:"DQ",h:["vec3"],g:!1},{a:"node_in",c:"DR",h:["vec3"],g:!1},{a:"node_out",c:"DS",h:["vec3"],g:!1},{a:"node_out",c:"DT",h:["float"],g:!0}],m:[{a:"txt",b:"DS = DQ - DR ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DT"],
m:[{a:"txt",b:"DT = ( abs ( DS [ 0 ] ) + abs ( DS [ 1 ] ) + abs ( DS [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",u:[],s:[{a:"node_in",c:"DU",h:["vec3"],g:!1},{a:"node_in",c:"DV",h:["vec3"],g:!1},{a:"node_out",c:"DW",h:["vec3"],g:!1},{a:"node_out",c:"DX",h:["float"],g:!0}],m:[{a:"txt",b:"DW = DU + DV ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DX"],m:[{a:"txt",b:"DX = length ( DW ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DW"],m:[{a:"txt",
b:"DW = normalize ( DW ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",u:[],s:[{a:"node_in",c:"DY",h:["vec3"],g:!1},{a:"node_in",c:"DZ",h:["vec3"],g:!1},{a:"node_out",c:"D_",h:["vec3"],g:!1},{a:"node_out",c:"Ea",h:["float"],g:!0}],m:[{a:"txt",b:"D_ = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ea"],m:[{a:"txt",b:"Ea = dot ( DY , DZ ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",u:[],s:[{a:"node_in",c:"Eb",h:["vec3"],g:!1},{a:"node_in",c:"Ec",h:["vec3"],
g:!1},{a:"node_out",c:"Ed",h:["vec3"],g:!1},{a:"node_out",c:"Ee",h:["float"],g:!0}],m:[{a:"txt",b:"Ed = cross ( Eb , Ec ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ee"],m:[{a:"txt",b:"Ee = length ( Ed ) ; Ed /= Ee ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Ed = normalize ( Ed ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_NORMALIZE",u:[],s:[{a:"node_in",c:"Ef",h:["vec3"],g:!1},{a:"node_in",c:"Eg",h:["vec3"],g:!1},{a:"node_out",c:"Eh",h:["vec3"],g:!1},{a:"node_out",c:"Ei",h:["float"],
g:!0}],m:[{a:"txt",b:"Eh = normalize ( Ef ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ei"],m:[{a:"txt",b:"Ei = length ( Ef ) ;".split(" ")}]}]},{a:"txt",b:["Eg",";"]}]},{a:"node",c:"FRESNEL",u:[{a:"node_var",c:"USE_FRESNEL_NORMAL",b:["0"]}],s:[{a:"node_in",c:"Ej",h:["float"],g:!1},{a:"node_in",c:"Ek",h:["vec3"],g:!1},{a:"node_out",c:"El",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_FRESNEL_NORMAL"],m:[{a:"txt",b:"vec3 bW = normalize ( Ek ) ;".split(" ")}]},{a:"node_else",
m:[{a:"txt",b:["vec3","bW","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["CAMERA_TYPE","CAM_TYPE_PERSP",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 yW = normalize ( nI ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","yW","=","u_camera_direction",";"]}]}]},{a:"txt",b:"float qT = max ( Ej , 0.00001 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"qT = gl_FrontFacing == false ? qT : _1_0 / qT ;".split(" ")}]},{a:"node_else",
m:[{a:"txt",b:"qT = gl_FrontFacing ? qT : _1_0 / qT ;".split(" ")}]}]},{a:"txt",b:"El = qV ( yW , bW , qT ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT",u:[],s:[{a:"node_in",c:"Em",h:["vec3"],g:!1},{a:"node_in",c:"En",h:["vec3"],g:!1},{a:"node_out",c:"Eo",h:["vec3"],g:!1}],m:[{a:"txt",b:"Eo = reflect ( T ( u_view_tsr_inverse , Em ) , En ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",u:[],s:[{a:"node_in",c:"Ep",h:["vec3"],g:!1},{a:"node_out",c:"Eq",h:["vec3"],g:!1}],m:[{a:"txt",b:"Eq = reflect ( - nI . xyz , Ep ) ;".split(" ")}]},
{a:"node",c:"B4W_PARALLAX",u:[],s:[{a:"node_in",c:"Er",h:["vec3"],g:!1},{a:"node_in",c:"Es",h:["float"],g:!1},{a:"node_in",c:"Et",h:["const","float"],g:!1},{a:"node_in",c:"Eu",h:["const","float"],g:!1},{a:"node_out",c:"Ev",h:["vec3"],g:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < Eu ) { vec2 bE = qQ ( Er ) ; float bI = clamp ( _0_5 * ( Eu - bp ) , _0_0 , _1_0 ) ; float hk = Es * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / Et ; vec2 bM = bK . xy * hk / ( Et * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = _1_0 ; bQ <= Et ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; Ev = qP ( bE ) ; } else Ev = Er ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",u:[],s:[{a:"node_in",c:"Ew",h:["vec3"],g:!1},{a:"node_out",c:"Ex",h:["vec3"],g:!1}],m:[{a:"txt",b:"Ex = clamp ( Ew , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",u:[],s:[{a:"node_in",c:"Ey",h:["vec3"],g:!1},{a:"node_in",c:"Ez",h:["float"],g:!1},{a:"node_out",c:"EA",h:["vec3"],g:!1}],m:[{a:"txt",b:"EA = qO ( Ey , Ez ) ;".split(" ")}]},{a:"node",c:"B4W_TRANSLUCENCY",u:[],s:[{a:"node_in",c:"EB",h:["float"],g:!1},{a:"node_in",c:"EC",h:["float"],g:!1},{a:"node_in",
c:"ED",h:["float"],g:!1},{a:"node_in",c:"EE",h:["float"],g:!1},{a:"node_in",c:"EF",h:["float"],g:!1},{a:"node_out",c:"EG",h:["float"],g:!0},{a:"node_out",c:"EH",h:["vec4"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EG"],m:[{a:"txt",b:["EG","=","EB",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EH"],m:[{a:"txt",b:"EH = vec4 ( EC , ED , EE , EF ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",u:[],s:[{a:"node_out",c:"EI",h:["float"],g:!1}],m:[{a:"txt",b:["EI","=","u_time",";"]}]},{a:"node",
c:"B4W_SMOOTHSTEP",u:[],s:[{a:"node_in",c:"EJ",h:["float"],g:!1},{a:"node_in",c:"EK",h:["float"],g:!1},{a:"node_in",c:"EL",h:["float"],g:!1},{a:"node_out",c:"EM",h:["float"],g:!1}],m:[{a:"txt",b:"EM = smoothstep ( EK , EL , EJ ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",u:[],s:[{a:"node_in",c:"EN",h:["vec3"],g:!1},{a:"node_in",c:"EO",h:["float"],g:!1}],m:[{a:"txt",b:"D = EN ; H = EO ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",u:[],s:[{a:"node_in",c:"EP",h:["vec3"],g:!1},{a:"node_out",c:"EQ",
h:["float"],g:!1}],m:[{a:"txt",b:"EQ = ( EP . r + EP . g + EP . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",u:[],s:[{a:"node_in",c:"ER",h:["float"],g:!1},{a:"node_out",c:"ES",h:["vec3"],g:!1}],m:[{a:"txt",b:"ES [ 0 ] = ER ; ES [ 1 ] = ER ; ES [ 2 ] = ER ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:11}],j:{a:"grp",f:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING"],j:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_NO"],j:{a:"grp",f:[{a:"txt",b:["vec3","rl",
"=","bF",";"]}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"NODES_GLSLV",j:{a:"grp",f:[{a:"define",c:"NODES_GLSLV",
b:[""]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2},"PARTICLE_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 qL ;".split(" ")}]}}]},{a:"node",c:"TEX_COORD_UV",u:[],s:[{a:"node_param",c:"node_TEX_COORD_UV_var_a_uv",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"re",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["re","=","node_TEX_COORD_UV_var_a_uv",
";"]}]},{a:"node",c:"UV_MERGED",u:[],s:[{a:"node_param",c:"node_UV_MERGED_var_a_uv",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"rd",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["rd","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",c:"UVMAP",u:[],s:[{a:"node_param",c:"node_UVMAP_var_a_uv",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"rf",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["rf","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[{a:"node_param",c:"node_GEOMETRY_UV_var_a_uv",
h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"qW",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["qW","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",c:"GEOMETRY_VC",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC_var_a_vertex_color",h:["GLSL_IN","vec3"],g:!1},{a:"node_param",c:"ET",h:["GLSL_OUT","vec3"],g:!1}],m:[{a:"txt",b:["ET","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC1",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC1_var_a_vertex_color",h:["GLSL_IN","float"],g:!1},{a:"node_param",
c:"EU",h:["GLSL_OUT","float"],g:!1}],m:[{a:"txt",b:["EU","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC2",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC2_var_a_vertex_color",h:["GLSL_IN","vec2"],g:!1},{a:"node_param",c:"EV",h:["GLSL_OUT","vec2"],g:!1}],m:[{a:"txt",b:["EV","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",c:"GEOMETRY_VC3",u:[],s:[{a:"node_param",c:"node_GEOMETRY_VC3_var_a_vertex_color",h:["GLSL_IN","vec3"],g:!1},{a:"node_param",c:"EW",h:["GLSL_OUT",
"vec3"],g:!1}],m:[{a:"txt",b:["EW","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{a:"nodes_global"},{a:"txt",b:["void","I","(",")","{"]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["qL","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/pack.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PACK_GLSLF",j:{a:"grp",f:[{a:"define",c:"PACK_GLSLF",b:[""]},{a:"txt",b:"vec4 fS ( const in float hA ) { vec4 eG = vec4 ( _255_0 * _255_0 * _255_0 , _255_0 * _255_0 , _255_0 , _1_0 ) ; vec4 EX = vec4 ( _0_0 , _1_0 / _255_0 , _1_0 / _255_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( hA * eG ) ; iS -= iS . xxyz * EX ; return iS ; } float cv ( const in vec4 EY ) { float fN ; vec4 eG = vec4 ( _1_0 / ( _255_0 * _255_0 * _255_0 ) , _1_0 / ( _255_0 * _255_0 ) , _1_0 / _255_0 , _1_0 ) ; fN = dot ( EY , eG ) ; return fN ; } vec4 fS ( const in vec2 gJ ) { vec2 eG = vec2 ( _255_0 , _1_0 ) ; vec2 EX = vec2 ( _0_0 , _1_0 / _255_0 ) ; vec4 iS = fract ( gJ . xxyy * eG . xyxy ) ; iS -= iS . xxzz * EX . xyxy ; if ( gJ . r == _1_0 ) iS . rg = vec2 ( _0_0 , _1_0 ) ; if ( gJ . g == _1_0 ) iS . ba = vec2 ( _0_0 , _1_0 ) ; return iS ; } vec2 ix ( const in vec4 EZ ) { vec2 gJ ; vec2 eG = vec2 ( _1_0 / _255_0 , _1_0 ) ; gJ . r = dot ( EZ . rg , eG ) ; gJ . g = dot ( EZ . ba , eG ) ; return gJ ; }".split(" ")}]}}]}]};
a["include/particles.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_GLSLV",j:{a:"grp",f:[{a:"define",c:"PARTICLES_GLSLV",b:[""]},{a:"var",c:"EPSILON",b:["0.000001"]},{a:"var",c:"COLOR_RAMP_LENGTH",b:["0"]},{a:"var",c:"WORLD_SPACE",b:["0"]},{a:"var",c:"USE_COLOR_RAMP",b:["0"]},{a:"include",A:"math.glslv"},{a:"txt",b:"struct cD { float cM ; vec3 N ; float J ; vec3 aG ; float bm ; vec3 cS ; vec3 cT ; float cU ; } ;".split(" ")},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",l:2}],
j:{a:"grp",f:[{a:"txt",b:"void Fc ( inout vec3 aG , float E_ , vec4 js , vec4 jt ) { float Fa = jt . x - js . x ; float Fb = ( E_ - js . x ) / Fa ; aG = mix ( aG , jt . yzw , clamp ( Fb , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Ff ( float t , float Fd , vec4 Fe [ COLOR_RAMP_LENGTH ] ) { float E_ = t / Fd ; vec3 aG = Fe [ 0 ] . yzw ;".split(" ")},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",1,{a:"g_expr",l:2}],
j:{a:"grp",f:[{a:"txt",b:"Fc ( aG , E_ , Fe [ 0 ] , Fe [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Fc ( aG , E_ , Fe [ 1 ] , Fe [ 2 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Fc ( aG , E_ , Fe [ 2 ] , Fe [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","aG",";","}"]}]}}]},{a:"txt",b:"float Fl ( float t , float Fd , float Fg , float Fh ) { float Fi = max ( 0.01 , min ( Fd , Fg ) ) ; float Fj = max ( 0.01 , min ( Fd , Fh ) ) ; float Fk = Fd - Fj ; float J = clamp ( t / Fi , 0.0 , 1.0 ) - step ( Fk , t ) * ( t - Fk ) / Fj ; return J ; } cD cE ( ) { cD sp ; float t ; float Fd = a_p_data [ 0 ] ; float Fm = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - Fm ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - Fm ; } if ( t < 0.0 || t >= Fd ) { sp . cM = 0.0001 ; sp . N = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= Fd ) ) { vec3 bz = O ( a_tbn_quat , vec3 ( 0.0 , 1.0 , 0.0 ) ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["WORLD_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 eD = a_position ; vec3 qS = bz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 eD = ad ( u_model_tsr , a_position ) ; vec3 qS = T ( u_model_tsr , bz ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 Fn = u_p_nfactor * qS ; Fn += a_p_vels . xyz ; Fn . z -= u_p_gravity * t / 2.0 ; float Fo = max ( u_p_mass , EPSILON ) ; Fn += ( u_p_wind_fac * u_wind / Fo ) * t / 2.0 ; sp . cU = t ; sp . cS = Fn ; sp . cT = bz * a_p_vels . w ; sp . N = eD + Fn * t ; sp . bm = a_p_vels . w * t ;".split(" ")},
{a:"cond",f:[{a:"if",i:["USE_COLOR_RAMP"],j:{a:"grp",f:[{a:"txt",b:"sp . cM = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"sp . cM = 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COLOR_RAMP_LENGTH",0,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"sp . aG = Ff ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"sp . aG = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . J = Fl ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]}}]}]};
a["include/particles_nodes.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_NODES_GLSLF",j:{a:"grp",f:[{a:"define",c:"PARTICLES_NODES_GLSLF",b:[""]},{a:"var",c:"CAUSTICS",b:["0"]},{a:"var",c:"DOUBLE_SIDED_LIGHTING",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"PARTICLE_BATCH",b:["0"]},{a:"var",c:"NUM_LIGHTS",b:["0"]},{a:"var",c:"CALC_TBN_SPACE",b:["0"]},{a:"cond",f:[{a:"if",i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{a:"logical_or_expr",l:2}],j:{a:"grp",
f:[{a:"include",A:"environment.glslf"}]}}]},{a:"include",A:"color_util.glslf"},{a:"include",A:"math.glslv"},{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 jy ( vec3 rgb ) { vec4 jx = vec4 ( _0_0 , - _1_0 / 3.0 , 2.0 / 3.0 , - _1_0 ) ; vec4 p = mix ( vec4 ( rgb . bg , jx . wz ) , vec4 ( rgb . gb , jx . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float df = q . x - min ( q . w , q . y ) ; float hQ = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * df + hQ ) ) , df / ( q . x + hQ ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",l:6}],j:{a:"grp",f:[{a:"txt",b:"vec3 jA ( vec3 jz ) { vec4 jx = vec4 ( _1_0 , 2.0 / 3.0 , _1_0 / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( jz . r , jz . r , jz . r ) + jx . xyz ) * 6.0 - jx . www ) ; return jz . b * mix ( jx . xxx , clamp ( p - jx . xxx , _0_0 , _1_0 ) , jz . g ) ; }".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec3 qP ( vec2 gl ) { return vec3 ( gl * 2.0 - vec2 ( _1_0 , _1_0 ) , _0_0 ) ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"txt",b:"vec2 qQ ( vec3 gJ ) { return vec2 ( gJ . xy * _0_5 + vec2 ( _0_5 , _0_5 ) ) ; }".split(" ")}]}}]},{a:"node",c:"CAMERA",
u:[],s:[{a:"node_out",c:"rq",h:["vec3"],g:!0},{a:"node_out",c:"rs",h:["float"],g:!0},{a:"node_out",c:"rt",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rq"],m:[{a:"txt",b:"rq = normalize ( rn . xyz ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rs"],m:[{a:"txt",b:"rs = abs ( rn . z ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_rt"],m:[{a:"txt",b:"rt = length ( rn . xyz ) ;".split(" ")}]}]}]},{a:"node",c:"COMBRGB",u:[],s:[{a:"node_in",c:"ru",h:["float"],
g:!1},{a:"node_in",c:"rv",h:["float"],g:!1},{a:"node_in",c:"rw",h:["float"],g:!1},{a:"node_out",c:"rx",h:["vec3"],g:!1}],m:[{a:"txt",b:"rx = vec3 ( ru , rv , rw ) ;".split(" ")}]},{a:"node",c:"COMBHSV",u:[],s:[{a:"node_in",c:"ry",h:["float"],g:!1},{a:"node_in",c:"rz",h:["float"],g:!1},{a:"node_in",c:"rA",h:["float"],g:!1},{a:"node_out",c:"rB",h:["vec3"],g:!1}],m:[{a:"txt",b:"rB = jA ( vec3 ( ry , rz , rA ) ) ;".split(" ")}]},{a:"node",c:"EMPTY_UV",u:[],s:[{a:"node_out",c:"rC",h:["vec3"],g:!1}],m:[{a:"txt",
b:"rC = vec3 ( - _1_0 , - _1_0 , _0_0 ) ;".split(" ")}]},{a:"node",c:"EMPTY_VC",u:[],s:[{a:"node_out",c:"rD",h:["vec3"],g:!1}],m:[{a:"txt",b:"rD = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[{a:"node_out",c:"rE",h:["vec3"],g:!1}],m:[{a:"txt",b:"rE = qP ( A ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_OR",u:[],s:[{a:"node_out",c:"rF",h:["vec3"],g:!1}],m:[{a:"txt",b:"rF = 2.0 * vec3 ( A , _0_0 ) - vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC",u:[],s:[{a:"node_out",c:"rG",
h:["vec3"],g:!1}],m:[{a:"txt",b:"rG = vec3 ( _1_0 ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC1",u:[],s:[{a:"node_out",c:"rH",h:["float"],g:!1}],m:[{a:"txt",b:["rH","=","_1_0",";"]}]},{a:"node",c:"GEOMETRY_VC2",u:[],s:[{a:"node_out",c:"rI",h:["float"],g:!1},{a:"node_out",c:"rJ",h:["float"],g:!1}],m:[{a:"txt",b:"rI = _1_0 ; rJ = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_VC3",u:[],s:[{a:"node_out",c:"rK",h:["float"],g:!1},{a:"node_out",c:"rL",h:["float"],g:!1},{a:"node_out",c:"rM",h:["float"],g:!1}],
m:[{a:"txt",b:"rK = _1_0 ; rL = _1_0 ; rM = _1_0 ;".split(" ")}]},{a:"node",c:"GEOMETRY_NO",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"rN",h:["vec3"],g:!1},{a:"node_out",c:"rO",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["rO","=","rN",";"]}]},{a:"node_else",m:[{a:"txt",b:"rO = rl . xyz ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_FB",u:[],s:[{a:"node_out",c:"rP",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["REFLECTION_PASS",
"REFL_PASS_PLANE",{a:"equal_expr",l:2}],m:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _0_0 : _1_0 ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"rP = ( gl_FrontFacing ) ? _1_0 : _0_0 ;".split(" ")}]}]}]},{a:"node",c:"GEOMETRY_VW",u:[],s:[{a:"node_out",c:"rR",h:["vec3"],g:!1}],m:[{a:"txt",b:"rR = - T ( u_view_tsr_frag , nI ) ;".split(" ")}]},{a:"node",c:"GEOMETRY_LO",u:[],s:[{a:"node_out",c:"rS",h:["vec3"],g:!1}],m:[{a:"txt",b:"rS [ 0 ] = rn [ 0 ] ; rS [ 1 ] = rn [ 1 ] ; rS [ 2 ] = rn [ 2 ] ;".split(" ")}]},
{a:"node",c:"GEOMETRY_GL",u:[],s:[{a:"node_out",c:"rT",h:["vec3"],g:!1}],m:[{a:"txt",b:"rT = vec3 ( nG . r , nG . g , nG . b ) ;".split(" ")}]},{a:"node",c:"NEW_GEOMETRY",u:[],s:[{a:"node_out",c:"rV",h:["vec3"],g:!1},{a:"node_out",c:"rW",h:["vec3"],g:!1},{a:"node_out",c:"rX",h:["vec3"],g:!1},{a:"node_out",c:"rY",h:["vec3"],g:!1},{a:"node_out",c:"rZ",h:["vec3"],g:!1},{a:"node_out",c:"r_",h:["vec3"],g:!1},{a:"node_out",c:"sa",h:["float"],g:!1},{a:"node_out",c:"sb",h:["float"],g:!1}],m:[{a:"txt",b:"rV = vec3 ( _0_0 ) ; rW = vec3 ( _0_0 ) ; rX = vec3 ( _0_0 ) ; rY = vec3 ( _0_0 ) ; rZ = vec3 ( _0_0 ) ; r_ = vec3 ( _0_0 ) ; sa = _0_0 ; sb = _0_0 ;".split(" ")}]},
{a:"node",c:"HUE_SAT",u:[],s:[{a:"node_in",c:"sc",h:["float"],g:!1},{a:"node_in",c:"sd",h:["float"],g:!1},{a:"node_in",c:"se",h:["float"],g:!1},{a:"node_in",c:"sf",h:["float"],g:!1},{a:"node_in",c:"sg",h:["vec3"],g:!1},{a:"node_out",c:"sh",h:["vec3"],g:!1}],m:[{a:"txt",b:"vec3 jz = jy ( sg ) ; jz [ 0 ] += ( sc - _0_5 ) ; if ( jz [ 0 ] > _1_0 ) jz [ 0 ] -= _1_0 ; else if ( jz [ 0 ] < _0_0 ) jz [ 0 ] += _1_0 ; jz *= vec3 ( _1_0 , sd , se ) ; jz = mix ( vec3 ( _1_0 ) , mix ( vec3 ( _0_0 ) , jz , step ( vec3 ( _0_0 ) , jz ) ) , step ( jz , vec3 ( _1_0 ) ) ) ; sh = mix ( sg , jA ( jz ) , sf ) ;".split(" ")}]},
{a:"node",c:"INVERT",u:[],s:[{a:"node_in",c:"si",h:["float"],g:!1},{a:"node_in",c:"sj",h:["vec3"],g:!1},{a:"node_out",c:"sk",h:["vec3"],g:!1}],m:[{a:"txt",b:"sk = mix ( sj , vec3 ( _1_0 ) - sj , si ) ;".split(" ")}]},{a:"node",c:"LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_INDEX",b:["0"]},{a:"node_var",c:"LAMP_USE_SPHERE",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]}],s:[{a:"node_out",
c:"sl",h:["vec3"],g:!0},{a:"node_out",c:"sm",h:["vec3"],g:!1},{a:"node_out",c:"sn",h:["float"],g:!1},{a:"node_out",c:"so",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sl"],m:[{a:"txt",b:"sl = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},{a:"txt",b:"vec3 sr = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 su = u_lamp_light_positions [ LAMP_INDEX ] ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",
l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"sm = - h + su ; sn = length ( sm ) ; sm = normalize ( sm ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_so"],m:[{a:"txt",b:"so = LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + sn * sn ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"float ol = dot ( sm , sr ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; so *= ol ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",
i:["LAMP_USE_SPHERE"],m:[{a:"txt",b:"so *= max ( LAMP_LIGHT_DIST - sn , _0_0 ) / LAMP_LIGHT_DIST ;".split(" ")}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sm"],m:[{a:"txt",b:["sm","=","sr",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sn"],m:[{a:"txt",b:"sn = length ( su - h ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_so"],m:[{a:"txt",b:["so","=","_1_0",";"]}]}]}]}]}]},{a:"node",c:"NORMAL",u:[],s:[{a:"node_in",c:"sv",h:["vec3"],g:!1},{a:"node_out",
c:"sw",h:["vec3"],g:!0},{a:"node_out",c:"sx",h:["float"],g:!0},{a:"node_param",c:"rc",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sw"],m:[{a:"txt",b:["sw","=","rc",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_sx"],m:[{a:"txt",b:"sx = - dot ( sv , rc ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_VECTOR_VIEW",u:[],s:[{a:"node_in",c:"sy",h:["vec3"],g:!1},{a:"node_out",c:"sz",h:["vec3"],g:!1}],m:[{a:"txt",b:"sz = - T ( u_view_tsr_frag , sy ) ;".split(" ")}]},{a:"node",c:"BSDF_BEGIN",
u:[],s:[{a:"node_in",c:"sA",h:["vec3"],g:!1},{a:"node_in",c:"sB",h:["vec3"],g:!1},{a:"node_in",c:"sC",h:["float"],g:!1},{a:"node_in",c:"sD",h:["vec3"],g:!1},{a:"node_in",c:"sE",h:["float"],g:!1},{a:"node_in",c:"sF",h:["float"],g:!1},{a:"node_in",c:"sG",h:["vec3"],g:!1},{a:"node_in",c:"sH",h:["vec3"],g:!1},{a:"node_in",c:"sI",h:["float"],g:!1},{a:"node_in",c:"sJ",h:["vec3"],g:!1},{a:"node_in",c:"sK",h:["float"],g:!1},{a:"node_out",c:"sL",h:["vec3"],g:!1},{a:"node_out",c:"sM",h:["vec3"],g:!1},{a:"node_out",
c:"sN",h:["vec3"],g:!1},{a:"node_out",c:"sO",h:["vec3"],g:!1},{a:"node_out",c:"sP",h:["vec3"],g:!1},{a:"node_out",c:"sQ",h:["vec4"],g:!1},{a:"node_out",c:"sR",h:["vec4"],g:!1},{a:"node_out",c:"sS",h:["vec3"],g:!1},{a:"node_out",c:"sT",h:["float"],g:!1},{a:"node_out",c:"sU",h:["vec3"],g:!1},{a:"node_out",c:"sV",h:["float"],g:!1},{a:"node_out",c:"sW",h:["vec3"],g:!1},{a:"node_out",c:"sX",h:["float"],g:!1}],m:[{a:"txt",b:"sN = sB ; sO = sD ; sP = sG ; sS = sD ; sT = sF ; sU = sH ; sV = sI ; sW = sJ ; sX = sK ; sL = ro * sN ; sM = rp * u_environment_energy * ce ( sP ) ; sR = ch ( sN ) ; G = sR ; sQ [ 0 ] = sC ; sQ [ 1 ] = sE ; sQ [ 2 ] = sF ;".split(" ")}]},
{a:"node",c:"BSDF_END",u:[],s:[{a:"node_in",c:"sY",h:["vec4"],g:!1},{a:"node_in",c:"sZ",h:["vec3"],g:!1},{a:"node_in",c:"s_",h:["vec3"],g:!1},{a:"node_in",c:"ta",h:["vec3"],g:!1},{a:"node_in",c:"tb",h:["float"],g:!1},{a:"node_in",c:"tc",h:["vec3"],g:!1},{a:"node_in",c:"te",h:["vec3"],g:!1},{a:"node_in",c:"td",h:["float"],g:!1},{a:"node_out",c:"tg",h:["vec3"],g:!1}],m:[{a:"txt",b:"tg = sY . rgb + sZ ; tg = mix ( tg , tc , td ) ; H = _1_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_BSDF_TRANSPARENT"],
m:[{a:"txt",b:"vec3 th = GLSL_TEXTURE ( u_refractmap , l . xy / l . z ) . rgb ; bY ( th ) ; te = te * th ; tg += te ;".split(" ")}]}]},{a:"txt",b:["s_",";"]}]},{a:"node",c:"BSDF_COMPUTE",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ti",h:["vec3"],g:!1},{a:"node_in",c:"tj",h:["vec2"],g:!1},{a:"node_in",c:"tk",h:["vec3"],g:!1},{a:"node_in",c:"tl",h:["float"],g:!1},{a:"node_in",c:"tm",h:["vec4"],g:!1},{a:"node_out",c:"tn",h:["float"],g:!1},{a:"node_out",c:"to",h:["float"],g:!1}],
m:[{a:"txt",b:"vec3 qS = tk ; float tr = clamp ( tm [ 0 ] , _0_0 , _1_0 ) ; float tu = clamp ( tm [ 1 ] , _0_0 , _1_0 ) ; float qJ = tm [ 2 ] ; vec3 pg = normalize ( nI + ti ) ; float ot = ( _1_0 - tl ) * dot ( qS , ti ) + tl ; float tv = ( _1_0 - tl ) * max ( dot ( ti , pg ) , _0_0 ) + tl ; float tw = ( _1_0 - tl ) * max ( dot ( tk , pg ) , _0_0 ) + tl ; tn = _0_0 ; if ( tj . r != _0_0 ) { if ( tr > _0_0 ) { float oF = max ( dot ( qS , nI ) , _0_0 ) ; float oG = tr * tr ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = ti - ot * qS ; vec3 oI = nI - oF * qS ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) tn = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; tn = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else tn = ot ; tn = max ( tn , _0_0 ) ; } float J = tu ; float tx = J * J ; float ty = ( tw * tx - tw ) * tw + _1_0 ; float cd = tx / ( M_PI * ty * ty ) ; float tz ; float tA ; float tB = pow ( _1_0 - tv , 5.0 ) ; tz = _1_0 ; tA = tB ; float jx = J / 2.0 ; float tC = jx * jx ; float tD = _1_0 - tC ; float tE = _1_0 / ( tv * tv * tD + tC ) ; tz *= tE ; tA *= tE ; float tF = mix ( 0.04 , _1_0 , qJ ) ; float tG = mix ( tA , tz , tF ) ; to = max ( ot * cd * tG , _0_0 ) ;".split(" ")}]},
{a:"node",c:"BSDF_ANISOTROPIC",u:[],s:[{a:"node_in",c:"tH",h:["vec3"],g:!1},{a:"node_in",c:"tI",h:["float"],g:!1},{a:"node_in",c:"tJ",h:["float"],g:!1},{a:"node_in",c:"tK",h:["float"],g:!1},{a:"node_in",c:"tL",h:["vec3"],g:!1},{a:"node_in",c:"tM",h:["vec3"],g:!1},{a:"node_out",c:"tN",h:["vec3"],g:!1}],m:[{a:"txt",b:"tN = tH ; tI ; tJ ; tK ; tL ; tM ;".split(" ")}]},{a:"node",c:"BSDF_DIFFUSE",u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"tO",h:["vec3"],g:!1},{a:"node_in",c:"tP",h:["float"],
g:!1},{a:"node_in",c:"tQ",h:["vec3"],g:!1},{a:"node_out",c:"tR",h:["vec3"],g:!1},{a:"node_out",c:"tS",h:["vec3"],g:!1},{a:"node_out",c:"tT",h:["float"],g:!1},{a:"node_out",c:"tU",h:["vec3"],g:!1},{a:"node_out",c:"tV",h:["float"],g:!1},{a:"node_out",c:"tW",h:["float"],g:!1},{a:"node_out",c:"tX",h:["vec3"],g:!1},{a:"node_out",c:"tY",h:["vec3"],g:!1},{a:"node_out",c:"tZ",h:["float"],g:!1},{a:"node_out",c:"t_",h:["vec3"],g:!1},{a:"node_out",c:"ua",h:["float"],g:!1}],m:[{a:"txt",b:"tS = tO ; tT = tP ; tW = _0_0 ; tZ = _0_0 ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["tX","=","tQ",";"]}]},{a:"node_else",m:[{a:"txt",b:["tX","=","nH",";"]}]}]},{a:"txt",b:"tR ; tU ; tV ; tY ; t_ ; ua ;".split(" ")}]},{a:"node",c:"BSDF_GLASS",u:[],s:[{a:"node_in",c:"ub",h:["vec3"],g:!1},{a:"node_in",c:"uc",h:["float"],g:!1},{a:"node_in",c:"ud",h:["float"],g:!1},{a:"node_in",c:"ue",h:["vec3"],g:!1},{a:"node_out",c:"uf",h:["vec3"],g:!1}],m:[{a:"txt",b:"uf = ub ; uc ; ud ; ue ;".split(" ")}]},{a:"node",c:"BSDF_GLOSSY",
u:[{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"ug",h:["vec3"],g:!1},{a:"node_in",c:"uh",h:["float"],g:!1},{a:"node_in",c:"ui",h:["vec3"],g:!1},{a:"node_out",c:"uj",h:["vec3"],g:!1},{a:"node_out",c:"uk",h:["vec3"],g:!1},{a:"node_out",c:"ul",h:["float"],g:!1},{a:"node_out",c:"um",h:["vec3"],g:!1},{a:"node_out",c:"un",h:["float"],g:!1},{a:"node_out",c:"uo",h:["float"],g:!1},{a:"node_out",c:"up",h:["vec3"],g:!1},{a:"node_out",c:"uq",h:["vec3"],g:!1},{a:"node_out",c:"ur",h:["float"],g:!1},
{a:"node_out",c:"us",h:["vec3"],g:!1},{a:"node_out",c:"ut",h:["float"],g:!1}],m:[{a:"txt",b:"um = ug ; un = uh ; uo = _1_0 ; ur = _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:["up","=","ui",";"]}]},{a:"node_else",m:[{a:"txt",b:["up","=","nH",";"]}]}]},{a:"txt",b:"uj ; uk ; ul ; uq ; us ; ut ;".split(" ")}]},{a:"node",c:"BSDF_HAIR",u:[],s:[{a:"node_in",c:"uu",h:["vec3"],g:!1},{a:"node_in",c:"uv",h:["float"],g:!1},{a:"node_in",c:"uw",h:["float"],g:!1},{a:"node_in",
c:"ux",h:["float"],g:!1},{a:"node_out",c:"uy",h:["vec3"],g:!1}],m:[{a:"txt",b:"uy = uu ; uv ; uw ; ux ;".split(" ")}]},{a:"node",c:"BSDF_TRANSPARENT",u:[],s:[{a:"node_in",c:"uz",h:["vec3"],g:!1},{a:"node_out",c:"uA",h:["vec3"],g:!1},{a:"node_out",c:"uB",h:["vec3"],g:!1},{a:"node_out",c:"uC",h:["float"],g:!1},{a:"node_out",c:"uD",h:["vec3"],g:!1},{a:"node_out",c:"uE",h:["float"],g:!1},{a:"node_out",c:"uF",h:["float"],g:!1},{a:"node_out",c:"uG",h:["vec3"],g:!1},{a:"node_out",c:"uH",h:["vec3"],g:!1},
{a:"node_out",c:"uI",h:["float"],g:!1},{a:"node_out",c:"uJ",h:["vec3"],g:!1},{a:"node_out",c:"uK",h:["float"],g:!1}],m:[{a:"txt",b:"uJ = uz ; uF = _0_0 ; uI = _0_0 ; uK = _0_0 ; uG = nH ; uA ; uB ; uC ; uD ; uE ; uH ;".split(" ")}]},{a:"node",c:"BSDF_TRANSLUCENT",u:[],s:[{a:"node_in",c:"uL",h:["vec3"],g:!1},{a:"node_in",c:"uM",h:["vec3"],g:!1},{a:"node_out",c:"uN",h:["vec3"],g:!1}],m:[{a:"txt",b:"uN = uL ; uM ;".split(" ")}]},{a:"node",c:"BSDF_REFRACTION",u:[],s:[{a:"node_in",c:"uO",h:["vec3"],g:!1},
{a:"node_in",c:"uP",h:["float"],g:!1},{a:"node_in",c:"uQ",h:["float"],g:!1},{a:"node_in",c:"uR",h:["vec3"],g:!1},{a:"node_out",c:"uS",h:["vec3"],g:!1}],m:[{a:"txt",b:"uS [ 0 ] = uS [ 1 ] = uS [ 2 ] = _0_0 ; uO ; uP ; uQ ; uR ;".split(" ")}]},{a:"node",c:"BSDF_TOON",u:[],s:[{a:"node_in",c:"uT",h:["vec3"],g:!1},{a:"node_in",c:"uU",h:["float"],g:!1},{a:"node_in",c:"uV",h:["float"],g:!1},{a:"node_in",c:"uW",h:["vec3"],g:!1},{a:"node_out",c:"uX",h:["vec3"],g:!1}],m:[{a:"txt",b:"uX = uT ; uU ; uV ; uW ;".split(" ")}]},
{a:"node",c:"BSDF_VELVET",u:[],s:[{a:"node_in",c:"uY",h:["vec3"],g:!1},{a:"node_in",c:"uZ",h:["float"],g:!1},{a:"node_in",c:"u_",h:["vec3"],g:!1},{a:"node_out",c:"va",h:["vec3"],g:!1}],m:[{a:"txt",b:"va = uY ; uZ ; u_ ;".split(" ")}]},{a:"node",c:"SUBSURFACE_SCATTERING",u:[],s:[{a:"node_in",c:"vb",h:["vec3"],g:!1},{a:"node_in",c:"vc",h:["float"],g:!1},{a:"node_in",c:"vd",h:["vec3"],g:!1},{a:"node_in",c:"ve",h:["float"],g:!1},{a:"node_in",c:"vf",h:["float"],g:!1},{a:"node_in",c:"vg",h:["vec3"],g:!1},
{a:"node_out",c:"vh",h:["vec3"],g:!1}],m:[{a:"txt",b:"vh [ 0 ] = vh [ 1 ] = vh [ 2 ] = _0_0 ; vb ; vd ; ve ; vf ; vg ; vc ;".split(" ")}]},{a:"node",c:"EMISSION",u:[],s:[{a:"node_in",c:"vi",h:["vec3"],g:!1},{a:"node_in",c:"vj",h:["float"],g:!1},{a:"node_out",c:"vk",h:["vec3"],g:!1},{a:"node_out",c:"vl",h:["vec3"],g:!1},{a:"node_out",c:"vm",h:["float"],g:!1},{a:"node_out",c:"vn",h:["vec3"],g:!1},{a:"node_out",c:"vo",h:["float"],g:!1},{a:"node_out",c:"vp",h:["float"],g:!1},{a:"node_out",c:"vq",h:["vec3"],
g:!1},{a:"node_out",c:"vr",h:["vec3"],g:!1},{a:"node_out",c:"vs",h:["float"],g:!1},{a:"node_out",c:"vt",h:["vec3"],g:!1},{a:"node_out",c:"vu",h:["float"],g:!1}],m:[{a:"txt",b:"vr = vj * vi ; vp = _0_0 ; vs = _1_0 ; vq = nH ; vk ; vl ; vm ; vn ; vo ; vt ; vu ;".split(" ")}]},{a:"node",c:"AMBIENT_OCCLUSION",u:[],s:[{a:"node_in",c:"vv",h:["vec3"],g:!1},{a:"node_out",c:"vw",h:["vec3"],g:!1}],m:[{a:"txt",b:"vw [ 0 ] = vw [ 1 ] = vw [ 2 ] = _0_0 ; vv ;".split(" ")}]},{a:"node",c:"HOLDOUT",u:[],s:[{a:"node_out",
c:"vx",h:["vec3"],g:!1}],m:[{a:"txt",b:"vx [ 0 ] = vx [ 1 ] = vx [ 2 ] = _0_0 ;".split(" ")}]},{a:"node",c:"VOLUME_ABSORPTION",u:[],s:[{a:"node_in",c:"vy",h:["vec3"],g:!1},{a:"node_in",c:"vz",h:["float"],g:!1},{a:"node_out",c:"vA",h:["vec3"],g:!1}],m:[{a:"txt",b:"vA [ 0 ] = vA [ 1 ] = vA [ 2 ] = _0_0 ; vy ; vz ;".split(" ")}]},{a:"node",c:"VOLUME_SCATTER",u:[],s:[{a:"node_in",c:"vB",h:["vec3"],g:!1},{a:"node_in",c:"vC",h:["float"],g:!1},{a:"node_in",c:"vD",h:["float"],g:!1},{a:"node_out",c:"vE",h:["vec3"],
g:!1}],m:[{a:"txt",b:"vE [ 0 ] = vE [ 1 ] = vE [ 2 ] = _0_0 ; vB ; vC ; vD ;".split(" ")}]},{a:"node",c:"BUMP",u:[],s:[{a:"node_in",c:"Ft",h:["float"],g:!1},{a:"node_in",c:"Fu",h:["float"],g:!1},{a:"node_in",c:"vH",h:["float"],g:!1},{a:"node_in",c:"Fv",h:["vec3"],g:!1},{a:"node_out",c:"vJ",h:["vec3"],g:!1}],m:[{a:"txt",b:"vJ = Fv ; Ft ; Fu ; vH ;".split(" ")}]},{a:"node",c:"DISPLACEMENT_BUMP",u:[],s:[{a:"node_in",c:"vQ",h:["float"],g:!1},{a:"node_out",c:"vR",h:["vec3"],g:!1}],m:[{a:"txt",b:"vR = nH ; vQ ;".split(" ")}]},
{a:"node",c:"NORMAL_MAP",u:[{a:"node_var",c:"SPACE",b:["NM_TANGENT"]},{a:"node_var",c:"USE_NORMAL_IN",b:["0"]}],s:[{a:"node_in",c:"vS",h:["float"],g:!1},{a:"node_in",c:"vT",h:["vec4"],g:!1},{a:"node_in",c:"vU",h:["vec3"],g:!1},{a:"node_out",c:"vV",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NORMAL_IN"],m:[{a:"txt",b:"vec3 vW = normalize ( vU ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["vec3","vW","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["SPACE","NM_TANGENT",{a:"equal_expr",
l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV = rm * vV ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_OBJECT",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV . yz *= - _1_0 ; vV = T ( u_model_tsr , vV ) ;".split(" ")}]},{a:"node_elif",i:["SPACE","NM_WORLD",{a:"equal_expr",l:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vV = 2.0 * vT . xyz - _1_0 ; vV . yz *= - _1_0 ;".split(" ")}]}]},
{a:"txt",b:"vV = normalize ( mix ( vW , vV , vS ) ) ;".split(" ")}]},{a:"node",c:"VECT_TRANSFORM",u:[{a:"node_var",c:"CONVERT_TYPE",b:["VT_WORLD_TO_OBJECT"]},{a:"node_var",c:"VECTOR_TYPE",b:["VT_VECTOR"]}],s:[{a:"node_in",c:"vX",h:["vec3"],g:!1},{a:"node_out",c:"vY",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",l:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",l:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",l:2},{a:"logical_or_expr",
l:3}],m:[{a:"txt",b:["vY","=","vX",";"]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",l:2}],m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_frag , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",
{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_model_tsr , vX ) ; vY = ad ( u_view_tsr_frag , vY ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = ad ( u_view_tsr_inverse , vX ) ; vY = ad ( u_model_tsr_inverse , vY ) ;".split(" ")}]}]}]},
{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_frag , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",
{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_model_tsr , vX ) ; vY = T ( u_view_tsr_frag , vY ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_inverse , vX ) ;".split(" ")}]},{a:"node_elif",i:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = T ( u_view_tsr_inverse , vX ) ; vY = T ( u_model_tsr_inverse , vY ) ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["VECTOR_TYPE","VT_NORMAL",
{a:"equal_expr",l:2}],m:[{a:"txt",b:"vY = normalize ( vY ) ;".split(" ")}]}]}]}]}]},{a:"node",c:"BLACKBODY",u:[],s:[{a:"node_in",c:"vZ",h:["float"],g:!1},{a:"node_out",c:"v_",h:["vec3"],g:!1}],m:[{a:"txt",b:"v_ [ 0 ] = v_ [ 1 ] = v_ [ 2 ] = _0_0 ; vZ ;".split(" ")}]},{a:"node",c:"WAVELENGTH",u:[],s:[{a:"node_in",c:"wa",h:["float"],g:!1},{a:"node_out",c:"wb",h:["vec3"],g:!1}],m:[{a:"txt",b:"wb [ 0 ] = wb [ 1 ] = wb [ 2 ] = _0_0 ; wa ;".split(" ")}]},{a:"node",c:"SEPXYZ",u:[],s:[{a:"node_in",c:"wc",
h:["vec3"],g:!1},{a:"node_out",c:"wd",h:["float"],g:!1},{a:"node_out",c:"we",h:["float"],g:!1},{a:"node_out",c:"wf",h:["float"],g:!1}],m:[{a:"txt",b:"wd = wc [ 0 ] ; we = wc [ 1 ] ; wf = wc [ 2 ] ;".split(" ")}]},{a:"node",c:"COMBXYZ",u:[],s:[{a:"node_in",c:"wg",h:["float"],g:!1},{a:"node_in",c:"wh",h:["float"],g:!1},{a:"node_in",c:"wi",h:["float"],g:!1},{a:"node_out",c:"wj",h:["vec3"],g:!1}],m:[{a:"txt",b:"wj [ 0 ] = wg ; wj [ 1 ] = wh ; wj [ 2 ] = wi ;".split(" ")}]},{a:"node",c:"BRIGHTCONTRAST",
u:[],s:[{a:"node_in",c:"wk",h:["vec3"],g:!1},{a:"node_in",c:"wl",h:["float"],g:!1},{a:"node_in",c:"wm",h:["float"],g:!1},{a:"node_out",c:"wn",h:["vec3"],g:!1}],m:[{a:"txt",b:"float b = wl - wm * _0_5 ; wn = max ( ( _1_0 + wm ) * wk + b , vec3 ( _0_0 ) ) ;".split(" ")}]},{a:"node",c:"LIGHT_FALLOFF",u:[],s:[{a:"node_in",c:"wo",h:["float"],g:!1},{a:"node_in",c:"wp",h:["float"],g:!1},{a:"node_out",c:"wq",h:["float"],g:!1},{a:"node_out",c:"wr",h:["float"],g:!1},{a:"node_out",c:"ws",h:["float"],g:!1}],
m:[{a:"txt",b:"wq = wr = ws = _0_0 ; wo ; wp ;".split(" ")}]},{a:"node",c:"TEX_IMAGE",u:[],s:[{a:"node_in",c:"Fw",h:["vec3"],g:!1},{a:"node_out",c:"Fx",h:["vec3"],g:!1},{a:"node_out",c:"Fy",h:["float"],g:!1}],m:[{a:"txt",b:"Fx [ 0 ] = Fx [ 1 ] = Fx [ 2 ] = _0_0 ; Fy = _1_0 ; Fw ;".split(" ")}]},{a:"node",c:"TEX_ENVIRONMENT",u:[],s:[{a:"node_in",c:"Fz",h:["vec3"],g:!1},{a:"node_out",c:"FA",h:["vec3"],g:!1}],m:[{a:"txt",b:"FA [ 0 ] = FA [ 1 ] = FA [ 2 ] = _0_0 ; Fz ;".split(" ")}]},{a:"node",c:"TEX_SKY",
u:[],s:[{a:"node_in",c:"wt",h:["vec3"],g:!1},{a:"node_out",c:"wu",h:["vec3"],g:!1}],m:[{a:"txt",b:"wu [ 0 ] = wu [ 1 ] = wu [ 2 ] = _0_0 ; wt ;".split(" ")}]},{a:"node",c:"TEX_NOISE",u:[],s:[{a:"node_in",c:"wv",h:["vec3"],g:!1},{a:"node_in",c:"wA",h:["float"],g:!1},{a:"node_in",c:"wB",h:["float"],g:!1},{a:"node_in",c:"wC",h:["float"],g:!1},{a:"node_out",c:"wD",h:["vec3"],g:!1},{a:"node_out",c:"wE",h:["float"],g:!1}],m:[{a:"txt",b:"wD [ 0 ] = wD [ 1 ] = wD [ 2 ] = _0_0 ; wE = _1_0 ; wv ; wA ; wB ; wC ;".split(" ")}]},
{a:"node",c:"TEX_WAVE",u:[],s:[{a:"node_in",c:"wF",h:["vec3"],g:!1},{a:"node_in",c:"wG",h:["float"],g:!1},{a:"node_in",c:"wH",h:["float"],g:!1},{a:"node_in",c:"wI",h:["float"],g:!1},{a:"node_in",c:"wJ",h:["float"],g:!1},{a:"node_out",c:"wK",h:["vec3"],g:!1},{a:"node_out",c:"wL",h:["float"],g:!1}],m:[{a:"txt",b:"wK [ 0 ] = wK [ 1 ] = wK [ 2 ] = _0_0 ; wL = _1_0 ; wF ; wG ; wH ; wI ; wJ ;".split(" ")}]},{a:"node",c:"TEX_VORONOI",u:[],s:[{a:"node_in",c:"wM",h:["vec3"],g:!1},{a:"node_in",c:"wN",h:["float"],
g:!1},{a:"node_out",c:"wO",h:["vec3"],g:!1},{a:"node_out",c:"wP",h:["float"],g:!1}],m:[{a:"txt",b:"wO [ 0 ] = wO [ 1 ] = wO [ 2 ] = _0_0 ; wP = _1_0 ; wM ; wN ;".split(" ")}]},{a:"node",c:"TEX_MUSGRAVE",u:[],s:[{a:"node_in",c:"wQ",h:["vec3"],g:!1},{a:"node_in",c:"wR",h:["float"],g:!1},{a:"node_in",c:"wS",h:["float"],g:!1},{a:"node_in",c:"wT",h:["float"],g:!1},{a:"node_in",c:"wU",h:["float"],g:!1},{a:"node_in",c:"wV",h:["float"],g:!1},{a:"node_in",c:"wW",h:["float"],g:!1},{a:"node_out",c:"wX",h:["vec3"],
g:!1},{a:"node_out",c:"wY",h:["float"],g:!1}],m:[{a:"txt",b:"wX [ 0 ] = wX [ 1 ] = wX [ 2 ] = _0_0 ; wY = _1_0 ; wQ ; wR ; wS ; wT ; wU ; wV ; wW ;".split(" ")}]},{a:"node",c:"TEX_GRADIENT",u:[],s:[{a:"node_in",c:"wZ",h:["vec3"],g:!1},{a:"node_out",c:"w_",h:["vec3"],g:!1},{a:"node_out",c:"xa",h:["float"],g:!1}],m:[{a:"txt",b:"w_ [ 0 ] = w_ [ 1 ] = w_ [ 2 ] = _0_0 ; xa = _1_0 ; wZ ;".split(" ")}]},{a:"node",c:"TEX_MAGIC",u:[],s:[{a:"node_in",c:"xb",h:["vec3"],g:!1},{a:"node_in",c:"xc",h:["float"],
g:!1},{a:"node_in",c:"xd",h:["float"],g:!1},{a:"node_out",c:"xe",h:["vec3"],g:!1},{a:"node_out",c:"xf",h:["float"],g:!1}],m:[{a:"txt",b:"xe [ 0 ] = xe [ 1 ] = xe [ 2 ] = _0_0 ; xf = _1_0 ; xb ; xc ; xd ;".split(" ")}]},{a:"node",c:"TEX_CHECKER",u:[],s:[{a:"node_in",c:"xg",h:["vec3"],g:!1},{a:"node_in",c:"xh",h:["vec3"],g:!1},{a:"node_in",c:"xi",h:["vec3"],g:!1},{a:"node_in",c:"xj",h:["float"],g:!1},{a:"node_out",c:"xk",h:["vec3"],g:!1},{a:"node_out",c:"xl",h:["float"],g:!1}],m:[{a:"txt",b:"xk [ 0 ] = xk [ 1 ] = xk [ 2 ] = _0_0 ; xl = _1_0 ; xg ; xh ; xi ; xj ;".split(" ")}]},
{a:"node",c:"TEX_BRICK",u:[],s:[{a:"node_in",c:"xm",h:["vec3"],g:!1},{a:"node_in",c:"xn",h:["vec3"],g:!1},{a:"node_in",c:"xo",h:["vec3"],g:!1},{a:"node_in",c:"xp",h:["vec3"],g:!1},{a:"node_in",c:"xq",h:["float"],g:!1},{a:"node_in",c:"xr",h:["float"],g:!1},{a:"node_in",c:"xs",h:["float"],g:!1},{a:"node_in",c:"xt",h:["float"],g:!1},{a:"node_in",c:"xu",h:["float"],g:!1},{a:"node_out",c:"xv",h:["vec3"],g:!1},{a:"node_out",c:"xA",h:["float"],g:!1}],m:[{a:"txt",b:"xv [ 0 ] = xv [ 1 ] = xv [ 2 ] = _0_0 ; xA = _1_0 ; xm ; xn ; xo ; xp ; xq ; xr ; xs ; xt ; xu ;".split(" ")}]},
{a:"node",c:"ADD_SHADER",u:[],s:[{a:"node_in",c:"xB",h:["vec3"],g:!1},{a:"node_in",c:"xC",h:["vec3"],g:!1},{a:"node_out",c:"xD",h:["vec3"],g:!1}],m:[{a:"txt",b:"xD = clamp ( xB + xC , vec3 ( _0_0 ) , vec3 ( _1_0 ) ) ;".split(" ")}]},{a:"node",c:"MIX_SHADER",u:[],s:[{a:"node_in",c:"xE",h:["float"],g:!1},{a:"node_in",c:"xF",h:["vec3"],g:!1},{a:"node_in",c:"xG",h:["vec3"],g:!1},{a:"node_in",c:"xH",h:["vec3"],g:!1},{a:"node_in",c:"xI",h:["float"],g:!1},{a:"node_in",c:"xJ",h:["vec3"],g:!1},{a:"node_in",
c:"xK",h:["float"],g:!1},{a:"node_in",c:"xL",h:["float"],g:!1},{a:"node_in",c:"xM",h:["vec3"],g:!1},{a:"node_in",c:"xN",h:["vec3"],g:!1},{a:"node_in",c:"xO",h:["float"],g:!1},{a:"node_in",c:"xP",h:["vec3"],g:!1},{a:"node_in",c:"xQ",h:["float"],g:!1},{a:"node_in",c:"xR",h:["vec3"],g:!1},{a:"node_in",c:"xS",h:["float"],g:!1},{a:"node_in",c:"xT",h:["vec3"],g:!1},{a:"node_in",c:"xU",h:["float"],g:!1},{a:"node_in",c:"xV",h:["float"],g:!1},{a:"node_in",c:"xW",h:["vec3"],g:!1},{a:"node_in",c:"xX",h:["vec3"],
g:!1},{a:"node_in",c:"xY",h:["float"],g:!1},{a:"node_in",c:"xZ",h:["vec3"],g:!1},{a:"node_in",c:"x_",h:["float"],g:!1},{a:"node_out",c:"ya",h:["vec3"],g:!1},{a:"node_out",c:"yb",h:["vec3"],g:!1},{a:"node_out",c:"yc",h:["float"],g:!1},{a:"node_out",c:"yd",h:["vec3"],g:!1},{a:"node_out",c:"ye",h:["float"],g:!1},{a:"node_out",c:"yf",h:["float"],g:!1},{a:"node_out",c:"yg",h:["vec3"],g:!1},{a:"node_out",c:"yh",h:["vec3"],g:!1},{a:"node_out",c:"yi",h:["float"],g:!1},{a:"node_out",c:"yj",h:["vec3"],g:!1},
{a:"node_out",c:"yk",h:["float"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( xE , _0_0 , _1_0 ) ; yb = mix ( xH , xR , yl ) ; yc = mix ( xI , xS , yl ) ; if ( xL > _0_0 ) { if ( xV > _0_0 ) { yd = mix ( xJ , xT , yl ) ; ye = mix ( xK , xU , yl ) ; } else { yd = xJ ; ye = xK ; } } else { yd = xT ; ye = xU ; } if ( xO > _0_0 ) { if ( xY > _0_0 ) { yh = mix ( xN , xX , yl ) ; } else { yh = xN ; } } else { yh = xX ; } yf = mix ( xL , xV , yl ) ; yg = mix ( xM , xW , yl ) ; yi = mix ( xO , xY , yl ) ; yj = mix ( xP , xZ , yl ) ; yk = mix ( xQ , x_ , yl ) ;".split(" ")}]},
{a:"node",c:"UV_MERGED",u:[],s:[{a:"node_out",c:"ym",h:["vec3"],g:!1},{a:"node_out",c:"yn",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_ym"],m:[{a:"txt",b:"ym = qP ( A ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yn"],m:[{a:"txt",b:"yn = vec3 ( A , _0_0 ) ;".split(" ")}]}]}]},{a:"node",c:"TEX_COORD_UV",u:[],s:[{a:"node_out",c:"yo",h:["vec3"],g:!1}],m:[{a:"txt",b:"yo = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_NO",u:[],s:[{a:"node_out",c:"yp",h:["vec3"],
g:!1}],m:[{a:"txt",b:["yp","=","nH",";"]}]},{a:"node",c:"TEX_COORD_GE",u:[],s:[{a:"node_out",c:"yq",h:["vec3"],g:!1}],m:[{a:"txt",b:"yq = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"TEX_COORD_OB",u:[],s:[{a:"node_out",c:"yr",h:["vec3"],g:!1}],m:[{a:"txt",b:"yr [ 0 ] = yr [ 1 ] = yr [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_CA",u:[],s:[{a:"node_out",c:"ys",h:["vec3"],g:!1}],m:[{a:"txt",b:"ys [ 0 ] = rn [ 0 ] ; ys [ 1 ] = rn [ 1 ] ; ys [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_WI",
u:[],s:[{a:"node_out",c:"yt",h:["vec3"],g:!1}],m:[{a:"txt",b:"yt [ 0 ] = yt [ 1 ] = yt [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"TEX_COORD_RE",u:[],s:[{a:"node_out",c:"yu",h:["vec3"],g:!1}],m:[{a:"txt",b:"yu [ 0 ] = yu [ 1 ] = yu [ 2 ] = _1_0 ;".split(" ")}]},{a:"node",c:"UVMAP",u:[],s:[{a:"node_out",c:"yv",h:["vec3"],g:!1}],m:[{a:"txt",b:"yv = vec3 ( A , _0_0 ) ;".split(" ")}]},{a:"node",c:"PARTICLE_INFO",u:[],s:[{a:"node_out",c:"yA",h:["float"],g:!1},{a:"node_out",c:"yB",h:["float"],g:!1},{a:"node_out",
c:"yC",h:["float"],g:!1},{a:"node_out",c:"yD",h:["vec3"],g:!1},{a:"node_out",c:"yE",h:["float"],g:!1},{a:"node_out",c:"yF",h:["vec3"],g:!1},{a:"node_out",c:"yG",h:["vec3"],g:!1},{a:"node_param",c:"Fp",h:["GLSL_IN","vec4"],g:!0},{a:"node_param",c:"Fq",h:["GLSL_IN","vec3"],g:!0},{a:"node_param",c:"Fr",h:["GLSL_IN","vec3"],g:!0},{a:"node_param",c:"Fs",h:["GLSL_IN","vec3"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["PARTICLE_BATCH"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yA"],m:[{a:"txt",b:"yA = Fp [ 0 ] ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yB"],m:[{a:"txt",b:"yB = Fp [ 1 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yC"],m:[{a:"txt",b:"yC = Fp [ 2 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yD"],m:[{a:"txt",b:["yD","=","Fq",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yE"],m:[{a:"txt",b:"yE = Fp [ 3 ] ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yF"],m:[{a:"txt",b:["yF","=","Fr",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_yG"],
m:[{a:"txt",b:["yG","=","Fs",";"]}]}]}]},{a:"node_else",m:[{a:"txt",b:"yA = _0_0 ; yB = _0_0 ; yC = _0_0 ; yD = vec3 ( _0_0 ) ; yE = _0_0 ; yF = yD ; yG = yD ;".split(" ")}]}]}]},{a:"node",c:"HAIR_INFO",u:[],s:[{a:"node_out",c:"yH",h:["float"],g:!1},{a:"node_out",c:"yI",h:["float"],g:!1},{a:"node_out",c:"yJ",h:["float"],g:!1},{a:"node_out",c:"yK",h:["vec3"],g:!1}],m:[{a:"txt",b:"yH = _0_0 ; yI = _0_0 ; yJ = _0_0 ; yK = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"OBJECT_INFO",u:[],s:[{a:"node_out",
c:"yL",h:["vec3"],g:!1},{a:"node_out",c:"yM",h:["float"],g:!1},{a:"node_out",c:"yN",h:["float"],g:!1},{a:"node_out",c:"yO",h:["float"],g:!1}],m:[{a:"txt",b:"yM = _0_0 ; yN = _0_0 ; yO = _0_0 ; yL = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",c:"WIREFRAME",u:[],s:[{a:"node_in",c:"yP",h:["float"],g:!1},{a:"node_out",c:"yQ",h:["float"],g:!1}],m:[{a:"txt",b:["yQ","=","yP",";"]}]},{a:"node",c:"TANGENT",u:[],s:[{a:"node_out",c:"yR",h:["vec3"],g:!1}],m:[{a:"txt",b:"yR = vec3 ( _0_0 ) ;".split(" ")}]},{a:"node",
c:"LAYER_WEIGHT",u:[],s:[{a:"node_in",c:"FB",h:["float"],g:!1},{a:"node_in",c:"FC",h:["vec3"],g:!1},{a:"node_out",c:"yU",h:["float"],g:!1},{a:"node_out",c:"yV",h:["float"],g:!1}],m:[{a:"txt",b:"yU = yV = _0_0 ; FC ; FB ;".split(" ")}]},{a:"node",c:"LIGHT_PATH",u:[],s:[{a:"node_out",c:"yX",h:["float"],g:!1},{a:"node_out",c:"yY",h:["float"],g:!1},{a:"node_out",c:"yZ",h:["float"],g:!1},{a:"node_out",c:"y_",h:["float"],g:!1},{a:"node_out",c:"za",h:["float"],g:!1},{a:"node_out",c:"zb",h:["float"],g:!1},
{a:"node_out",c:"zc",h:["float"],g:!1},{a:"node_out",c:"zd",h:["float"],g:!1},{a:"node_out",c:"ze",h:["float"],g:!1},{a:"node_out",c:"zf",h:["float"],g:!1}],m:[{a:"txt",b:"yX = yY = yZ = _0_0 ; y_ = za = zb = _0_0 ; zc = zc = ze = zf = _0_0 ; zd = _0_0 ;".split(" ")}]},{a:"node",c:"ATTRIBUTE",u:[],s:[{a:"node_out",c:"zh",h:["vec3"],g:!1},{a:"node_out",c:"zi",h:["vec3"],g:!1},{a:"node_out",c:"zj",h:["float"],g:!1}],m:[{a:"txt",b:"zh = zi = vec3 ( _0_0 ) ; zj = _0_0 ;".split(" ")}]},{a:"node",c:"SCRIPT",
u:[],s:[],m:[]},{a:"node",c:"CURVE_VEC",u:[{a:"node_var",c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["0.0"]}],s:[{a:"node_in",c:"zk",h:["float"],g:!1},{a:"node_in",c:"zl",h:["vec3"],g:!1},{a:"node_out",c:"zm",h:["vec3"],g:!1}],m:[{a:"txt",b:["zm","=","zl",";"]},{a:"node_cond",f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zm . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . r + _0_5 , NODE_TEX_ROW ) ) . r - _0_5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zm . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . g + _0_5 , NODE_TEX_ROW ) ) . g - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zm . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( _0_5 * zl . b + _0_5 , NODE_TEX_ROW ) ) . b - _0_5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"zm = mix ( zl , zm , zk ) ;".split(" ")}]},{a:"node",c:"CURVE_RGB",u:[{a:"node_var",c:"READ_A",b:["0"]},{a:"node_var",
c:"READ_R",b:["0"]},{a:"node_var",c:"READ_G",b:["0"]},{a:"node_var",c:"READ_B",b:["0"]},{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zn",h:["float"],g:!1},{a:"node_in",c:"zo",h:["vec3"],g:!1},{a:"node_out",c:"zp",h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["READ_A"],m:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zo . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"float r = zo . r ; float g = zo . g ; float b = zo . b ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_R"],m:[{a:"txt",b:"zp . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zp . r = r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["READ_G"],m:[{a:"txt",b:"zp . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zp . g = g ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["READ_B"],m:[{a:"txt",b:"zp . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"zp . b = b ;".split(" ")}]}]},{a:"txt",b:"zp = mix ( zo , zp , zn ) ;".split(" ")}]},{a:"node",c:"VALTORGB",u:[{a:"node_var",c:"NODE_TEX_ROW",b:["_0_0"]}],s:[{a:"node_in",c:"zq",h:["float"],g:!1},{a:"node_out",c:"zr",h:["vec3"],g:!1},{a:"node_out",c:"zs",h:["float"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( u_nodes_texture , vec2 ( zq , NODE_TEX_ROW ) ) ; zr = zt . rgb ; zs = zt . a ;".split(" ")}]},
{a:"node",c:"MAPPING",u:[{a:"node_var",c:"MAPPING_SCALE_DEF",b:["0"]},{a:"node_var",c:"MAPPING_SCALE",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_TRANS_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRANS",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_TRS_MATRIX_DEF",b:["0"]},{a:"node_var",c:"MAPPING_TRS_MATRIX",b:["mat4","(","_1_0",")"]},{a:"node_var",c:"MAPPING_MIN_CLIP_DEF",b:["0"]},{a:"node_var",c:"MAPPING_MIN_CLIP",b:["vec3","(","_0_0",")"]},{a:"node_var",c:"MAPPING_MAX_CLIP_DEF",b:["0"]},
{a:"node_var",c:"MAPPING_MAX_CLIP",b:["vec3","(","_1_0",")"]},{a:"node_var",c:"MAPPING_IS_NORMAL",b:["0"]}],s:[{a:"node_in",c:"zu",h:["vec3"],g:!1},{a:"node_out",c:"zv",h:["vec3"],g:!1}],m:[{a:"txt",b:["zv","=","zu",";"]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_SCALE_DEF"],m:[{a:"txt",b:"zv = zv * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRANS_DEF"],m:[{a:"txt",b:"zv = zv + MAPPING_TRANS ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_TRS_MATRIX_DEF"],
m:[{a:"txt",b:"zv = ( MAPPING_TRS_MATRIX * vec4 ( zv , _1_0 ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MIN_CLIP_DEF"],m:[{a:"txt",b:"zv = max ( zv , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_MAX_CLIP_DEF"],m:[{a:"txt",b:"zv = min ( zv , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAPPING_IS_NORMAL"],m:[{a:"txt",b:"zv = normalize ( zv ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ADD",u:[{a:"node_var",c:"MATH_USE_CLAMP",
b:["0"]}],s:[{a:"node_in",c:"zA",h:["float"],g:!1},{a:"node_in",c:"zB",h:["float"],g:!1},{a:"node_out",c:"zC",h:["float"],g:!1}],m:[{a:"txt",b:"zC = zA + zB ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zC = clamp ( zC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SUBTRACT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zD",h:["float"],g:!1},{a:"node_in",c:"zE",h:["float"],g:!1},{a:"node_out",c:"zF",h:["float"],g:!1}],m:[{a:"txt",b:"zF = zD - zE ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zF = clamp ( zF , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MULTIPLY",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zG",h:["float"],g:!1},{a:"node_in",c:"zH",h:["float"],g:!1},{a:"node_out",c:"zI",h:["float"],g:!1}],m:[{a:"txt",b:"zI = zG * zH ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zI = clamp ( zI , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_DIVIDE",
u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zJ",h:["float"],g:!1},{a:"node_in",c:"zK",h:["float"],g:!1},{a:"node_out",c:"zL",h:["float"],g:!1}],m:[{a:"txt",b:"zL = ( zK != _0_0 ) ? zJ / zK : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zL = clamp ( zL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_SINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zM",h:["float"],g:!1},{a:"node_in",c:"zN",h:["float"],g:!1},
{a:"node_out",c:"zO",h:["float"],g:!1}],m:[{a:"txt",b:"zO = sin ( zM ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zO = clamp ( zO , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zN",";"]}]},{a:"node",c:"MATH_COSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zP",h:["float"],g:!1},{a:"node_in",c:"zQ",h:["float"],g:!1},{a:"node_out",c:"zR",h:["float"],g:!1}],m:[{a:"txt",b:"zR = cos ( zP ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],
m:[{a:"txt",b:"zR = clamp ( zR , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zQ",";"]}]},{a:"node",c:"MATH_TANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zS",h:["float"],g:!1},{a:"node_in",c:"zT",h:["float"],g:!1},{a:"node_out",c:"zU",h:["float"],g:!1}],m:[{a:"txt",b:"zU = tan ( zS ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zU = clamp ( zU , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zT",";"]}]},{a:"node",c:"MATH_ARCSINE",u:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zV",h:["float"],g:!1},{a:"node_in",c:"zW",h:["float"],g:!1},{a:"node_out",c:"zX",h:["float"],g:!1}],m:[{a:"txt",b:"zX = ( zV <= _1_0 && zV >= - _1_0 ) ? asin ( zV ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"zX = clamp ( zX , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zW",";"]}]},{a:"node",c:"MATH_ARCCOSINE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"zY",h:["float"],g:!1},{a:"node_in",
c:"zZ",h:["float"],g:!1},{a:"node_out",c:"z_",h:["float"],g:!1}],m:[{a:"txt",b:"z_ = ( zY <= _1_0 && zY >= - _1_0 ) ? acos ( zY ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"z_ = clamp ( z_ , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["zZ",";"]}]},{a:"node",c:"MATH_ARCTANGENT",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Aa",h:["float"],g:!1},{a:"node_in",c:"Ab",h:["float"],g:!1},{a:"node_out",c:"Ac",h:["float"],g:!1}],m:[{a:"txt",
b:"Ac = atan ( Aa ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ac = clamp ( Ac , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Ab",";"]}]},{a:"node",c:"MATH_POWER",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ad",h:["float"],g:!1},{a:"node_in",c:"Ae",h:["float"],g:!1},{a:"node_out",c:"Af",h:["float"],g:!1}],m:[{a:"txt",b:"if ( Ad < _0_0 && Ae != floor ( Ae ) ) Af = _0_0 ; else if ( Ae == _0_0 ) Af = _1_0 ; else if ( Ad < _0_0 ) Af = mix ( _1_0 , - _1_0 , sign ( mod ( - Ae , 2.0 ) ) ) * pow ( - Ad , Ae ) ; else if ( Ad == _0_0 ) Af = _0_0 ; else Af = pow ( Ad , Ae ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Af = clamp ( Af , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_LOGARITHM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ag",h:["float"],g:!1},{a:"node_in",c:"Ah",h:["float"],g:!1},{a:"node_out",c:"Ai",h:["float"],g:!1}],m:[{a:"txt",b:"Ai = ( Ag > _0_0 && Ah > _0_0 ) ? log2 ( Ag ) / log2 ( Ah ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ai = clamp ( Ai , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MATH_MINIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Aj",h:["float"],g:!1},{a:"node_in",c:"Ak",h:["float"],g:!1},{a:"node_out",c:"Al",h:["float"],g:!1}],m:[{a:"txt",b:"Al = min ( Aj , Ak ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Al = clamp ( Al , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MAXIMUM",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Am",h:["float"],g:!1},{a:"node_in",c:"An",h:["float"],
g:!1},{a:"node_out",c:"Ao",h:["float"],g:!1}],m:[{a:"txt",b:"Ao = max ( Am , An ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ao = clamp ( Ao , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ROUND",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ap",h:["float"],g:!1},{a:"node_in",c:"Aq",h:["float"],g:!1},{a:"node_out",c:"Ar",h:["float"],g:!1}],m:[{a:"txt",b:"Ar = floor ( Ap + _0_5 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],
m:[{a:"txt",b:"Ar = clamp ( Ar , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["Aq",";"]}]},{a:"node",c:"MATH_LESS_THAN",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"As",h:["float"],g:!1},{a:"node_in",c:"At",h:["float"],g:!1},{a:"node_out",c:"Au",h:["float"],g:!1}],m:[{a:"txt",b:"Au = ( As < At ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Au = clamp ( Au , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_GREATER_THAN",u:[{a:"node_var",
c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Av",h:["float"],g:!1},{a:"node_in",c:"Aw",h:["float"],g:!1},{a:"node_out",c:"Ax",h:["float"],g:!1}],m:[{a:"txt",b:"Ax = ( Av > Aw ) ? _1_0 : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"Ax = clamp ( Ax , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_MODULO",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Ay",h:["float"],g:!1},{a:"node_in",c:"Az",h:["float"],g:!1},{a:"node_out",c:"AA",
h:["float"],g:!1}],m:[{a:"txt",b:"AA = abs ( Az ) > 0.000001 ? mod ( Ay , Az ) : _0_0 ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],m:[{a:"txt",b:"AA = clamp ( AA , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATH_ABSOLUTE",u:[{a:"node_var",c:"MATH_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AB",h:["float"],g:!1},{a:"node_in",c:"AC",h:["float"],g:!1},{a:"node_out",c:"AD",h:["float"],g:!1}],m:[{a:"txt",b:"AD = abs ( AB ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MATH_USE_CLAMP"],
m:[{a:"txt",b:"AD = clamp ( AD , _0_0 , _1_0 ) ;".split(" ")}]}]},{a:"txt",b:["AC",";"]}]},{a:"node",c:"MIX_RGB_MIX",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AE",h:["float"],g:!1},{a:"node_in",c:"AF",h:["vec3"],g:!1},{a:"node_in",c:"AG",h:["vec3"],g:!1},{a:"node_out",c:"AH",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AE , _0_0 , _1_0 ) ; AH = mix ( AF , AG , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AH = clamp ( AH , _0_0 , _1_0 ) ;".split(" ")}]}]}]},
{a:"node",c:"MIX_RGB_ADD",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AI",h:["float"],g:!1},{a:"node_in",c:"AJ",h:["vec3"],g:!1},{a:"node_in",c:"AK",h:["vec3"],g:!1},{a:"node_out",c:"AL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AI , _0_0 , _1_0 ) ; AL = mix ( AJ , AJ + AK , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AL = clamp ( AL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_MULTIPLY",u:[{a:"node_var",
c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AM",h:["float"],g:!1},{a:"node_in",c:"AN",h:["vec3"],g:!1},{a:"node_in",c:"AO",h:["vec3"],g:!1},{a:"node_out",c:"AP",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AM , _0_0 , _1_0 ) ; AP = mix ( AN , AN * AO , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AP = clamp ( AP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SUBTRACT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",
c:"AQ",h:["float"],g:!1},{a:"node_in",c:"AR",h:["vec3"],g:!1},{a:"node_in",c:"AS",h:["vec3"],g:!1},{a:"node_out",c:"AT",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AQ , _0_0 , _1_0 ) ; AT = mix ( AR , AR - AS , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AT = clamp ( AT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SCREEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AU",h:["float"],g:!1},{a:"node_in",c:"AV",
h:["vec3"],g:!1},{a:"node_in",c:"AW",h:["vec3"],g:!1},{a:"node_out",c:"AX",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AU , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; AX = vec3 ( _1_0 ) - ( vec3 ( AY ) + yl * ( vec3 ( _1_0 ) - AW ) ) * ( vec3 ( _1_0 ) - AV ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"AX = clamp ( AX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIVIDE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"AZ",
h:["float"],g:!1},{a:"node_in",c:"A_",h:["vec3"],g:!1},{a:"node_in",c:"Ba",h:["vec3"],g:!1},{a:"node_out",c:"Bb",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( AZ , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; Ba += step ( Ba , vec3 ( _0_0 ) ) ; Bb = AY * A_ + yl * A_ / Ba ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bb = clamp ( Bb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DIFFERENCE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",
c:"Bc",h:["float"],g:!1},{a:"node_in",c:"Bd",h:["vec3"],g:!1},{a:"node_in",c:"Be",h:["vec3"],g:!1},{a:"node_out",c:"Bf",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bc , _0_0 , _1_0 ) ; Bf = mix ( Bd , abs ( Bd - Be ) , yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bf = clamp ( Bf , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DARKEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bg",h:["float"],g:!1},{a:"node_in",
c:"Bh",h:["vec3"],g:!1},{a:"node_in",c:"Bi",h:["vec3"],g:!1},{a:"node_out",c:"Bj",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bg , _0_0 , _1_0 ) ; Bj = min ( Bh . rgb , Bi . rgb * yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bj = clamp ( Bj , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LIGHTEN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bk",h:["float"],g:!1},{a:"node_in",c:"Bl",h:["vec3"],g:!1},{a:"node_in",
c:"Bm",h:["vec3"],g:!1},{a:"node_out",c:"Bn",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bk , _0_0 , _1_0 ) ; Bn = max ( Bl . rgb , Bm . rgb * yl ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bn = clamp ( Bn , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_OVERLAY",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bo",h:["float"],g:!1},{a:"node_in",c:"Bp",h:["vec3"],g:!1},{a:"node_in",c:"Bq",h:["vec3"],g:!1},{a:"node_out",
c:"Br",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bo , _0_0 , _1_0 ) ; vec3 Bs = vec3 ( _1_0 - yl ) ; Br = mix ( Bp * ( Bs + 2.0 * yl * Bq ) , vec3 ( _1_0 ) - ( Bs + 2.0 * yl * ( vec3 ( _1_0 ) - Bq ) ) * ( vec3 ( _1_0 ) - Bp ) , step ( _0_5 , Bp ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Br = clamp ( Br , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_DODGE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bt",h:["float"],
g:!1},{a:"node_in",c:"Bu",h:["vec3"],g:!1},{a:"node_in",c:"Bv",h:["vec3"],g:!1},{a:"node_out",c:"Bw",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bt , _0_0 , _1_0 ) ; vec3 Bx = vec3 ( _1_0 ) - yl * Bv ; vec3 By = clamp ( Bu / Bx , _0_0 , _1_0 ) ; Bw = mix ( mix ( By , vec3 ( _1_0 ) , step ( Bx , vec3 ( _0_0 ) ) ) , Bu , step ( Bu , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Bw = clamp ( Bw , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",
c:"MIX_RGB_BURN",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"Bz",h:["float"],g:!1},{a:"node_in",c:"BA",h:["vec3"],g:!1},{a:"node_in",c:"BB",h:["vec3"],g:!1},{a:"node_out",c:"BC",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( Bz , _0_0 , _1_0 ) ; vec3 jH = vec3 ( _1_0 - yl ) ; vec3 Bx = jH + yl * BB ; vec3 By = clamp ( vec3 ( _1_0 ) - ( vec3 ( _1_0 ) - BA ) / Bx , _0_0 , _1_0 ) ; BC = mix ( By , vec3 ( _0_0 ) , step ( Bx , vec3 ( _0_0 ) ) ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BC = clamp ( BC , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_HUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BD",h:["float"],g:!1},{a:"node_in",c:"BE",h:["vec3"],g:!1},{a:"node_in",c:"BF",h:["vec3"],g:!1},{a:"node_out",c:"BG",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BD , _0_0 , _1_0 ) ; vec3 jz , BH , Bx ; BG = BE ; BH = jy ( BF ) ; if ( BH . y != _0_0 ) { jz = jy ( BG ) ; jz . x = BH . x ; Bx = jA ( jz ) ; BG = mix ( BG , Bx , yl ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BG = clamp ( BG , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SATURATION",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BI",h:["float"],g:!1},{a:"node_in",c:"BJ",h:["vec3"],g:!1},{a:"node_in",c:"BK",h:["vec3"],g:!1},{a:"node_out",c:"BL",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BI , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; BL = BJ ; vec3 jz , BH ; jz = jy ( BL ) ; if ( jz . y != _0_0 ) { BH = jy ( BK ) ; jz . y = AY * jz . y + yl * BH . y ; BL = jA ( jz ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BL = clamp ( BL , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_VALUE",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BM",h:["float"],g:!1},{a:"node_in",c:"BN",h:["vec3"],g:!1},{a:"node_in",c:"BO",h:["vec3"],g:!1},{a:"node_out",c:"BP",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BM , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; vec3 jz , BH ; jz = jy ( BN ) ; BH = jy ( BO ) ; jz . z = AY * jz . z + yl * BH . z ; BP = jA ( jz ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BP = clamp ( BP , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_COLOR",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BQ",h:["float"],g:!1},{a:"node_in",c:"BR",h:["vec3"],g:!1},{a:"node_in",c:"BS",h:["vec3"],g:!1},{a:"node_out",c:"BT",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BQ , _0_0 , _1_0 ) ; vec3 jz , BH , Bx ; BT = BR ; BH = jy ( BS ) ; if ( BH . y != _0_0 ) { jz = jy ( BT ) ; jz . x = BH . x ; jz . y = BH . y ; Bx = jA ( jz ) ; BT = mix ( BT , Bx , yl ) ; }".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BT = clamp ( BT , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_SOFT_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BU",h:["float"],g:!1},{a:"node_in",c:"BV",h:["vec3"],g:!1},{a:"node_in",c:"BW",h:["vec3"],g:!1},{a:"node_out",c:"BX",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BU , _0_0 , _1_0 ) ; float AY = _1_0 - yl ; vec3 BY = BW + BV - BW * BV ; BX = BV * ( vec3 ( AY ) + vec3 ( yl ) * ( ( vec3 ( _1_0 ) - BV ) * BW + BY ) ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"BX = clamp ( BX , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MIX_RGB_LINEAR_LIGHT",u:[{a:"node_var",c:"MIX_RGB_USE_CLAMP",b:["0"]}],s:[{a:"node_in",c:"BZ",h:["float"],g:!1},{a:"node_in",c:"B_",h:["vec3"],g:!1},{a:"node_in",c:"Ca",h:["vec3"],g:!1},{a:"node_out",c:"Cb",h:["vec3"],g:!1}],m:[{a:"txt",b:"float yl = clamp ( BZ , _0_0 , _1_0 ) ; Cb = B_ + yl * ( 2.0 * Ca - vec3 ( _1_0 ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",
i:["MIX_RGB_USE_CLAMP"],m:[{a:"txt",b:"Cb = clamp ( Cb , _0_0 , _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"OUTPUT",u:[],s:[{a:"node_in",c:"Cc",h:["vec3"],g:!1},{a:"node_in",c:"Cd",h:["float"],g:!1}],m:[{a:"txt",b:"D = Cc ; H = Cd ;".split(" ")}]},{a:"node",c:"OUTPUT_SURFACE",u:[],s:[{a:"node_in",c:"Ce",h:["vec3"],g:!1}],m:[{a:"txt",b:"D = Ce ; H = _1_0 ;".split(" ")}]},{a:"node",c:"MATERIAL_BEGIN",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_NORMAL",b:["0"]},{a:"node_var",
c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"SHADELESS_MAT",b:["0"]}],s:[{a:"node_in",c:"Cf",h:["vec3"],g:!1},{a:"node_in",c:"Cg",h:["vec3"],g:!1},{a:"node_in",c:"Ch",h:["float"],g:!1},{a:"node_in",c:"Ci",h:["vec3"],g:!0},{a:"node_in",c:"Cj",h:["float"],g:!0},{a:"node_out",c:"Ck",h:["vec3"],g:!1},{a:"node_out",c:"Cl",h:["vec3"],g:!1},{a:"node_out",c:"Cm",h:["vec3"],g:!1},{a:"node_out",c:"Cn",h:["vec3"],g:!1},{a:"node_out",c:"Co",h:["vec3"],g:!1},{a:"node_out",c:"Cp",h:["vec2"],g:!1},{a:"node_out",
c:"Cq",h:["vec2"],g:!1},{a:"node_out",c:"Cr",h:["vec4"],g:!1},{a:"node_param",c:"rh",h:["const","vec2"],g:!0},{a:"node_param",c:"ri",h:["const","vec3"],g:!1}],m:[{a:"txt",b:"Cm = clamp ( Cf , _0_0 , _1_0 ) ; Cn = ri [ 0 ] * clamp ( Cg , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_NORMAL"],m:[{a:"txt",b:"Co = normalize ( Ci ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:["Co","=","nH",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["SHADELESS_MAT",{a:"logic_negative_expr",
l:1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"txt",b:"Ck = Cj * Cm ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Ck = ro * Cm ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:["Cm","*=","Ch",";"]}]}]},{a:"txt",b:"Cl = rp * u_environment_energy * ce ( Co ) ; Cr = vec4 ( _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NUM_LIGHTS",0,{a:"g_expr",l:2}],m:[{a:"txt",b:"Cp = vec2 ( rh [ 0 ] , rh [ 1 ] ) ; Cq = vec2 ( ri [ 1 ] , ri [ 2 ] ) ;".split(" ")}]}]},
{a:"txt",b:["G","=","Cr",";"]}]},{a:"node_else",m:[{a:"txt",b:"Ck = vec3 ( _0_0 ) ; Cl = vec3 ( _1_0 ) ;".split(" ")}]}]}]},{a:"node",c:"MATERIAL_END",u:[{a:"node_var",c:"MATERIAL_EXT",b:["0"]},{a:"node_var",c:"USE_MATERIAL_DIFFUSE",b:["0"]},{a:"node_var",c:"USE_MATERIAL_SPECULAR",b:["0"]}],s:[{a:"node_in",c:"Cs",h:["vec4"],g:!1},{a:"node_in",c:"Ct",h:["vec3"],g:!1},{a:"node_in",c:"Cu",h:["vec3"],g:!1},{a:"node_in",c:"Cv",h:["float"],g:!0},{a:"node_in",c:"Cw",h:["float"],g:!0},{a:"node_in",c:"Cx",
h:["float"],g:!0},{a:"node_out",c:"Cy",h:["vec3"],g:!0},{a:"node_out",c:"Cz",h:["float"],g:!0},{a:"node_out",c:"CA",h:["vec3"],g:!0},{a:"node_out",c:"CB",h:["vec3"],g:!0},{a:"node_out",c:"CC",h:["vec3"],g:!0},{a:"node_param",c:"rj",h:["float"],g:!1},{a:"node_param",c:"rk",h:["float"],g:!1}],m:[{a:"txt",b:["Cv",";"]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cy"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_DIFFUSE"],m:[{a:"txt",b:"Cy = Cs . rgb ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"Cy = vec3 ( _0_0 ) ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["Cy","+=","Ct",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CA"],m:[{a:"txt",b:["CA","=","Cu",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["MATERIAL_EXT"],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CB"],m:[{a:"txt",b:"CB = Cs . rgb ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CC"],m:[{a:"txt",b:["CC","=","Ct",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cz"],m:[{a:"txt",b:"Cz = clamp ( Cx , _0_0 , _1_0 ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( Ct . r , Ct . g ) , Ct . b ) * Cw ; Cz = clamp ( Cx * ( _1_0 - t ) + t , _0_0 , _1_0 ) ;".split(" ")}]}]}]}]}]},{a:"node_else",m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Cz"],m:[{a:"txt",b:"Cz = clamp ( rj , _0_0 , _1_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:"float t = max ( max ( Ct . r , Ct . g ) , Ct . b ) * rk ; Cz = rj * ( _1_0 - t ) + t ;".split(" ")}]}]}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_MATERIAL_SPECULAR"],m:[{a:"txt",b:["E","=","Ct",";"]}]},{a:"node_else",m:[{a:"txt",b:"E = vec3 ( _0_0 ) ;".split(" ")}]}]},{a:"txt",b:["F","=","Cu",";"]}]},{a:"node",c:"LIGHTING_AMBIENT",u:[],s:[{a:"node_in",c:"nZ",h:["vec3"],g:!1},{a:"node_in",c:"n_",h:["vec3"],g:!1},{a:"node_in",c:"oa",h:["vec3"],g:!1},{a:"node_out",c:"ob",h:["vec4"],g:!1},{a:"node_out",c:"oc",h:["vec3"],g:!1}],m:[{a:"txt",b:"ob = vec4 ( nZ + oa * n_ , _0_0 ) ; oc = vec3 ( _0_0 ) ;".split(" ")}]},
{a:"node",c:"LIGHTING_LAMP",u:[{a:"node_var",c:"LAMP_TYPE",b:["HEMI"]},{a:"node_var",c:"LAMP_IND",b:["0"]},{a:"node_var",c:"LAMP_SPOT_SIZE",b:["0.8"]},{a:"node_var",c:"LAMP_SPOT_BLEND",b:["0.03"]},{a:"node_var",c:"LAMP_LIGHT_DIST",b:["30.0"]},{a:"node_var",c:"LAMP_SHADOW_MAP_IND",b:["-","1"]}],s:[{a:"node_in",c:"od",h:["vec4"],g:!1},{a:"node_out",c:"oe",h:["vec3"],g:!1},{a:"node_out",c:"of",h:["vec2"],g:!1},{a:"node_out",c:"og",h:["vec3"],g:!1},{a:"node_out",c:"oh",h:["float"],g:!1}],m:[{a:"txt",
b:"of = vec2 ( u_light_positions [ LAMP_IND ] . w , u_light_color_intensities [ LAMP_IND ] . w ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","HEMI",{a:"equal_expr",l:2}],m:[{a:"txt",b:["oh","=","_0_5",";"]}]},{a:"node_else",m:[{a:"txt",b:["oh","=","_0_0",";"]}]}]},{a:"txt",b:"og = u_light_color_intensities [ LAMP_IND ] . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",l:1},{a:"non_equal_expr",l:2}],m:[{a:"txt",b:"og *= od [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},
{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2},"LAMP_TYPE","POINT",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],m:[{a:"txt",b:"vec3 oi = u_light_positions [ LAMP_IND ] . xyz ; oe = oi - nG ; float aC = length ( oe ) ; og *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + aC * aC ) ; oe = normalize ( oe ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["LAMP_TYPE","SPOT",{a:"equal_expr",l:2}],m:[{a:"txt",b:"vec3 ok = u_light_directions [ LAMP_IND ] ; float ol = dot ( oe , ok ) ; ol *= smoothstep ( _0_0 , _1_0 , ( ol - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; og *= ol ;".split(" ")}]}]}]},
{a:"node_else",m:[{a:"txt",b:"oe = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",c:"DIFFUSE_FRESNEL",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"om",h:["vec3"],g:!1},{a:"node_in",c:"on",h:["vec2"],g:!1},{a:"node_in",c:"oo",h:["vec3"],g:!1},{a:"node_in",c:"op",h:["float"],g:!1},{a:"node_in",c:"oq",h:["vec2"],g:!1},{a:"node_out",c:"or",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( om , k . xyz ) ; oo = cross ( os , k . xyz ) ; oo = - normalize ( oo ) ;".split(" ")}]}]},
{a:"txt",b:"or = _0_0 ; if ( on . r != _0_0 ) { float ot = ( _1_0 - op ) * dot ( oo , om ) + op ; if ( oq [ 0 ] == _0_0 ) { or = _1_0 ; } else { float t = _1_0 + abs ( ot ) ; t = oq [ 1 ] + ( _1_0 - oq [ 1 ] ) * pow ( t , oq [ 0 ] ) ; or = clamp ( t , _0_0 , _1_0 ) ; } or = max ( or , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_LAMBERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ou",h:["vec3"],g:!1},{a:"node_in",c:"ov",h:["vec2"],g:!1},{a:"node_in",c:"ow",h:["vec3"],
g:!1},{a:"node_in",c:"ox",h:["float"],g:!1},{a:"node_out",c:"oy",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( ou , k . xyz ) ; ow = cross ( os , k . xyz ) ; ow = - normalize ( ow ) ;".split(" ")}]}]},{a:"txt",b:"oy = _0_0 ; if ( ov . r != _0_0 ) { float ot = ( _1_0 - ox ) * dot ( ow , ou ) + ox ; oy = max ( ot , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_OREN_NAYAR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",
c:"oz",h:["vec3"],g:!1},{a:"node_in",c:"oA",h:["vec2"],g:!1},{a:"node_in",c:"oB",h:["vec3"],g:!1},{a:"node_in",c:"oC",h:["float"],g:!1},{a:"node_in",c:"oD",h:["vec2"],g:!1},{a:"node_out",c:"oE",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oz , k . xyz ) ; oB = cross ( os , k . xyz ) ; oB = - normalize ( oB ) ;".split(" ")}]}]},{a:"txt",b:"oE = _0_0 ; if ( oA . r != _0_0 ) { float ot = ( _1_0 - oC ) * dot ( oB , oz ) + oC ; if ( oD [ 0 ] > _0_0 ) { float oF = max ( dot ( oB , nI ) , _0_0 ) ; float oG = oD [ 0 ] * oD [ 0 ] ; float cg = _1_0 - _0_5 * ( oG / ( oG + 0.33 ) ) ; vec3 oH = oz - ot * oB ; vec3 oI = nI - oF * oB ; if ( length ( oH ) == _0_0 || length ( oI ) == _0_0 || abs ( ot ) > _1_0 || abs ( oF ) > _1_0 ) oE = ot * cg ; else { float oJ = acos ( ot ) ; float oK = acos ( oF ) ; vec3 oL = normalize ( oH ) ; vec3 oM = normalize ( oI ) ; float a , b ; a = max ( oJ , oK ) ; b = min ( oJ , oK ) ; b *= 0.95 ; float t = max ( dot ( oL , oM ) , _0_0 ) ; float oN = 0.45 * ( oG / ( oG + 0.09 ) ) ; oE = ot * ( cg + ( oN * t * sin ( a ) * tan ( b ) ) ) ; } } else oE = ot ; oE = max ( oE , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"DIFFUSE_MINNAERT",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oO",h:["vec3"],g:!1},{a:"node_in",c:"oP",h:["vec2"],g:!1},{a:"node_in",c:"oQ",h:["vec3"],g:!1},{a:"node_in",c:"oR",h:["float"],g:!1},{a:"node_in",c:"oS",h:["vec2"],g:!1},{a:"node_out",c:"oT",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oO , k . xyz ) ; oQ = cross ( os , k . xyz ) ; oQ = - normalize ( oQ ) ;".split(" ")}]}]},{a:"txt",
b:"oT = _0_0 ; if ( oP . r != _0_0 ) { float ot = ( _1_0 - oR ) * dot ( oQ , oO ) + oR ; float oF = max ( dot ( oQ , nI ) , _0_0 ) ; if ( oS [ 0 ] <= _1_0 ) oT = ot * pow ( max ( oF * ot , 0.1 ) , oS [ 0 ] - _1_0 ) ; else oT = ot * pow ( 1.0001 - oF , oS [ 0 ] - _1_0 ) ; oT = max ( oT , _0_0 ) ; }".split(" ")}]},{a:"node",c:"DIFFUSE_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"oU",h:["vec3"],g:!1},{a:"node_in",c:"oV",h:["vec2"],g:!1},{a:"node_in",c:"oW",h:["vec3"],g:!1},
{a:"node_in",c:"oX",h:["float"],g:!1},{a:"node_in",c:"oY",h:["vec2"],g:!1},{a:"node_out",c:"oZ",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"vec3 os = cross ( oU , k . xyz ) ; oW = cross ( os , k . xyz ) ; oW = - normalize ( oW ) ;".split(" ")}]}]},{a:"txt",b:"oZ = _0_0 ; if ( oV . r != _0_0 ) { float ot = ( _1_0 - oX ) * dot ( oW , oU ) + oX ; float o_ = acos ( ot ) ; if ( o_ < oY [ 0 ] ) oZ = _1_0 ; else if ( o_ > ( oY [ 0 ] + oY [ 1 ] ) || oY [ 1 ] == _0_0 ) oZ = _0_0 ; else oZ = _1_0 - ( ( o_ - oY [ 0 ] ) / oY [ 1 ] ) ; oZ = max ( oZ , _0_0 ) ; }".split(" ")}]},
{a:"node",c:"SPECULAR_PHONG",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pa",h:["vec3"],g:!1},{a:"node_in",c:"pb",h:["vec2"],g:!1},{a:"node_in",c:"pc",h:["vec3"],g:!1},{a:"node_in",c:"pd",h:["float"],g:!1},{a:"node_in",c:"pe",h:["vec2"],g:!1},{a:"node_out",c:"pf",h:["float"],g:!1}],m:[{a:"txt",b:"pf = _0_0 ; if ( pb . g == _1_0 ) { vec3 pg = normalize ( pa + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pd == _0_0 ) { pf = dot ( k . xyz , pg ) ; pf = sqrt ( _1_0 - pf * pf ) ; }".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"pf = ( _1_0 - pd ) * max ( dot ( pc , pg ) , _0_0 ) + pd ;".split(" ")}]}]},{a:"txt",b:"pf = pow ( pf , pe [ 0 ] ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_COOKTORR",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"ph",h:["vec3"],g:!1},{a:"node_in",c:"pi",h:["vec2"],g:!1},{a:"node_in",c:"pj",h:["vec3"],g:!1},{a:"node_in",c:"pk",h:["float"],g:!1},{a:"node_in",c:"pl",h:["vec2"],g:!1},{a:"node_out",c:"pm",h:["float"],g:!1}],m:[{a:"txt",b:"pm = _0_0 ; if ( pi . g != _0_0 ) { vec3 pg = normalize ( ph + nI ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"if ( pk == _0_0 ) { pm = dot ( B . xyz , pg ) ; pm = sqrt ( _1_0 - pm * pm ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"pm = max ( dot ( pj , pg ) , _0_0 ) ; pm = ( _1_0 - pk ) * pm + pk ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float oF = max ( dot ( B . xyz , nI ) , _0_0 ) ; oF = sqrt ( _1_0 - oF * oF ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float oF = max ( dot ( pj , nI ) , _0_0 ) ;".split(" ")}]}]},
{a:"txt",b:"pm = pow ( pm , pl [ 0 ] ) ; pm = pm / ( 0.1 + oF ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_WARDISO",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pn",h:["vec3"],g:!1},{a:"node_in",c:"po",h:["vec2"],g:!1},{a:"node_in",c:"pr",h:["vec3"],g:!1},{a:"node_in",c:"pu",h:["float"],g:!1},{a:"node_in",c:"pv",h:["vec2"],g:!1},{a:"node_out",c:"pw",h:["float"],g:!1}],m:[{a:"txt",b:"pw = _0_0 ; if ( po . g == _1_0 ) { vec3 pg = normalize ( pn + nI ) ;".split(" ")},{a:"node_cond",
f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = _0_0 ; float oF = _0_0 ; float py = _0_0 ; if ( pu == _0_0 ) { px = dot ( k . xyz , pg ) ; oF = dot ( k . xyz , nI ) ; py = dot ( k . xyz , pn ) ; px = sqrt ( _1_0 - px * px ) ; oF = sqrt ( _1_0 - oF * oF ) ; py = sqrt ( _1_0 - py * py ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = max ( dot ( pr , pg ) , 0.01 ) ; float oF = max ( dot ( pr , nI ) , 0.01 ) ; float py = max ( dot ( pr , pn ) , 0.01 ) ;".split(" ")}]}]},
{a:"txt",b:"float bm = tan ( acos ( px ) ) ; float J = max ( pv [ 0 ] , 0.01 ) ; pw = py * ( _1_0 / ( 4.0 * M_PI * J * J ) ) * ( exp ( - ( bm * bm ) / ( J * J ) ) / ( sqrt ( oF * py ) ) ) ; }".split(" ")}]},{a:"node",c:"SPECULAR_TOON",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pz",h:["vec3"],g:!1},{a:"node_in",c:"pA",h:["vec2"],g:!1},{a:"node_in",c:"pB",h:["vec3"],g:!1},{a:"node_in",c:"pC",h:["float"],g:!1},{a:"node_in",c:"pD",h:["vec2"],g:!1},{a:"node_out",c:"pE",h:["float"],
g:!1}],m:[{a:"txt",b:"pE = _0_0 ; if ( pA . g == _1_0 ) { vec3 bO = normalize ( pz + nI ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float pF = dot ( bO , k . xyz ) ; float bm = pD [ 0 ] + pD [ 1 ] ; if ( pC == _0_0 ) bm = acos ( sqrt ( _1_0 - pF * pF ) ) ;".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float bm = acos ( dot ( bO , pB ) ) ;".split(" ")}]}]},{a:"txt",b:"if ( bm < pD [ 0 ] ) pE = _1_0 ; else if ( bm >= pD [ 0 ] + pD [ 1 ] || pD [ 1 ] == _0_0 ) pE = _0_0 ; else pE = _1_0 - ( bm - pD [ 0 ] ) / pD [ 1 ] ; }".split(" ")}]},
{a:"node",c:"SPECULAR_BLINN",u:[{a:"node_var",c:"MAT_USE_TBN_SHADING",b:["0"]}],s:[{a:"node_in",c:"pG",h:["vec3"],g:!1},{a:"node_in",c:"pH",h:["vec2"],g:!1},{a:"node_in",c:"pI",h:["vec3"],g:!1},{a:"node_in",c:"pJ",h:["float"],g:!1},{a:"node_in",c:"pK",h:["vec2"],g:!1},{a:"node_out",c:"pL",h:["float"],g:!1}],m:[{a:"txt",b:"pL = _0_0 ; if ( pH . g == _1_0 ) { if ( pK [ 0 ] < _1_0 || pK [ 1 ] == _0_0 ) pL = _0_0 ; else { if ( pK [ 1 ] < 100.0 ) pK [ 1 ] = sqrt ( _1_0 / pK [ 1 ] ) ; else pK [ 1 ] = 10.0 / pK [ 1 ] ; vec3 pg = normalize ( nI + pG ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["MAT_USE_TBN_SHADING"],m:[{a:"txt",b:"float px = _0_0 ; if ( pJ == _0_0 ) { float pO = dot ( k . xyz , pg ) ; px = sqrt ( _1_0 - pO * pO ) ; }".split(" ")}]},{a:"node_else",m:[{a:"txt",b:"float px = ( _1_0 - pJ ) * max ( dot ( pI , pg ) , _0_0 ) + pJ ;".split(" ")}]}]},{a:"txt",b:"if ( px < _0_0 ) pL = _0_0 ; else { float oF = max ( dot ( pI , nI ) , 0.01 ) ; float py = dot ( pI , pG ) ; if ( py <= 0.01 ) pL = _0_0 ; else { float pP = max ( dot ( nI , pg ) , 0.01 ) ; float a = _1_0 ; float b = ( 2.0 * px * oF ) / pP ; float da = ( 2.0 * px * py ) / pP ; float g = min ( min ( a , b ) , da ) ; float p = sqrt ( pow ( pK [ 0 ] , 2.0 ) + pow ( pP , 2.0 ) - _1_0 ) ; float lw = pow ( p - pP , 2.0 ) / pow ( p + pP , 2.0 ) * ( _1_0 + pow ( pP * ( p + pP ) - _1_0 , 2.0 ) / pow ( pP * ( p - pP ) + _1_0 , 2.0 ) ) ; float o_ = acos ( px ) ; pL = max ( lw * g * exp ( - pow ( o_ , 2.0 ) / ( 2.0 * pow ( pK [ 1 ] , 2.0 ) ) ) , _0_0 ) ; } } } }".split(" ")}]},
{a:"node",c:"LIGHTING_APPLY",u:[],s:[{a:"node_in",c:"pQ",h:["vec4"],g:!1},{a:"node_in",c:"pR",h:["vec3"],g:!1},{a:"node_in",c:"pS",h:["float"],g:!1},{a:"node_in",c:"pT",h:["float"],g:!1},{a:"node_in",c:"pU",h:["vec3"],g:!1},{a:"node_in",c:"pV",h:["vec3"],g:!1},{a:"node_in",c:"pW",h:["vec4"],g:!1},{a:"node_in",c:"pX",h:["vec3"],g:!1},{a:"node_in",c:"pY",h:["vec3"],g:!1},{a:"node_in",c:"pZ",h:["vec3"],g:!1},{a:"node_in",c:"p_",h:["float"],g:!1},{a:"node_out",c:"qa",h:["vec4"],g:!1},{a:"node_out",c:"qb",
h:["vec3"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_NODE_B4W_TRANSLUCENCY"],m:[{a:"txt",b:"if ( dot ( pU , pV ) * dot ( nI , pV ) < _0_0 ) { float CD = pW . x ; float CE = pW . y ; float CF = pW . z ; float CG = pW . w ; float CH = clamp ( abs ( dot ( pU , pV ) ) , _0_0 , _1_0 ) ; float CI = clamp ( dot ( nI , - pU ) , _0_0 , _1_0 ) ; float CJ = pow ( CI , CE ) ; qa = pQ + p_ * vec4 ( pZ * CH * pow ( pX , vec3 ( CD ) ) , _1_0 ) ; qa += CF * mix ( vec4 ( pX , _1_0 ) , vec4 ( _1_0 ) , CG ) * p_ * vec4 ( pZ * CH * vec3 ( CJ ) , _1_0 ) ; qb = pR ; } else { qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ; }".split(" ")}]},
{a:"node_else",m:[{a:"txt",b:"qb = pR + pZ * pY * pT ; qa = pQ + vec4 ( pZ * pX * pS , pT ) ;".split(" ")}]}]}]},{a:"node",c:"RGB",u:[{a:"node_var",c:"RGB_IND",b:["0"]}],s:[{a:"node_out",c:"CK",h:["vec3"],g:!1}],m:[{a:"txt",b:"CK = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},{a:"node",c:"RGBTOBW",u:[],s:[{a:"node_in",c:"CL",h:["vec3"],g:!1},{a:"node_out",c:"CM",h:["float"],g:!1}],m:[{a:"txt",b:"CM = dot ( CL , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",c:"SEPRGB",u:[],s:[{a:"node_in",c:"CN",
h:["vec3"],g:!1},{a:"node_out",c:"CO",h:["float"],g:!0},{a:"node_out",c:"CP",h:["float"],g:!0},{a:"node_out",c:"CQ",h:["float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CO"],m:[{a:"txt",b:"CO = CN . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CP"],m:[{a:"txt",b:"CP = CN . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CQ"],m:[{a:"txt",b:"CQ = CN . b ;".split(" ")}]}]}]},{a:"node",c:"SEPHSV",u:[],s:[{a:"node_in",c:"CR",h:["vec3"],g:!1},{a:"node_out",
c:"CS",h:["float"],g:!0},{a:"node_out",c:"CT",h:["float"],g:!0},{a:"node_out",c:"CU",h:["float"],g:!0}],m:[{a:"txt",b:"vec3 CV = jy ( CR ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CS"],m:[{a:"txt",b:"CS = CV . r ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CT"],m:[{a:"txt",b:"CT = CV . g ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_CU"],m:[{a:"txt",b:"CU = CV . b ;".split(" ")}]}]}]},{a:"node",c:"SQUEEZE",u:[],s:[{a:"node_in",c:"CW",h:["float"],g:!1},
{a:"node_in",c:"CX",h:["float"],g:!1},{a:"node_in",c:"CY",h:["float"],g:!1},{a:"node_out",c:"CZ",h:["float"],g:!1}],m:[{a:"txt",b:"CZ = _1_0 / ( _1_0 + pow ( 2.71828183 , - ( CW - CY ) * CX ) ) ;".split(" ")}]},{a:"node",c:"GAMMA",u:[],s:[{a:"node_in",c:"C_",h:["vec3"],g:!1},{a:"node_in",c:"Da",h:["float"],g:!1},{a:"node_out",c:"Db",h:["vec3"],g:!1}],m:[{a:"txt",b:"Db = C_ ; if ( Db . x > _0_0 ) Db . x = pow ( C_ . x , Da ) ; if ( Db . y > _0_0 ) Db . y = pow ( C_ . y , Da ) ; if ( Db . z > _0_0 ) Db . z = pow ( C_ . z , Da ) ;".split(" ")}]},
{a:"node",c:"B4W_SRGB_TO_LINEAR",u:[],s:[{a:"node_in",c:"Dc",h:["vec3"],g:!1},{a:"node_out",c:"Dd",h:["vec3"],g:!1}],m:[{a:"txt",b:"Dd = max ( vec3 ( _0_0 ) , Dc ) ; Dd = pow ( Dd , vec3 ( 2.2 ) ) ;".split(" ")}]},{a:"node",c:"B4W_LINEAR_TO_SRGB",u:[],s:[{a:"node_in",c:"De",h:["vec3"],g:!1},{a:"node_out",c:"Df",h:["vec3"],g:!1}],m:[{a:"txt",b:"Df = max ( vec3 ( _0_0 ) , De ) ; Df = pow ( Df , vec3 ( _1_0 / 2.2 ) ) ;".split(" ")}]},{a:"node",c:"TEXTURE_EMPTY",u:[],s:[{a:"node_out",c:"Dg",h:["vec3"],
g:!1},{a:"node_out",c:"Dh",h:["vec3"],g:!1},{a:"node_out",c:"Di",h:["float"],g:!1}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dg"],m:[{a:"txt",b:"Dg [ 2 ] = Dg [ 1 ] = Dg [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dh"],m:[{a:"txt",b:"Dh [ 2 ] = Dh [ 1 ] = Dh [ 0 ] = _0_0 ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Di"],m:[{a:"txt",b:["Di","=","_0_0",";"]}]}]}]},{a:"node",c:"TEXTURE_ENVIRONMENT",u:[],s:[{a:"node_in",c:"Dj",h:["vec3"],g:!1},{a:"node_out",
c:"Dk",h:["vec3"],g:!0},{a:"node_out",c:"Dl",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_ENVIRONMENT_var_texture",h:["uniform","samplerCube"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , Dj ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dk"],m:[{a:"txt",b:"Dk = zt . xyz ; bY ( Dk ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dl"],m:[{a:"txt",b:"Dl = zt . w ;".split(" ")}]}]}]},{a:"node",c:"TEXTURE_COLOR",u:[{a:"node_var",
c:"NON_COLOR",b:["0"]},{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"Dn",h:["vec3"],g:!0},{a:"node_in",c:"Do",h:["vec3"],g:!0},{a:"node_in",c:"Dp",h:["vec3"],g:!0},{a:"node_in",c:"Dq",h:["vec3"],g:!0},{a:"node_out",c:"Dr",h:["vec3"],g:!0},{a:"node_out",c:"Ds",h:["float"],g:!0},{a:"node_out",c:"Dt",h:["vec3"],g:!0},{a:"node_out",c:"Du",h:["float"],g:!0},{a:"node_out",c:"Dv",h:["vec3"],g:!0},{a:"node_out",c:"Dw",h:["float"],
g:!0},{a:"node_out",c:"Dx",h:["vec3"],g:!0},{a:"node_out",c:"Dy",h:["float"],g:!0},{a:"node_param",c:"node_TEXTURE_COLOR_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dn ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dr"],m:[{a:"txt",b:"Dr = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dr",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",
i:["USE_OUT_Ds"],m:[{a:"txt",b:"Ds = zt . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Do ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dt"],m:[{a:"txt",b:"Dt = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dt",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Du"],m:[{a:"txt",b:"Du = zt . w ;".split(" ")}]}]}]}]},
{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dp ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dv"],m:[{a:"txt",b:"Dv = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dv",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dw"],m:[{a:"txt",b:"Dw = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"txt",
b:"zt = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , qQ ( Dq ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dx"],m:[{a:"txt",b:"Dx = zt . xyz ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["NON_COLOR",{a:"logic_negative_expr",l:1}],m:[{a:"txt",b:["bY","(","Dx",")",";"]}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Dy"],m:[{a:"txt",b:"Dy = zt . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"TEXTURE_NORMAL",u:[{a:"node_var",c:"USE_uv2",b:["0"]},{a:"node_var",c:"USE_uv3",b:["0"]},
{a:"node_var",c:"USE_uv4",b:["0"]}],s:[{a:"node_in",c:"Dz",h:["vec3"],g:!0},{a:"node_in",c:"DA",h:["vec3"],g:!0},{a:"node_in",c:"DB",h:["vec3"],g:!0},{a:"node_in",c:"DC",h:["vec3"],g:!0},{a:"node_out",c:"DD",h:["vec3"],g:!0},{a:"node_out",c:"DE",h:["float"],g:!0},{a:"node_out",c:"DF",h:["vec3"],g:!0},{a:"node_out",c:"DG",h:["float"],g:!0},{a:"node_out",c:"DH",h:["vec3"],g:!0},{a:"node_out",c:"DI",h:["float"],g:!0},{a:"node_out",c:"DJ",h:["vec3"],g:!0},{a:"node_out",c:"DK",h:["float"],g:!0},{a:"node_param",
c:"node_TEXTURE_NORMAL_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"vec4 zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( Dz ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DD"],m:[{a:"txt",b:"DD = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DE"],m:[{a:"txt",b:"DE = zt . w ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv2"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DA ) ) ;".split(" ")},
{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DF"],m:[{a:"txt",b:"DF = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DG"],m:[{a:"txt",b:"DG = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv3"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DB ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DH"],m:[{a:"txt",b:"DH = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",
f:[{a:"node_if",i:["USE_OUT_DI"],m:[{a:"txt",b:"DI = zt . w ;".split(" ")}]}]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_uv4"],m:[{a:"txt",b:"zt = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , qQ ( DC ) ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DJ"],m:[{a:"txt",b:"DJ = normalize ( rm * ( zt . xyz - _0_5 ) ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DK"],m:[{a:"txt",b:"DK = zt . w ;".split(" ")}]}]}]}]}]},{a:"node",c:"VALUE",u:[{a:"node_var",c:"VALUE_IND",
b:["0"]}],s:[{a:"node_out",c:"DL",h:["float"],g:!1}],m:[{a:"txt",b:"DL = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",c:"VECT_MATH_ADD",u:[],s:[{a:"node_in",c:"DM",h:["vec3"],g:!1},{a:"node_in",c:"DN",h:["vec3"],g:!1},{a:"node_out",c:"DO",h:["vec3"],g:!1},{a:"node_out",c:"DP",h:["float"],g:!0}],m:[{a:"txt",b:"DO = DM + DN ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DP"],m:[{a:"txt",b:"DP = ( abs ( DO [ 0 ] ) + abs ( DO [ 1 ] ) + abs ( DO [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_SUBTRACT",u:[],s:[{a:"node_in",c:"DQ",h:["vec3"],g:!1},{a:"node_in",c:"DR",h:["vec3"],g:!1},{a:"node_out",c:"DS",h:["vec3"],g:!1},{a:"node_out",c:"DT",h:["float"],g:!0}],m:[{a:"txt",b:"DS = DQ - DR ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DT"],m:[{a:"txt",b:"DT = ( abs ( DS [ 0 ] ) + abs ( DS [ 1 ] ) + abs ( DS [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_AVERAGE",u:[],s:[{a:"node_in",c:"DU",h:["vec3"],g:!1},{a:"node_in",c:"DV",h:["vec3"],g:!1},
{a:"node_out",c:"DW",h:["vec3"],g:!1},{a:"node_out",c:"DX",h:["float"],g:!0}],m:[{a:"txt",b:"DW = DU + DV ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DX"],m:[{a:"txt",b:"DX = length ( DW ) ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_DW"],m:[{a:"txt",b:"DW = normalize ( DW ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_DOT_PRODUCT",u:[],s:[{a:"node_in",c:"DY",h:["vec3"],g:!1},{a:"node_in",c:"DZ",h:["vec3"],g:!1},{a:"node_out",c:"D_",h:["vec3"],g:!1},{a:"node_out",c:"Ea",
h:["float"],g:!0}],m:[{a:"txt",b:"D_ = vec3 ( _0_0 ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ea"],m:[{a:"txt",b:"Ea = dot ( DY , DZ ) ;".split(" ")}]}]}]},{a:"node",c:"VECT_MATH_CROSS_PRODUCT",u:[],s:[{a:"node_in",c:"Eb",h:["vec3"],g:!1},{a:"node_in",c:"Ec",h:["vec3"],g:!1},{a:"node_out",c:"Ed",h:["vec3"],g:!1},{a:"node_out",c:"Ee",h:["float"],g:!0}],m:[{a:"txt",b:"Ed = cross ( Eb , Ec ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ee"],m:[{a:"txt",b:"Ee = length ( Ed ) ;".split(" ")}]}]}]},
{a:"node",c:"VECT_MATH_NORMALIZE",u:[],s:[{a:"node_in",c:"Ef",h:["vec3"],g:!1},{a:"node_in",c:"Eg",h:["vec3"],g:!1},{a:"node_out",c:"Eh",h:["vec3"],g:!1},{a:"node_out",c:"Ei",h:["float"],g:!0}],m:[{a:"txt",b:"Eh = normalize ( Ef ) ;".split(" ")},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_Ei"],m:[{a:"txt",b:"Ei = length ( Ef ) ;".split(" ")}]}]},{a:"txt",b:["Eg",";"]}]},{a:"node",c:"B4W_REFLECT",u:[],s:[{a:"node_in",c:"Em",h:["vec3"],g:!1},{a:"node_in",c:"En",h:["vec3"],g:!1},{a:"node_out",c:"Eo",
h:["vec3"],g:!1}],m:[{a:"txt",b:"Eo = reflect ( T ( u_view_tsr_inverse , Em ) , En ) ;".split(" ")}]},{a:"node",c:"B4W_REFLECT_WORLD",u:[],s:[{a:"node_in",c:"Ep",h:["vec3"],g:!1},{a:"node_out",c:"Eq",h:["vec3"],g:!1}],m:[{a:"txt",b:"vec3 FD = - nI . xyz ; Eq = reflect ( FD , Ep ) ;".split(" ")}]},{a:"node",c:"B4W_PARALLAX",u:[],s:[{a:"node_in",c:"Er",h:["vec3"],g:!1},{a:"node_in",c:"Es",h:["float"],g:!1},{a:"node_in",c:"Et",h:["const","float"],g:!1},{a:"node_in",c:"Eu",h:["const","float"],g:!1},{a:"node_out",
c:"Ev",h:["vec3"],g:!1},{a:"node_param",c:"node_B4W_PARALLAX_var_texture",h:["uniform","sampler2D"],g:!1}],m:[{a:"txt",b:"float bp = length ( rn ) ; if ( bp < Eu ) { vec2 bE = qQ ( Er ) ; float bI = clamp ( _0_5 * ( Eu - bp ) , _0_0 , _1_0 ) ; float hk = Es * bI ; vec3 bK = normalize ( nI * rm ) ; float bL = _1_0 / Et ; vec2 bM = bK . xy * hk / ( Et * bK . z ) ; float bN = _1_0 ; float bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; for ( float bQ = _1_0 ; bQ <= Et ; bQ ++ ) { if ( bO < bN ) { bN -= bL ; bE -= bM ; bO = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bE ) . a ; } } vec2 bR = bE + bM ; float bS = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bR ) . a - ( bN + bL ) ; float bT = bO - bN ; float bU = bT / ( bT - bS ) ; bE = bU * bR + ( _1_0 - bU ) * bE ; Ev = qP ( bE ) ; } else Ev = Er ;".split(" ")}]},
{a:"node",c:"B4W_CLAMP",u:[],s:[{a:"node_in",c:"Ew",h:["vec3"],g:!1},{a:"node_out",c:"Ex",h:["vec3"],g:!1}],m:[{a:"txt",b:"Ex = clamp ( Ew , _0_0 , _1_0 ) ;".split(" ")}]},{a:"node",c:"B4W_REFRACTION",u:[],s:[{a:"node_in",c:"Ey",h:["vec3"],g:!1},{a:"node_in",c:"Ez",h:["float"],g:!1},{a:"node_out",c:"EA",h:["vec3"],g:!1}],m:[{a:"txt",b:["EA","=","Ey",";"]}]},{a:"node",c:"B4W_TRANSLUCENCY",u:[],s:[{a:"node_in",c:"EB",h:["float"],g:!1},{a:"node_in",c:"EC",h:["float"],g:!1},{a:"node_in",c:"ED",h:["float"],
g:!1},{a:"node_in",c:"EE",h:["float"],g:!1},{a:"node_in",c:"EF",h:["float"],g:!1},{a:"node_out",c:"EG",h:["float"],g:!0},{a:"node_out",c:"EH",h:["vec4"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EG"],m:[{a:"txt",b:["EG","=","EB",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["USE_OUT_EH"],m:[{a:"txt",b:"EH = vec4 ( EC , ED , EE , EF ) ;".split(" ")}]}]}]},{a:"node",c:"B4W_TIME",u:[],s:[{a:"node_out",c:"EI",h:["float"],g:!1}],m:[{a:"txt",b:["EI","=","u_time",";"]}]},{a:"node",c:"B4W_SMOOTHSTEP",
u:[],s:[{a:"node_in",c:"EJ",h:["float"],g:!1},{a:"node_in",c:"EK",h:["float"],g:!1},{a:"node_in",c:"EL",h:["float"],g:!1},{a:"node_out",c:"EM",h:["float"],g:!1}],m:[{a:"txt",b:"EM = smoothstep ( EK , EL , EJ ) ;".split(" ")}]},{a:"node",c:"B4W_GLOW_OUTPUT",u:[],s:[{a:"node_in",c:"EN",h:["vec3"],g:!1},{a:"node_in",c:"EO",h:["float"],g:!1}],m:[{a:"txt",b:"D = EN ; H = EO ;".split(" ")}]},{a:"node",c:"B4W_VECTOSCAL",u:[],s:[{a:"node_in",c:"EP",h:["vec3"],g:!1},{a:"node_out",c:"EQ",h:["float"],g:!1}],
m:[{a:"txt",b:"EQ = ( EP . r + EP . g + EP . b ) / 3.0 ;".split(" ")}]},{a:"node",c:"B4W_SCALTOVEC",u:[],s:[{a:"node_in",c:"ER",h:["float"],g:!1},{a:"node_out",c:"ES",h:["vec3"],g:!1}],m:[{a:"txt",b:"ES [ 0 ] = ER ; ES [ 1 ] = ER ; ES [ 2 ] = ER ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 nI , out vec3 D , out vec3 E , out vec3 F , out vec4 G , out float H ) { D = vec3 ( _0_0 ) ; E = vec3 ( _0_0 ) ; F = vec3 ( _0_0 ) ; G = vec4 ( _0_0 ) ; H = _0_0 ;".split(" ")},{a:"cond",f:[{a:"if",
i:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{a:"logical_or_expr",l:11}],j:{a:"grp",f:[{a:"txt",b:"vec3 P = normalize ( j ) ; vec3 bF = P ;".split(" ")},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"if ( gl_FrontFacing == false )".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"bF = bF ; else bF = - bF ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["DOUBLE_SIDED_LIGHTING"],j:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","bF",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","nH","=","P",";"]}]}}]},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_NO"],j:{a:"grp",f:[{a:"txt",b:["vec3","rl","=","bF",";"]}]}}]}]}}]},
{a:"cond",f:[{a:"if",i:["CALC_TBN_SPACE"],j:{a:"grp",f:[{a:"txt",b:"vec3 R = cross ( bF , k . xyz ) * k . w ; R = normalize ( R ) ; vec3 Q = cross ( R , bF ) * k . w ; mat3 rm = mat3 ( Q , R , bF ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nG = h ; vec4 rn = i ; float ro = u_emit ; float rp = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/particles_nodes.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PARTICLES_NODES_GLSLV",j:{a:"grp",f:[{a:"define",c:"PARTICLES_NODES_GLSLV",
b:[""]},{a:"node",c:"TEX_COORD_UV",u:[],s:[],m:[{a:"txt",b:["A","=","FJ",";"]}]},{a:"node",c:"UV_MERGED",u:[],s:[],m:[{a:"txt",b:["A","=","FJ",";"]}]},{a:"node",c:"UVMAP",u:[],s:[],m:[{a:"txt",b:["A","=","FJ",";"]}]},{a:"node",c:"GEOMETRY_UV",u:[],s:[],m:[{a:"txt",b:["A","=","FJ",";"]}]},{a:"node",c:"PARTICLE_INFO",u:[{a:"node_var",c:"PART_INFO_SIZE",b:["0"]},{a:"node_var",c:"PART_INFO_AGE",b:["0"]},{a:"node_var",c:"PART_INFO_LT",b:["0"]},{a:"node_var",c:"PART_INFO_LOC",b:["0"]},{a:"node_var",c:"PART_INFO_IND",
b:["0"]},{a:"node_var",c:"PART_INFO_VEL",b:["0"]},{a:"node_var",c:"PART_INFO_A_VEL",b:["0"]}],s:[{a:"node_param",c:"Fp",h:["GLSL_OUT","vec4"],g:!0},{a:"node_param",c:"Fq",h:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"Fr",h:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"Fs",h:["GLSL_OUT","vec3"],g:!0},{a:"node_param",c:"node_PARTICLE_INFO_var_a_p_indices",h:["GLSL_IN","float"],g:!0}],m:[{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_SIZE"],m:[{a:"txt",b:"Fp [ 3 ] = FI ;".split(" ")}]}]},{a:"node_cond",
f:[{a:"node_if",i:["PART_INFO_AGE"],m:[{a:"txt",b:"Fp [ 1 ] = FH ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_LT"],m:[{a:"txt",b:"Fp [ 2 ] = FK ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_LOC"],m:[{a:"txt",b:["Fq","=","FE",";"]}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_IND"],m:[{a:"txt",b:"Fp [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",f:[{a:"node_if",i:["PART_INFO_VEL"],m:[{a:"txt",b:["Fr","=","FF",";"]}]}]},{a:"node_cond",
f:[{a:"node_if",i:["PART_INFO_A_VEL"],m:[{a:"txt",b:["Fs","=","FG",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void I ( in vec3 FE , in vec3 FF , in vec3 FG , in float FH , in float FI , in vec2 FJ , in float FK ) {".split(" ")},{a:"cond",f:[{a:"if",i:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["A","=","FJ",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]}}]}]};a["include/precision_statement.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PRECISION_STATEMENT_GLSLF",
j:{a:"grp",f:[{a:"define",c:"PRECISION_STATEMENT_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"txt",b:["precision","PRECISION","float",";"]}]}}]}]};a["include/procedural.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"PROCEDURAL_GLSLF",j:{a:"grp",f:[{a:"define",c:"PROCEDURAL_GLSLF",b:[""]},{a:"txt",b:"vec4 FL ( vec4 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec3 FL ( vec3 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec2 FL ( vec2 x ) { return x - floor ( x * ( _1_0 / 289.0 ) ) * 289.0 ; } vec4 FM ( vec4 x ) { return x - floor ( x * ( _1_0 / 7.0 ) ) * 7.0 ; } vec4 FN ( vec4 x ) { return FL ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},
{a:"define",c:"K",b:["0.142857142857"]},{a:"define",c:"K2",b:["0.0714285714285"]},{a:"define",c:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 eW ( vec2 FO ) { vec2 FP = FL ( floor ( FO ) ) ; vec2 FQ = fract ( FO ) ; vec4 FR = FQ . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 FS = FQ . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = FN ( FP . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = FN ( p + FP . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 FT = FM ( p ) * K + K2 ; vec4 FU = FM ( floor ( p * K ) ) * K + K2 ; vec4 FV = FR + JITTER * FT ; vec4 FW = FS + JITTER * FU ; vec4 df = FV * FV + FW * FW ;".split(" ")},
{a:"cond",f:[{a:"if",i:[1],j:{a:"grp",f:[{a:"txt",b:"df . xy = min ( df . xy , df . zw ) ; df . x = min ( df . x , df . y ) ; return df . xx ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"df . xy = ( df . x < df . y ) ? df . xy : df . yx ; df . xz = ( df . x < df . z ) ? df . xz : df . zx ; df . xw = ( df . x < df . w ) ? df . xw : df . wx ; df . y = min ( df . y , df . z ) ; df . y = min ( df . y , df . w ) ; return sqrt ( df . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 kp ( vec2 FO , float FX ) { vec2 FP = FL ( floor ( FO ) ) ; vec2 FQ = fract ( FO ) ; vec4 FR = FQ . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 FS = FQ . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = FN ( FP . x + vec4 ( _0_0 , _1_0 , _0_0 , _1_0 ) ) ; p = FN ( p + FP . y + vec4 ( _0_0 , _0_0 , _1_0 , _1_0 ) ) ; vec4 FT = FM ( p ) * K + K2 ; vec4 FU = FM ( floor ( p * K ) ) * K + K2 ; vec4 FV = FR + JITTER * FT ; vec4 FW = FS + JITTER * FU ; vec4 FY = FV * FV + FW * FW ; FV += FX ; FW += FX ; vec4 FZ = FV * FV + FW * FW ; FV += FX ; FW += FX ; vec4 F_ = FV * FV + FW * FW ; FY . xy = min ( FY . xy , FY . zw ) ; FY . x = min ( FY . x , FY . y ) ; FZ . xy = min ( FZ . xy , FZ . zw ) ; FZ . x = min ( FZ . x , FZ . y ) ; F_ . xy = min ( F_ . xy , F_ . zw ) ; F_ . x = min ( F_ . x , F_ . y ) ; return vec3 ( FY . x , FZ . x , F_ . x ) ; } vec3 Ga ( vec3 x ) { return FL ( ( ( x * 34.0 ) + _1_0 ) * x ) ; } float eL ( vec2 ki ) { const vec4 Gb = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 bQ = floor ( ki + dot ( ki , Gb . yy ) ) ; vec2 Gc = ki - bQ + dot ( bQ , Gb . xx ) ; vec2 Gd ; Gd = ( Gc . x > Gc . y ) ? vec2 ( _1_0 , _0_0 ) : vec2 ( _0_0 , _1_0 ) ; vec4 Ge = Gc . xyxy + Gb . xxzz ; Ge . xy -= Gd ; bQ = FL ( bQ ) ; vec3 p = Ga ( Ga ( bQ . y + vec3 ( _0_0 , Gd . y , _1_0 ) ) + bQ . x + vec3 ( _0_0 , Gd . x , _1_0 ) ) ; vec3 ap = max ( 0.5 - vec3 ( dot ( Gc , Gc ) , dot ( Ge . xy , Ge . xy ) , dot ( Ge . zw , Ge . zw ) ) , _0_0 ) ; ap = ap * ap ; ap = ap * ap ; vec3 x = 2.0 * fract ( p * Gb . www ) - _1_0 ; vec3 bO = abs ( x ) - 0.5 ; vec3 FT = floor ( x + 0.5 ) ; vec3 Gf = x - FT ; ap *= 1.79284291400159 - 0.85373472095314 * ( Gf * Gf + bO * bO ) ; vec3 g ; g . x = Gf . x * Gc . x + bO . x * Gc . y ; g . yz = Gf . yz * Ge . xz + bO . yz * Ge . yw ; return 130.0 * dot ( ap , g ) ; } vec2 Gi ( vec2 fm ) { float FY = dot ( fm , vec2 ( 12.9898 , 78.233 ) ) ; float FZ = dot ( fm , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float Gg = fract ( sin ( FY ) * 43758.5453 ) * 2.0 - _1_0 ; float Gh = fract ( sin ( FZ ) * 43758.5453 ) * 2.0 - _1_0 ; return vec2 ( Gg , Gh ) ; }".split(" ")}]}}]}]};
a["include/refraction.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"REFRACTION_GLSLF",j:{a:"grp",f:[{a:"define",c:"REFRACTION_GLSLF",b:[""]},{a:"var",c:"REFRACTIVE",b:["0"]},{a:"var",c:"USE_REFRACTION_CORRECTION",b:["0"]},{a:"cond",f:[{a:"if",i:["REFRACTIVE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["USE_REFRACTION_CORRECTION"],j:{a:"grp",f:[{a:"include",A:"pack.glslf"}]}}]},{a:"include",A:"color_util.glslf"},{a:"cond",f:[{a:"if",i:["USE_REFRACTION_CORRECTION"],j:{a:"grp",f:[{a:"txt",b:"float el ( in float cw , inout vec2 ek , in vec2 dU ) { vec4 Gj = GLSL_TEXTURE ( u_scene_depth , ek ) ; float em = cv ( Gj ) ; if ( em < m ) { ek = dU ; return cw ; } else { return em ; } return cw ; }".split(" ")}]}}]},
{a:"txt",b:"vec3 cs ( in vec3 qy , in vec2 Gk ) { vec2 dU = qy . xy / qy . z ; vec2 ek = dU + Gk ;".split(" ")},{a:"cond",f:[{a:"if",i:["USE_REFRACTION_CORRECTION"],j:{a:"grp",f:[{a:"txt",b:"vec4 cu = GLSL_TEXTURE_PROJ ( u_scene_depth , qy ) ; float cw = cv ( cu ) ; el ( cw , ek , dU ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 eq = GLSL_TEXTURE ( u_refractmap , ek ) . rgb ; bY ( eq ) ; return eq ; }".split(" ")}]}}]}]}}]}]};a["include/scale_texcoord.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SCALE_TEXCOORD_GLSLV",
j:{a:"grp",f:[{a:"define",c:"SCALE_TEXCOORD_GLSLV",b:[""]},{a:"txt",b:"vec2 ao ( vec2 bE , vec3 Gl ) { return ( bE + 0.5 ) * Gl . xy - 0.5 ; }".split(" ")}]}}]}]};a["include/shadow.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SHADOW_GLSLF",j:{a:"grp",f:[{a:"define",c:"SHADOW_GLSLF",b:[""]},{a:"var",c:"PRECISION",b:["highp"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"CSM_FADE_LAST_CASCADE",b:["0"]},{a:"var",c:"CSM_BLEND_BETWEEN_CASCADES",b:["0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},
{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"var",c:"COMPARED_MODE",b:["0"]},{a:"var",c:"POISSON_DISK_NUM",b:["NO_SOFT_SHADOWS"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"procedural.glslf"}]}}]},{a:"cond",f:[{a:"if",
i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"const float Gm = 0.1 ; const float Gn = 0.1 ; const float Go = - 0.01 ; const float Gp = 0.05 ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","POISSON_X_16",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 Gq = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 Gr = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 Gs = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 Gt = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 Gu = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 Gv = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 Gw = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 Gx = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ;".split(" ")}]}},
{a:"elif",i:["POISSON_DISK_NUM","POISSON_X_8",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 Gq = vec2 ( - 0.37192261 , 0.47109537 ) ; vec2 Gr = vec2 ( - 0.6807477 , 0.69048062 ) ; vec2 Gs = vec2 ( 0.11615683 , - 0.91318524 ) ; vec2 Gt = vec2 ( 0.93688596 , - 0.16948928 ) ; vec2 Gu = vec2 ( - 0.89699117 , 0.74092316 ) ; vec2 Gv = vec2 ( 0.38263656 , - 0.66119884 ) ; vec2 Gw = vec2 ( - 0.08193062 , - 0.21275223 ) ; vec2 Gx = vec2 ( 0.05578877 , 0.84225623 ) ;".split(" ")}]}},{a:"elif",i:["POISSON_DISK_NUM",
"POISSON_X_4",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 Gq = vec2 ( - 0.51808083 , 0.0 ) ; vec2 Gr = vec2 ( 0.5741194 , 0.0 ) ; vec2 Gs = vec2 ( - 0.68048857 , 0.0 ) ; vec2 Gt = vec2 ( 0.82934988 , 0.0 ) ; vec2 Gu = vec2 ( 0.70009436 , 0.0 ) ; vec2 Gv = vec2 ( - 0.78790467 , 0.0 ) ; vec2 Gw = vec2 ( - 0.58619489 , 0.0 ) ; vec2 Gx = vec2 ( 0.41902178 , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"bool Gz ( vec2 hZ , float Gy ) { return all ( lessThanEqual ( hZ , vec2 ( 1.0 + Gy ) ) ) && all ( greaterThanEqual ( hZ , vec2 ( 0.0 - Gy ) ) ) ; } float GG ( float GA , float GB , mat2 GC , vec3 GD , float GE , PRECISION GLSL_SMPLR2D_SHDW GF ) {".split(" ")},
{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec2 hZ , eY ; eY . x = GA ; eY . y = GB ; eY = GC * eY ; hZ = GD . xy + eY * GE / SHADOW_TEX_RES ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec2 hZ = GD . xy ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"if ( ! Gz ( hZ , Go ) ) return 1.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["COMPARED_MODE"],j:{a:"grp",
f:[{a:"txt",b:"return GLSL_TEXTURE ( GF , vec3 ( hZ , GD . z ) ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return step ( GD . z , GLSL_TEXTURE ( GF , hZ ) . r ) ;".split(" ")}]}}]},{a:"txt",b:"} float GL ( vec3 GD , PRECISION GLSL_SMPLR2D_SHDW GF , float GE ) { float GH = 0.0 ; GD . z = clamp ( GD . z , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float GI = Gi ( GD . xy ) . x * M_PI ; float GJ = cos ( GI ) ; float GK = sin ( GI ) ; mat2 GC = mat2 ( GJ , GK , - GK , GJ ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { GH += GG ( Gq [ bQ ] , Gu [ bQ ] , GC , GD , GE , GF ) ; GH += GG ( Gr [ bQ ] , Gv [ bQ ] , GC , GD , GE , GF ) ; GH += GG ( Gs [ bQ ] , Gw [ bQ ] , GC , GD , GE , GF ) ; GH += GG ( Gt [ bQ ] , Gx [ bQ ] , GC , GD , GE , GF ) ; } return clamp ( GH / ( float ( POISSON_DISK_NUM ) * 4.0 ) , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"return GG ( 0.0 , 0.0 , mat2 ( 0.0 ) , GD , GE , GF ) ;".split(" ")}]}}]},{a:"txt",b:"} float GU ( vec3 GM , PRECISION GLSL_SMPLR2D_SHDW GN , vec3 GO , PRECISION GLSL_SMPLR2D_SHDW GP , float GQ , float GR , float aB ) { float GS , GT ; GM . z = clamp ( GM . z , 0.0 , 1.0 ) ; GO . z = clamp ( GO . z , 0.0 , 1.0 ) ; GS = 0.0 ; GT = 0.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float GI = Gi ( GM . xy ) . x * M_PI ; float GJ = cos ( GI ) ; float GK = sin ( GI ) ; mat2 GC = mat2 ( GJ , GK , - GK , GJ ) ; for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { GS += GG ( Gq [ bQ ] , Gu [ bQ ] , GC , GM , GQ , GN ) ; GS += GG ( Gr [ bQ ] , Gv [ bQ ] , GC , GM , GQ , GN ) ; GS += GG ( Gs [ bQ ] , Gw [ bQ ] , GC , GM , GQ , GN ) ; GS += GG ( Gt [ bQ ] , Gx [ bQ ] , GC , GM , GQ , GN ) ; } for ( int bQ = 0 ; bQ < POISSON_DISK_NUM ; bQ ++ ) { GT += GG ( Gq [ bQ ] , Gu [ bQ ] , GC , GO , GR , GP ) ; GT += GG ( Gr [ bQ ] , Gv [ bQ ] , GC , GO , GR , GP ) ; GT += GG ( Gs [ bQ ] , Gw [ bQ ] , GC , GO , GR , GP ) ; GT += GG ( Gt [ bQ ] , Gx [ bQ ] , GC , GO , GR , GP ) ; } GS = mix ( GS , GT , aB ) ; GS /= ( float ( POISSON_DISK_NUM ) * 4.0 ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"GS += GG ( 0.0 , 0.0 , mat2 ( 0.0 ) , GM , GQ , GN ) ; GT += GG ( 0.0 , 0.0 , mat2 ( 0.0 ) , GO , GR , GP ) ; GS = mix ( GS , GT , aB ) ;".split(" ")}]}}]},{a:"txt",b:"return clamp ( GS , 0.0 , 1.0 ) ; } float GV ( vec2 hZ ) { float a = min ( hZ . x , hZ . y ) ; float b = min ( 1.0 - hZ . x , 1.0 - hZ . y ) ; return min ( a , b ) ; } float GX ( float tE , float GW ) { if ( GW >= 0.0 && GW <= Gn ) tE = ( tE - 1.0 ) / Gn * GW + 1.0 ; return tE ; } float Hb ( vec3 GY , vec3 GZ , PRECISION GLSL_SMPLR2D_SHDW GN , PRECISION GLSL_SMPLR2D_SHDW GP , float GQ , float GR , float G_ , float fN ) { float tE ;".split(" ")},
{a:"cond",f:[{a:"if",i:["CSM_BLEND_BETWEEN_CASCADES"],j:{a:"grp",f:[{a:"txt",b:"float GW = GV ( GY . xy ) ; if ( - fN > G_ && GW >= 0.0 && GW <= Gm && Gz ( GZ . xy , 0.0 ) ) { float Ha = 1.0 - GW / Gm ; tE = GU ( GY , GN , GZ , GP , GQ , GR , Ha ) ; } else".split(" ")}]}}]},{a:"txt",b:"tE = GL ( GY , GN , GQ ) ; return tE ; } float Hd ( vec3 Hc , PRECISION GLSL_SMPLR2D_SHDW GF , float GE , float G_ , float fN ) { float tE = GL ( Hc , GF , GE ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_FADE_LAST_CASCADE"],
j:{a:"grp",f:[{a:"txt",b:"if ( - fN > G_ ) { float GW = GV ( Hc . xy ) ; tE = GX ( tE , GW ) ; }".split(" ")}]}}]},{a:"txt",b:"return tE ; } vec4 dD ( float fN ) { float tE = 1.0 ;".split(" ")},{a:"cond",f:[{a:"if",i:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{a:"non_equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["vec4","He","=","u_pcf_blur_radii",";"]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 He = vec4 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 GM = n . xyz / n . w ; if ( n . w < 0.0 ) GM . z = 0.0 ;".split(" ")},
{a:"cond",f:[{a:"if",i:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 GO = o . xyz / o . w ; if ( o . w < 0.0 ) GO . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Hf = u . xyz / u . w ; if ( u . w < 0.0 ) Hf . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",l:2},{a:"logical_or_expr",
l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 Hg = v . xyz / v . w ; if ( v . w < 0.0 ) Hg . z = 0.0 ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1"],j:{a:"grp",f:[{a:"txt",b:"if ( Gz ( GM . xy , 0.0 ) ) { tE = Hb ( GM , GO , u_shadow_map0 , u_shadow_map1 , He [ 0 ] , He [ 1 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"if ( Gz ( GM . xy , Gp ) ) { tE = Hd ( GM , u_shadow_map0 , He [ 0 ] , u_csm_center_dists [ 0 ] , fN ) ; }".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["CSM_SECTION1"],j:{a:"grp",f:[{a:"txt",b:"else { if ( Gz ( GO . xy , 0.0 ) ) {".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION2"],j:{a:"grp",f:[{a:"txt",b:"tE = Hb ( GO , Hf , u_shadow_map1 , u_shadow_map2 , He [ 1 ] , He [ 2 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"tE = Hd ( GO , u_shadow_map1 , He [ 1 ] , u_csm_center_dists [ 1 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2"],j:{a:"grp",f:[{a:"txt",
b:"else { if ( Gz ( Hf . xy , 0.0 ) ) {".split(" ")},{a:"cond",f:[{a:"if",i:["CSM_SECTION3"],j:{a:"grp",f:[{a:"txt",b:"tE = Hb ( Hf , Hg , u_shadow_map2 , u_shadow_map3 , He [ 2 ] , He [ 3 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"tE = Hd ( Hf , u_shadow_map2 , He [ 2 ] , u_csm_center_dists [ 2 ] , fN ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3"],j:{a:"grp",f:[{a:"txt",b:"else { if ( Gz ( Hg . xy , 0.0 ) ) tE = Hd ( Hg , u_shadow_map3 , He [ 3 ] , u_csm_center_dists [ 3 ] , fN ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float Hh = GL ( GO , u_shadow_map1 , He [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["float","Hh","=","0.0",";"]}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float Hi = GL ( Hf , u_shadow_map2 , He [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["float","Hi","=","0.0",";"]}]}}]},{a:"cond",
f:[{a:"if",i:["NUM_CAST_LAMPS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"float Hj = GL ( Hg , u_shadow_map3 , He [ 0 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:["float","Hj","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( tE , Hh , Hi , Hj ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 ch ( inout vec3 cd ) {".split(" ")},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 GH = GLSL_TEXTURE ( u_shadow_mask , l . xy / l . z ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",3,{a:"l_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"cd *= GH . a ;".split(" ")}]}}]},{a:"txt",b:["return","GH",";"]}]}},{a:"elif",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 GH = dD ( i . z ) ; return GH ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/shadow.glslv"]=
{a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SHADOW_GLSLV",j:{a:"grp",f:[{a:"define",c:"SHADOW_GLSLV",b:[""]},{a:"var",c:"MAC_OS_SHADOW_HACK",b:["0"]},{a:"var",c:"SHADOW_TEX_RES",b:["2048.0"]},{a:"var",c:"SHADOW_USAGE",b:["NO_SHADOWS"]},{a:"var",c:"NUM_CAST_LAMPS",b:["0"]},{a:"var",c:"CSM_SECTION1",b:["0"]},{a:"var",c:"CSM_SECTION2",b:["0"]},{a:"var",c:"CSM_SECTION3",b:["0"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",l:2},"SHADOW_USAGE",
"SHADOW_MAPPING_BLEND",{a:"equal_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"include",A:"math.glslv"},{a:"txt",b:"vec4 Hn ( mat4 Hk , vec4 Hl , mat4 Hm ) { vec2 dF = ( Hk * Hm [ 3 ] ) . xy ; float dG = SHADOW_TEX_RES / 2.0 ; dF = floor ( dF * dG + 0.5 ) / dG - dF ; vec4 GD = Hk * Hl ; GD . xy += dF ; GD . xyz = 0.5 * ( GD . xyz + GD . w ) ; return GD ; } void bD ( vec3 eD , vec3 Ho ) {".split(" ")},{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"mat4 Hm = aR ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat4 Hm = aR ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 Hp = Hm * vec4 ( eD + u_normal_offset * Ho , 1.0 ) ; n = Hn ( u_p_light_matrix0 , Hp , Hm ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",1,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"Hp = Hm * vec4 ( eD + u_normal_offset * Ho , 1.0 ) ; o = Hn ( u_p_light_matrix1 , Hp , Hm ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",2,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Hp = Hm * vec4 ( eD + u_normal_offset * Ho , 1.0 ) ; u = Hn ( u_p_light_matrix2 , Hp , Hm ) ;".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["NUM_CAST_LAMPS",3,{a:"g_expr",l:2}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MAC_OS_SHADOW_HACK"],j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Hm = aR ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"Hp = Hm * vec4 ( eD + u_normal_offset * Ho , 1.0 ) ; v = Hn ( u_p_light_matrix3 , Hp , Hm ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION1"],j:{a:"grp",f:[{a:"txt",
b:"o = Hn ( u_p_light_matrix1 , Hp , Hm ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION2"],j:{a:"grp",f:[{a:"txt",b:"u = Hn ( u_p_light_matrix2 , Hp , Hm ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["CSM_SECTION3"],j:{a:"grp",f:[{a:"txt",b:"v = Hn ( u_p_light_matrix3 , Hp , Hm ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]};a["include/skin.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SKIN_GLSLV",j:{a:"grp",f:[{a:"define",c:"SKIN_GLSLV",b:[""]},{a:"var",c:"DISABLE_TANGENT_SKINNING",
b:["0"]},{a:"var",c:"SKINNED",b:["0"]},{a:"var",c:"FRAMES_BLENDING",b:["0"]},{a:"cond",f:[{a:"if",i:["SKINNED"],j:{a:"grp",f:[{a:"include",A:"math.glslv"},{a:"define",c:"SKIN_SLERP",b:["0"]},{a:"cond",f:[{a:"if",i:["SKIN_SLERP"],j:{a:"grp",f:[{a:"txt",b:"vec4 Hx ( in vec4 gI , in vec4 Hq , in float Hr ) { float Hs = gI [ 0 ] * Hq [ 0 ] + gI [ 1 ] * Hq [ 1 ] + gI [ 2 ] * Hq [ 2 ] + gI [ 3 ] * Hq [ 3 ] ; if ( Hs < 0.0 ) { Hq *= - 1.0 ; Hs = - Hs ; } if ( abs ( Hs ) >= 1.0 ) return gI ; float Ht = acos ( Hs ) ; float Hu = sqrt ( 1.0 - Hs * Hs ) ; if ( abs ( Hu ) < 0.001 ) return vec4 ( gI * 0.5 + Hq * 0.5 ) ; float Hv = sin ( ( 1.0 - Hr ) * Ht ) / Hu ; float Hw = sin ( Hr * Ht ) / Hu ; return gI * Hv + Hq * Hw ; }".split(" ")}]}}]},
{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"vec3 HL ( in vec3 N , in vec4 Hy , in vec4 Hz , in vec4 HA , in vec4 HB , in float HC ) { vec3 HD = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKIN_SLERP"],j:{a:"grp",f:[{a:"txt",b:"vec4 gI = Hx ( Hy , Hz , HC ) ; vec4 HE = mix ( HA , HB , HC ) ; vec3 HF = O ( gI , HD ) ; vec3 HG = HF * HE . w + HE . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 HH = O ( Hy , HD ) ; vec3 HI = O ( Hz , HD ) ; vec3 HJ = HH * HA . w + HA . xyz ; vec3 HK = HI * HB . w + HB . xyz ; vec3 HG = mix ( HJ , HK , HC ) ;".split(" ")}]}}]},
{a:"txt",b:"return qo ( u_arm_rel_trans , u_arm_rel_quat , HG ) ; } vec3 HR ( in vec3 HM , in vec4 Hy , in vec4 Hz , in float HC ) { vec3 HN = qn ( u_arm_rel_trans , u_arm_rel_quat , HM ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["SKIN_SLERP"],j:{a:"grp",f:[{a:"txt",b:"vec4 gI = Hx ( Hy , Hz , HC ) ; vec3 HO = O ( gI , HN ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 HP = O ( Hy , HN ) ; vec3 HQ = O ( Hz , HN ) ; vec3 HO = mix ( HP , HQ , HC ) ;".split(" ")}]}}]},{a:"txt",b:"return qr ( u_arm_rel_trans , u_arm_rel_quat , HO ) ; }".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 HL ( in vec3 N , in vec4 Hy , in vec4 HA ) { vec3 HD = ql ( u_arm_rel_trans , u_arm_rel_quat , N ) ; vec3 HF = O ( Hy , HD ) ; vec3 HG = HF * HA . w + HA . xyz ; return qo ( u_arm_rel_trans , u_arm_rel_quat , HG ) ; } vec3 HR ( in vec3 HM , in vec4 Hy ) { vec3 HN = qn ( u_arm_rel_trans , u_arm_rel_quat , HM ) ; vec3 HO = O ( Hy , HN ) ; return qr ( u_arm_rel_trans , u_arm_rel_quat , HO ) ; }".split(" ")}]}}]},{a:"txt",b:"void _ ( inout vec3 N , inout vec3 Q , inout vec3 R , inout vec3 P ) {".split(" ")},
{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:["float","HS","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 iU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 HT = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 HU = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 HV = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 HW = a_influence ; for ( int bQ = 0 ; bQ < 4 ; bQ ++ ) { int HX = int ( HW [ bQ ] ) ; float HY = fract ( HW [ bQ ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",
b:"HT += HY * HR ( Q , u_quatsb [ HX ] , u_quatsa [ HX ] , HS ) ; HU += HY * HR ( R , u_quatsb [ HX ] , u_quatsa [ HX ] , HS ) ; HV += HY * HR ( P , u_quatsb [ HX ] , u_quatsa [ HX ] , HS ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"iU += HY * HL ( N , u_quatsb [ HX ] , u_transb [ HX ] ) ; HV += HY * HR ( P , u_quatsb [ HX ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"HT += HY * HR ( Q , u_quatsb [ HX ] ) ; HU += HY * HR ( R , u_quatsb [ HX ] ) ;".split(" ")}]}}]}]}}]},
{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"int HX = int ( HW [ 0 ] ) ; float HY = fract ( HW [ 0 ] ) ; iU += HY * HL ( N , u_quatsb [ HX ] , u_quatsa [ HX ] , u_transb [ HX ] , u_transa [ HX ] , HS ) ; HX = int ( HW [ 1 ] ) ; HY = fract ( HW [ 1 ] ) ; iU += HY * HL ( N , u_quatsb [ HX ] , u_quatsa [ HX ] , u_transb [ HX ] , u_transa [ HX ] , HS ) ; HX = int ( HW [ 2 ] ) ; HY = fract ( HW [ 2 ] ) ; iU += HY * HL ( N , u_quatsb [ HX ] , u_quatsa [ HX ] , u_transb [ HX ] , u_transa [ HX ] , HS ) ; HX = int ( HW [ 3 ] ) ; HY = fract ( HW [ 3 ] ) ; iU += HY * HL ( N , u_quatsb [ HX ] , u_quatsa [ HX ] , u_transb [ HX ] , u_transa [ HX ] , HS ) ;".split(" ")}]}}]},
{a:"txt",b:"N = iU ; P = HV ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"Q = HT ; R = HU ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int HZ = int ( a_influence [ 0 ] - 1.0 ) ; if ( HZ > - 1 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["FRAMES_BLENDING"],j:{a:"grp",f:[{a:"txt",b:"N = HL ( N , u_quatsb [ HZ ] , u_quatsa [ HZ ] , u_transb [ HZ ] , u_transa [ HZ ] , HS ) ; Q = HR ( Q , u_quatsb [ HZ ] , u_quatsa [ HZ ] , HS ) ; R = HR ( R , u_quatsb [ HZ ] , u_quatsa [ HZ ] , HS ) ; P = HR ( P , u_quatsb [ HZ ] , u_quatsa [ HZ ] , HS ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"N = HL ( N , u_quatsb [ HZ ] , u_transb [ HZ ] ) ; P = HR ( P , u_quatsb [ HZ ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"Q = HR ( Q , u_quatsb [ HZ ] ) ; R = HR ( R , u_quatsb [ HZ ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]}}]}]};a["include/sky_blending.glslf"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"SKY_BLENDING_GLSLF",j:{a:"grp",f:[{a:"define",c:"SKY_BLENDING_GLSLF",
b:[""]},{a:"include",A:"std.glsl"},{a:"include",A:"blending.glslf"},{a:"var",c:"WO_SKYREAL",b:["0"]},{a:"var",c:"WO_SKYBLEND",b:["0"]},{a:"var",c:"BLENDTYPE",b:["MIX"]},{a:"var",c:"MTEX_RGBTOINT",b:["0"]},{a:"var",c:"WOMAP_HORIZ",b:["0"]},{a:"var",c:"WOMAP_ZENUP",b:["0"]},{a:"var",c:"WOMAP_ZENDOWN",b:["0"]},{a:"var",c:"WOMAP_BLEND",b:["0"]},{a:"var",c:"MTEX_NEGATIVE",b:["0"]},{a:"txt",b:"vec3 H_ ( vec3 jB , vec3 jC , float aB , float ka ) { float jD = aB * ka ;".split(" ")},{a:"cond",f:[{a:"if",i:["BLENDTYPE",
"MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jE ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","ADD",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jF ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SUBTRACT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jG ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jI ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE",
"SCREEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jJ ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","OVERLAY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jK ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jL ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIVIDE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jM ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE",
"DARKEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jN ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LIGHTEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jO ( jB , jC , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","HUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jS ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SATURATION",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jT ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE",
"VALUE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jU ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","COLOR",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jV ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jX ( jC , jB , jD ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jY ( jC , jB , jD ) ;".split(" ")}]}}]},{a:"txt",
b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float Ia ( float jZ , float j_ , float aB , float ka ) { vec3 jB = vec3 ( jZ ) , jC = vec3 ( j_ ) ; float jD = aB * ka ;".split(" ")},{a:"cond",f:[{a:"if",i:["BLENDTYPE","MIX",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jE ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","ADD",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jF ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SUBTRACT",{a:"equal_expr",l:2}],j:{a:"grp",
f:[{a:"txt",b:"return jG ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","MULTIPLY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return kb ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","SCREEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return kc ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","OVERLAY",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return kd ( jZ , j_ , jD , ka ) ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIFFERENCE",
{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jL ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DIVIDE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jM ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","DARKEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jN ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LIGHTEN",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jO ( jB , jC , jD ) . x ;".split(" ")}]}},{a:"elif",
i:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jX ( jC , jB , jD ) . x ;".split(" ")}]}},{a:"elif",i:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"return jY ( jC , jB , jD ) . x ;".split(" ")}]}}]},{a:"txt",b:"return 0.0 ; } vec3 dN ( vec3 dJ , vec3 dK , vec4 dM , float dI , vec3 dL ) { float Ib = 1.0 ; Ib = dM . a ;".split(" ")},{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT"],j:{a:"grp",f:[{a:"txt",b:"Ib = ft ( dM ) ;".split(" ")}]}}]},{a:"cond",
f:[{a:"if",i:["MTEX_NEGATIVE"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"dM = vec4 ( vec3 ( 1.0 ) - dM . rgb , dM . a ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"Ib = 1.0 - Ib ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",l:3}],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT"],j:{a:"grp",f:[{a:"txt",b:"dM = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"Ib = dM . a ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_HORIZ"],j:{a:"grp",f:[{a:"txt",b:"dJ = H_ ( dM . rgb , dJ , Ib , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:["float","Ic","=","0.0",";"]},{a:"cond",f:[{a:"if",i:["WO_SKYREAL"],j:{a:"grp",f:[{a:"txt",b:"if ( dot ( dL , vec3 ( 0.0 , 0.0 , 1.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",f:[{a:"if",i:["WOMAP_ZENUP"],
j:{a:"grp",f:[{a:"txt",b:"Ic = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",f:[{a:"if",i:["WOMAP_ZENDOWN"],j:{a:"grp",f:[{a:"txt",b:"else Ic = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["WOMAP_ZENUP"],j:{a:"grp",f:[{a:"txt",b:"Ic = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"elif",i:["WOMAP_ZENDOWN"],j:{a:"grp",f:[{a:"txt",b:"Ic = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",
b:"if ( Ic != 0.0 ) dK = H_ ( dM . rgb , dK , Ib , Ic ) ;".split(" ")}]}}]}]}}]},{a:"cond",f:[{a:"if",i:["WOMAP_BLEND"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["MTEX_RGBTOINT",{a:"logic_negative_expr",l:1}],j:{a:"grp",f:[{a:"txt",b:"Ib = dot ( dM . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"dI = Ia ( u_sky_tex_dvar , dI , Ib , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["WO_SKYBLEND"],j:{a:"grp",f:[{a:"txt",b:"vec3 dH = mix ( dJ , dK , dI ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:["vec3","dH","=","dJ",";"]}]}}]},{a:"txt",b:["return","dH",";","}"]}]}}]}]};a["include/std.glsl"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"STD_ENUMS_GLSL",j:{a:"grp",f:[{a:"define",c:"STD_ENUMS_GLSL",b:[""]},{a:"var",c:"CONSTANTS_HACK",b:["0"]},{a:"define",c:"TEXTURE_COORDS_NONE",b:["0"]},{a:"define",c:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",c:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",c:"TEXTURE_BLEND_TYPE_MULTIPLY",
b:["2"]},{a:"define",c:"SHADOW_SRC_NONE",b:["1"]},{a:"define",c:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",c:"SHADOW_SRC_MASK",b:["3"]},{a:"define",c:"SHADOW_DST_NONE",b:["1"]},{a:"define",c:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",c:"SHADOW_DST_MASK",b:["3"]},{a:"define",c:"NO_SHADOWS",b:["1"]},{a:"define",c:"SHADOW_CASTING",b:["2"]},{a:"define",c:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",c:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",c:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",c:"POISSON_X_16",
b:["4"]},{a:"define",c:"POISSON_X_8",b:["2"]},{a:"define",c:"POISSON_X_4",b:["1"]},{a:"define",c:"NO_SOFT_SHADOWS",b:["0"]},{a:"define",c:"SPECULAR_PHONG",b:["1"]},{a:"define",c:"SPECULAR_COOKTORR",b:["2"]},{a:"define",c:"SPECULAR_WARDISO",b:["3"]},{a:"define",c:"SPECULAR_BLINN",b:["4"]},{a:"define",c:"SPECULAR_TOON",b:["5"]},{a:"define",c:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",c:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",c:"DIFFUSE_FRESNEL",b:["3"]},{a:"define",c:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",
c:"DIFFUSE_TOON",b:["5"]},{a:"define",c:"MIX",b:["0"]},{a:"define",c:"ADD",b:["1"]},{a:"define",c:"SUBTRACT",b:["2"]},{a:"define",c:"MULTIPLY",b:["3"]},{a:"define",c:"SCREEN",b:["4"]},{a:"define",c:"OVERLAY",b:["5"]},{a:"define",c:"DIFFERENCE",b:["6"]},{a:"define",c:"DIVIDE",b:["7"]},{a:"define",c:"DARKEN",b:["8"]},{a:"define",c:"LIGHTEN",b:["9"]},{a:"define",c:"HUE",b:["10"]},{a:"define",c:"SATURATION",b:["11"]},{a:"define",c:"VALUE",b:["12"]},{a:"define",c:"COLOR",b:["13"]},{a:"define",c:"SOFT_LIGHT",
b:["14"]},{a:"define",c:"LINEAR_LIGHT",b:["15"]},{a:"define",c:"REFL_NONE",b:["0"]},{a:"define",c:"REFL_MIRRORMAP",b:["1"]},{a:"define",c:"REFL_PLANE",b:["2"]},{a:"define",c:"REFL_CUBE",b:["3"]},{a:"define",c:"INVERSE_QUADRATIC",b:["0"]},{a:"define",c:"LINEAR",b:["1"]},{a:"define",c:"QUADRATIC",b:["2"]},{a:"define",c:"HEMI",b:["1"]},{a:"define",c:"SPOT",b:["2"]},{a:"define",c:"POINT",b:["3"]},{a:"define",c:"SUN",b:["4"]},{a:"define",c:"DOF_SIMPLE",b:["0"]},{a:"define",c:"DOF_BOKEH",b:["1"]},{a:"define",
c:"COC_ALL",b:["0"]},{a:"define",c:"COC_FOREGROUND",b:["1"]},{a:"define",c:"COC_COMBINE",b:["2"]},{a:"define",c:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",c:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",c:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",c:"VT_OBJECT_TO_WORLD",b:["3"]},{a:"define",c:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",c:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",c:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",c:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",c:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",
c:"VT_POINT",b:["0"]},{a:"define",c:"VT_VECTOR",b:["1"]},{a:"define",c:"VT_NORMAL",b:["2"]},{a:"define",c:"NM_TANGENT",b:["0"]},{a:"define",c:"NM_OBJECT",b:["1"]},{a:"define",c:"NM_WORLD",b:["2"]},{a:"define",c:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",c:"NM_BLENDER_WORLD",b:["4"]},{a:"define",c:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",c:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",c:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",c:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",c:"POST_EFFECT_NONE",b:["1"]},
{a:"define",c:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",c:"POST_EFFECT_BLUR",b:["3"]},{a:"define",c:"POST_EFFECT_GLOW_BLUR",b:["4"]},{a:"define",c:"POST_EFFECT_DOF_BLUR",b:["5"]},{a:"define",c:"POST_EFFECT_ALPHA_BLUR",b:["6"]},{a:"define",c:"POST_EFFECT_EXTEND",b:["7"]},{a:"define",c:"FLIP_CUBEMAP_COORDS",b:["8"]},{a:"define",c:"DV_NONE",b:["0"]},{a:"define",c:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",c:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",c:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",
c:"DV_BOUNDINGS",b:["4"]},{a:"define",c:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",c:"DV_BATCHES_VIEW",b:["6"]},{a:"define",c:"DV_RENDER_TIME",b:["7"]},{a:"define",c:"SSAO_QUALITY_8",b:["1"]},{a:"define",c:"SSAO_QUALITY_16",b:["2"]},{a:"define",c:"SSAO_QUALITY_24",b:["3"]},{a:"define",c:"SSAO_QUALITY_32",b:["4"]},{a:"define",c:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",c:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",c:"AA_QUALITY_LOW",b:["0"]},{a:"define",c:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",
c:"AA_QUALITY_HIGH",b:["2"]},{a:"define",c:"SMAA_RESOLVE",b:["1"]},{a:"define",c:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",c:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",c:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",c:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",c:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",c:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",c:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"define",c:"REFL_PASS_NONE",b:["0"]},{a:"define",c:"REFL_PASS_PLANE",b:["1"]},{a:"define",c:"REFL_PASS_CUBE",
b:["2"]},{a:"define",c:"SRGB_NONE",b:["0"]},{a:"define",c:"SRGB_SIMPLE",b:["1"]},{a:"define",c:"SRGB_PROPER",b:["2"]},{a:"define",c:"CAM_TYPE_ORTHO",b:["0"]},{a:"define",c:"CAM_TYPE_PERSP",b:["1"]},{a:"define",c:"M_PI",b:["3.14159265359"]},{a:"define",c:"M_PI_4",b:["0.785398163"]},{a:"define",c:"INV_PI",b:["0.318309886"]},{a:"define",c:"UP_VECTOR",b:"vec3 ( 0.0 , 0.0 , 1.0 )".split(" ")},{a:"define",c:"RIGHT_VECTOR",b:"vec3 ( 1.0 , 0.0 , 0.0 )".split(" ")},{a:"define",c:"TOWARD_VECTOR",b:"vec3 ( 0.0 , - 1.0 , 0.0 )".split(" ")},
{a:"cond",f:[{a:"if",i:["CONSTANTS_HACK"],j:{a:"grp",f:[{a:"txt",b:"float _0_0 = 0.0 ; float _0_5 = 0.5 ; float _1_0 = 1.0 ; float _255_0 = 255.0 ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"define",c:"_0_0",b:["0.0"]},{a:"define",c:"_0_5",b:["0.5"]},{a:"define",c:"_1_0",b:["1.0"]},{a:"define",c:"_255_0",b:["255.0"]}]}}]}]}}]}]};a["include/to_world.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"TO_WORLD_GLSLV",j:{a:"grp",f:[{a:"define",c:"TO_WORLD_GLSLV",b:[""]},{a:"include",A:"math.glslv"},{a:"var",
c:"BILLBOARD_ALIGN",b:["BILLBOARD_ALIGN_VIEW"]},{a:"var",c:"USE_INSTANCED_PARTCLS",b:["0"]},{a:"var",c:"BILLBOARD_SPHERICAL",b:["0"]},{a:"var",c:"BILLBOARD_RANDOM",b:["0"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"var",c:"BILLBOARD_JITTERED",b:["0"]},{a:"var",c:"BILLBOARD_PRES_GLOB_ORIENTATION",b:["0"]},{a:"var",c:"STATIC_BATCH",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"define",c:"MAX_BILLBOARD_ANGLE",b:["M_PI_4"]},{a:"cond",f:[{a:"if",i:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",
l:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 aX ( vec3 Id , mat3 M ) { vec4 Ie = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec4 If = cI ( RIGHT_VECTOR , - M_PI / 2.0 ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec4 If = cI ( RIGHT_VECTOR , M_PI / 2.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"Ie = qe ( If , Ie ) ; Ie = kj ( Ie ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Id ; aY = cK ( Ie , aY ) ; return aY ; }".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat3 Ih ( vec3 kV , vec3 Id ) { vec3 Ig = kV - Id ; Ig . z = 0.0 ; Ig = normalize ( Ig ) ; vec4 Ie = qj ( Ig , TOWARD_VECTOR ) ; mat3 aY = cG ( ) ; aY [ 0 ] = Id ; aY = cK ( Ie , aY ) ; return aY ; }".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BILLBOARD_JITTERED"],j:{a:"grp",f:[{a:"txt",b:"mat3 ai ( in vec3 Ii , float Ij , float Ik , float Il , vec3 aQ , mat3 S ) { float Im = fract ( length ( aQ ) / 0.17 ) ; float In = Il + Im / 10.0 ; float Io = Im ; if ( Il != 0.0 ) Io /= Il ; Ii *= 1.0 + 0.5 * sin ( Ij ) ; float Ip = length ( Ii ) * Ik * sin ( 2.0 * 3.14 * Ij * In + Io ) ; vec4 Iq = cI ( TOWARD_VECTOR , Ip ) ; vec4 Ir = vec4 ( S [ 1 ] [ 1 ] , S [ 1 ] [ 2 ] , S [ 2 ] [ 0 ] , S [ 2 ] [ 1 ] ) ; Ir = qe ( Ir , Iq ) ; S = cK ( Ir , S ) ; return S ; }".split(" ")}]}}]},
{a:"txt",b:"mat3 ah ( in vec3 kV , in vec3 ae , in mat3 M ) {".split(" ")},{a:"cond",f:[{a:"if",i:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",l:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",l:2},{a:"logical_and_expr",l:2},{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 lj = aX ( ae , M ) ;".split(" ")}]}},{a:"elif",i:["BILLBOARD_RANDOM"],j:{a:"grp",f:[{a:"txt",b:"float Im = fract ( ( ae . x * 1.43 - ae . z * 0.123 + ae . y * 6.1 ) ) ; float Is = 2.0 * M_PI * Im ; vec4 It = vec4 ( M [ 1 ] [ 1 ] , M [ 1 ] [ 2 ] , M [ 2 ] [ 0 ] , M [ 2 ] [ 1 ] ) ; float Iu = asin ( 2.0 * ( It . x * It . y - It . z * It . w ) ) ; float gZ = Iu - Is ; if ( gZ < 0.0 ) gZ = 2.0 * M_PI + gZ ; float Iv = Is ; if ( gZ <= MAX_BILLBOARD_ANGLE ) Iv += gZ ; else if ( gZ <= M_PI - MAX_BILLBOARD_ANGLE ) Iv += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( gZ <= M_PI + MAX_BILLBOARD_ANGLE ) Iv += gZ - M_PI ; else if ( gZ <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) Iv += MAX_BILLBOARD_ANGLE * ( 2.0 * gZ - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else Iv += gZ - 2.0 * M_PI ; vec4 Iw = cI ( UP_VECTOR , Iv ) ; mat3 lj ; lj [ 0 ] = ae ; lj [ 1 ] [ 0 ] = 1.0 ; lj = cK ( Iw , lj ) ;".split(" ")}]}},
{a:"else",j:{a:"grp",f:[{a:"txt",b:"mat3 lj = Ih ( kV , ae ) ;".split(" ")}]}}]},{a:"txt",b:["return","lj",";","}"]},{a:"cond",f:[{a:"if",i:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",l:1},{a:"logical_and_expr",l:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"mat3 af ( in vec3 kV , in vec3 ae , in mat3 M , in mat3 S ) { mat3 lj = ah ( kV , ae , M ) ; S [ 0 ] = vec3 ( 0.0 , 0.0 , 0.0 ) ; lj = aO ( lj , S ) ; return lj ; }".split(" ")}]}}]},
{a:"txt",b:"aj ak ( in vec3 eD , in vec3 Ix , in vec3 Iy , in vec3 Iz , in vec3 IA , in vec3 IB , in mat3 S ) { eD = ad ( S , eD ) ; Ix = ad ( S , Ix ) ; Iy = T ( S , Iy ) ; Iz = T ( S , Iz ) ; IA = T ( S , IA ) ; IB = T ( S , IB ) ; return lk ( aj ( eD , Ix , Iy , Iz , IA , IB , vec3 ( 0.0 ) ) ) ; }".split(" ")}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",f:[{a:"cond",f:[{a:"ifndef",c:"WIND_BENDING_GLSLV",j:{a:"grp",f:[{a:"define",c:"WIND_BENDING_GLSLV",b:[""]},{a:"var",c:"WIND_BEND",b:["0"]},
{a:"var",c:"MAIN_BEND_COL",b:["0"]},{a:"var",c:"DETAIL_BEND",b:["0"]},{a:"var",c:"BEND_CENTER_ONLY",b:["0"]},{a:"var",c:"REFLECTION_PASS",b:["REFL_PASS_NONE"]},{a:"var",c:"BILLBOARD",b:["0"]},{a:"include",A:"std.glsl"},{a:"cond",f:[{a:"if",i:["WIND_BEND"],j:{a:"grp",f:[{a:"txt",b:"void IO ( inout vec3 bd , in vec3 IC , in float ID , in float IE , in float eK , in vec3 Ii , in float IF , in mat4 by ) {".split(" ")},{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",
{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 IG = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 IH = ( by * vec4 ( IC , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 IG = bd ; vec3 IH = IC ;".split(" ")}]}}]},{a:"txt",b:"float dg = length ( IH ) ; float II = IE * ( 1.0 + 0.1 * fract ( dg ) ) ; float IJ = ID * IF * ( 1.0 + sin ( 2.0 * 3.14 * eK * II + dg ) ) ; float IK = ( IG . z - IH . z ) * abs ( IJ ) ; IK += 1.0 ; IK *= IK ; IK = IK * IK - IK ; vec3 IL = IG ; IL . xy += Ii . xy * IK * sign ( IJ ) ; vec3 IM = IL - IH ; if ( all ( equal ( IM , vec3 ( 0.0 ) ) ) ) bd = IC ; else {".split(" ")},
{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"IM = ( by * vec4 ( IM , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"float IN = length ( IG - IH ) ; bd = IC + normalize ( IM ) * IN ; } }".split(" ")},{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"vec4 IP ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 IQ ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 IR ( vec4 x ) { return IP ( IQ ( x ) ) ; } void Jc ( inout vec3 bd , in float eK , in vec3 P , in vec3 Ii , in vec3 IC , in float IS , in float IT , in float IU , in vec3 IV , in mat4 by ) { float IW ; float IX ; float IY ; vec2 IZ ; vec4 I_ ; vec2 Ja ; vec3 Jb ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"vec3 IG = ( by * vec4 ( bd , 1.0 ) ) . xyz ; vec3 IH = ( by * vec4 ( IC , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 IG = bd ; vec3 IH = IC ;".split(" ")}]}}]},{a:"txt",b:"IW = dot ( IH , vec3 ( 1.0 ) ) ; IX = IW + IV . g ; IY = dot ( IG , vec3 ( IV . g ) ) ; IZ = ( eK + vec2 ( IY , IX ) ) ; I_ = ( ( fract ( ( IZ . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( Ii ) * IS ; I_ = IR ( I_ ) ; Ja = I_ . xz + I_ . yw ; Ja . y = 0.5 - Ja . y ; Jb = Ja . xxy * IV . rrb * vec3 ( IT * P . x , IT * P . y , IU ) ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Jb = ( by * vec4 ( Jb , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:["bd","+=","Jb",";","}"]}]}}]},{a:"txt",b:"void am ( inout vec3 N , inout vec3 ac , in vec3 P , in mat4 by ) { vec3 Jd = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:"vec3 Je = ac ; vec3 Jf = a_emitter_center ;".split(" ")},
{a:"cond",f:[{a:"if",i:["REFLECTION_PASS","REFL_PASS_PLANE",{a:"equal_expr",l:2},"BILLBOARD",{a:"logical_and_expr",l:2}],j:{a:"grp",f:[{a:"txt",b:"Jf = ( by * vec4 ( Jf , 1.0 ) ) . xyz ;".split(" ")}]}}]}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"vec3 Je = N ; vec3 Jf = ac ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["MAIN_BEND_COL"],j:{a:"grp",f:[{a:"cond",f:[{a:"if",i:["DETAIL_BEND"],j:{a:"grp",f:[{a:"txt",b:"Jc ( Je , u_time , P , Jd , Jf , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail , by ) ;".split(" ")}]}}]},
{a:"txt",b:"IO ( Je , Jf , au_wind_bending_amp , au_wind_bending_freq , u_time , Jd , a_bending_col_main , by ) ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"IO ( Je , Jf , au_wind_bending_amp , au_wind_bending_freq , u_time , Jd , 1.0 , by ) ;".split(" ")}]}}]},{a:"cond",f:[{a:"if",i:["BEND_CENTER_ONLY"],j:{a:"grp",f:[{a:"txt",b:"N += Je - ac ; ac = Je ;".split(" ")}]}},{a:"else",j:{a:"grp",f:[{a:"txt",b:"N = Je ; ac = Jf ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]}}]}]}};b4w.module.animation=function(a,q){var d=q("__animation"),c=q("__obj_util"),b=q("__print");a.SLOT_0=d.SLOT_0;a.SLOT_1=d.SLOT_1;a.SLOT_2=d.SLOT_2;a.SLOT_3=d.SLOT_3;a.SLOT_4=d.SLOT_4;a.SLOT_5=d.SLOT_5;a.SLOT_6=d.SLOT_6;a.SLOT_7=d.SLOT_7;a.SLOT_ALL=d.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=d.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=d.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=d.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=d.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=d.OBJ_ANIM_TYPE_SOUND;a.OBJ_ANIM_TYPE_PARTICLES=
d.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=d.OBJ_ANIM_TYPE_MATERIAL;a.OBJ_ANIM_TYPE_STATIC=d.OBJ_ANIM_TYPE_STATIC;a.AB_CYCLIC=d.AB_CYCLIC;a.AB_FINISH_RESET=d.AB_FINISH_RESET;a.AB_FINISH_STOP=d.AB_FINISH_STOP;a.is_animated=function(a){return d.is_animated(a)};a.get_anim_names=function(a){return d.uD(a)?d.get_anim_names(a):[]};a.get_current_anim_name=function(a,b){if(!d.is_animated(a))return null;b=b||d.SLOT_0;return d.RM(a,b)};a.apply=function(a,c,q){if(q>d.SLOT_7)b.error("Can't apply animation to slot "+
q+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{q=q||d.SLOT_0;if(d.is_animated(a)){var e=d.get_slot_num_by_anim(a,c);if(-1!=e&&e!=q){b.error('Animation "'+c+'" is already applied to object "'+a.name+'" (slot "'+e+'").');return}}d.PF(a,c)?d.apply(a,null,c,q):b.error('No fcurves in action "'+c+'"')}};a.apply_ext=function(a,c,q){if(q>d.SLOT_7)b.error("Can't apply animation to slot "+q+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{q=q||
d.SLOT_0;var e=c[0];if(d.is_animated(a)){var g=d.get_slot_num_by_anim(a,e);if(-1!=g&&g!=q){b.error('Animation "'+e+'" is already applied to object "'+a.name+'" (slot "'+g+'").');return}}d.PF(a,e)?d.apply(a,c.slice(1),e,q):b.error('No fcurves in action "'+e+'"')}};a.remove=function(a){d.remove(a)};a.remove_slot_animation=function(a,b){d.is_animated(a)&&(b=b||d.SLOT_0,d.remove_slot_animation(a,b))};a.apply_def=function(a){d.apply_def(a)};a.play=function(a,c,q){d.is_animated(a)?(q=q||d.SLOT_0,d.play(a,
c,q),d.NR(a,0,q,!0)):b.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){d.is_animated(a)&&(b=b||d.SLOT_0,d.stop(a,b))};a.is_play=function(a,b){if(!d.is_animated(a))return!1;b=b||d.SLOT_0;return d.is_play(a,b)};a.set_frame=function(a,b,c){d.is_animated(a)&&(c=c||d.SLOT_0,d.set_frame(a,b,c))};a.set_first_frame=function(a,b){d.is_animated(a)&&d.set_first_frame(a,b)};a.set_last_frame=function(a,b){if(d.is_animated(a)){b=b||d.SLOT_0;var c=d.get_anim_start_frame(a,b),e=d.get_anim_length(a,
b);d.set_frame(a,c+e-d.CG,b)}};a.get_frame=function(a,b){if(!d.is_animated(a))return 0;b=b||d.SLOT_0;return d.sw(a,b)};a.set_speed=function(a,b,c){d.is_animated(a)&&(c=c||d.SLOT_0,d.set_speed(a,b||1,c))};a.get_speed=function(a,b){if(!d.is_animated(a))return 0;b=b||d.SLOT_0;return a.fa[b]?d.get_speed(a,b):0};a.get_anim_start_frame=function(a,b){return d.is_animated(a)&&(b=b||d.SLOT_0,a.fa[b])?d.get_anim_start_frame(a,b):-1};a.get_anim_length=function(a,b){return d.is_animated(a)&&(b=b||d.SLOT_0,a.fa[b])?
d.get_anim_length(a,b):-1};a.set_behavior=function(a,b,c){d.is_animated(a)&&(c=c||d.SLOT_0,d.set_behavior(a,b,c))};a.get_behavior=function(a,b){if(!d.is_animated(a))return null;b=b||d.SLOT_0;return d.get_behavior(a,b)};a.apply_smoothing=function(a,b,c,e){e=e||d.SLOT_0;d.is_animated(a)&&d.apply_smoothing(a,b,c,e)};a.frame_to_sec=function(a){return d.frame_to_sec(a)};a.get_slot_num_by_anim=function(a,b){return d.is_animated(a)&&b?d.get_slot_num_by_anim(a,b):-1};a.get_anim_type=function(a,b){return d.is_animated(a)?
d.get_anim_type(a,b):null};a.apply_to_first_empty_slot=function(a,b){return d.apply_to_first_empty_slot(a,b)};a.get_skel_mix_factor=function(a){return a.o.mg};a.set_skel_mix_factor=function(a,n,q){c.is_armature(a)?(n=Math.min(Math.max(n,0),1),a.o.mg!=n&&d.set_skel_mix_factor(a,n,q||0)):b.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.anchors=function(a,q){var d=q("__anchors");a.attach_move_cb=d.attach_move_cb;a.detach_move_cb=d.detach_move_cb;a.is_anchor=d.is_anchor;a.get_element_id=d.get_element_id;a.update=function(){d.update(!0)}};b4w.module.armature=function(a,q){var d=q("__armature"),c=q("__obj_util"),b=q("__transform"),g=q("__print");a.get_bone_tsr=function(a,b,e){if(!c.is_armature(a))return null;if(!d.vr(a,b))return g.error('There is no bone: "',b,'" in "',a.name,'".'),null;e||(e=new Float32Array(8));d.get_bone_tsr(a,b,!1,!1,e);return e};a.get_bone_tsr_rel=function(a,b,e){if(!c.is_armature(a))return null;if(!d.vr(a,b))return g.error('There is no bone: "',b,'" in "',a.name,'".'),null;e||(e=new Float32Array(8));d.get_bone_tsr(a,
b,!1,!0,e);return e};a.set_bone_tsr=function(a,q,e){c.is_armature(a)&&(d.vr(a,q)?(d.set_bone_tsr(a,q,e,!1),b.L(a)):g.error('There is no bone: "',q,'" in "',a.name,'".'))};a.set_bone_tsr_rel=function(a,q,e){c.is_armature(a)&&(d.vr(a,q)?(d.set_bone_tsr(a,q,e,!0),b.L(a)):g.error('There is no bone: "',q,'" in "',a.name,'".'))}};b4w.module.assets=function(a,q){var d=q("__assets");a.AT_ARRAYBUFFER=d.AT_ARRAYBUFFER;a.AT_JSON=d.AT_JSON;a.AT_TEXT=d.AT_TEXT;a.AT_AUDIOBUFFER=d.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=d.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=d.AT_AUDIO_ELEMENT;a.enqueue=function(a,b,g,n){if(a.length)if(a.id)d.enqueue(a,b,g,n);else{for(var c=[],e=0;e<a.length;e++){var q=a[e];c.push({id:q[0],type:q[1],url:q[2],request:q.request?q.request:"GET",ul:null,Mj:null,vb:q[3]})}d.enqueue(c,b,g,n)}}};b4w.module.camera=function(a,q){var d=q("__camera"),c=q("__constraints"),b=q("__container"),g=q("__mat4"),n=q("__math"),B=q("__obj_util"),e=q("__physics"),v=q("__print"),w=q("__scenes"),h=q("__transform"),l=q("__tsr"),x=q("__util"),k=q("__vec3"),f=q("__vec4"),F=q("__quat"),u=new Float32Array(2),r=new Float32Array(3),z=new Float32Array(3),J=new Float32Array(4),D=F.create(),H={},C={};a.MS_STATIC=d.MS_STATIC;a.MS_TARGET_CONTROLS=d.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=d.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=
d.MS_HOVER_CONTROLS;a.static_setup=function(a,b){if(B.is_camera(a)){d.Kq(a);a.o.kb=d.MS_STATIC;if(b){var c=b.pos||l.get_trans_view(a.o.v);b.look_at?d.oE(a,c,b.look_at):h.set_translation(a,c)}h.L(a);e.sync_transform(a);d.Am(a)}else v.error("static_setup(): Wrong camera object")};a.static_set_look_at=function(a,b,c){d.is_static_camera(a)?(b=b||l.get_trans_view(a.o.v),c?d.oE(a,b,c):h.set_translation(a,b),h.L(a),e.sync_transform(a)):v.error("static_set_look_at(): Wrong camera object or camera move style")};
a.static_set_rotation=function(a,b){d.is_static_camera(a)?(h.set_rotation(a,b),h.L(a),e.sync_transform(a)):v.error("static_set_rotation(): Wrong camera object or camera move style")};a.static_get_rotation=function(a,b){if(!d.is_static_camera(a))return v.error("static_get_rotation(): Wrong camera object or camera move style"),null;b=b||new Float32Array(4);return h.get_rotation(a,b)};a.eye_setup=function(a,b){if(B.is_camera(a))if(b&&b.horiz_rot_lim&&("number"!=typeof b.horiz_rot_lim.left||"number"!=
typeof b.horiz_rot_lim.right))v.error("eye_setup(): Wrong horizontal limits object.");else if(b&&b.vert_rot_lim&&("number"!=typeof b.vert_rot_lim.down||"number"!=typeof b.vert_rot_lim.up))v.error("eye_setup(): Wrong vertical limits object.");else{d.Kq(a);a.o.kb=d.MS_EYE_CONTROLS;if(b){var c=b.pos||l.get_trans_view(a.o.v);d.tE(a,c,b.look_at,b.horiz_rot_lim,b.vert_rot_lim)}h.L(a);e.sync_transform(a);d.Am(a)}else v.error("eye_setup(): Wrong camera object")};a.eye_set_look_at=function(a,b,f){d.is_eye_camera(a)?
(b=b||l.get_trans_view(a.o.v),f?d.rQ(a,b,f):h.set_translation(a,b),c.correct_up(a,a.o.sf,!0),h.L(a),e.sync_transform(a)):v.error("eye_set_look_at(): Wrong camera object or camera move style")};a.eye_rotate=function(a,b,c,f,g){d.is_eye_camera(a)?(d.ey(a,b,c,f||!1,g||!1),h.L(a),e.sync_transform(a)):v.error("eye_rotate(): Wrong camera object or camera move style")};a.eye_set_vertical_limits=function(a,b){d.is_eye_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.rE(a,b),h.L(a),e.sync_transform(a)):
v.error("eye_set_vertical_limits(): Incorrect limits object."):v.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.eye_get_vertical_limits=function(a,b,c){if(!d.is_eye_camera(a))return v.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.o;return a.Da?(b=b||{},c?(b.down=a.Da.km,b.up=a.Da.vn):(b.down=a.Da.down,b.up=a.Da.up),b.camera_space=c||!1,b):null};a.eye_set_horizontal_limits=function(a,b){d.is_eye_camera(a)?!b||"number"==typeof b.left&&
"number"==typeof b.right?(d.mE(a,b),h.L(a),e.sync_transform(a)):v.error("eye_set_horizontal_limits(): Incorrect limits object."):v.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.eye_get_horizontal_limits=function(a,b,c){if(!d.is_eye_camera(a))return v.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;a=a.o;return a.Bb?(b=b||{},c?(b.left=a.Bb.Gm,b.right=a.Bb.Zm):(b.left=a.Bb.left,b.right=a.Bb.right),b.camera_space=c||!1,b):null};
a.target_setup=function(a,b){if(B.is_camera(a))if(!b.horiz_rot_lim||"number"==typeof b.horiz_rot_lim.left&&"number"==typeof b.horiz_rot_lim.right)if(!b.vert_rot_lim||"number"==typeof b.vert_rot_lim.down&&"number"==typeof b.vert_rot_lim.up){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){v.error("target_setup(): Wrong distance limits object");return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.Np&&
("number"!=typeof b.Np.min_y||"number"!=typeof b.Np.max_y||b.Np.min_y>b.Np.max_y))v.error("target_setup(): Wrong pivot limits object");else{d.Kq(a);a.o.kb=d.MS_TARGET_CONTROLS;var c=b.pos||l.get_trans_view(a.o.v);d.vE(a,c,b.pivot,b.horiz_rot_lim,b.vert_rot_lim,b.dist_lim,b.Np,b.use_panning||!1);h.L(a);e.sync_transform(a);d.Am(a)}}else v.error("target_setup(): Wrong vertical limits object");else v.error("target_setup(): Wrong horizontal limits object");else v.error("target_setup(): Wrong camera object")};
a.target_rotate=function(a,b,c,f,g){d.is_target_camera(a)?(d.XD(a,b,c,f||!1,g||!1),h.L(a),e.sync_transform(a)):v.error("target_rotate(): Wrong camera object or camera move style")};a.target_set_trans_pivot=function(a,b,c){d.is_target_camera(a)?(b=b||l.get_trans_view(a.o.v),c=c||a.o.pivot,d.ny(a,b,c),h.L(a),e.sync_transform(a)):v.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.target_set_pivot_translation=function(a,b){d.is_target_camera(a)?(d.yQ(a,b),h.L(a),e.sync_transform(a)):
v.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.target_set_distance=function(a,b){if(d.is_target_camera(a)){var c=h.Ep(a,a.o.pivot);h.move_local(a,0,0,Math.max(0,b)-c);h.L(a);e.sync_transform(a)}else v.error("target_set_distance(): Wrong camera object or camera move style")};a.target_get_distance=function(a){return d.is_target_camera(a)?h.Ep(a,a.o.pivot):(v.error("target_get_distance(): Wrong camera object or camera move style"),0)};a.target_zoom_object=function(a,
b){if(d.is_target_camera(a)){var c=h.get_object_center(b,!1,r),f=h.get_object_size(b),g=w.get_active(),g=B.oa(a,g).ea[0],g=d.QM(g)/2,f=f/Math.sin(g),g=h.Ep(a,c);d.ny(a,l.get_trans_view(a.o.v),c);h.L(a);h.move_local(a,0,0,f-g);h.L(a);e.sync_transform(a)}else v.error("target_zoom_object(): Wrong camera object or camera move style")};a.target_get_pivot=function(a,b){if(!d.is_target_camera(a))return v.error("target_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);
k.copy(a.o.pivot,b);return b};a.target_set_distance_limits=function(a,b){if(d.is_target_camera(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){v.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}d.fQ(a,b);h.L(a);e.sync_transform(a)}else v.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.target_get_distance_limits=function(a,b){if(!d.is_target_camera(a))return v.error("target_get_distance_limits(): Wrong camera object or camera move style"),
null;var c=a.o;return c.ub?(b=b||{},b.min=c.ub.min,b.max=c.ub.max,b):null};a.target_set_vertical_limits=function(a,b){d.is_target_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(d.rE(a,b),h.L(a),e.sync_transform(a)):v.error("target_set_vertical_limits(): Wrong limits object"):v.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.target_get_vertical_limits=function(a,b,c){if(!d.is_target_camera(a))return v.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.o;return a.Da?(b=b||{},c?(b.down=a.Da.km,b.up=a.Da.vn):(b.down=a.Da.down,b.up=a.Da.up),b.camera_space=c||!1,b):null};a.target_set_horizontal_limits=function(a,b){d.is_target_camera(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(d.mE(a,b),h.L(a),e.sync_transform(a)):v.error("target_set_horizontal_limits(): Wrong limits object"):v.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.target_get_horizontal_limits=function(a,b,c){if(!d.is_target_camera(a))return v.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.o;return a.Bb?(b=b||{},c?(b.left=a.Bb.Gm,b.right=a.Bb.Zm):(b.left=a.Bb.left,b.right=a.Bb.right),b.camera_space=c||!1,b):null};a.target_set_pivot_limits=function(a,b){d.is_target_camera(a)?b&&("number"!=typeof b.min_z||"number"!=typeof b.max_z||b.min_z>b.max_z)?v.error("target_set_pivot_limits(): Wrong limits object"):(d.uQ(a,b),h.L(a),e.sync_transform(a)):v.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.target_get_pivot_limits=function(a,b){if(!d.is_target_camera(a))return v.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var c=a.o;return c.Dd?(b=b||{},b.min_z=c.Dd.min_z,b.max_z=c.Dd.max_z,b):null};a.target_pan_pivot=function(a,b,c){if(d.is_target_camera(a)){var f=a.o;f.use_panning&&(r[0]=b,r[1]=-c,r[2]=0,l.transform_dir_vec3(r,f.v,r),k.add(f.pivot,r,f.pivot),b=l.get_trans_view(f.v),k.add(b,r,b),h.L(a),e.sync_transform(a))}else v.error("target_pan_pivot(): wrong object")};a.target_switch_panning=function(a,b){if(!d.is_target_camera(a))return v.error("target_switch_panning(): Wrong camera object or camera move style"),
null;a.o.use_panning=b};a.hover_setup_rel=function(b,c){a.hover_setup(b,{pos:c.pos,pivot:c.pivot});var f="undefined"==typeof c.dist_interval?0:Math.max(c.dist_interval,0),g="undefined"==typeof c.angle_interval?0:Math.max(c.angle_interval,0),k="undefined"==typeof c.t?.5:x.clamp(c.t,0,1),l=a.hover_get_distance_limits(b,H);l.min=Math.max(l.min-k*f,0);l.max+=(1-k)*f;f=a.hover_get_vertical_limits(b,C);f.down=x.clamp(f.down+k*g,-Math.PI/2,0);f.up=x.clamp(f.up-(1-k)*g,-Math.PI/2,0);d.hover_set_distance_limits(b,
l);d.hover_set_vertical_limits(b,f);h.L(b);e.sync_transform(b);d.Am(b)};a.hover_setup=function(a,b){if(B.is_camera(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){v.error("hover_setup(): Wrong distance limits object");return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<
b.hover_angle_lim.up))v.error("hover_setup(): Wrong hover angle limits object");else if(b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max))v.error("hover_setup(): Wrong horizontal translation limits object");else if(b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max))v.error("hover_setup(): Wrong vertical translation limits object");
else{d.Kq(a);a.o.kb=d.MS_HOVER_CONTROLS;var c=b.pos||l.get_trans_view(a.o.v);d.uE(a,c,b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1);h.L(a);e.sync_transform(a);d.Am(a)}}else v.error("hover_setup(): Wrong camera object")};a.hover_rotate=function(a,b,c,f,g){d.is_hover_camera(a)?(d.fy(a,b,c,f||!1,g||!1),h.L(a),e.sync_transform(a)):v.error("hover_rotate(): Wrong camera object or camera move style")};a.hover_set_pivot_translation=function(a,b){d.is_hover_camera(a)?
(d.nE(a,b),h.L(a),e.sync_transform(a)):v.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.hover_get_pivot=function(a,b){if(!d.is_hover_camera(a))return v.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);k.copy(a.o.fc,b);return b};a.hover_get_distance=function(a){return d.is_hover_camera(a)?h.Ep(a,a.o.fc):(v.error("hover_get_distance(): Wrong camera object or camera move style"),0)};a.hover_set_vertical_limits=function(a,
b){d.is_hover_camera(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?v.error("hover_set_vertical_limits(): Wrong limits object"):(d.hover_set_vertical_limits(a,b),h.L(a),e.sync_transform(a)):v.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.hover_get_vertical_limits=function(a,b){if(!d.is_hover_camera(a))return v.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var c=a.o;b=b||{};b.down=c.Da.down;b.up=c.Da.up;return b};
a.hover_set_distance_limits=function(a,b){d.is_hover_camera(a)?"number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max?v.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),d.hover_set_distance_limits(a,b),h.L(a),e.sync_transform(a)):v.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.hover_get_distance_limits=function(a,b){if(!d.is_hover_camera(a))return v.error("hover_get_distance_limits(): Wrong camera object or camera move style"),
null;var c=a.o;b=b||{};b.min=c.ub.min;b.max=c.ub.max;return b};a.hover_set_vert_trans_limits=function(a,b){d.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?v.error("hover_set_vert_trans_limits(): Wrong limits object"):(d.CQ(a,b),h.L(a),e.sync_transform(a)):v.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.hover_get_vert_trans_limits=function(a,b){if(!d.is_hover_camera(a))return v.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),
null;var c=a.o;return c.cd?(b=b||{},b.min=c.cd.min,b.max=c.cd.max,b):null};a.hover_set_horiz_trans_limits=function(a,b){d.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?v.error("hover_set_horiz_trans_limits(): Wrong limits object"):(d.lQ(a,b),h.L(a),e.sync_transform(a)):v.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.hover_get_horiz_trans_limits=function(a,b){if(!d.is_hover_camera(a))return v.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),
null;var c=a.o;return c.bd?(b=b||{},b.min=c.bd.min,b.max=c.bd.max,b):null};a.hover_switch_horiz_rotation=function(a,b){if(!d.is_hover_camera(a))return v.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.o.jh=b};a.is_static_camera=d.is_static_camera;a.is_target_camera=d.is_target_camera;a.is_eye_camera=d.is_eye_camera;a.is_hover_camera=d.is_hover_camera;a.get_move_style=function(a){return B.is_camera(a)?d.get_move_style(a):(v.error("get_move_style(): Wrong camera object"),
null)};a.set_translation=function(a,b){if(B.is_camera(a)){var c=a.o;if(d.is_target_camera(a)){var f=l.get_trans_view(c.v),f=k.subtract(b,f,r);k.add(f,c.pivot,c.pivot)}else d.is_hover_camera(a)&&(f=l.get_trans_view(c.v),f=k.subtract(b,f,r),k.add(f,c.fc,c.fc));h.set_translation(a,b);h.L(a);e.sync_transform(a)}else v.error("set_translation(): Wrong camera object")};a.get_translation=function(a,b){if(!B.is_camera(a))return v.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);
return h.get_translation(a,b)};a.rotate_camera=function(a,b,c,f,g){B.is_camera(a)?(f=f||!1,g=g||!1,d.is_target_camera(a)?d.XD(a,b,c,f,g):d.is_eye_camera(a)?d.ey(a,b,c,f,g):d.is_hover_camera(a)?d.fy(a,b,c,f,g):d.is_static_camera(a)?v.warn("rotate_camera(): not supported for STATIC cameras"):v.error("rotate_camera(): Wrong camera move style"),h.L(a),e.sync_transform(a)):v.error("rotate_camera(): Wrong camera object")};a.set_velocities=function(a,b){if(B.is_camera(a)){var c=a.o;"number"==typeof b.trans&&
(c.An=x.clamp(b.trans,0,Infinity));"number"==typeof b.rot&&(c.zn=x.clamp(b.rot,0,Infinity));"number"==typeof b.zoom&&(c.Bn=x.clamp(b.zoom,0,.99))}else v.error("set_velocities(): Wrong camera object")};a.get_velocities=function(a,b){if(!B.is_camera(a))return v.error("get_velocities(): Wrong camera object"),null;var c=a.o;b=b||{};b.trans=c.An;b.rot=c.zn;b.zoom=c.Bn;return b};a.is_look_up=function(a){if(!B.is_camera(a))return v.error("is_look_up(): Wrong camera object"),!1;a=l.get_quat_view(a.o.v);return 0<=
x.quat_to_dir(a,x.AXIS_MZ,r)[1]};a.get_camera_angles=function(a,b){if(!B.is_camera(a))return v.error("get_camera_angles(): Wrong camera object"),null;b=b||new Float32Array(2);d.get_camera_angles(a,b);return b};a.get_camera_angles_char=function(a,b){if(!B.is_camera(a))return v.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);d.get_camera_angles_char(a,b);return b};a.get_camera_angles_dir=function(a,b){b=b||new Float32Array(2);var c=k.normalize(a,r),c=x.iy(x.AXIS_MZ,
c,D);x.correct_cam_quat_up(c,!0);d.rw(c,b);return b};a.set_stereo_distance=function(a,b){if(B.is_camera(a))for(var c=w.get_active(),c=B.oa(a,c).ea,e=0;e<c.length;e++){var f=c[e];f.type!=d.pc&&f.type!=d.wc&&f.type!=d.re&&f.type!=d.Yd||d.xQ(f,b,f.He)}else v.error("set_stereo_distance(): Wrong camera object")};a.get_stereo_distance=function(a){if(!B.is_camera(a))return v.error("get_stereo_distance(): Wrong camera object"),0;var b=w.get_active();a=B.oa(a,b).ea;for(b=0;b<a.length;b++){var c=a[b];if(c.type==
d.pc||c.type==d.wc)return c.Vj}return 0};a.set_eye_distance=function(a,b){if(B.is_camera(a)){var c=w.get_active(),c=B.oa(a,c).ea;d.set_eye_distance(c,b)}else v.error("set_eye_distance(): Wrong camera object")};a.get_eye_distance=function(a){if(!B.is_camera(a))return v.error("get_eye_distance(): Wrong camera object"),0;var b=w.get_active();a=B.oa(a,b).ea;for(b=0;b<a.length;b++){var c=a[b];if(c.type==d.pc||c.type==d.wc||c.type==d.re||c.type==d.Yd)return c.He}return 0};a.set_vertical_axis=function(a,
b){B.is_camera(a)?(k.copy(b,a.o.sf),h.L(a),e.sync_transform(a)):v.error("set_vertical_axis(): Wrong camera object")};a.get_vertical_axis=function(a,b){if(B.is_camera(a))return b||(b=k.create()),k.copy(a.o.sf,b),b;v.error("get_vertical_axis(): Wrong camera object")};a.translate_view=function(a,b,c,e){if(B.is_camera(a)){var f=w.get_active();a=B.oa(a,f).ea;for(f=0;f<a.length;f++){var h=a[f];h.hc||d.Sj(h,!1);var k=r;k[0]=-b;k[1]=-c;k[2]=0;g.translate(h.lb,k,h.lb);g.rotateZ(h.lb,e,h.lb);d.HA(h);d.rv(h)}}else v.error("translate_view(): Wrong camera object")};
a.get_view_vector=function(a,b){if(!B.is_camera(a))return v.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);var c=l.get_quat_view(a.o.v);x.quat_to_dir(c,x.AXIS_MZ,b);return b};a.get_fov=function(a){if(!B.is_camera(a))return v.error("get_fov(): Wrong camera object"),0;var b=w.get_active();a=B.oa(a,b).ea;return d.get_fov(a[0])};a.set_fov=function(a,b){if(B.is_camera(a))for(var c=w.get_active(),c=B.oa(a,c).ea,e=0;e<c.length;e++){var f=c[e];d.set_fov(f,b);f.hc||d.Sj(f,!1);
d.HA(f);d.rv(f)}else v.error("set_fov(): Wrong camera object")};a.set_hmd_fov=function(){v.ja("set_hmd_fov() deprecated")};a.correct_up=function(a,b,d){B.is_camera(a)?(b=b||a.o.sf,c.correct_up(a,b,d||!1),h.L(a),e.sync_transform(a)):v.error("correct_up(): Wrong camera object")};a.set_ortho_scale=function(a,b){if(B.is_camera(a)&&d.is_ortho_camera(a)){var c=a.o;if(d.is_target_camera(a)){var e=l.get_trans_view(c.v),e=k.dist(e,c.pivot);c.tj=b/2*c.sj/e}else d.is_hover_camera(a)?(e=l.get_trans_view(c.v),
e=k.distance(e,c.fc),c.tj=b/2*c.sj/e):(c=w.get_active(),B.oa(a,c).ea[0].top=b/2);d.QR(a)}else v.error("set_ortho_scale(): Wrong camera object")};a.get_ortho_scale=function(a){if(!B.is_camera(a)||!d.is_ortho_camera(a))return v.error("get_ortho_scale(): Wrong camera object"),0;var b=w.get_active();return 2*B.oa(a,b).ea[0].top};a.is_ortho_camera=function(a){return B.is_camera(a)?d.is_ortho_camera(a):(v.error("is_ortho_camera(): Wrong camera object"),!1)};a.calc_ray=function(a,c,e,f){if(!B.is_camera(a))return v.error("calc_ray(): Wrong camera object"),
null;var g=w.get_active(),m=B.oa(a,g).ea[0];f&&3==f.length?v.ja('dest parameter in the function "calc_ray" should be type of parametric line.'):f=f||new Float32Array(6);switch(m.type){case d.Zc:case d.vf:case d.pc:case d.wc:var t=Math.tan(d.vN(m)/2),q=t*m.fb,g=r;c=b.po(c,e,u,m);g[0]=(2*c[0]/m.width-1)*q;g[1]=(1-2*c[1]/m.height)*t;g[2]=-1;l.transform_dir_vec3(g,a.o.v,g);k.normalize(g,g);3==f.length?k.copy(g,f):(a=h.get_translation(a,z),n.set_pline_initial_point(f,a),n.set_pline_directional_vec(f,g));
return f;case d.Jd:return g=r,c=b.po(c,e,u,m),g[0]=(2*c[0]/m.width-1)*m.top*m.fb,g[1]=(1-2*c[1]/m.height)*m.top,g[2]=0,l.transform_vec3(g,a.o.v,g),k.copy(g,f),a=l.get_quat_view(a.o.v,J),k.transformQuat(x.AXIS_MZ,a,g),n.set_pline_directional_vec(f,g),f;default:return v.error("calc_ray(): Non-compatible camera"),f}};a.project_point=function(a,b,c){if(!B.is_camera(a))return v.error("project_point(): Wrong camera object"),null;c=c||new Float32Array(2);return d.project_point(a,b,c)};a.has_distance_limits=
function(a){return(d.is_target_camera(a)||d.is_hover_camera(a))&&null!==a.o.ub};a.has_vertical_rot_limits=function(a){return(d.is_eye_camera(a)||d.is_target_camera(a)||d.is_hover_camera(a))&&null!==a.o.Da};a.has_horizontal_rot_limits=function(a){return(d.is_target_camera(a)||d.is_eye_camera(a))&&null!==a.o.Bb};a.has_vertical_trans_limits=function(a){return d.is_hover_camera(a)&&null!==a.o.cd};a.has_horizontal_trans_limits=function(a){return d.is_hover_camera(a)&&null!==a.o.bd};a.get_frustum_planes=
function(a,b){if(!B.is_camera(a))return v.error("get_frustum_planes(): Wrong camera object"),null;var c=w.get_active(),c=B.oa(a,c).ea[0].lh;f.copy(c.left,b.left);f.copy(c.right,b.right);f.copy(c.top,b.top);f.copy(c.bottom,b.bottom);f.copy(c.near,b.near);f.copy(c.far,b.far);return b}};b4w.module.config=function(a,q){var d=q("__config"),c=q("__compat"),b=q("__debug"),g=q("__data"),n=q("__print");a.P_LOW=d.P_LOW;a.P_HIGH=d.P_HIGH;a.P_ULTRA=d.P_ULTRA;a.P_CUSTOM=d.P_CUSTOM;a.P_AUTO=d.P_AUTO;a.set=d.set;a.get=d.get;a.reset=d.reset;a.reset_limits=d.reset_limits;a.get_std_assets_path=d.get_assets_path;a.get_assets_path=d.get_assets_path;a.apply_quality=function(a){g.is_primary_loaded()?n.error("Cannot change quality profile after a scene is loaded."):(d.set("quality",a),b.ks()&&(d.apply_quality(),
c.lE(b.ks(),!1)))}};b4w.module.controls=function(a,q){var d=q("__controls"),c=q("__physics"),b=q("__print");a.CT_POSITIVE=d.CT_POSITIVE;a.CT_CONTINUOUS=d.CT_CONTINUOUS;a.CT_TRIGGER=d.CT_TRIGGER;a.CT_SHOT=d.CT_SHOT;a.CT_LEVEL=d.CT_LEVEL;a.CT_CHANGE=d.CT_CHANGE;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=
54;a.KEY_7=55;a.KEY_8=56;a.KEY_9=57;a.KEY_A=65;a.KEY_B=66;a.KEY_C=67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_MULT=106;a.KEY_ADD=107;a.KEY_SUB=
109;a.KEY_DEC_POINT=110;a.KEY_DIV=111;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=187;a.KEY_COMMA=188;a.KEY_DASH=189;a.KEY_PERIOD=190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=d.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=d.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=d.PL_MULTITOUCH_MOVE_PAN;a.PL_MULTITOUCH_MOVE_ROTATE=d.PL_MULTITOUCH_MOVE_ROTATE;a.default_AND_logic_fun=d.default_AND_logic_fun;
a.default_OR_logic_fun=d.default_OR_logic_fun;a.create_gamepad_btn_sensor=d.create_gamepad_btn_sensor;a.create_gamepad_axis_sensor=d.create_gamepad_axis_sensor;a.create_custom_sensor=d.create_custom_sensor;a.create_keyboard_sensor=d.create_keyboard_sensor;a.create_collision_sensor=function(a,b,c){return d.create_collision_sensor(a,b||"ANY",c||!1)};a.create_collision_impulse_sensor=d.create_collision_impulse_sensor;a.create_ray_sensor=function(a,n,q,e,v,w,h){if(a&&!c.ka(a))b.ja("No physics for object "+
a.name);else return d.create_ray_sensor(a,n,q,e||"ANY",v||!1,w||!1,h||!1)};a.create_mouse_click_sensor=d.create_mouse_click_sensor;a.create_mouse_wheel_sensor=d.create_mouse_wheel_sensor;a.create_mouse_move_sensor=d.create_mouse_move_sensor;a.create_plock_mouse_sensor=d.create_plock_mouse_sensor;a.create_plock_sensor=d.create_plock_sensor;a.create_touch_move_sensor=d.create_touch_move_sensor;a.create_touch_zoom_sensor=d.create_touch_zoom_sensor;a.create_touch_rotate_sensor=d.create_touch_rotate_sensor;
a.create_touch_click_sensor=d.create_touch_click_sensor;a.create_motion_sensor=d.create_motion_sensor;a.create_vertical_velocity_sensor=d.create_vertical_velocity_sensor;a.create_gyro_angles_sensor=d.create_gyro_angles_sensor;a.create_gyro_quat_sensor=d.create_gyro_quat_sensor;a.create_gyro_delta_sensor=d.create_gyro_delta_sensor;a.create_hmd_quat_sensor=d.create_hmd_quat_sensor;a.create_hmd_position_sensor=d.create_hmd_position_sensor;a.create_timer_sensor=function(a,b){return d.create_timer_sensor(a,
b||!1)};a.reset_timer_sensor=d.reset_timer_sensor;a.create_elapsed_sensor=d.create_elapsed_sensor;a.create_timeline_sensor=d.create_timeline_sensor;a.create_selection_sensor=function(a,b){return d.create_selection_sensor(a,b||!1)};a.create_callback_sensor=function(a,b){return d.create_callback_sensor(a,b||0)};a.set_custom_sensor=function(a,b){d.XP(a,b)};a.get_custom_sensor=function(a){return a.value};a.get_sensor_value=d.get_sensor_value;a.get_sensor_payload=d.get_sensor_payload;a.create_sensor_manifold=
function(a,b,c,e,q,w,h){q=q||d.default_AND_logic_fun;d.create_sensor_manifold(a,b,c,e,q,w,void 0===h?null:h)};a.create_kb_sensor_manifold=function(a,b,c,e,q,w){e=d.create_keyboard_sensor(e);d.create_sensor_manifold(a,b,c,[e],d.default_AND_logic_fun,q,void 0===w?null:w)};a.check_sensor_manifolds=function(a){return d.check_sensor_manifold(a,null)};a.check_sensor_manifold=d.check_sensor_manifold;a.remove_sensor_manifold=d.remove_sensor_manifold;a.reset=d.reset;a.set_plock_smooth_factor=d.set_plock_smooth_factor};b4w.module.constraints=function(a,q){var d=q("__camera"),c=q("__constraints"),b=q("__physics"),g=q("__print"),n=q("__transform");a.append_stiff=function(a,d,g,q,h){h=h||1;d instanceof Array&&2==d.length?c.RI(a,d[0],d[1],g,q,h):c.fA(a,d,g,q,h);n.L(a);b.sync_transform(a)};a.append_semi_stiff=function(a,d,g,q){c.OI(a,d,g,q);n.L(a);b.sync_transform(a)};a.append_semi_stiff_cam=function(a,e,q,w,h,l,x,k){d.is_eye_camera(a)?(h=h||-Math.PI/2,l=l||Math.PI/2,x=x||Math.PI/2,k=k||-Math.PI/2,c.NI(a,e,q,w,h,l,x,
k),n.L(a),b.sync_transform(a)):g.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_semi_soft_cam=function(a,e,q,w){if(d.is_eye_camera(a)){if(!w||0>w)w=.25;c.MI(a,e,q,w);n.L(a);b.sync_transform(a)}else g.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_stiff_trans=function(a,d,g){c.TI(a,d,g);n.L(a);b.sync_transform(a)};a.append_copy_trans=function(a,d,g){c.FI(a,d,g);n.L(a);b.sync_transform(a)};
a.append_stiff_trans_rot=function(a,d,g,q){c.UI(a,d,g,q);n.L(a);b.sync_transform(a)};a.append_track=function(a,d){3==d.length?c.WI(a,d):c.VI(a,d);n.L(a);b.sync_transform(a)};a.append_follow=function(a,d,g,q){3==d.length?c.JI(a,d,g,q):c.II(a,d,g,q);n.L(a);b.sync_transform(a)};a.append_stiff_viewport=function(a,d,g){c.append_stiff_viewport(a,d,g);n.L(a);b.sync_transform(a)};a.remove=function(a){a.cc&&c.remove(a)}};b4w.module.container=function(a,q){var d=q("__container"),c=q("__print");a.get_canvas=d.get_canvas;a.get_canvas_hud=d.get_canvas_hud;a.get_container=d.get_container;a.insert_to_container=function(a,g){2!=arguments.length?c.error("insert_to_container(): two arguments required"):a&&g&&d.insert_to_container(a,g)};a.set_canvas_offsets=function(a,g){c.ja("container.set_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");return d.set_canvas_offsets(a,g)};
a.update_canvas_offsets=function(){c.ja("container.update_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");d.update_canvas_offsets()};a.client_to_canvas_coords=function(a,c,n){n||(n=new Float32Array(2));return d.client_to_canvas_coords(a,c,n)};a.client_to_element_coords=function(a,c,n,q){q||(q=new Float32Array(2));return d.client_to_element_coords(a,c,n,q)};a.force_offsets_updating=function(){c.ja("container.force_offsets_updating() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");
d.force_offsets_updating()};a.resize=function(a,g,n){a&&g||c.warn("Wrong canvas container dimensions: "+a+"x"+g+". Zero dimensions aren't allowed. Resized to: "+d.Iu+"x"+d.Hu+".");d.resize(a,g,n)};a.resize_to_container=function(a){d.resize_to_container(a||!1)}};b4w.module.data=function(a,q){var d=q("__data"),c=q("__loader");a.load=d.load;a.unload=function(a){d.unload(a|0)};a.set_debug_resources_root=d.set_debug_resources_root;a.is_primary_loaded=d.is_primary_loaded;a.is_idle=c.al;a.load_and_add_new=d.load;a.cleanup=a.unload;a.activate_media=d.activate_media;a.prefetch=d.prefetch;a.unfetch=d.unfetch};b4w.module.debug=function(a,q){function d(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}d=c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ATTRIB":d+=b[e];break;case "ADDRESS":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;
case "END":break;default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;b.ATTRIBS=d;return b}function c(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;r.error(c.responseText);throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.mw.ALL_OPS-a.mw.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.mw,e=c.vS,f=g(c.yL),f=f.length?"\t\t("+f.join(", ")+")":"\t\t(NA)";r.groupCollapsed("VERT ->","OPS",e.ALL_OPS,"ATT",e.ATTRIBS,"TEX",e.TEX_OPS,
"\t\tFRAG ->","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);r.groupCollapsed("directives");for(var h=c.ab.di.slice().sort(),f=0;f<h.length;f++){var k=h[f];r.dd(k[0],k[1])}r.groupEnd();r.groupCollapsed("node elements");h=c.ab.Rf;for(f=0;f<h.length;f++)r.dd(h[f]);r.groupEnd();r.groupCollapsed("vert source");r.dd(c.tS);r.groupEnd();r.groupCollapsed("vert translated source");r.dd(c.uS);r.groupEnd();f=["ALL_OPS","TEX_OPS","ATTRIBS"];r.groupCollapsed("vert ops stats");for(var l in e)-1==f.indexOf(l)&&r.dd(l,e[l]);
r.groupEnd();r.groupCollapsed("vert assembly");r.dd(c.sS);r.groupEnd();r.groupCollapsed("frag source");r.dd(c.BM);r.groupEnd();r.groupCollapsed("frag translated source");r.dd(c.CM);r.groupEnd();r.groupCollapsed("frag ops stats");for(l in d)-1==f.indexOf(l)&&r.dd(l,d[l]);r.groupEnd();r.groupCollapsed("frag assembly");r.dd(c.tM);r.groupEnd();r.groupEnd()}}function g(a){for(var b=[],c=J.kp(),d=0;d<c.length;d++)for(var e=c[d],g=f.Ib(e,"MESH",f.DATA_ID_ALL),h=0;h<g.length;h++){var k=F.oa(g[h],e);if(k&&
k.R.length)for(var k=k.R,l=0;l<k.length;l++){var m=k[l];if(m.ib==a)for(var n=0;n<m.Jb.length;n++){var p=m.Jb[n];-1==b.indexOf(p)&&b.push(p)}}}return b}function n(a,b){function c(){y.push(c);Y=b;return a.apply(a,arguments)}return c}function B(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}var e=q("__config"),v=q("__compat"),w=q("__controls"),
h=q("__container"),l=q("__debug"),x=q("__extensions"),k=q("__loader"),f=q("__objects"),F=q("__obj_util"),u=q("__physics"),r=q("__print"),z=q("__renderer"),J=q("__scenes"),D=q("__scenegraph"),H=q("__sfx"),C=q("__shaders"),t=q("__subscene"),m=q("__textures"),A=q("__tsr"),I=q("__util"),p=q("__vec3"),Q=e.H,y=[],Y="",R=!0,G=new Float32Array(2);a.DV_NONE=l.DV_NONE;a.DV_OPAQUE_WIREFRAME=l.DV_OPAQUE_WIREFRAME;a.DV_TRANSPARENT_WIREFRAME=l.DV_TRANSPARENT_WIREFRAME;a.DV_FRONT_BACK_VIEW=l.DV_FRONT_BACK_VIEW;
a.DV_BOUNDINGS=l.DV_BOUNDINGS;a.DV_CLUSTERS_VIEW=l.DV_CLUSTERS_VIEW;a.DV_BATCHES_VIEW=l.DV_BATCHES_VIEW;a.DV_RENDER_TIME=l.DV_RENDER_TIME;a.physics_stats=function(){u.FL()};a.physics_id=function(a){r.log("O",u.nM(a));for(var b=u.OM().jc.ra,c=0;c<b.length;c++){var d=b[c];d.J.ba==a&&r.log("B",d)}};a.visible_objects=function(){for(var a=J.get_active(),b=f.Ib(a,"MESH",f.DATA_ID_ALL),a=[J.Aa(a,t.Db),J.Aa(a,t.Vc),J.Aa(a,t.Id)],c=0;c<a.length;c++){var d=a[c],e=d.Qa;if(e.length){r.group(d.type,"DYNAMIC");
for(var g=0;g<b.length;g++){var h=b[g],k=h.o;if("DYNAMIC"==k.type)for(var l=!1,m=0;m<e.length;m++){for(var n=e[m].ra,p=0;p<n.length;p++){var u=n[p];if(u.Vb&&u.Ee==k){r.dd(h.name,h);l=!0;break}}if(l)break}}r.groupEnd();r.groupCollapsed(d.type,"STATIC");for(g=0;g<b.length;g++)if(h=b[g],k=h.o,"DYNAMIC"!=k.type)for(l=!1,m=0;m<e.length;m++){n=e[m].ra;for(p=0;p<n.length;p++)if(u=n[p],u.Vb&&u.Ee==k){r.dd(h.name,h);l=!0;break}if(l)break}r.groupEnd()}}};a.object_info=function(a){for(var b=J.get_active(),c=
f.Ib(b,"MESH",f.DATA_ID_ALL),d=0;d<c.length;d++){var e=c[d];if(e.name==a){r.log("Object",e);for(var g=J.pw(b),h=0;h<g.length;h++){for(var k=g[h],l=[],m=k.Qa,n=0;n<m.length;n++)for(var p=m[n].ra,u=0;u<p.length;u++)p[u].Ee==e.o&&l.push(p[u]);r.log("Subscene "+k.type,l)}}}};a.objects_stat=function(){var a=J.get_active();console.log("Armatures: "+f.Ib(a,"ARMATURE",f.DATA_ID_ALL).length);console.log("Cameras: "+f.Ib(a,"CAMERA",f.DATA_ID_ALL).length);console.log("Curves: "+f.Ib(a,"CURVE",f.DATA_ID_ALL).length);
console.log("Empties: "+f.Ib(a,"EMPTY",f.DATA_ID_ALL).length);console.log("Lamps: "+f.Ib(a,"LAMP",f.DATA_ID_ALL).length);console.log("Meshes: "+f.Ib(a,"MESH",f.DATA_ID_ALL).length);console.log("Speakers: "+f.Ib(a,"SPEAKER",f.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=0,b=J.get_active(),b=[J.Aa(b,t.Db),J.Aa(b,t.Vc),J.Aa(b,t.Id)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Qa,e=0;e<d.length;e++)for(var f=d[e].ra,g=0;g<f.length;g++){var h=f[g].qa;h&&(a+=h.num_vertices)}}return a};
a.num_triangles=function(){for(var a=0,b=J.get_active(),b=[J.Aa(b,t.Db),J.Aa(b,t.Vc),J.Aa(b,t.Id)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.Qa,e=0;e<d.length;e++)for(var f=d[e].ra,g=0;g<f.length;g++){var h=f[g].qa;h&&(a+=h.num_triangles)}}return a};a.num_draw_calls=function(){for(var a=J.get_active(),b=J.Hi(a,[t.Db,t.Vc,t.Id,t.qd,t.Qe]),c=0,d=0;d<b.length;d++)for(var e=b[d],e=e.Qa,f=0;f<e.length;f++)c+=e[f].ra.length;a=J.Hi(a,[t.Wc,t.qe]);for(d=0;d<a.length;d++)for(e=a[d],e=e.Qa,f=0;f<e.length;f++)c+=
6*e[f].ra.length;return c};a.num_shaders=function(){return I.gi(C.aC())};a.geometry_stats=function(){for(var a=J.get_active(),b=J.pw(a),a={},c=0;c<b.length;c++){var d=b[c];if(d.type!=t.Xl&&d.type!=t.eg)for(var e=d.Qa,f=0;f<e.length;f++)for(var g=e[f].ra,h=0;h<g.length;h++){var k=g[h].qa,l=g[h].Ee;k&&(d.type!=t.Wd&&d.type!=t.fg||l.ot||l.nt)&&(a[k.id]=k)}}var c=b=0,m;for(m in a)d=a[m].da,d.fm&&(c+=d.fm/1048576),b+=d.hm/1048576;return{vbo_memory:b,ibo_memory:c}};a.num_textures=function(){for(var a=[],
b=0,c=J.get_active(),c=[J.Aa(c,t.Db),J.Aa(c,t.Vc),J.Aa(c,t.Id)],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.Qa,f=0;f<e.length;f++)for(var g=e[f].ra,h=0;h<g.length;h++){var k=g[h].qa;if(k)for(var k=k.Sa,l=0;l<k.length;l++){var m=k[l];if("IMAGE"===m.source||"ENVIRONMENT_MAP"===m.source){var n=m.Cb;-1===a.indexOf(n)&&(a.push(n),m=m.width*m.height*4/1048576/m.Io,m*=1.3333,b+=m)}}}}return{number:a.length,memory:b}};a.num_render_targets=function(){for(var a=[],b=0,c=J.get_active(),c=J.pw(c),d=0;d<c.length;d++){var e=
c[d];if(e.type!=t.Xl){var f=e.B,g=[f.lc,f.we];g.push.apply(g,e.Gh);for(e=0;e<g.length;e++){var h=g[e];m.Em(h)&&-1==a.indexOf(h)&&(a.push(h),b+=f.width*f.height*m.uN(h))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=J.get_active();(a=J.Aa(a,t.Db))&&J.bD(a.B,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=J.get_active(),b=J.Aa(a,t.Db),a=J.Hi(a,[t.Xc]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;
case 2:e=[0,0,1];break;default:e=[1,0,1]}J.bD(d.B,b,e)}};a.scenegraph_to_dot=function(){for(var a=J.kp(),b=0;b<a.length;b++)r.log("\n"+D.CL(J.ls(a[b])))};a.scenes_to_dot=function(){};a.loading_graph_to_dot=function(){r.log("\n"+k.zN())};a.controls_info=w.debug;a.object_distance=function(a,b){var c=A.get_trans_view(a.o.v),d=A.get_trans_view(b.o.v);return p.dist(c,d)};a.msg=l.msg;a.fbmsg=l.fbmsg;a.print_telemetry=l.print_telemetry;a.plot_telemetry=l.plot_telemetry;a.fbres=function(a,b){function c(){l.fbmsg("FBRES",
a());setTimeout(c,b)}b||(b=16);c()};a.assert_constants=function(){var a=new Float32Array([0,0,0,1]),b=new Float32Array([1,0,0]),c=new Float32Array([0,1,0]),d=new Float32Array([0,0,1]),e=new Float32Array([-1,0,0]),f=new Float32Array([0,-1,0]),g=new Float32Array([0,0,-1]);if(!I.$i(new Float32Array(3),I.Tz))throw"Wrong VEC3_IDENT";if(!I.$i(a,I.Wl))throw"Wrong QUAT4_IDENT";if(!I.$i(b,I.AXIS_X))throw"Wrong AXIS_X";if(!I.$i(c,I.AXIS_Y))throw"Wrong AXIS_Y";if(!I.$i(d,I.AXIS_Z))throw"Wrong AXIS_Z";if(!I.$i(e,
I.AXIS_MX))throw"Wrong AXIS_MX";if(!I.$i(f,I.AXIS_MY))throw"Wrong AXIS_MY";if(!I.$i(g,I.AXIS_MZ))throw"Wrong AXIS_MZ";};a.mute_music=function(){for(var a=H.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==H.Aw(c)&&H.mute(c,!0)}};a.check_finite=function(a){l.check_finite(a)};a.set_debug_params=function(a){var b=J.get_active(),b=J.Hi(b,[t.eg]);if(b.length)for(var c=0;c<b.length;c++){var d=b[c];if("number"==typeof a.debug_view_mode)switch(a.debug_view_mode){case l.DV_NONE:case l.DV_OPAQUE_WIREFRAME:case l.DV_TRANSPARENT_WIREFRAME:case l.DV_FRONT_BACK_VIEW:case l.DV_BOUNDINGS:case l.DV_CLUSTERS_VIEW:case l.DV_BATCHES_VIEW:case l.DV_RENDER_TIME:J.cQ(d,
a.debug_view_mode);break;default:r.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&J.bQ(d,a.debug_colors_seed);"number"==typeof a.EP&&J.wQ(d,a.EP);"object"==typeof a.wireframe_edge_color&&J.EQ(d,I.f32(a.wireframe_edge_color))}else r.error("Debugging is not available on the scene.")};a.get_error_quantity=function(){return r.aN()};a.get_warning_quantity=function(){return r.wN()};a.clear_errors_warnings=function(){return r.clear_errors_warnings()};a.analyze_shaders=
function(a){var e=C.aC(),f=0,g;for(g in e)a&&-1===g.indexOf(a)||f++;var f="of "+f+" analyzing...",h={};for(g in e)if(!a||-1!==g.indexOf(a)){var k=e[g],m;var n=k.vu;m=k.cs;var p=x.YM();if(p){var u=p.getTranslatedShaderSource(n),p=p.getTranslatedShaderSource(m);if(v.detect_mobile())var u=u.replace("#version","#version 300 //"),p=p.replace("#version","#version 300 //"),t=c("/analyze_shader/vert_gles",u),q=c("/analyze_shader/frag_gles",p);else u=u.replace("#version","#version 400 //"),p=p.replace("#version",
"#version 400 //"),t=c("/analyze_shader/vert",u),q=c("/analyze_shader/frag",p);var w=d(t),y=d(q);m={tS:l.ks().getShaderSource(n),uS:u,sS:t,vS:w,BM:l.ks().getShaderSource(m),CM:p,tM:q,mw:y}}else r.error("WEBGL_debug_shaders extension not found"),m=void 0;u=k.ab;n=u.bg+" + "+u.Ae;m.yL=k;m.ab=u;k=h[n]=h[n]||[];k.push(m);r.dd(f)}for(n in h)r.group("%c"+n,"color: #800"),k=h[n],b(k),r.groupEnd()};a.fake_load=l.fake_load;a.test_performance=function(b){if(C.TA())if(x.uw()){var c=Q.gl_debug;Q.gl_debug=!0;
var d=D.QK();J.SB(null,d);for(var e=D.dc(d,t.On),f=e.B,d=0;5>d;d++)z.lm(e);Q.gl_debug=c;window.setTimeout(function(){l.qP(e);var a=e.Xe;b(a,f.width*f.height*40/(a/1E3)/Math.pow(10,9))},100)}else b(0,0);else window.setTimeout(function(){a.test_performance(b)},100)};a.calc_vbo_garbage_byte_size=l.calc_vbo_garbage_byte_size;a.show_vbo_garbage_info=l.show_vbo_garbage_info;a.print_batches_stat=l.print_batches_stat;a.start_debug=function(a){y=[];R=!0;a=q(a);for(var b in a)"function"===typeof a[b]&&(a[b]=
n(a[b],b))};a.check_debug_result=function(){return R};a.test=function(a,b){try{return b(),!0}catch(V){return R=!1,console.error(a+" test was failed. ",V),!1}};a.pix=function(a){var b=h.oC(),c=h.nC(),d=b/2,e=c/2;h.resize(b,c,!1);b=J.get_active().F.Ja;(c=D.oM(b))||I.D("Couldn't find onscreen subscene");b=c.B;d=h.po(d,e,G,c.B);d[1]=b.height-d[1];d=z.Et(b.ee,d[0],d[1]);B(a,d,1)};a.eqs=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+Y;};a.eqv=B;a.eqf=function(a,b,
c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.eq=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=q(a);for(var b in a)-1==y.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.ok=function(a){if(!a)throw"Wrong result. Function: "+Y;}};b4w.module.geometry=function(a,q){var d=q("__batch"),c=q("__geometry"),b=q("__print"),g=q("__renderer"),n=q("__util");a.extract_vertex_array=function(a,e,g){if(!c.pj(a))return b.error("Wrong object:",a.name),null;if(a=d.Oa(a,e,"MAIN")){if((e=a.da)&&e.Fb&&e.Fb[g])return c.dM(e,g);b.error("Attribute not found:"+g);return null}b.error("Wrong material:",e);return null};a.extract_index_array=function(a,e){if(!c.pj(a))return b.error("Wrong object:",a.name),null;var g=d.Oa(a,e,"MAIN");if(g){if((g=g.da)&&
g.Fb)return g.zd;b.error("Buffer data not found");return null}b.error("Wrong material:",e);return null};a.update_vertex_array=function(a,e,g,n){if(c.pj(a)){var h=c.nj(g),h=c.bC(h);if(h!=n.constructor)b.error("Wrong input array type '"+n.constructor.name+"' for the given attribute. Should be '"+h.name+"'.");else for(var h=["MAIN","SHADOW","COLOR_ID"],l=0;l<h.length;l++){var q=d.Oa(a,e,h[l]);q&&(q=q.da)&&q.Fb&&q.Fb[g]&&c.vF(q,g,0,n)}}else b.error("Wrong object:",a.name)};a.override_geometry=function(a,
e,q,w,h){if(c.pj(a))if(q instanceof Uint16Array||q instanceof Uint32Array)if(w instanceof Float32Array)for(var l=["MAIN","SHADOW","COLOR_ID"],v=0;v<l.length;v++){var k=d.Oa(a,e,l[v]);if(k){var f=k.da;if(f){c.wF(f,k.tg,q);var F={},u;for(u in f.Fb){var r=f.Fb[u],r=w.length/3*r.Wb,z=c.nj(u);F[z]||(F[z]=0);F[z]+=r}z=c.IN(F);f.Kb=z;F={};for(u in f.Fb)switch(r=f.Fb[u],z=c.nj(u),F[z]||(F[z]=0),u){case "a_position":c.Gq(f.Kb,"a_position",w,F[z]);r.offset=F[z];r.length=w.length;F[z]+=r.length;break;case "a_tbn_quat":var B;
h&&(B=c.FA(q,w,w));var D=c.EA(q,w,B);r.length=w.length/3*r.Wb;for(var H=new Float32Array(r.length),C=0;C<H.length;C+=4)H[C]=1,H[C+3]=1;D=n.gen_tbn_quats(D,H);c.Gq(f.Kb,"a_tbn_quat",D,F[z]);r.offset=F[z];F[z]+=r.length;break;default:r.offset=F[z],r.length=w.length/3*r.Wb,D=new (c.bC(z))(r.length),c.Gq(f.Kb,u,D,F[z]),F[z]+=r.length}c.cz(f);g.cv(k);(k=d.af(a,k))&&k.da&&(k.da=f)}}}else b.error("Wrong positions_array type");else b.error("Wrong ibo_array type");else b.error("Wrong object:",a.name)};a.set_shape_key_value=
function(a,d,g){c.check_shape_keys(a)?c.Lw(a,d)?c.bv(a,d,parseFloat(g)):b.error("Wrong key name:",d):b.error("Wrong object:",a.name)};a.check_shape_keys=function(a){return c.check_shape_keys(a)};a.get_shape_keys_names=function(a){return c.check_shape_keys(a)?c.get_shape_keys_names(a):(b.error("Wrong object:",a.name),[])};a.get_shape_key_value=function(a,d){return c.check_shape_keys(a)?c.Lw(a,d)?c.get_shape_key_value(a,d):(b.error("Wrong key name:",d),0):(b.error("Wrong object:",a.name),0)};a.draw_line=
function(a,e,n){n=n||!1;if(e instanceof Float32Array){if(a=d.ww(a))c.draw_line(a,e,n),g.cv(a)}else b.error("Wrong positions type")}};b4w.module.hud=function(a,q){var d=q("__hud"),c=q("__print");a.draw_mixer_strip=function(a,g,n,q,e,v,w){c.Ze("draw_mixer_strip","screen.draw_mixer_strip");d.draw_mixer_strip(a,g,n,q,e,v,w)};a.plot_array=function(a,g,n,q,e,v,w){c.Ze("plot_array","screen.plot_array");d.plot_array(a,g,n,q,e,v,w)}};b4w.module.input=function(a,q){function d(a){e.Ze("enable_split_screen","screen.request_split_screen");var d=c.get_device_by_type_element(c.DEVICE_HMD);if(!d)return!1;if(x)return!0;var f=c.get_vector_param(d,c.yz,h),g=c.get_vector_param(d,c.zz,l);b.set_hmd_fov(a,f,g);if(f=c.get_value_param(d,F))g=v.get_active(),a=B.oa(a,g).ea,b.set_eye_distance(a,f);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};c.get_value_param(d,c.HMD_WEBVR_TYPE)&(c.HMD_NON_WEBVR|c.HMD_WEBVR_MOBILE|c.HMD_WEBVR_DESKTOP)&&
(a.distortion_coefs=[d.distortion_coefs[0],d.distortion_coefs[1]],a.chromatic_aberration_coefs=[d.chromatic_aberration_coefs[0],d.chromatic_aberration_coefs[1],d.chromatic_aberration_coefs[2],d.chromatic_aberration_coefs[3]],d.Pl||(d.Yg&&d.qh&&d.Zg?a.base_line_factor=(d.Yg-d.Zg)/d.qh:d.Zg||(a.base_line_factor=d.Yg/d.qh)),d.Kf&&d.hk&&!d.Pl&&(a.inter_lens_factor=d.Kf/d.hk),k.enabled||(f=1+d.distortion_coefs[0]+d.distortion_coefs[1],v.ft(f,f)));v.set_hmd_params(a);n.resize_to_container(!0);c.reset_device(d);
return x=!0}var c=q("__input"),b=q("__camera"),g=q("__config"),n=q("__container"),B=q("__obj_util"),e=q("__print"),v=q("__scenes"),w=q("__vec4"),h=w.create(),l=w.create(),x=!1,k=g.Jk,f=g.H;a.GMPD_BUTTON_12=c.GMPD_BUTTON_12;a.GMPD_BUTTON_13=c.GMPD_BUTTON_13;a.GMPD_BUTTON_15=c.GMPD_BUTTON_15;a.GMPD_BUTTON_14=c.GMPD_BUTTON_14;a.GMPD_BUTTON_3=c.GMPD_BUTTON_3;a.GMPD_BUTTON_0=c.GMPD_BUTTON_0;a.GMPD_BUTTON_1=c.GMPD_BUTTON_1;a.GMPD_BUTTON_2=c.GMPD_BUTTON_2;a.GMPD_BUTTON_5=c.GMPD_BUTTON_5;a.GMPD_BUTTON_7=
c.GMPD_BUTTON_7;a.GMPD_BUTTON_4=c.GMPD_BUTTON_4;a.GMPD_BUTTON_6=c.GMPD_BUTTON_6;a.GMPD_BUTTON_8=c.GMPD_BUTTON_8;a.GMPD_BUTTON_9=c.GMPD_BUTTON_9;a.GMPD_BUTTON_10=c.GMPD_BUTTON_10;a.GMPD_BUTTON_11=c.GMPD_BUTTON_11;a.GMPD_BUTTON_16=c.GMPD_BUTTON_16;a.GMPD_BUTTON_17=c.GMPD_BUTTON_17;a.GMPD_BUTTON_18=c.GMPD_BUTTON_18;a.GMPD_BUTTON_19=c.GMPD_BUTTON_19;a.GMPD_BUTTON_20=c.GMPD_BUTTON_20;a.GMPD_BUTTON_21=c.GMPD_BUTTON_21;a.GMPD_BUTTON_22=c.GMPD_BUTTON_22;a.GMPD_BUTTON_23=c.GMPD_BUTTON_23;a.GMPD_BUTTON_24=
c.GMPD_BUTTON_24;a.GMPD_BUTTON_25=c.GMPD_BUTTON_25;a.GMPD_AXIS_0=c.GMPD_AXIS_0;a.GMPD_AXIS_1=c.GMPD_AXIS_1;a.GMPD_AXIS_2=c.GMPD_AXIS_2;a.GMPD_AXIS_3=c.GMPD_AXIS_3;a.GMPD_AXIS_4=c.GMPD_AXIS_4;a.GMPD_AXIS_5=c.GMPD_AXIS_5;a.GMPD_AXIS_6=c.GMPD_AXIS_6;a.GMPD_AXIS_7=c.GMPD_AXIS_7;a.GMPD_AXIS_8=c.GMPD_AXIS_8;a.GMPD_AXIS_9=c.GMPD_AXIS_9;a.GMPD_AXIS_10=c.GMPD_AXIS_10;a.GMPD_AXIS_11=c.GMPD_AXIS_11;a.HMD_ORIENTATION_QUAT=c.HMD_ORIENTATION_QUAT;a.HMD_POSITION=c.HMD_POSITION;a.HMD_WEBVR_TYPE=c.HMD_WEBVR_TYPE;
a.HMD_WEBVR_DESKTOP=c.HMD_WEBVR_DESKTOP;a.HMD_WEBVR_MOBILE=c.HMD_WEBVR_MOBILE;a.HMD_NON_WEBVR=c.HMD_NON_WEBVR;a.HMD_WEBVR1=c.HMD_WEBVR1;a.HMD_WEBVR1_1=c.HMD_WEBVR1_1;var F=c.HMD_EYE_DISTANCE;a.HMD_EYE_DISTANCE=F;a.HMD_DISTORTION=c.HMD_DISTORTION;a.HMD_BASELINE_DIST=c.HMD_BASELINE_DIST;a.HMD_SCREEN_LENSE_DIST=c.HMD_SCREEN_LENSE_DIST;a.HMD_SCREEN_WIDTH=c.HMD_SCREEN_WIDTH;a.HMD_SCREEN_HEIGHT=c.HMD_SCREEN_HEIGHT;a.HMD_BEVEL_SIZE=c.HMD_BEVEL_SIZE;a.MOUSE_LOCATION=c.MOUSE_LOCATION;a.MOUSE_DOWN_WHICH=c.MOUSE_DOWN_WHICH;
a.MOUSE_UP_WHICH=c.MOUSE_UP_WHICH;a.MOUSE_WHEEL=c.MOUSE_WHEEL;a.KEYBOARD_UP=c.KEYBOARD_UP;a.KEYBOARD_DOWN=c.KEYBOARD_DOWN;a.TOUCH_START=c.TOUCH_START;a.TOUCH_MOVE=c.TOUCH_MOVE;a.TOUCH_END=c.TOUCH_END;a.GYRO_ORIENTATION_QUAT=c.GYRO_ORIENTATION_QUAT;a.GYRO_ORIENTATION_ANGLES=c.GYRO_ORIENTATION_ANGLES;var u={};u[c.DEVICE_HMD]=[c.HMD_ORIENTATION_QUAT,c.HMD_POSITION];u[c.DEVICE_MOUSE]=[c.MOUSE_LOCATION];var r={};r[c.DEVICE_HMD]=[c.HMD_WEBVR_TYPE];var z={};z[c.DEVICE_MOUSE]=[c.MOUSE_LOCATION,c.MOUSE_DOWN_WHICH,
c.MOUSE_UP_WHICH,c.MOUSE_WHEEL];z[c.DEVICE_KEYBOARD]=[c.KEYBOARD_UP,c.KEYBOARD_DOWN];z[c.DEVICE_TOUCH]=[c.TOUCH_START,c.TOUCH_MOVE,c.TOUCH_END];z[c.DEVICE_GYRO]=[c.GYRO_ORIENTATION_QUAT,c.GYRO_ORIENTATION_ANGLES];var J={};J[c.DEVICE_HMD]=[c.HMD_DISTORTION,c.HMD_EYE_DISTANCE,c.HMD_BASELINE_DIST,c.HMD_SCREEN_LENSE_DIST,c.HMD_SCREEN_WIDTH,c.HMD_SCREEN_HEIGHT,c.HMD_BEVEL_SIZE];a.DEVICE_GYRO=c.DEVICE_GYRO;a.DEVICE_HMD=c.DEVICE_HMD;a.DEVICE_MOUSE=c.DEVICE_MOUSE;a.DEVICE_KEYBOARD=c.DEVICE_KEYBOARD;a.DEVICE_TOUCH=
c.DEVICE_TOUCH;a.can_use_device=c.can_use_device;a.get_device_by_type_element=c.get_device_by_type_element;a.switch_prevent_default=function(a,b){a&&c.switch_prevent_default(a,b)};a.register_device=function(){e.ja("input.register_device() deprecated")};a.reset_device=function(a){a&&a.type==c.DEVICE_HMD?c.reset_device(a):e.error("reset_device is undefined for device.")};a.get_vector_param=function(a,b,d){if(a&&a.type in u&&0<=u[a.type].indexOf(b))return c.get_vector_param(a,b,d);e.error("device hasn't param: ",
b);return null};a.get_value_param=function(a,b){if(a&&a.type in r&&0<=r[a.type].indexOf(b))return c.get_value_param(a,b);e.error("device hasn't param: ",b);return null};a.attach_param_cb=function(a,b,d){d=d||null;if(a&&a.type in z&&0<=z[a.type].indexOf(b))return c.attach_param_cb(a,b,d);e.error("device hasn't param: ",b)};a.detach_param_cb=function(a,b,d){d=d||null;if(a&&a.type in z&&0<=z[a.type].indexOf(b))return c.detach_param_cb(a,b,d);e.error("device hasn't param: ",b)};a.set_config=function(a,
b,d){if(a&&a.type in J&&0<=J[a.type].indexOf(b))return c.set_config(a,b,d);e.error("device hasn't config: ",b)};a.request_fullscreen_hmd=function(){e.Ze("request_fullscreen_hmd","screen.request_fullscreen_hmd");if(v.xa()){var a=v.mj(v.get_active());if(a&&(d(a),a=c.get_device_by_type_element(c.DEVICE_HMD))){var b=a.Uc;b&&!b.isPresenting&&(b.capabilities.canPresent?(a=n.get_canvas(),b.requestPresent([{source:a}]).then(function(){if(!f.is_mobile_device){var a=b.getEyeParameters("left"),c=b.getEyeParameters("right");
n.resize(2*Math.max(a.renderWidth,c.renderWidth),Math.max(a.renderHeight,c.renderHeight),!1)}},function(){e.error("HMD fullscreen request failed.")})):e.error("HMD fullscreen request failed."))}}};a.enable_split_screen=d;a.disable_split_screen=function(){e.Ze("disable_split_screen","screen.exit_split_screen");var a=c.get_device_by_type_element(c.DEVICE_HMD);if(!x||!a||!a.lf)return!1;v.set_hmd_params({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);v.ft(a,a);n.resize_to_container(!0);
return!0};a.set_gamepad_key=function(a,b,d){switch(a){case 0:a=c.Nq;break;case 1:a=c.Ju;break;case 2:a=c.Ku;break;case 3:a=c.Lu;break;default:a=c.Nq}a=c.get_device_by_type_element(a);c.set_config(a,b,d)};a.get_pressed_gmpd_btn=c.get_pressed_gmpd_btn;a.get_moved_gmpd_axis=c.get_moved_gmpd_axis;a.check_enable_gamepad_indices=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b};
a.add_click_listener=function(a,b){a&&b&&c.add_click_listener(a,b)};a.remove_click_listener=function(a,b){a&&b&&c.remove_click_listener(a,b)}};b4w.module.lights=function(a,q){function d(a){for(var c=e.get_active(),d=g.Ib(c,"LAMP",g.DATA_ID_ALL),f=0;f<d.length;f++){var k=d[f];if("SUN"==k.nb.type){var n=k;break}}if(!n)B.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){d=h.deg_to_rad(180-a.hor_position);a=h.deg_to_rad(90-a.vert_position);f=n.o;v.set_rotation_euler(n,[a,0,d]);d=new Float32Array(3);k=w.get_quat_view(f.v);h.quat_to_dir(k,h.AXIS_Z,d);f=w.get_trans_view(f.v);f=l.length(f);
l.copy(d,x);l.scale(x,f,x);v.set_translation(n,x);v.L(n);d=n.nb;if(d.CB){f=c.world.horizon_color;k=c.world.zenith_color;a=Math.cos(Math.abs(a));var r=Math.max(a,.1)*c.world.light_settings.environment_energy;b.set_light_energy(d,Math.max(Math.min(3*a,1),0)*d.vB);e.set_environment_colors(c,r,f,k)}e.wq(n,c)}}function c(a){if(n.is_lamp(a))return a.nb.type;B.error("get_light_type(): Wrong object");return""}var b=q("__lights"),g=q("__objects"),n=q("__obj_util"),B=q("__print"),e=q("__scenes"),v=q("__transform"),
w=q("__tsr"),h=q("__util"),l=q("__vec3"),x=new Float32Array(3),k,f,F,u=60;a.get_lamps=function(a){var b=e.get_active(),b=g.Ib(b,"LAMP",g.DATA_ID_ALL);if(!a)return b;for(var c=[],d=0;d<b.length;d++){var f=b[d];f.nb.type===a&&c.push(f)}return c};a.get_sun_params=function(){for(var a=e.get_active(),a=g.Ib(a,"LAMP",g.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.nb.type){b=d;break}}return b?(b=b.nb.direction,a=h.rad_to_deg(Math.atan2(-b[1],b[0]))+90,180<a&&(a-=360),b=h.rad_to_deg(Math.atan2(b[2],
Math.sqrt(b[0]*b[0]+b[1]*b[1]))),c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=d;a.set_day_time=function(a){for(var b=e.get_active(),b=g.Ib(b,"LAMP",g.DATA_ID_ALL),c=0;c<b.length;c++){var f=b[c];if("SUN"==f.nb.type){var h=f;break}}h?(h=-Math.cos(a/12*Math.PI)*u,b={},b.hor_position=12>a?15*a:15*(a-24),b.vert_position=h,d(b)):B.error("There is no sun on the scene")};a.set_date=function(a){k=a.getFullYear();f=a.getMonth();F=a.getDate();k?1582==k&&9==f&&4<F&&15>F&&B.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):
B.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=function(a){u=Math.min(Math.max(a,0),90)};a.get_light_params=function(a){if(n.is_lamp(a))var b=a.nb;else return B.error("get_light_params(): Wrong object"),null;if(a=c(a))switch(a){case "SPOT":var d={light_type:a,light_color:new Float32Array(3),light_energy:b.Ye,light_spot_blend:b.mq,light_spot_size:b.Dl,light_distance:b.distance};d.light_color.set(b.color);break;case "POINT":d={light_type:a,light_color:new Float32Array(3),light_energy:b.Ye,
light_distance:b.distance};d.light_color.set(b.color);break;default:d={light_type:a,light_color:new Float32Array(3),light_energy:b.Ye},d.light_color.set(b.color)}return d?d:null};a.get_light_type=c;a.set_light_params=function(a,c){if(n.is_lamp(a)){var d=a.nb,f=e.get_active(),g=!1;"number"==typeof c.light_energy&&b.set_light_energy(d,c.light_energy);"object"==typeof c.light_color&&b.set_light_color(d,c.light_color);"number"==typeof c.light_spot_blend&&(b.oQ(d,c.light_spot_blend),g=!0);"number"==typeof c.light_spot_size&&
(b.pQ(d,c.light_spot_size),g=!0);"number"==typeof c.light_distance&&(b.nQ(d,c.light_distance),g=!0);e.wq(a,f);g&&e.wR(f)}else B.error("set_light_params(): Wrong object")};a.get_light_energy=function(a){return n.is_lamp(a)?a.nb.Ye:(B.error("get_light_energy(): Wrong object"),0)};a.set_light_energy=function(a,c){if(n.is_lamp(a)){var d=e.get_active();b.set_light_energy(a.nb,c);e.wq(a,d)}else B.error("set_light_energy(): Wrong object")};a.get_light_color=function(a,b){if(!n.is_lamp(a))return B.error("get_light_color(): Wrong object"),
null;b=b||new Float32Array(3);b.set(a.nb.color);return b};a.set_light_color=function(a,c){if(n.is_lamp(a)){var d=e.get_active();b.set_light_color(a.nb,c);e.wq(a,d)}else B.error("set_light_color(): Wrong object")}};b4w.module.logic_nodes=function(a,q){var d=q("__logic_nodes");a.append_custom_callback=function(a,b){d.HI(a,b)};a.remove_custom_callback=function(a){d.wP(a)};a.run_entrypoint=function(a,b){d.RP(a,b)}};b4w.module.material=function(a,q){function d(a,b){for(var c=a.K[0].R,d=0;d<c.length;d++){var e=c[d];if(-1<e.Jb.indexOf(b)&&"MAIN"==e.type)return!0}return!1}function c(a,b){var c=g.Oa(a,b,"MAIN");return!(!c||!c.Rd[0])}function b(a,b){var c=g.Oa(a,b,"MAIN");return!(!c||!c.Rd[1])}var g=q("__batch"),n=q("__config"),B=q("__geometry"),e=q("__objects"),v=q("__obj_util"),w=q("__print"),h=q("__shaders"),l=q("__util"),x=q("__scenes"),k=n.H;a.inherit_material=function(a,b,c,d){if(B.pj(c)&&B.pj(a)){var f=a.rc.Fj.indexOf(b);
if(-1==f)w.error('inherit_material(): material "'+b+'" not found on the object "'+a.Cd+'".');else{var g=c.rc.Fj.indexOf(d);-1==g?w.error('inherit_material(): material "'+d+'" not found on the object "'+c.Cd+'".'):(0==c.ig.data.submeshes[g].shade_tangs.length&&a.rc.Xi[f].use_tangent_shading&&w.warn('The target material "'+d+'" was exported without tangent shading data. However, the "'+b+'" material requires it. It\'s needed to enable the "Tangent Shading" option on the target material for correct rendering.'),
e.inherit_material(a,b,c,d))}}else w.error('inherit_material(): both objects "'+a.Cd+'" and "'+c.Cd+'" must have the "Dynamic Geometry & Materials" flag enabled.')};a.get_materials_names=function(a){var b=[];a=a.K;for(var c=0;c<a.length;c++)for(var d=a[c].R,e=0;e<d.length;e++)for(var f=0;f<d[e].Jb.length;f++)-1==b.indexOf(d[e].Jb[f])&&b.push(d[e].Jb[f]);return b};a.set_diffuse_color=function(a,b,c){var d=g.Oa(a,b,"MAIN");d?(d.xd.set(c),(a=g.af(a,b,"MAIN"))&&a.xd.set(c)):w.error('Couldn\'t set property "diffuse_color"!')};
a.get_diffuse_color=function(a,b){var c=g.Oa(a,b,"MAIN");if(c){var d=new Float32Array(4);d.set(c.xd);return d}w.error('Couldn\'t get property "diffuse_color"!')};a.set_diffuse_intensity=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.ih=c,a=g.af(a,b,"MAIN"))a.ih=c}else w.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_intensity=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.ih;w.error('Couldn\'t get property "diffuse_intensity"!');return 0};a.set_specular_color=function(a,b,
c){var d=g.Oa(a,b,"MAIN");d?(d.Yf.set(c),(a=g.af(a,b,"MAIN"))&&a.Yf.set(c)):w.error('Couldn\'t set property "specular_color"!')};a.get_specular_color=function(a,b){var c=g.Oa(a,b,"MAIN");if(c){var d=Array(3);d[0]=c.Yf[0];d[1]=c.Yf[1];d[2]=c.Yf[2];return d}w.error('Couldn\'t get property "specular_color"!')};a.set_specular_color_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.Di=c,a=g.af(a,b,"MAIN"))a.Di=c}else w.error('Couldn\'t set property "specular_color_factor"!')};a.get_specular_color_factor=
function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.Di;w.error('Couldn\'t get property "specular_color_factor"!');return 0};a.set_specular_intensity=function(a,b,d){c(a,b)||w.error('Property "specular_intensity" is missing!');g.Oa(a,b,"MAIN").Rd[0]=d;(a=g.af(a,b,"MAIN"))&&(a.Rd[0]=d)};a.get_specular_intensity=function(a,b){c(a,b)||w.error('Property "specular_intensity" is missing!');return g.Oa(a,b,"MAIN").Rd[0]};a.check_specular_intensity=c;a.set_specular_hardness=function(a,c,d){b(a,c)||w.error('Property "specular_hardness" is missing!');
g.Oa(a,c,"MAIN").Rd[1]=d;(a=g.af(a,c,"MAIN"))&&(a.Rd[1]=d)};a.get_specular_hardness=function(a,c){b(a,c)||w.error('Property "specular_hardness" is missing!');return g.Oa(a,c,"MAIN").Rd[1]};a.check_specular_hardness=b;a.set_emit_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.ug=c,a=g.af(a,b,"MAIN"))a.ug=c}else w.error('Couldn\'t set property "emit_factor"!')};a.get_emit_factor=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.ug;w.error('Couldn\'t get property "emit_factor"!');return 0};
a.set_ambient_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.lg=c,a=g.af(a,b,"MAIN"))a.lg=c}else w.error('Couldn\'t set property "ambient_factor"!')};a.get_ambient_factor=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.lg;w.error('Couldn\'t get property "ambient_factor"!');return 0};a.set_diffuse_color_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.hh=c,a=g.af(a,b,"MAIN"))a.hh=c}else w.error('Couldn\'t set property "diffuse_color_factor"!')};a.get_diffuse_color_factor=function(a,
b){var c=g.Oa(a,b,"MAIN");if(c)return c.hh;w.error('Couldn\'t get property "diffuse_color_factor"!');return 0};a.set_alpha_factor=function(a,b,c){var d=g.Oa(a,b,"MAIN");if(d){if(d.xf=c,a=g.af(a,b,"MAIN"))a.xf=c}else w.error('Couldn\'t set property "alpha_factor"!')};a.get_alpha_factor=function(a,b){var c=g.Oa(a,b,"MAIN");if(c)return c.xf;w.error('Couldn\'t get property "alpha_factor"!');return 0};a.get_material_extended_params=function(a,b){if(!a||!b)return w.error("missing arguments in get_material_params"),
null;if(!d(a,b))return null;var c=g.Oa(a,b,"MAIN");if(!c)return null;var e={};"MAIN"==c.type&&(e.reflect_factor=c.reflect_factor,e.fresnel=c.bf[2],e.fresnel_factor=5*(1-c.bf[3]),e.parallax_scale=c.parallax_scale,e.parallax_steps=g.Kd(c,"PARALLAX_STEPS")[1]);return e};a.get_water_material_params=function(a,b){if(!a||!b)return w.error("missing arguments in get_water_material_params"),null;if(!d(a,b))return null;var c=g.Oa(a,b,"MAIN");if(!c||!c.Kh)return null;if(!c)return w.error("material not found"),
null;var e={};if("MAIN"==c.type){if(k.an){var f=e.shallow_water_col=Array(3);f[0]=c.shallow_water_col[0];f[1]=c.shallow_water_col[1];f[2]=c.shallow_water_col[2];f=e.shore_water_col=Array(3);f[0]=c.shore_water_col[0];f[1]=c.shore_water_col[1];f[2]=c.shore_water_col[2];e.shallow_water_col_fac=c.shallow_water_col_fac;e.shore_water_col_fac=c.shore_water_col_fac}e.foam_factor=c.foam_factor;e.norm_uv_velocity=c.gk;e.absorb_factor=g.Kd(c,"ABSORB")[1];e.sss_strength=g.Kd(c,"SSS_STRENGTH")[1];e.sss_width=
g.Kd(c,"SSS_WIDTH")[1];e.dst_noise_scale0=g.Kd(c,"DST_NOISE_SCALE_0")[1];e.dst_noise_scale1=g.Kd(c,"DST_NOISE_SCALE_1")[1];e.dst_noise_freq0=g.Kd(c,"DST_NOISE_FREQ_0")[1];e.dst_noise_freq1=g.Kd(c,"DST_NOISE_FREQ_1")[1];e.dir_min_shore_fac=g.Kd(c,"DIR_MIN_SHR_FAC")[1];e.dir_freq=g.Kd(c,"DIR_FREQ")[1];e.dir_noise_scale=g.Kd(c,"DIR_NOISE_SCALE")[1];e.dir_noise_freq=g.Kd(c,"DIR_NOISE_FREQ")[1];e.dir_min_noise_fac=g.Kd(c,"DIR_MIN_NOISE_FAC")[1];e.dst_min_fac=g.Kd(c,"DST_MIN_FAC")[1];e.waves_hor_fac=g.Kd(c,
"WAVES_HOR_FAC")[1]}return e};a.set_material_extended_params=function(a,b,c){if(a&&b&&c)if(d(a,b)){var e=g.Oa(a,b,"MAIN");if(e){var f=[e];(e=g.af(a,b,"MAIN"))&&f.push(e);for(a=0;a<f.length;a++)e=f[a],"number"==typeof c.material_reflectivity&&(e.reflect_factor=c.material_reflectivity),"number"==typeof c.material_fresnel&&(e.bf[2]=c.material_fresnel),"number"==typeof c.material_fresnel_factor&&(e.bf[3]=1-c.material_fresnel_factor/5),"number"==typeof c.material_parallax_scale&&(e.parallax_scale=c.material_parallax_scale),
"number"==typeof c.material_parallax_steps&&(b=h.N(parseFloat(c.material_parallax_steps)),g.mb(e,"PARALLAX_STEPS",b),g.vc(e),x.PD(e))}else w.error("material not found")}else w.error("setting material params is not possible");else w.error("missing arguments in set_material_params")};a.set_water_material_params=function(a,b,c){if(a&&b&&c)if(d(a,b)){var e=g.Oa(a,b,"MAIN");if(e){var f=[e];(e=g.af(a,b,"MAIN"))&&f.push(e);for(a=0;a<f.length;a++)e=f[a],k.an&&("object"==typeof c.shallow_water_col&&e.shallow_water_col.set(c.shallow_water_col),
"number"==typeof c.shallow_water_col_fac&&(e.shallow_water_col_fac=c.shallow_water_col_fac),"object"==typeof c.shore_water_col&&e.shore_water_col.set(c.shore_water_col),"number"==typeof c.shore_water_col_fac&&(e.shore_water_col_fac=c.shore_water_col_fac)),k.shore_smoothing&&e.Fn&&("boolean"==typeof c.shore_smoothing&&(c.shore_smoothing?g.mb(e,"SHORE_SMOOTHING",1):g.mb(e,"SHORE_SMOOTHING",0)),"number"==typeof c.absorb_factor&&(b=h.N(parseFloat(c.absorb_factor)),g.mb(e,"ABSORB",b))),"number"==typeof c.foam_factor&&
k.sm&&(e.foam_factor=c.foam_factor),"number"==typeof c.norm_uv_velocity&&(e.gk=c.norm_uv_velocity),k.water_dynamic&&e.water_dynamic&&("boolean"==typeof c.water_dynamic&&(c.water_dynamic?g.mb(e,"DYNAMIC",1):g.mb(e,"DYNAMIC",0)),"number"==typeof c.waves_height&&(b=h.N(parseFloat(c.waves_height)),g.mb(e,"WAVES_HEIGHT",b)),"number"==typeof c.waves_length&&(b=h.N(parseFloat(c.waves_length)),g.mb(e,"WAVES_LENGTH",b)),"number"==typeof c.sss_strength&&(b=h.N(parseFloat(c.sss_strength)),g.mb(e,"SSS_STRENGTH",
b)),"number"==typeof c.sss_width&&(b=h.N(parseFloat(c.sss_width)),g.mb(e,"SSS_WIDTH",b)),"number"==typeof c.dst_noise_scale0&&(b=h.N(parseFloat(c.dst_noise_scale0)),g.mb(e,"DST_NOISE_SCALE_0",b)),"number"==typeof c.dst_noise_scale1&&(b=h.N(parseFloat(c.dst_noise_scale1)),g.mb(e,"DST_NOISE_SCALE_1",b)),"number"==typeof c.dst_noise_freq0&&(b=h.N(parseFloat(c.dst_noise_freq0)),g.mb(e,"DST_NOISE_FREQ_0",b)),"number"==typeof c.dst_noise_freq1&&(b=h.N(parseFloat(c.dst_noise_freq1)),g.mb(e,"DST_NOISE_FREQ_1",
b)),"number"==typeof c.dir_min_shore_fac&&(b=h.N(parseFloat(c.dir_min_shore_fac)),g.mb(e,"DIR_MIN_SHR_FAC",b)),"number"==typeof c.dir_freq&&(b=h.N(parseFloat(c.dir_freq)),g.mb(e,"DIR_FREQ",b)),"number"==typeof c.dir_noise_scale&&(b=h.N(parseFloat(c.dir_noise_scale)),g.mb(e,"DIR_NOISE_SCALE",b)),"number"==typeof c.dir_noise_freq&&(b=h.N(parseFloat(c.dir_noise_freq)),g.mb(e,"DIR_NOISE_FREQ",b)),"number"==typeof c.dir_min_noise_fac&&(b=h.N(parseFloat(c.dir_min_noise_fac)),g.mb(e,"DIR_MIN_NOISE_FAC",
b)),"number"==typeof c.dst_min_fac&&(b=h.N(parseFloat(c.dst_min_fac)),g.mb(e,"DST_MIN_FAC",b)),"number"==typeof c.waves_hor_fac&&(b=h.N(parseFloat(c.waves_hor_fac)),g.mb(e,"WAVES_HOR_FAC",b))),g.vc(e),x.PD(e)}else w.error("material not found")}else w.error("setting water material params is not possible");else w.error("missing arguments in set_water_material_params")};a.set_line_params=function(a,b){var c=g.ww(a);c?(l.Lf(b.color)&&c.xd.set(b.color),l.Lf(b.width)&&(c.Hm=b.width)):w.error("Couldn't set line params!")};
a.get_line_params=function(a){if(a=g.ww(a))return{color:new Float32Array(a.xd),width:a.Hm};w.error("Couldn't get line params");return null};a.set_nodemat_value=function(a,b,c){if(v.Ag(a)){var d=b[0],e=g.Oa(a,d,"MAIN");if(null===e)return w.error('Material "'+d+'" was not found in the object "'+a.name+'".'),null;e=g.oh(e.jf,b);if(null===e)return w.error('Value node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'),null;g.set_nodemat_value(a,d,e,c)}else w.error('The type of the object "'+
a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_value=function(a,b){if(!v.Ag(a))return w.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),0;var c=b[0],d=g.Oa(a,c,"MAIN");if(null===d)return w.error('Material "'+c+'" was not found in the object "'+a.name+'".'),0;c=g.oh(d.jf,b);return null===c?(w.error('Value node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'),0):g.get_nodemat_value(d,c)};a.set_nodemat_rgb=function(a,b,c,d,e){if(v.Ag(a)){var f=
b[0],h=g.Oa(a,f,"MAIN");null===h?w.error('Material "'+f+'" was not found in the object "'+a.name+'".'):(h=g.oh(h.hf,b),null===h?w.error('RGB node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'):g.set_nodemat_rgb(a,f,h,c,d,e))}else w.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_rgb=function(a,b,c){if(!v.Ag(a))return w.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var d=b[0],e=g.Oa(a,d,"MAIN");
if(null===e)return w.error('Material "'+d+'" was not found in the object "'+a.name+'".'),null;d=g.oh(e.hf,b);if(null===d)return w.error('RGB node "'+b[b.length-1]+'" was not found in the object "'+a.name+'".'),null;c||(c=new Float32Array(3));return g.get_nodemat_rgb(e,d,c)}};b4w.module.math=function(a,q){var d=q("__vec3"),c=q("__util"),b=q("__math"),g=new Float32Array(3);a.create_pline_from_points=function(a,c){var e=new Float32Array(6);b.set_pline_initial_point(e,a);d.subtract(c,a,g);b.set_pline_directional_vec(e,g);return e};a.create_pline_from_point_vec=function(a,c){var d=new Float32Array(6);b.set_pline_initial_point(d,a);b.set_pline_directional_vec(d,c);return d};a.create_pline=function(){return new Float32Array(6)};a.get_pline_directional_vec=b.get_pline_directional_vec;
a.get_pline_initial_point=b.get_pline_initial_point;a.set_pline_initial_point=b.set_pline_initial_point;a.set_pline_directional_vec=b.set_pline_directional_vec;a.line_plane_intersect=c.line_plane_intersect;a.calc_pline_point=b.calc_pline_point;a.point_plane_dist=b.point_plane_dist};b4w.module.particles=function(a,q){var d=q("__particles"),c=q("__print");a.set_size=function(a,g,n){d.Fx(a,g)?d.set_size(a,g,n):c.error('set_size(): Object "'+a.name+'" has not a particle system named "'+g+'"')};a.set_normal_factor=function(a,g,n){d.Fx(a,g)?d.set_normal_factor(a,g,n):c.error('set_normal_factor(): Object "'+a.name+'" has not a particle system named "'+g+'"')};a.set_factor=function(a,g,n){d.Fx(a,g)?(n=Math.min(n,1),n=Math.max(n,0),d.set_factor(a,g,n)):c.error('set_factor(): Object "'+
a.name+'" has not a particle system named "'+g+'"')}};b4w.module.physics=function(a,q){function d(a,b,c,d){return n.ML(a,d[c[0]],d[c[1]],d[c[2]])}function c(a,b,c,d,g){b=Math.abs(a[2]-b[2]);return b<g&&B.UN(a,c,d)?b:Number.MAX_VALUE}var b=q("__physics"),g=q("__print"),n=q("__util"),B=q("__navmesh");a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){b.ka(a)?b.enable_simulation(a):g.ja("No physics for object "+a.name)};a.disable_simulation=function(a){b.ka(a)?b.disable_simulation(a):g.ja("No physics for object "+a.name)};a.has_physics=
function(a){return b.ka(a)};a.has_simulated_physics=function(a){return b.has_simulated_physics(a)};a.has_dynamic_physics=function(a){return b.has_dynamic_physics(a)};a.set_gravity=function(a,c){b.ka(a)?b.set_gravity(a,c):g.ja("No physics for object "+a.name)};a.set_transform=function(a,c,d){b.ka(a)?b.set_transform(a,c,d):g.ja("No physics for object "+a.name)};a.sync_transform=function(a){b.ka(a)?b.sync_transform(a):g.ja("No physics for object "+a.name)};a.apply_velocity=function(a,c,d,h){b.ka(a)?
b.apply_velocity(a,c,d,h):g.ja("No physics for object "+a.name)};a.apply_velocity_world=function(a,c,d,h){b.ka(a)?b.apply_velocity_world(a,c,d,h):g.ja("No physics for object "+a.name)};a.apply_force=function(a,c,d,h){b.ka(a)?b.apply_force(a,c,d,h,!1):g.ja("No physics for object "+a.name)};a.apply_force_world=function(a,c,d,h){b.ka(a)?b.apply_force(a,c,d,h,!0):g.ja("No physics for object "+a.name)};a.apply_torque=function(a,c,d,h){b.ka(a)?b.apply_torque(a,c,d,h):g.ja("No physics for object "+a.name)};
a.vehicle_throttle=function(a,c){b.ka(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object"),b.vehicle_throttle(a,n.clamp(c,-1,1))):g.ja("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,c,d){if(b.ka(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object");c=n.clamp(c,0,1);var e=a.I.nm;-1==d||1==d?e=Math.max(-1,Math.min(e+d*c,1)):!d&&0<=e?e=Math.max(0,e-c):!d&&0>e?e=Math.min(0,e+c):g.error("Wrong steering direction");b.vehicle_throttle(a,n.clamp(e,
-1,1))}else g.ja("No physics for object "+a.name)};a.vehicle_steer=function(a,c){b.ka(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object"),b.vehicle_steer(a,n.clamp(c,-1,1))):g.ja("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,c,d){if(b.ka(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object");c=n.clamp(c,0,1);var e=a.I.hn;-1==d||1==d?e=Math.max(-1,Math.min(e+d*c,1)):!d&&0<=e?e=Math.max(0,e-c):!d&&0>e?e=Math.min(0,e+c):g.error("Wrong steering direction");
b.vehicle_steer(a,n.clamp(e,-1,1))}else g.ja("No physics for object "+a.name)};a.vehicle_brake=function(a,c){b.ka(a)?(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object"),b.vehicle_brake(a,n.clamp(c,0,1))):g.ja("No physics for object "+a.name)};a.vehicle_brake_inc=function(a,c){if(b.ka(a)){b.is_vehicle_chassis(a)||b.is_vehicle_hull(a)||g.error("Wrong object");c=n.clamp(c,-1,1);var d=a.I.mo;b.vehicle_brake(a,n.clamp(d+d*c,0,1))}else g.ja("No physics for object "+a.name)};a.is_vehicle_chassis=
function(a){return b.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return b.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!b.ka(a))return g.ja("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.Le.name;g.error("Wrong object");return null};a.get_vehicle_throttle=function(a){if(!b.ka(a))return g.ja("No physics for object "+a.name),null;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.I.nm;g.error("Wrong object");return null};a.get_vehicle_steering=
function(a){if(!b.ka(a))return g.ja("No physics for object "+a.name),0;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.I.hn;g.error("Wrong object");return 0};a.get_vehicle_brake=function(a){if(!b.ka(a))return g.ja("No physics for object "+a.name),0;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return a.I.mo;g.error("Wrong object");return 0};a.get_vehicle_speed=function(a){if(!b.ka(a))return g.ja("No physics for object "+a.name),0;if(b.is_vehicle_chassis(a)||b.is_vehicle_hull(a))return b.get_vehicle_speed(a);
g.error("Wrong object");return 0};a.is_character=function(a){return b.tC(a)};a.set_character_move_dir=function(a,c,d){b.ka(a)?b.set_character_move_dir(a,c,d):g.ja("No physics for object "+a.name)};a.set_character_move_type=function(a,c){b.ka(a)?b.set_character_move_type(a,c):g.ja("No physics for object "+a.name)};a.set_character_walk_velocity=function(a,c){b.ka(a)?b.set_character_walk_velocity(a,c):g.ja("No physics for object "+a.name)};a.set_character_run_velocity=function(a,c){b.ka(a)?b.set_character_run_velocity(a,
c):g.ja("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,c){b.ka(a)?b.set_character_fly_velocity(a,c):g.ja("No physics for object "+a.name)};a.character_jump=function(a){b.ka(a)?b.character_jump(a):g.ja("No physics for object "+a.name)};a.character_rotation_inc=function(a,c,d){b.ka(a)?b.character_rotation_inc(a,c,d):g.ja("No physics for object "+a.name)};a.set_character_rotation=function(a,c,d){b.ka(a)?b.set_character_rotation(a,c,d):g.ja("No physics for object "+a.name)};
a.set_character_rotation_v=function(a,c){b.ka(a)?b.set_character_rotation_v(a,c):g.ja("No physics for object "+a.name)};a.set_character_rotation_h=function(a,c){b.ka(a)?b.set_character_rotation_h(a,c):g.ja("No physics for object "+a.name)};a.append_collision_test=function(a,c,d,h){b.ka(a)?b.append_collision_test(a,c||"ANY",d,h||!1):g.ja("No physics for object "+a.name)};a.remove_collision_test=function(a,c,d){b.ka(a)?b.remove_collision_test(a,c||"ANY",d):g.ja("No physics for object "+a.name)};a.apply_collision_impulse_test=
function(a,c){b.ka(a)?b.apply_collision_impulse_test(a,c):g.ja("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){b.ka(a)?b.clear_collision_impulse_test(a):g.ja("No physics for object "+a.name)};a.append_ray_test=function(a,c,d,h,l,n){a=a||null;return null==a||b.ka(a)?b.append_ray_test(a,c,d,h||"ANY",l,n||!1,!1,!1,!1):(g.ja("No physics for object "+a.name),0)};a.append_ray_test_ext=function(a,c,d,h,l,n,k,f,q){a=a||null;return null==a||b.ka(a)?b.append_ray_test(a,c,d,h||"ANY",
l,n||!1,k||!1,f||!1,q||!1):(g.ja("No physics for object "+a.name),0)};a.remove_ray_test=function(a){b.KC(a)?b.remove_ray_test(a):g.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,c,d){b.KC(a)?b.change_ray_test_from_to(a,c,d):g.error("Wrong ray test ID")};a.apply_constraint=function(a,c,d,h,l,n,k,f,q,u){b.ka(c)&&b.ka(l)?b.apply_constraint(a,c,d,h,l,n,k,f,q,u):g.error("Wrong objects")};a.clear_constraint=function(a){b.ka(a)&&b.CN(a)?b.clear_constraint(a):g.error("Wrong object")};a.pull_to_constraint_pivot=
function(a,c,d,h,l,n){b.ka(a)&&b.ka(h)?b.pull_to_constraint_pivot(a,c,d,h,l,n):g.error("Wrong objects")};a.navmesh_get_island=function(a,c,n){n||(n=d);if(b.ka(a)){var e=a.J.Dp;return e?B.navmesh_get_island(e,c,n):(g.error(a.name+" is not a navigation mesh object"),null)}g.ja("No physics for object "+a.name)};a.navmesh_find_path=function(a,n,q,h){if(b.ka(a)){var e=a.J.Dp;if(!e)return g.error(a.name+" is not a navigation mesh object"),null;h=h||{};a={};a.do_not_pull_string=!!h.do_not_pull_string;a.distance_to_closest=
h.distance_to_closest||d;a.distance_to_farthest=h.distance_to_farthest||c;a.island=h.island||0;a.allowed_distance=h.allowed_distance||Number.MAX_VALUE;a.return_normals=h.return_normals||!1;return B.navmesh_find_path(e,n,q,a)}g.ja("No physics for object "+a.name)}};b4w.module.rgb=function(a,q){var d=q("__util"),c=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,c,d){var b=new Float32Array(3);b[0]=a;b[1]=c;b[2]=d;return b};a.set=function(a,c,d,q){q[0]=a;q[1]=c;q[2]=d;return q};a.css_to_rgb=function(a,c,n,q){q=q||new Float32Array(3);q[0]=a/255;q[1]=c/255;q[2]=n/255;d.OE(q,q);return q};a.rgb_to_css=function(a){a=d.ex(a,c);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=function(a){function b(a){a=
Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=d.ex(a,c);return"#"+b(a[0])+b(a[1])+b(a[2])}};
b4w.module.rgba=function(a,q){var d=q("__util"),c=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,c,d,q){var b=new Float32Array(4);b[0]=a;b[1]=c;b[2]=d;b[3]=q;return b};a.set=function(a,c,d,q,e){e[0]=a;e[1]=c;e[2]=d;e[3]=q;return e};a.css_to_rgba=function(a,c,n,q,e){e=e||new Float32Array(4);e[0]=a/255;e[1]=c/255;e[2]=n/255;e[3]=q;d.OE(e,e);return e};a.rgba_to_css=function(a){var b=d.ex(a,c);return[Math.round(255*b[0]),Math.round(255*b[1]),
Math.round(255*b[2]),a[3]]}};b4w.module.scenes=function(a,q){function d(){var a=g.get_canvas();return e.pick_object(a.clientWidth/2,a.clientHeight/2)}var c=q("__batch"),b=q("__camera"),g=q("__container"),n=q("__data"),B=q("__graph"),e=q("__objects"),v=q("__obj_util"),w=q("__print"),h=q("__scenes"),l=q("__scenegraph"),x=q("__subscene"),k=q("__util");a.DATA_ID_ALL=e.DATA_ID_ALL;a.set_active=function(a){var b=h.kp();h.set_active(k.keysearch("name",a,b))};a.get_active=function(){return h.xa()?h.get_active().name:""};a.get_scenes=
function(){for(var a=h.kp(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.get_active_camera=function(){if(h.xa())return h.mj(h.get_active());w.error("No active scene");return!1};a.get_object_by_name=function(a,b){var c=e.oc(e.Nu,a,b|0,!0);if(c)return c;w.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,c){if(a=e.oc(e.Mu,a,b,c|0))return a;w.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=function(a,b){var c=e.oc(e.Cc,a,b|0);if(c)return c;w.error("get object "+
a+": not found")};a.get_world_by_name=function(a,b){var c=e.get_world_by_name(a,b|0);if(c)return c;w.error("get object "+a+": not found")};a.get_object_data_id=function(a){return v.get_object_data_id(a)};a.pick_object=function(a,b){var c=h.nh();return c?(c=h.Aa(c,x.uf))&&c.enable_hmd_stereo?(w.ja("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),d()):e.pick_object(a,b):(w.error("No active scene"),null)};a.pick_center=d;a.outlining_is_enabled=function(a){return a&&
a.o&&a.o.Ic};a.set_outline_intensity=function(a,b){a&&a.o&&a.o.Ic?e.set_outline_intensity(a,b):w.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.o&&a.o.Ic)return a.o.Jg;w.error("get_outline_intensity(): wrong object");return 0};a.apply_outline_anim=function(a,b,c,d){a&&a.o&&a.o.Ic?e.apply_outline_anim(a,b,c,d):w.error("apply_outline_anim(): wrong object")};a.apply_outline_anim_def=function(a){if(a&&a.o&&a.o.Ic){var b=a.o.zh;e.apply_outline_anim(a,b.Gj,b.Hj,
b.Ij)}else w.error("apply_outline_anim_def(): wrong object")};a.clear_outline_anim=function(a){a&&a.o&&a.o.Ic?e.clear_outline_anim(a):w.error("clear_outline_anim(): wrong object")};a.set_outline_color=h.set_outline_color;a.get_outline_color=function(a){var b=h.get_active();if(b=h.Aa(b,x.Vl))return a=a||new Float32Array(3),a.set(b.vi),a};a.set_hmd_params=function(a){h.xa()?a&&(!a.distortion_coefs||a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof
Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),h.set_hmd_params(a)):w.error("No active scene")};a.get_shadow_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active(),b=h.Aa(a,x.Xc);if(!b)return null;var c=a.F.Jc,d=h.Aa(a,x.Db),e=h.Aa(a,x.Re),g={};g.csm_resolution=c.csm_resolution;
g.self_shadow_polygon_offset=b.self_shadow_polygon_offset;e&&(g.self_shadow_normal_offset=e.self_shadow_normal_offset);g.enable_csm=c.enable_csm;g.csm_num=c.csm_num;g.csm_first_cascade_border=c.csm_first_cascade_border;g.first_cascade_blur_radius=c.first_cascade_blur_radius;g.csm_last_cascade_border=c.csm_last_cascade_border;g.last_cascade_blur_radius=c.last_cascade_blur_radius;g.fade_last_cascade=c.fade_last_cascade;g.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(g.csm_borders=h.XM(a,
d.B),g.blur_radii=new Float32Array(c.csm_num),g.blur_radii.set(d.B.Sm.subarray(0,c.csm_num))):(g.csm_borders=null,g.blur_radii=null);return g};a.set_shadow_params=function(a){if(h.xa()){var d=h.get_active();"number"==typeof a.self_shadow_polygon_offset&&B.ha(d.F.Ja,function(b,c){c.type==x.Xc&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});for(var e=h.Hi(d,[x.Re]),f=0;f<e.length;f++){var g=e[f];"number"==typeof a.self_shadow_normal_offset&&(g.self_shadow_normal_offset=a.self_shadow_normal_offset);
"number"==typeof a.pcf_blur_radius&&(g.pcf_blur_radius=a.pcf_blur_radius)}e=h.Hi(d,[x.Vc]);for(f=0;f<e.length;f++){var k=e[f];"number"==typeof a.self_shadow_normal_offset&&(k.self_shadow_normal_offset=a.self_shadow_normal_offset);"number"==typeof a.pcf_blur_radius&&(k.pcf_blur_radius=a.pcf_blur_radius);k.Ba=!0}e=d.F.Jc;"number"==typeof a.csm_first_cascade_border&&(e.csm_first_cascade_border=a.csm_first_cascade_border);"number"==typeof a.first_cascade_blur_radius&&(e.first_cascade_blur_radius=a.first_cascade_blur_radius);
"number"==typeof a.csm_last_cascade_border&&(e.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(e.last_cascade_blur_radius=a.last_cascade_blur_radius);if(g){k=g.Qa;for(f=0;f<k.length;f++)for(var l=k[f].ra,n=0;n<l.length;n++){var q=l[n];if(q.Ee.Gd){var t=q.qa;c.jA(t,e);c.vc(t);x.Ec(g,q)}}g.Ba=!0}g=v.oa(d.Ui,d).ea;for(f=0;f<g.length;f++)b.az(g[f],e);h.ky(d)}else w.error("No active scene")};a.get_environment_colors=function(){if(!h.xa())return w.error("No active scene"),
[];var a=h.get_active();return h.get_environment_colors(a)};a.set_environment_colors=function(a,b,c){if(h.xa()){var d=h.get_active(),e=h.Aa(d,x.Db);h.set_environment_colors(d,a||0==a?parseFloat(a):e.wg,b||0==b?b:e.Md,c||0==c?c:e.Vd)}else w.error("No active scene")};a.get_fog_color_density=function(a){if(!h.xa())return w.error("No active scene"),!1;var b=h.get_active();return h.get_fog_color_density(b,a)};a.set_fog_color_density=function(a){if(h.xa()){var b=h.get_active();h.set_fog_color_density(b,
a)}else w.error("No active scene")};a.get_fog_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active(),b={};b.cp=h.eN(a);b.fog_depth=h.cN(a);b.fog_start=h.fN(a);b.fog_height=h.dN(a);return b};a.set_fog_params=function(a){if(h.xa()){var b=h.get_active();"number"==typeof a.cp&&h.hE(b,a.cp);"number"==typeof a.fog_depth&&h.fE(b,a.fog_depth);"number"==typeof a.fog_start&&h.iE(b,a.fog_start);"number"==typeof a.fog_height&&h.gE(b,a.fog_height)}else w.error("No active scene")};
a.get_ssao_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.get_ssao_params(a)};a.set_ssao_params=function(a){if(h.xa()){var b=h.get_active(),d=h.Hi(b,[x.Uq]),b=h.Hi(b,[x.Su]);if(!d.length)return w.error("SSAO is not enabled on the scene"),0;for(var e=0;e<d;e++){var f=d[e],g=b[e],k=a,n=h.get_active(),q=f.Qa[0].ra[0],t=q.qa,m=g.Qa[0].ra[0],v=m.qa;if("quality"in k){var B=k.quality;8===B||16===B||24===B||32===B?(f.nq=B,c.mb(t,"SSAO_QUALITY","SSAO_QUALITY_"+
B),c.vc(t),x.Ec(f,q)):w.error('set_ssao_params(): Wrong "quality" value.')}"use_hemisphere"in k&&(f.Yt=k.use_hemisphere,c.mb(t,"SSAO_HEMISPHERE",k.use_hemisphere|0),c.vc(t),x.Ec(f,q));"use_blur_depth"in k&&(g.Vt=k.use_blur_depth,c.mb(v,"SSAO_BLUR_DEPTH",k.use_blur_depth|0),c.vc(v),x.Ec(g,m),l.Ck(n.F.Ja,g,v));"ssao_white"in k&&(f.ssao_white=k.ssao_white,c.mb(t,"SSAO_WHITE",k.ssao_white|0),c.vc(t),x.Ec(f,q));"blur_discard_value"in k&&(g.Wt=k.blur_discard_value);"radius_increase"in k&&(f.$t=k.radius_increase);
"influence"in k&&(f.Zt=k.influence);"dist_factor"in k&&(f.Xt=k.dist_factor);if("boolean"==typeof k.ssao_only){n=h.Aa(n,x.Db);n.ssao_only=k.ssao_only;q=n.Qa;t=[];for(m=0;m<q.length;m++)for(v=q[m].ra,B=0;B<v.length;B++){var p=v[B].qa;c.mb(p,"SSAO_ONLY",k.ssao_only|0);c.vc(p);t.push(v[B])}for(m=0;m<t.length;m++)x.Ec(n,t[m])}f.Ba=!0;g.Ba=!0}}else w.error("No active scene")};a.get_color_correction_params=function(){if(!h.xa())return w.error("No active scene"),null;var a=h.get_active(),a=h.Aa(a,x.Fu);if(!a)return null;
var b={};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(h.xa()){var b=h.get_active();if(b=h.Aa(b,x.Fu))"brightness"in a&&(b.brightness=a.brightness),"contrast"in a&&(b.contrast=a.contrast),"exposure"in a&&(b.exposure=a.exposure),"saturation"in a&&(b.saturation=a.saturation),b.Ba=!0}else w.error("No active scene")};a.get_sky_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=
h.get_active();return h.get_sky_params(a)};a.set_sky_params=function(a){if(h.xa()){var b=h.get_active(),c=h.Aa(b,x.gg);c&&("color"in a&&c.en.set(a.color),"rayleigh_brightness"in a&&(c.rayleigh_brightness=a.rayleigh_brightness),"mie_brightness"in a&&(c.mie_brightness=a.mie_brightness),"spot_brightness"in a&&(c.spot_brightness=a.spot_brightness),"scatter_strength"in a&&(c.scatter_strength=a.scatter_strength),"rayleigh_strength"in a&&(c.rayleigh_strength=a.rayleigh_strength),"mie_strength"in a&&(c.mie_strength=
a.mie_strength),"rayleigh_collection_power"in a&&(c.rayleigh_collection_power=a.rayleigh_collection_power),"mie_collection_power"in a&&(c.mie_collection_power=a.mie_collection_power),"mie_distribution"in a&&(c.mie_distribution=a.mie_distribution),c.Ba=!0,c.gt=!0,h.XR(b,c))}else w.error("No active scene")};a.get_dof_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.Aa(a,x.Kn)?h.get_dof_params(a):null};a.set_dof_params=function(a){if(h.xa()){var b=h.get_active();
h.set_dof_params(b,a)}else w.error("No active scene")};a.get_god_rays_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.Aa(a,x.Ul)?h.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(h.xa()){var b=h.get_active();h.set_god_rays_params(b,a)}else w.error("No active scene")};a.get_bloom_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.Aa(a,x.Hn)?h.get_bloom_params(a):null};a.set_bloom_params=function(a){if(h.xa()){var b=
h.get_active();h.set_bloom_params(b,a)}else w.error("No active scene")};a.get_glow_material_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.Aa(a,x.Ln)?h.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(h.xa()){var b=h.get_active();h.set_glow_material_params(b,a)}else w.error("No active scene")};a.get_wind_params=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.get_wind_params(a)};a.set_wind_params=
function(a){if(h.xa()){var b=h.get_active();e.set_wind_params(b,a)}else w.error("No active scene")};a.get_water_surface_level=function(a,b){if(!h.xa())return w.error("No active scene"),0;var c=h.get_active();return c.F.Bc?h.get_water_surface_level(c,a,b):(w.error("No water parameters on the active scene"),0)};a.set_water_params=function(a){if(h.xa()){var b=h.get_active();h.set_water_params(b,a)}else w.error("No active scene")};a.get_water_mat_params=function(a){if(h.xa()){var b=h.get_active();h.get_water_mat_params(b,
a)}else w.error("No active scene")};a.update_scene_materials_params=function(){if(h.xa()){var a=h.get_active();h.BF(a)}else w.error("No active scene")};a.hide_object=function(a,b){b=b||!1;!v.is_mesh(a)&&!v.is_empty(a)||v.is_dynamic(a)?b?h.uo(a,!0):h.ur(a,!0):w.error("show/hide is only supported for dynamic objects.")};a.show_object=function(a,b){b=b||!1;!v.is_mesh(a)&&!v.is_empty(a)||v.is_dynamic(a)?b?h.uo(a,!1):h.ur(a,!1):w.error("show/hide is only supported for dynamic objects.")};a.is_hidden=function(a){if(v.Ag(a)||
v.is_empty(a)||v.is_lamp(a))return h.is_hidden(a);w.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.is_visible=function(a){return a.o.is_visible};a.check_object_by_name=function(a,b){return e.oc(e.Nu,a,b|0,!0)?!0:!1};a.check_object_by_dupli_name=function(a,b,c){return e.oc(e.Mu,a,b,c|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return e.oc(e.Cc,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var c=h.get_active();a||(a="ALL");b||0===b||(b=e.DATA_ID_ALL);
return e.kC(c,a,b)};a.get_object_name=function(a){return a?a.Cd:(w.error("Wrong object name"),"")};a.get_object_name_hierarchy=function(a){if(!a)return w.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Cd),a=v.get_dg_parent(a);return b.reverse()};a.get_object_type=function(a){return a&&a.type?a.type:(w.error("Wrong object"),"UNDEFINED")};a.get_object_children=function(a){return a.ve.slice(0)};a.get_first_character=function(){return e.get_first_character(h.get_active())};a.get_shore_dist=
function(a,b){b||0===b||(b=1);if(!h.xa())return w.error("No active scene"),0;var c=h.get_active();return h.get_shore_dist(c,a,b)};a.get_cam_water_depth=function(){return h.get_cam_water_depth()};a.get_type_mesh_object=function(a){return v.is_mesh(a)?a.o.type:""};a.get_meta_tags=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.get_meta_tags(a)};a.get_custom_prop=function(){if(!h.xa())return w.error("No active scene"),!1;var a=h.get_active();return h.get_custom_prop(a)};
a.append_object=function(a,b){if(a.o.Hs){if(b)var c=h.kp(),c=k.keysearch("name",b,c);else c=h.get_active();h.append_object(c,a,!0)}else w.error('object "'+a.name+'" has been created not by coping.')};a.remove_object=function(a){(v.is_mesh(a)||v.is_empty(a))&&v.is_dynamic(a)?(e.lt(a,a.o.Is,!1,!1),n.oP(a),e.lt(a,!0,!0,!0),e.remove_object(a)):w.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.marker_frame=function(a){var b=h.get_active();if(b.timeline_markers&&
a in b.timeline_markers)return h.marker_frame(b,a);w.error('"'+a+'" marker not found.');return 0};a.get_mb_params=function(){var a=h.get_active();return(a=h.Aa(a,x.Ug))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.set_mb_params=function(a){var b=h.get_active(),b=h.Hi(b,[x.Ug]);if(b.length)for(var c=0;c<b.length;c++){var d=b[c];"number"==typeof a.mb_decay_threshold&&(d.mb_decay_threshold=a.mb_decay_threshold);"number"==typeof a.mb_factor&&(d.mb_factor=a.mb_factor)}else w.error("The motion blur subscene doesn't exist.")};
a.can_select_objects=function(){var a=h.get_active();return!!h.Aa(a,x.Wd)}};b4w.module.screen=function(a,q){function d(){}function c(){}function b(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullscreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}a=a||e.get_container();
b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",d,!1);a.$x=a.$x||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.$x?a.$x():f.error("B4W App: request fullscreen method is not supported")}function g(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||
document.msExitFullscreen;"function"!=typeof a&&f.error("B4W App: exit fullscreen method is not supported");a.apply(document)}function n(a){var b=h.get_device_by_type_element(h.DEVICE_HMD);if(b&&!J){var c=h.get_value_param(b,h.HMD_WEBVR_TYPE);if(c&h.HMD_WEBVR1_1){var d=b.Uc;if(!H.is_mobile_device){var f=d.getEyeParameters("left"),d=d.getEyeParameters("right");e.resize(2*Math.max(f.renderWidth,d.renderWidth),Math.max(f.renderHeight,d.renderHeight),!1)}}else e.resize(2048,1024,!1);f=h.get_vector_param(b,
h.yz,r);d=h.get_vector_param(b,h.zz,z);B.set_hmd_fov(a,f,d,!(c&h.HMD_WEBVR1_1));f={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};c&(h.HMD_NON_WEBVR|h.HMD_WEBVR_MOBILE|h.HMD_WEBVR_DESKTOP)&&(f.distortion_coefs=[b.distortion_coefs[0],b.distortion_coefs[1]],f.chromatic_aberration_coefs=[b.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]],b.Pl||(b.Yg&&b.qh&&b.Zg?f.base_line_factor=(b.Yg-b.Zg)/b.qh:b.Zg||(f.base_line_factor=
b.Yg/b.qh)),b.Kf&&b.hk&&!b.Pl&&(f.inter_lens_factor=b.Kf/b.hk));D.enabled||F.ft(.5,1);F.set_hmd_params(f);if(c=h.get_value_param(b,h.HMD_EYE_DISTANCE))f=F.get_active(),a=k.oa(a,f).ea,B.set_eye_distance(a,c);F.yP();h.reset_device(b);J=!0}}var B=q("__camera"),e=q("__container"),v=q("__config"),w=q("__hud"),h=q("__input"),l=q("__main"),x=q("__mat4"),k=q("__obj_util"),f=q("__print"),F=q("__scenes"),u=q("__vec4"),r=u.create(),z=u.create();x.create();x.create();var J=!1,D=v.Jk,H=v.H;a.draw_mixer_strip=
w.draw_mixer_strip;a.plot_array=w.plot_array;a.request_fullscreen=b;a.exit_fullscreen=g;a.check_fullscreen=h.check_fullscreen;a.request_fullscreen_hmd=function(a,c,g){if("HMD"!=!v.get("stereo")||"NONE"==v.get("stereo")&&v.get("is_mobile_device")){var k=h.get_device_by_type_element(h.DEVICE_HMD);if(k&&h.get_value_param(k,h.HMD_WEBVR_TYPE)&h.HMD_WEBVR1){var l=k.Uc;l&&!l.isPresenting&&(c=c||function(){},g=g||function(){},d=function(){l.isPresenting?c():(window.removeEventListener("vrdisplaypresentchange",
d),g())},window.addEventListener("vrdisplaypresentchange",d,!1),l.capabilities.canPresent?(a=e.get_canvas(),l.requestPresent([{source:a}]).then(function(){},function(){f.error("HMD fullscreen request failed.")})):f.error("HMD fullscreen request failed."))}else b(a,c,g)}};a.exit_fullscreen_hmd=function(){if("HMD"!=!v.get("stereo")||"NONE"==v.get("stereo")&&v.get("is_mobile_device")){var a=h.get_device_by_type_element(h.DEVICE_HMD);a&&h.get_value_param(a,h.HMD_WEBVR_TYPE)&h.HMD_WEBVR1?(a=a.Uc)&&a.isPresenting&&
(a.exitPresent(),e.resize_to_container(!0)):g()}};a.check_fullscreen_hmd=function(){var a=h.get_device_by_type_element(h.DEVICE_HMD),b=h.get_value_param(a,h.HMD_WEBVR_TYPE)&h.HMD_WEBVR1;return a&&(b&&a.Uc||!b&&h.check_fullscreen())?!0:!1};a.request_split_screen=function(a,b){var d=h.get_device_by_type_element(h.DEVICE_HMD);if(!d)return!1;if(J)return!0;c=b;if(F.xa()){var e=F.mj(F.get_active());e&&(d.lf?(n(e),a&&a()):(h.JP(d),d.Yp=function(){n(e);a&&a()}))}};a.exit_split_screen=function(){var a=h.get_device_by_type_element(h.DEVICE_HMD);
if(!J||!a||!a.lf)return!1;F.set_hmd_params({enable_hmd_stereo:!1});J=!1;c&&c();F.zP();D.enabled||F.ft(2,1);e.resize_to_container(!0);return!0};a.shot=function(a,b){a=a||"image/png";l.canvas_data_url(function(b){var c=window.document.createElement("a");document.body.appendChild(c);c.style.display="none";c.href=b;c.download="screenshot."+a.split("/")[1];c.click();document.body.removeChild(c)},a,b||1,!0)}};b4w.module.sfx=function(a,q){var d=q("__obj_util"),c=q("__scenes"),b=q("__sfx"),g=q("__print");a.play=function(a,c,d){b.play(a,c||0,d||0)};a.play_def=function(a){b.play_def(a)};a.is_playing=function(a){return b.is_playing(a)};a.stop=function(a){b.stop(a)};a.pause=function(a){b.SQ(a)};a.resume=function(a){b.UQ(a)};a.loop_stop=function(a,c,d){b.loop_stop(a,c||0,d||!1)};a.playrate=function(a,c){b.playrate(a,c)};a.get_playrate=function(a){return b.get_playrate(a)};a.cyclic=function(a,c){b.cyclic(a,c)};
a.is_cyclic=function(a){return b.is_cyclic(a)};a.listener_reset_speed=function(){b.listener_stride()};a.listener_stride=function(){b.listener_stride()};a.speaker_reset_speed=function(a){b.speaker_stride(a)};a.speaker_stride=function(a){b.speaker_stride(a)};a.get_volume=function(a){return a&&"object"===typeof a?b.get_volume(a):b.oN()};a.set_volume=function(a,c){a&&"object"===typeof a?b.set_volume(a,c):b.sQ(c)};a.mute=function(a,c){a&&"object"===typeof a?b.mute(a,c):b.OO(c)};a.is_muted=function(a){return a&&
"object"===typeof a?b.is_muted(a):b.SN()};a.get_speaker_objects=function(){return b.get_speaker_objects().slice(0)};a.check_active_speakers=b.check_active_speakers;a.set_compressor_params=function(a){b.set_compressor_params(c.get_active(),a)};a.get_compressor_params=function(){return b.get_compressor_params(c.get_active())};a.duck=function(a,c,d){a&&"object"===typeof a?b.duck(a,c,d):b.QL(c,d)};a.unduck=function(a){a&&"object"===typeof a?b.unduck(a):b.vR()};a.apply_playlist=b.apply_playlist;a.clear_playlist=
b.clear_playlist;a.detect_audio_container=b.detect_audio_container;a.detect_video_container=b.detect_video_container;a.set_positional_params=b.set_positional_params;a.get_positional_params=b.get_positional_params;a.set_filter_params=b.set_filter_params;a.get_filter_params=b.get_filter_params;a.get_filter_freq_response=b.get_filter_freq_response;a.get_duration=function(a){return a&&d.is_speaker(a)?b.get_duration(a):(g.error('Object "'+(a?a.name:void 0)+'" is not a valid speaker'),0)}};b4w.module.textures=function(a,q){var d=q("__print"),c=q("__scenes"),b=q("__textures"),g=q("__obj_util"),n=q("__util"),B=q("__assets");a.play_video=function(a,g){g||(g=0);var e=b.Fw(a,g);e?c.get_active().b4w_use_nla&&b.jz(e)?d.error("NLA texture can't be controlled directly through API."):b.play_video(e):d.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,g){g||(g=0);var e=b.Fw(a,g);e?c.get_active().b4w_use_nla&&b.jz(e)?d.error("NLA texture can't be controlled directly through API."):
b.pause_video(e):d.error('Texture with name "'+a+'" not found!')};a.reset_video=function(a,g){g||(g=0);var e=b.Fw(a,g);e?c.get_active().b4w_use_nla&&b.jz(e)?d.error("NLA texture can't be controlled directly through API."):b.reset_video(e):d.error('Texture with name "'+a+'" not found!')};a.get_canvas_ctx=function(a,c){if(g.is_mesh(a)){var e=b.UM(a,c);if(e)return e;d.error("Couldn't find canvas texture with this name: "+c)}else d.error("Object must be type of mesh.");return null};a.update_canvas_ctx=
function(a,c){if(!g.is_mesh(a))return d.error("Object must be type of mesh."),!1;var e=b.Cw(a,c);if(!e||"CANVAS"!=e.source)return d.error("Couldn't find canvas texture \""+c+'" in object "'+a.name+'".'),!1;b.aS(e);return!0};a.change_image=function(a,c,g,h){h=h||function(){};var e=b.Cw(a,c);if(e)if(e.li)d.error("Changing video textures is forbidden."),h(!1);else{var q=n.yh(g);e.rj==q?h(!0):B.enqueue([{id:g,type:B.AT_IMAGE_ELEMENT,url:g,request:"GET"}],function(d){d?(b.change_image(a,e,c,d,g),h(!0)):
h(!1)},null,null)}else d.error("Couldn't find texture \""+c+'" in object "'+a.name+'".'),h(!1)};a.get_texture_names=function(a){if(g.is_mesh(a))return b.get_texture_names(a);d.error("Object must be type of mesh.");return[]}};b4w.module.time=function(a,q){var d=q("__time");a.set_timeout=d.set_timeout;a.clear_timeout=d.clear_timeout;a.get_timeline=d.get_timeline;a.animate=d.animate;a.clear_animation=d.clear_animation};b4w.module.transform=function(a,q){var d=q("__obj_util"),c=q("__physics"),b=q("__print"),g=q("__quat"),n=q("__transform"),B=q("__tsr"),e=q("__util"),v=B.create(),w=new Float32Array(3),h=new Float32Array(4);a.set_translation=function(a,e,g,f){d.is_dynamic(a)?(w[0]=e,w[1]=g,w[2]=f,n.set_translation(a,w),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel=function(a,e,g,f){d.is_dynamic(a)?(w[0]=e,w[1]=g,w[2]=f,n.set_translation_rel(a,w),n.L(a),c.sync_transform(a)):
b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,e){d.is_dynamic(a)?(n.set_translation(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel_v=function(a,e){d.is_dynamic(a)?(n.set_translation_rel(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_obj_rel=function(a,g,h,f,q){d.is_dynamic(a)?(w[0]=g,w[1]=h,w[2]=f,g=B.get_trans_view(q.o.v),q=B.get_quat_view(q.o.v),
e.transform_vec3(w,1,q,g,w),n.set_translation(a,w),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,b){b||(b=new Float32Array(3));n.get_translation(a,b);return b};a.get_translation_rel=function(a,b){b||(b=new Float32Array(3));n.get_translation_rel(a,b);return b};a.set_rotation=function(a,e,g,f,q){d.is_dynamic(a)?(h[0]=e,h[1]=g,h[2]=f,h[3]=q,n.set_rotation(a,h),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.set_rotation_rel=function(a,e,g,f,q){d.is_dynamic(a)?(h[0]=e,h[1]=g,h[2]=f,h[3]=q,n.set_rotation_rel(a,h),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_v=function(a,e){d.is_dynamic(a)?(n.set_rotation(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_rel_v=function(a,e){d.is_dynamic(a)?(n.set_rotation_rel(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.get_rotation=function(a,b){b||(b=new Float32Array(4));n.get_rotation(a,b);return b};a.get_rotation_rel=function(a,b){b||(b=new Float32Array(4));n.get_rotation_rel(a,b);return b};a.set_rotation_euler=function(a,e,g,f){d.is_dynamic(a)?(w[0]=e,w[1]=g,w[2]=f,n.set_rotation_euler(a,w),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_rotation_euler=function(a,b){b||(b=new Float32Array(3));n.get_rotation_euler(a,b);return b};a.get_rotation_euler_rel=function(a,b){b||
(b=new Float32Array(3));n.get_rotation_euler_rel(a,b);return b};a.set_rotation_euler_rel=function(a,e,g,f){d.is_dynamic(a)?(w[0]=e,w[1]=g,w[2]=f,n.set_rotation_euler_rel(a,w),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_v=function(a,e){d.is_dynamic(a)?(n.set_rotation_euler(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel_v=function(a,e){d.is_dynamic(a)?(n.set_rotation_euler_rel(a,
e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,c){d.is_dynamic(a)?(n.set_scale(a,c),n.L(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale_rel=function(a,c){d.is_dynamic(a)?(n.set_scale_rel(a,c),n.L(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_scale=function(a){return n.get_scale(a)};a.get_scale_rel=function(a){return n.get_scale_rel(a)};a.empty_reset_transform=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+
a.name);else{for(var e=0;e<a.ve.length;e++)if(!d.is_dynamic(a.ve[e])){b.error('Wrong object: "'+a.ve[e].name+'" is not dynamic.');return}n.set_translation(a,[0,0,0]);n.set_rotation(a,[0,0,0,1]);n.set_scale(a,1);n.L(a);c.sync_transform(a)}};a.get_object_size=function(a){return d.is_mesh(a)?n.get_object_size(a):(b.error("Wrong object: "+a.name),0)};a.get_object_center=function(a,c,e){if(!d.is_mesh(a))return b.error("Wrong object: "+a.name),null;e||(e=new Float32Array(3));return n.get_object_center(a,
c,e)};a.move_local=function(a,e,g,f){d.is_dynamic(a)?(n.move_local(a,e,g,f),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_x_local=function(a,q){if(d.is_dynamic(a)){var k=g.setAxisAngle(e.AXIS_X,q,h);n.gy(a,k);n.L(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_y_local=function(a,q){if(d.is_dynamic(a)){var k=g.setAxisAngle(e.AXIS_MY,q,h);n.gy(a,k);n.L(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.rotate_z_local=function(a,q){if(d.is_dynamic(a)){var k=g.setAxisAngle(e.AXIS_Z,q,h);n.gy(a,k);n.L(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return n.get_object_bounding_box(a)};a.set_tsr=function(a,e){d.is_dynamic(a)?(n.set_tsr(a,e),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr_rel=function(a,e){d.is_dynamic(a)?(n.set_tsr_rel(a,e),n.L(a),c.sync_transform(a)):
b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_tsr=function(a,b){b||(b=new Float32Array(8));n.get_tsr(a,b);return b};a.get_tsr_rel=function(a,b){b||(b=new Float32Array(8));n.get_tsr_rel(a,b);return b};a.distance=function(a,b){return n.distance(a,b)};a.set_matrix=function(a,e){d.is_dynamic(a)?(B.from_mat4(e,v),n.set_tsr(a,v),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_matrix_rel=function(a,e){d.is_dynamic(a)?(B.from_mat4(e,v),n.set_tsr_rel(a,
v),n.L(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_matrix=function(a,b){b||(b=new Float32Array(16));n.get_tsr(a,v);B.to_mat4(v,b);return b};a.get_matrix_rel=function(a,b){b||(b=new Float32Array(16));n.get_tsr_rel(a,v);B.to_mat4(v,b);return b}};b4w.module.tsr=function(a,q){var d=q("__mat4"),c=q("__tsr");a.create=c.create;a.from_values=c.from_values;a.copy=c.copy;a.identity=c.identity;a.set_sep=c.set_sep;a.set_trans=c.set_trans;a.set_scale=c.set_scale;a.set_transcale=c.set_transcale;a.set_quat=c.set_quat;a.get_trans_view=c.get_trans_view;a.get_scale=c.get_scale;a.get_quat_view=c.get_quat_view;a.invert=c.invert;a.to_mat4=function(a,g){g||(g=d.create());c.to_mat4(a,g);return g};a.from_mat4=c.from_mat4;a.multiply=c.multiply;a.transform_vec3=
c.transform_vec3;a.transform_vec3_inv=c.transform_vec3_inv;a.transform_vectors=c.transform_vectors;a.transform_dir_vectors=c.transform_dir_vectors;a.transform_dir_vec3=c.transform_dir_vec3;a.transform_tangents=c.transform_tangents;a.translate=c.translate;a.interpolate=function(a,d,n,q){q||(q=c.create());c.interpolate(a,d,n,q);return q}};b4w.module.util=function(a,q){var d=q("__compat"),c=q("__print"),b=q("__quat"),g=q("__util"),n=q("__vec3");a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.XYX=g.XYX;a.YZY=g.YZY;a.ZXZ=g.ZXZ;a.XZX=g.XZX;a.YXY=g.YXY;a.ZYZ=g.ZYZ;a.XYZ=g.XYZ;a.YZX=g.YZX;a.ZXY=g.ZXY;a.XZY=g.XZY;a.YXZ=g.YXZ;a.ZYX=g.ZYX;a.f32=function(a){return g.f32(a||
0)};a.assert=g.assert;a.keyfind=g.keyfind;a.keysearch=g.keysearch;a.matrix_to_quat=function(a){return g.matrix_to_quat(a)};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));return g.euler_to_quat(a,b)};a.ordered_angles_to_quat=function(a,c,d){d||(d=b.create());return g.ordered_angles_to_quat(a,c,d)};a.quat_to_ordered_angles=function(a,b,c){c||(c=n.create());return g.quat_to_ordered_angles(a,b,c)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));return g.quat_to_euler(a,b)};a.sign=g.sign;
a.clamp=g.clamp;a.quat_to_dir=g.quat_to_dir;a.ground_project_cam_quat=function(a,b){return g.quat_project(a,g.AXIS_MZ,g.AXIS_Z,g.AXIS_Y,b)};a.cam_quat_to_mesh_quat=function(a,b){return g.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,b,d,q,h){return 0!=n.dot(d,q)?(c.error("Wrong in-plane direction"),null):g.quat_project(a,b,d,q,h)};a.hash_code=g.hash_code;a.smooth=g.smooth;a.smooth_v=g.smooth_v;a.is_vector=g.is_vector;a.correct_cam_quat_up=g.correct_cam_quat_up;a.quat_to_angle_axis=g.quat_to_angle_axis;
a.random_from_array=g.random_from_array;a.horizontal_direction=g.horizontal_direction;a.angle_wrap_0_2pi=g.angle_wrap_0_2pi;a.angle_wrap_periodic=g.angle_wrap_periodic;a.smooth_step=g.smooth_step;a.lerp=g.lerp;a.deg_to_rad=g.deg_to_rad;a.rad_to_deg=g.rad_to_deg;a.dir_to_quat=g.dir_to_quat;a.is_ie11=d.is_ie11;a.gen_tbn_quats=g.gen_tbn_quats};b4w.module.version=function(a,q){var d=q("__version");a.version=d.version;a.version_str=d.version_str;a.type=d.type;a.date=d.date;a.date_str=d.date_str};b4w.module.objects=function(a,q){var d=q("__geometry"),c=q("__objects"),b=q("__batch"),g=q("__obj_util"),n=q("__print"),B=q("__scenes");a.get_meta_tags=function(a){if(a)return c.get_meta_tags(a)};a.get_custom_prop=function(a){if(a)return c.get_custom_prop(a)};a.copy=function(a,b,q){return g.is_mesh(a)?g.is_dynamic(a)?d.pj(a)||d.check_shape_keys(a)||!q?-1==c.Ib(B.get_active(),"MESH",c.DATA_ID_ALL).indexOf(a)?(n.error('object "'+a.name+'" does not belong to the active scene.'),!1):c.copy(a,b||"",q):
(n.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),!1):(n.error('object "'+a.name+'" is not dynamic.'),!1):(n.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,c,d){n.Ze("set_nodemat_value","material.set_nodemat_value");if(g.Ag(a)){var e=c[0],l=b.Oa(a,e,"MAIN");if(null===l)return n.error('Material "'+e+'" was not found in the object "'+a.name+'".'),null;l=b.oh(l.jf,c);if(null===l)return n.error('Value node "'+c[c.length-1]+'" was not found in the object "'+
a.name+'".'),null;b.set_nodemat_value(a,e,l,d)}else n.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_value=function(a,c){n.Ze("get_nodemat_value","material.get_nodemat_value");if(!g.Ag(a))return n.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),0;var d=c[0],e=b.Oa(a,d,"MAIN");if(null===e)return n.error('Material "'+d+'" was not found in the object "'+a.name+'".'),0;d=b.oh(e.jf,c);return null===d?(n.error('Value node "'+
c[c.length-1]+'" was not found in the object "'+a.name+'".'),0):b.get_nodemat_value(e,d)};a.set_nodemat_rgb=function(a,c,d,h,l){n.Ze("set_nodemat_rgb","material.set_nodemat_rgb");if(g.Ag(a)){var e=c[0],k=b.Oa(a,e,"MAIN");null===k?n.error('Material "'+e+'" was not found in the object "'+a.name+'".'):(k=b.oh(k.hf,c),null===k?n.error('RGB node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'):b.set_nodemat_rgb(a,e,k,d,h,l))}else n.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};
a.get_nodemat_rgb=function(a,c,d){n.Ze("get_nodemat_rgb","material.get_nodemat_rgb");if(!g.Ag(a))return n.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var e=c[0],l=b.Oa(a,e,"MAIN");if(null===l)return n.error('Material "'+e+'" was not found in the object "'+a.name+'".'),null;e=b.oh(l.hf,c);if(null===e)return n.error('RGB node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'),null;d||(d=new Float32Array(3));return b.get_nodemat_rgb(l,e,d)};a.update_boundings=
function(a){g.is_mesh(a)?d.pj(a)||d.check_shape_keys(a)?c.update_boundings(a):n.error('object "'+a.name+'" has not dynamic geometry.'):n.error('The type of the object "'+a.name+'" is not "MESH".')};a.get_parent=g.get_parent;a.get_dg_parent=g.get_dg_parent;a.is_mesh=g.is_mesh;a.is_armature=g.is_armature;a.is_speaker=g.is_speaker;a.is_camera=g.is_camera;a.is_lamp=g.is_lamp;a.is_empty=g.is_empty;a.is_line=g.is_line;a.is_world=g.is_world;a.get_selectable_objects=function(){return c.get_selectable_objects()};
a.get_outlining_objects=function(){return c.get_outlining_objects()};a.is_dynamic=g.is_dynamic;a.set_wind_bending_params=function(a,d){if(g.Ag(a)){var e=a.o;if(e.Ud){if("number"==typeof d.angle){var h=b.aG(d.angle,e.Th,e.v[3]);e.Ne=h}"number"==typeof d.main_frequency&&(e.Oe=d.main_frequency);"number"==typeof d.detail_frequency&&(e.ye=d.detail_frequency);"number"==typeof d.detail_amplitude&&(e.xe=d.detail_amplitude);"number"==typeof d.branch_amplitude&&(e.te=d.branch_amplitude);c.kQ(a)}else n.error('The "'+
a.name+"\" object doesn't have wind bending parameters.")}else n.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_wind_bending_params=function(a){var c=a.o;if(!g.Ag(a)||!c.Ud)return null;a={};var d=b.zS(c.Ne,c.Th,c.v[3]);a.angle=d;a.main_frequency=c.Oe;a.detail_frequency=c.ye;a.detail_amplitude=c.xe;a.branch_amplitude=c.te;return a}};b4w.module.main=function(a,q){function d(){}function c(){}function b(){}function g(){window.performance||(Y.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(Y.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});K.qE(0)}function n(a,b){for(var c=null,d=b?la:P,e=0;e<d.length;e++){var f=d[e];try{c=a.getContext(f,Z)}catch(va){}if(c)break}c&&u.IL(c);return c}function B(a,b,d){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();Y.error("WebGL context lost");v()},!1);H.mf(d);var e=H.get_renderer_info();e&&Y.log("%cRENDERER INFO:","color: #00a",d.getParameter(e.UNMASKED_VENDOR_WEBGL)+", "+d.getParameter(e.UNMASKED_RENDERER_WEBGL));R.mf(d);C.mf(d);V.mf(d);W.mf(d);D.mf(d);r.mf(d);J.FQ(a);r.init(a,b);G.sE(a.width,a.height,1);E.init();t.init();c=l();h()}function e(){d=function(){}}function v(){w()||(L=performance.now()/1E3,E.pause(),y.pause(),V.pause(),x.pause())}function w(){return ja<L}function h(){var a=
"HMD"===ca.stereo&&t.xN();a?a.requestAnimationFrame(h):ka(h);var b=performance.now()/1E3;da||(da=b);var e=b-da;if(!(e<1/ca.max_fps)){for(var g=K.get_timeline(),l=0;l<aa.length;l++)aa[l](g,e);w()||(ja>da&&(e-=ja-Math.max(L,da)),g+=e,K.qE(g),D.update(),f.update(),J.update(),l=e,J.is_primary_loaded()&&(m.reset(),ba.update(l),p.update(g,l),A.update(g,l),E.update(g,l),l&&k.update(l),J.is_primary_loaded()&&(y.update(g,l),J.is_primary_loaded()&&(t.update(g),z.update(g,l),J.is_primary_loaded()&&(x.update(!1),
Q.update(g,l),ha.update(),d(l,g),J.is_primary_loaded()&&(G.update(g,l),x.EF(),I.frame()))))),c(e));da=b;a&&a.isPresenting&&a.submitFrame()}}function l(){var a=60,c=0,d=ca.LB,e=ca.uM;return function(f){f<1/ca.max_fps||(a=oa.smooth(1/f,a,f,d),f=y.gN(),(c=(c+1)%e)||b(Math.round(a),f))}}var x=q("__anchors"),k=q("__animation"),f=q("__assets"),F=q("__config"),u=q("__compat"),r=q("__container"),z=q("__controls"),J=q("__data"),D=q("__debug"),H=q("__extensions"),C=q("__geometry"),t=q("__input"),m=q("__hud"),
A=q("__nla"),I=q("__main"),p=q("__logic_nodes"),Q=q("__objects"),y=q("__physics"),Y=q("__print"),R=q("__renderer"),G=q("__scenes"),E=q("__sfx"),W=q("__shaders"),V=q("__textures"),K=q("__time"),ba=q("__transform"),oa=q("__util"),X=q("__version"),ha=q("__particles"),Z=F.context,ca=F.H,da=0,L=0,ja=0,aa=[],P=["webgl","experimental-webgl"],la=["webgl2","experimental-webgl2"],T=null,ka=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||
window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/ca.max_fps)}}();a.init=function(a,b){F.tQ();Y.BQ(ca.console_verbose);var c=X.version_str()+" "+X.type()+" ("+X.date_str()+")";Y.log("%cINIT ENGINE","color: #00a",c);Y.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;g();b?m.init(b):(F.H.show_hud_debug_info=!1,F.Y.at=!1);u.ZI();u.xv("Chrome")||u.xv("Firefox")||(ca.Rb=!1);c=n(a,ca.Rb);!c&&ca.Rb&&(ca.Rb=!1,c=n(a,!1));if(!c)return null;
Y.log("%cINIT WEBGL "+(ca.Rb?"2":"1"),"color: #00a");T=c;B(a,b,c);F.apply_quality();u.lE(c,!0);W.rO();ca.Uk&&(a.style["touch-action"]="none");Y.log("%cSET PRECISION:","color: #00a",ca.precision);return c};a.set_fps_callback=function(a){b=a};a.clear_fps_callback=function(){b=function(){}};a.set_render_callback=function(a){d=a};a.clear_render_callback=function(){e()};a.pause=v;a.resume=function(){w()&&(ja=performance.now()/1E3,E.resume(),y.resume(),V.play(!0),x.resume())};a.is_paused=w;a.reset=function(){J.unload(0);
J.reset();H.reset();R.reset();C.reset();V.KP();W.reset();D.reset();r.reset();J.reset();r.reset();K.reset();E.reset();ja=L=da=0;b=function(){};c=function(){};d=function(){};aa.length=0;T=null};a.canvas_data_url=function(a,b,c,d){I.canvas_data_url(a,b,c,d)};a.detect_mobile=function(){return u.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<aa.length;b++)if(aa[b]==a)return;aa.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<aa.length;b++)if(aa[b]==a){aa.splice(b,1);break}};a.get_renderer_info=
function(){var a=H.get_renderer_info();return a?{vendor:T.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:T.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.nla=function(a,q){var d=q("__nla"),c=q("__time"),b=q("__print"),g=q("__util");a.set_frame=function(a){a=g.clamp(a,d.get_frame_start(),d.get_frame_end());d.check_logic_nodes()?b.error("The active scene is using NLA script."):d.set_frame(a,c.get_timeline())};a.get_frame=function(){return d.get_frame(c.get_timeline())};a.stop=function(){d.check_logic_nodes()?b.error("The active scene is using NLA script."):d.By()};a.play=function(a){d.check_logic_nodes()?b.error("The active scene is using NLA script."):
d.FD(a)};a.is_play=function(){return d.is_play()};a.get_frame_start=function(){return d.get_frame_start()};a.get_frame_end=function(){return d.get_frame_end()};a.check_nla=function(){return d.check_nla()};a.check_logic_nodes=function(){return d.check_logic_nodes()};a.set_range=function(a,c){d.check_logic_nodes()?b.error("The active scene is using NLA script."):(c=parseFloat(c)||d.get_frame_end(),a=parseFloat(a)||d.get_frame_end(),c=g.clamp(c,d.get_frame_start(),d.get_frame_end()),a=g.clamp(a,d.get_frame_start(),
c),d.set_range(a,c))};a.reset_range=function(){d.check_logic_nodes()?b.error("The active scene is using NLA script."):d.reset_range()};a.set_cyclic=function(a){d.check_logic_nodes()?b.error("The active scene is using NLA script."):d.set_cyclic(a)};a.clear_callback=function(){d.check_logic_nodes()?b.error("The active scene is using NLA script."):d.clear_callback()}};b4w.module.app=function(a,q){function d(){var a=I.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(a=I.is_paused(),I.pause()):a||I.resume()},!1)}function c(){var a=0,b=H.get_container(),c=I.is_paused(),d=!0;I.append_loop_cb(function(){if(!(a%10)){var e=b.getBoundingClientRect();e.top>window.innerHeight||0>e.bottom?(d&&(c=I.is_paused()),I.pause(),d=!1):c||d||(I.resume(),d=!0)}a++})}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);
f||(Q.error('Warning: canvas container "'+a+'" not found, appending to body'),f=document.body);e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(a=document.createElement("canvas"),a.style.position="absolute",e.style.left=0,e.style.top=0,a.style.pointerEvents="none"):a=null;f.appendChild(e);if(!I.init(e,a))return c&&u("Browser could not initialize WebGL",
"For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html#problems-upon-startup",d),!1;a&&H.insert_to_container(a,"LAST");return!0}function g(a,b){a?(b&&(document.getElementById(b).style.display="block"),V=document.getElementById(a)):(V=document.createElement("div"),V.innerHTML=0,V.style.cssText="position:absolute;font-family: Arial, sans-serif;top: 20px;right: 20px;text-shadow: 0px 0px 6px #000;font-size: 40px;line-height: 50px;font-weight: bold;color: #fff;",H.insert_to_container(V,
"JUST_AFTER_CANVAS"))}function n(a,b){var c=String(a);b&&(c+="/"+String(b));V.innerHTML=c}function B(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a);return b}function e(a,b,c){var d=Math.max(z.hover_get_distance(a),1),e=R.get_rotation(a,da);b=G.quat_to_dir(e,b,Z);b[2]=0;E.normalize(b,b);E.scale(b,d*c,b);c=R.get_translation(a,ca);E.add(c,b,c);z.set_translation(a,c)}function v(a,b){var c=z.hover_get_vertical_limits(a,ja);if(c.up!=c.down){var d=z.get_camera_angles(a,
ha)[1],c=(c.down-d)/(c.down-c.up),d=z.hover_get_distance_limits(a,ja),c=Math.max(c,2/d.max);z.hover_rotate(a,0,c*b)}}function w(a,b,c,d){R.move_local(a,5*b,5*c,5*d)}function h(a,b,c){var d=z.target_get_distance(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));R.move_local(a,0,0,0>b?.001<d?-d*c:0:c/(1-c)*d)}function l(a,b,c,d){for(var e=c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function x(a,b,c,d,e){e?(e=z.target_get_pivot(a,Z),a=z.get_translation(a),a=E.dist(e,a)+d,d=0<b?l(b,-c,a,d):l(-b,c/(1-c),a,
d)):d-=2*b*c;return d}function k(a,b,c,d,g){function k(a,b,c,d){if(1==c){z.get_velocities(a,J);var e=V?.003*J.trans:.003*J.rot;c=C.get_sensor_value(a,b,0);C.get_sensor_payload(a,b,0).fs===C.PL_SINGLE_TOUCH_MOVE?($a+="X"==d?-c*e:0,db+="Y"==d?-c*e:0):C.get_sensor_payload(a,b,0).fs===C.PL_MULTITOUCH_MOVE_PAN&&(a=V?.003*J.rot:7.5E-4*J.trans,vb+="X"==d?-c*a:0,Fb+="Y"==d?-c*a:0)}}function l(a){z.get_velocities(a,J);za-=.05*J.zoom}function m(a){z.get_velocities(a,J);Na-=.002*J.trans}function n(a){z.get_velocities(a,
J);za+=.05*J.zoom}function q(a){z.get_velocities(a,J);Na+=.002*J.trans}function r(a,b,c,d){if(1==c){c=C.get_sensor_value(a,b,1);z.get_velocities(a,J);if(V)e=.003*J.trans,f=7.5E-4*J.rot;else var e=.003*J.rot,f=7.5E-4*J.trans;if(1===C.get_sensor_payload(a,b,0).which)ya+="X"==d?-c*e:0,Xa+="Y"==d?-c*e:0;else if(2===C.get_sensor_payload(a,b,0).which||3===C.get_sensor_payload(a,b,0).which)Wc+="X"==d?-c*f:0,zb+="Y"==d?-c*f:0}}function t(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function u(a){return a[0]&&(a[1]||
a[2]||.1<a[3])}function y(a){return a[0]&&(a[1]||-.1>a[2])}function B(a){return a[0]&&(a[1]||.1<a[2])}function F(a){return a[0]&&(a[1]||a[2]||a[3])}function H(a,b,c){if(1==c)switch(c=C.get_sensor_value(a,b,0),z.get_velocities(a,J),b){case "FORWARD":P?ja[0]=1:V?(b=z.get_camera_angles(a,ha)[1],b=Math.abs(b)>=Math.PI/4?G.AXIS_Y:G.AXIS_MZ,e(a,b,.5*J.trans*c)):Q?h(a,-J.zoom,c):w(a,0,0,-J.trans*c);break;case "BACKWARD":P?ja[0]=-1:V?(b=z.get_camera_angles(a,ha)[1],b=Math.abs(b)>=Math.PI/4?G.AXIS_MY:G.AXIS_Z,
e(a,b,.5*J.trans*c)):Q?h(a,J.zoom,c):w(a,0,0,J.trans*c);break;case "UP":V?v(a,30*-J.zoom*c):P||w(a,0,J.trans*c,0);break;case "DOWN":V?v(a,30*J.zoom*c):P||w(a,0,-J.trans*c,0);break;case "LEFT":P?ja[1]=1:V?e(a,G.AXIS_MX,.5*J.trans*c):w(a,-J.trans*c,0,0);break;case "RIGHT":P?ja[1]=-1:V?e(a,G.AXIS_X,.5*J.trans*c):w(a,J.trans*c,0,0);break;case "ROT_LEFT":Q?z.target_rotate(a,.75*-J.rot*c,0):z.eye_rotate(a,.75*J.rot*c,0);break;case "ROT_RIGHT":Q?z.target_rotate(a,.75*J.rot*c,0):z.eye_rotate(a,.75*-J.rot*
c,0);break;case "ROT_UP":Q?z.target_rotate(a,0,.75*-J.rot*c):z.eye_rotate(a,0,.75*J.rot*c);break;case "ROT_DOWN":Q?z.target_rotate(a,0,.75*J.rot*c):z.eye_rotate(a,0,.75*-J.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":P&&(ja[0]=0);break;case "LEFT":case "RIGHT":P&&(ja[1]=0)}P&&(p.set_character_move_dir(P,ja[0],ja[1]),a=z.get_camera_angles_char(a,X),p.set_character_rotation(P,a[0],a[1]))}K=a;ba=b;oa=c;var I=Y.get_active_camera();f(I);var Q=!1,P=null,V=!1;switch(z.get_move_style(I)){case z.MS_TARGET_CONTROLS:Q=
!a;break;case z.MS_EYE_CONTROLS:P=Y.get_first_character();break;case z.MS_STATIC:return;case z.MS_HOVER_CONTROLS:V=!0}var J=z.get_velocities(I,L);a=C.create_elapsed_sensor();if(p.has_simulated_physics(I)){var aa=C.create_collision_sensor(I,null,!0);C.create_sensor_manifold(I,"CAMERA_COLLISION",C.CT_POSITIVE,[aa],null,function(a,b){var c=C.get_sensor_payload(a,b,0).bm;if(0>c){var d=C.get_sensor_payload(a,b,0).dh,e=Z;E.scale(d,-.25*c,e);c=R.get_translation(a,ca);E.add(c,e,c);R.set_translation_v(a,c)}})}if(P){var aa=
R.get_translation(I),T=R.get_rotation(I),T=G.cam_quat_to_mesh_quat(T);aa[2]-=.5;p.set_transform(P,aa,T);D.append_stiff_trans(I,P,[0,0,.5]);var ja=new Float32Array(2),O=!0;p.set_character_move_type(P,p.CM_FLY);C.create_kb_sensor_manifold(I,"TOGGLE_CHAR_MOVE_TYPE",C.CT_SHOT,C.KEY_C,function(){O=!O;p.set_character_move_type(P,O?p.CM_FLY:p.CM_WALK)})}var la=A.check_enable_gamepad_indices(),aa=la.length?la[la.length-1]:0,da,ka,Ca,Ka,Ta,Ia,Ra,La,ga,Fa;b?da=ka=Ca=Ka=Ta=Ia=b=aa=Ra=La=ga=Fa=C.create_custom_sensor(0):
(da=C.create_keyboard_sensor(C.KEY_W),ka=C.create_keyboard_sensor(C.KEY_S),Ca=C.create_keyboard_sensor(C.KEY_A),Ka=C.create_keyboard_sensor(C.KEY_D),Ta=C.create_keyboard_sensor(C.KEY_R),Ia=C.create_keyboard_sensor(C.KEY_F),b=C.create_gamepad_btn_sensor(A.GMPD_BUTTON_6,aa),aa=C.create_gamepad_btn_sensor(A.GMPD_BUTTON_7,aa),Ra=C.create_keyboard_sensor(C.KEY_UP),La=C.create_keyboard_sensor(C.KEY_DOWN),ga=C.create_keyboard_sensor(C.KEY_LEFT),Fa=C.create_keyboard_sensor(C.KEY_RIGHT));var T=C.create_gamepad_axis_sensor(A.GMPD_AXIS_0,
la),ia=C.create_gamepad_axis_sensor(A.GMPD_AXIS_1,la),S=C.create_gamepad_axis_sensor(A.GMPD_AXIS_2,la),la=C.create_gamepad_axis_sensor(A.GMPD_AXIS_3,la);V||(C.create_sensor_manifold(I,"FORWARD",C.CT_CONTINUOUS,[a,da,ia],y,H),C.create_sensor_manifold(I,"BACKWARD",C.CT_CONTINUOUS,[a,ka,ia],B,H));Q?(C.create_sensor_manifold(I,"ROT_UP",C.CT_CONTINUOUS,[a,Ra,Ta,la],t,H),C.create_sensor_manifold(I,"ROT_DOWN",C.CT_CONTINUOUS,[a,La,Ia,la],u,H),C.create_sensor_manifold(I,"ROT_LEFT",C.CT_CONTINUOUS,[a,ga,Ca,
S],t,H),C.create_sensor_manifold(I,"ROT_RIGHT",C.CT_CONTINUOUS,[a,Fa,Ka,S],u,H)):V?(C.create_sensor_manifold(I,"LEFT",C.CT_CONTINUOUS,[a,ga,Ca,T],t,H),C.create_sensor_manifold(I,"RIGHT",C.CT_CONTINUOUS,[a,Fa,Ka,T],u,H),C.create_sensor_manifold(I,"FORWARD",C.CT_CONTINUOUS,[a,Ra,da,ia],t,H),C.create_sensor_manifold(I,"BACKWARD",C.CT_CONTINUOUS,[a,La,ka,ia],u,H),C.create_sensor_manifold(I,"UP",C.CT_CONTINUOUS,[a,Ia,la],B,H),C.create_sensor_manifold(I,"DOWN",C.CT_CONTINUOUS,[a,Ta,la],y,H)):(C.create_sensor_manifold(I,
"UP",C.CT_CONTINUOUS,[a,Ta,b],F,H),C.create_sensor_manifold(I,"DOWN",C.CT_CONTINUOUS,[a,Ia,aa],F,H),C.create_sensor_manifold(I,"LEFT",C.CT_CONTINUOUS,[a,Ca,T],y,H),C.create_sensor_manifold(I,"RIGHT",C.CT_CONTINUOUS,[a,Ka,T],B,H),C.create_sensor_manifold(I,"ROT_UP",C.CT_CONTINUOUS,[a,Ra,la],y,H),C.create_sensor_manifold(I,"ROT_DOWN",C.CT_CONTINUOUS,[a,La,la],B,H),C.create_sensor_manifold(I,"ROT_LEFT",C.CT_CONTINUOUS,[a,ga,S],y,H),C.create_sensor_manifold(I,"ROT_RIGHT",C.CT_CONTINUOUS,[a,Fa,S],B,H));
if(!c){var Da=0;c=C.create_mouse_wheel_sensor(d);var ab=0,la=C.create_touch_zoom_sensor(d);C.create_sensor_manifold(I,"MOUSE_WHEEL",C.CT_LEVEL,[c],null,function(a,b,c){1==c&&(b=C.get_sensor_value(a,b,0),z.get_velocities(a,J),Q||V?Da=x(a,b,J.zoom,Da,Q):(J.trans*=1+b*J.zoom,z.set_velocities(a,J)))});C.create_sensor_manifold(I,"TOUCH_ZOOM",C.CT_LEVEL,[la],null,function(a,b,c){1==c&&(c=C.get_sensor_value(a,b,0),z.get_velocities(a,J),C.get_sensor_payload(a,b,0)===C.PL_MULTITOUCH_MOVE_ZOOM&&(ab=x(a,c,.03*
J.zoom,ab,Q)))});C.create_sensor_manifold(I,"ZOOM_INTERPOL",C.CT_POSITIVE,[a],null,function(a,b){if(Q||V)if(1E-5<Math.abs(Da)||1E-5<Math.abs(ab)){var c=C.get_sensor_value(a,b,0),d=G.smooth(Da,0,c,.1*W);Da-=d;c=G.smooth(ab,0,c,.15*W);ab-=c;V?v(a,-(d+c)):(d=z.target_get_distance(a)+d+c,d=Math.max(d,.001),z.target_set_distance(a,d))}else ab=Da=0})}var ya=0,Xa=0,Wc=0,zb=0,Na=0,za=0;Q?(C.create_sensor_manifold(I,"GMPD_PAN_Y_POS",C.CT_CONTINUOUS,[b],null,n),C.create_sensor_manifold(I,"GMPD_PAN_Y_NEG",C.CT_CONTINUOUS,
[aa],null,l),C.create_sensor_manifold(I,"GMPD_PAN_X_POS",C.CT_CONTINUOUS,[T],function(a){return-.1>a[0]},m),C.create_sensor_manifold(I,"GMPD_PAN_X_NEG",C.CT_CONTINUOUS,[T],function(a){return.1<a[0]},q)):V&&(C.create_sensor_manifold(I,"GMPD_PAN_X_POS",C.CT_CONTINUOUS,[S],function(a){return-.1>a[0]},m),C.create_sensor_manifold(I,"GMPD_PAN_X_NEG",C.CT_CONTINUOUS,[S],function(a){return.1<a[0]},q));if(g){g=C.create_mouse_move_sensor("X",window);c=C.create_mouse_move_sensor("Y",window);b=C.create_mouse_click_sensor(d);
var aa=C.create_mouse_click_sensor(window),Pa=!1,T=function(a){a[2]?Pa=!0:a[0]||(Pa=!1);return Pa&&a[0]};C.create_sensor_manifold(I,"MOUSE_X",C.CT_POSITIVE,[aa,g,b],T,r,"X");C.create_sensor_manifold(I,"MOUSE_Y",C.CT_POSITIVE,[aa,c,b],T,r,"Y");g=A.get_device_by_type_element(A.DEVICE_MOUSE,window);A.switch_prevent_default(g,!1)}else g=C.create_mouse_move_sensor("X",d),c=C.create_mouse_move_sensor("Y",d),b=C.create_mouse_click_sensor(d),C.create_sensor_manifold(I,"MOUSE_X",C.CT_POSITIVE,[b,g],null,r,
"X"),C.create_sensor_manifold(I,"MOUSE_Y",C.CT_POSITIVE,[b,c],null,r,"Y");var $a=0,db=0,vb=0,Fb=0;g=C.create_touch_move_sensor("X",d);d=C.create_touch_move_sensor("Y",d);C.create_sensor_manifold(I,"TOUCH_X",C.CT_POSITIVE,[g],null,k,"X");C.create_sensor_manifold(I,"TOUCH_Y",C.CT_POSITIVE,[d],null,k,"Y");C.create_sensor_manifold(I,"ROT_TRANS_INTERPOL",C.CT_POSITIVE,[a],null,function(a,b){if(1E-5<Math.abs(ya)||1E-5<Math.abs(Xa)||1E-5<Math.abs($a)||1E-5<Math.abs(db)||1E-5<Math.abs(Wc)||1E-5<Math.abs(zb)||
1E-5<Math.abs(vb)||1E-5<Math.abs(Fb)||1E-5<Math.abs(Na)||1E-5<Math.abs(za)){var c=C.get_sensor_value(a,b,0),d=G.smooth(ya,0,c,.08*W),f=G.smooth(Xa,0,c,.08*W);ya-=d;Xa-=f;var g=G.smooth($a,0,c,.12*W),h=G.smooth(db,0,c,.12*W);$a-=g;db-=h;var k=G.smooth(Wc,0,c,.08*W),l=G.smooth(zb,0,c,.08*W);Wc-=k;zb-=l;var m=G.smooth(vb,0,c,.12*W),n=G.smooth(Fb,0,c,.12*W);vb-=m;Fb-=n;var q=G.smooth(Na,0,c,.08*W),c=G.smooth(za,0,c,.08*W);Na-=q;za-=c;Q?(z.target_rotate(a,d+g,f+h),f=z.target_get_distance(a),z.target_pan_pivot(a,
f*(k+m+q),f*(l+n+c))):V?(d+g&&e(a,G.AXIS_X,.2*(d+g)),f+h&&(l=z.get_camera_angles(a,ha)[1],e(a,Math.abs(l)>Math.PI/4?G.AXIS_MY:G.AXIS_Z,.2*(f+h))),z.hover_rotate(a,k+m+q,0)):(z.eye_rotate(a,.5*(d+g),.5*(f+h)),P&&(k=z.get_camera_angles_char(a,X),p.set_character_rotation(P,k[0],k[1])))}});C.create_kb_sensor_manifold(I,"DEC_STEREO_DIST",C.CT_SHOT,C.KEY_LEFT_SQ_BRACKET,function(a){var b=z.get_stereo_distance(a);z.set_stereo_distance(a,.9*b)});C.create_kb_sensor_manifold(I,"INC_STEREO_DIST",C.CT_SHOT,C.KEY_RIGHT_SQ_BRACKET,
function(a){var b=z.get_stereo_distance(a);z.set_stereo_distance(a,1.1*b)})}function f(a){var b=z.get_move_style(a),c=C.create_callback_sensor(function(){var c=z.get_move_style(a),d=c!=b;b=c;return d});C.create_sensor_manifold(a,"CHANGE_MOVE_STYLE",C.CT_POSITIVE,[c],null,function(){F();k(K,ba,oa)})}function F(){var a=Y.get_active_camera();C.check_sensor_manifold(a,"TOGGLE_CHAR_MOVE_TYPE")&&Y.get_first_character()&&D.remove(a);for(var b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE TOGGLE_CHAR_MOVE_TYPE".split(" "),
c=0;c<b.length;c++)C.remove_sensor_manifold(a,b[c])}function u(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";f.innerHTML=a;g.innerHTML=
b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function r(a,b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&I.remove_loop_cb(f)}var g=performance.now();I.append_loop_cb(f)}var z=q("camera"),J=q("config"),D=q("constraints"),H=q("container"),C=q("controls"),t=q("data"),m=q("debug"),A=q("input"),I=q("main"),p=q("physics"),Q=q("print"),y=q("screen"),
Y=q("scenes"),R=q("transform"),G=q("util"),E=q("vec3"),W=1,V=null,K=!1,ba=!1,oa=!1,X=new Float32Array(2),ha=new Float32Array(2),Z=new Float32Array(3),ca=new Float32Array(3),da=new Float32Array(4),L={},ja={};a.init=function(a){function e(){var a=b(l,F,x,p),e=H.get_canvas();if(a){var f=H.get_container();H.resize_to_container();A&&(g(q,u),I.set_fps_callback(n));w&&(d(),c());r&&I.append_loop_cb(function(){f.style.height=f.clientWidth/r+"px"});k&&I.append_loop_cb(function(){H.resize_to_container()});B&&
I.append_loop_cb(function(){H.force_offsets_updating()});y&&J.reset_limits();D==J.P_AUTO?m.test_performance(function(a,b){0==a?(Q.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),J.apply_quality(J.P_HIGH)):1.5>b?(Q.log("QUALITY TEST RESULT: LOW ("+b.toFixed(1)+" GB/s)"),J.apply_quality(J.P_LOW)):(Q.log("QUALITY TEST RESULT: HIGH ("+b.toFixed(1)+" GB/s)"),J.apply_quality(J.P_HIGH));h(e,!0)}):h(e,!0)}else h(e,!1)}function f(a){a.keyCode==C.KEY_P&&(I.is_paused()?I.resume():I.pause())}function h(){}
a=a||{};var k=!1,l=null,p=null,q=null,r=0,u=null,v=!0,y=!1,w=!0,x=!0,E=!1,A=!1,z=!1,B=!1,D=J.get("quality"),G;for(G in a)switch(G){case "canvas_container_id":l=a.canvas_container_id;break;case "callback":h=a.callback;break;case "autoresize":k=a.autoresize;break;case "show_hud_debug_info":z=a.show_hud_debug_info;break;case "sfx_mix_mode":E=a.sfx_mix_mode;break;case "show_fps":A=a.show_fps;break;case "track_container_position":B=a.track_container_position;Q.ja("track_container_position deprecated. Not needed anymore. Use the container.client_to_canvas_coords method.");
break;case "fps_wrapper_id":u=a.fps_wrapper_id;break;case "fps_elem_id":q=a.fps_elem_id;break;case "error_purge_elements":p=a.error_purge_elements;break;case "report_init_failure":x=a.report_init_failure;break;case "pause_invisible":w=a.pause_invisible;break;case "key_pause_enabled":v=a.key_pause_enabled;break;case "force_container_ratio":r=a.force_container_ratio;break;case "min_capabilities":y=a.min_capabilities;break;case "quality":D=a.quality;break;default:J.set(G,a[G])}D!=J.P_AUTO&&J.set("quality",
D);v&&document.addEventListener("keydown",f,!1);J.set("show_hud_debug_info",z);J.set("sfx_mix_mode",E);var F=z||E||null;"complete"==document.readyState?window.setTimeout(e,0):window.addEventListener("load",e,!1);window.addEventListener("unload",function(){t.cleanup()},!1)};a.set_onclick=function(a,b){var c=B(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.set_onchange=function(a,b){var c=B(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.set_onkeypress=
function(a,b){var c=B(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.enable_camera_controls=k;a.disable_camera_controls=F;a.enable_object_controls=function(a){function b(a){return a[0]&&(a[1]||a[2])}function c(a,b,c){if(1==c)switch(c=C.get_sensor_value(a,b,0),b){case "FORWARD":d?p.vehicle_throttle(a,1):R.move_local(a,0,-1*c,0);break;case "BACKWARD":d?p.vehicle_throttle(a,-1):R.move_local(a,0,1*c,0);break;case "LEFT":d?p.vehicle_steer(a,-1):R.move_local(a,1*c,0,0);break;
case "RIGHT":d?p.vehicle_steer(a,1):R.move_local(a,-1*c,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&p.vehicle_throttle(a,0);break;case "LEFT":case "RIGHT":d&&p.vehicle_steer(a,0)}}var d=p.is_vehicle_chassis(a)||p.is_vehicle_hull(a),e=C.create_elapsed_sensor(),f=C.create_keyboard_sensor(C.KEY_W),g=C.create_keyboard_sensor(C.KEY_S),h=C.create_keyboard_sensor(C.KEY_A),k=C.create_keyboard_sensor(C.KEY_D),l=C.create_keyboard_sensor(C.KEY_UP),m=C.create_keyboard_sensor(C.KEY_DOWN),n=C.create_keyboard_sensor(C.KEY_LEFT),
q=C.create_keyboard_sensor(C.KEY_RIGHT);C.create_sensor_manifold(a,"FORWARD",C.CT_CONTINUOUS,[e,f,l],b,c);C.create_sensor_manifold(a,"BACKWARD",C.CT_CONTINUOUS,[e,g,m],b,c);C.create_sensor_manifold(a,"LEFT",C.CT_CONTINUOUS,[e,h,n],b,c);C.create_sensor_manifold(a,"RIGHT",C.CT_CONTINUOUS,[e,k,q],b,c)};a.disable_object_controls=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)C.remove_sensor_manifold(a,b[c])};a.enable_debug_controls=function(){C.create_kb_sensor_manifold(null,
"CAMERA_SHOT",C.CT_SHOT,C.KEY_K,function(){m.make_camera_frustum_shot()});C.create_kb_sensor_manifold(null,"LIGHT_SHOT",C.CT_SHOT,C.KEY_L,function(){m.make_light_frustum_shot()});C.create_kb_sensor_manifold(null,"TELEMETRY",C.CT_SHOT,C.KEY_T,function(){m.plot_telemetry()})};a.request_fullscreen=function(a,b,c){Q.Ze("request_fullscreen","screen.request_fullscreen");y.request_fullscreen(a,b,c)};a.exit_fullscreen=function(){Q.Ze("exit_fullscreen","screen.exit_fullscreen");y.exit_fullscreen()};a.check_fullscreen=
function(){Q.Ze("check_fullscreen","screen.check_fullscreen");return y.check_fullscreen()};a.report_app_error=u;a.get_url_params=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.css_animate=function(a,b,c,d,e,f,g,h){if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=
f||"";g=g||"";h=h||function(){};var k=a.style,l=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==k[b])if(void 0!=k["webkit"+l])b="webkit"+l;else if(void 0!=k["ms"+l])b="ms"+l;else if(void 0!=k["moz"+l])b="moz"+l;else return;r(a,c,d,e,function(e){a&&(k[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(k[b]=f+d+g,h())})}};a.attr_animate=function(a,b,c,d,e,f){a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)&&(f=f||function(){},r(a,c,d,e,function(e){a&&(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),
f())}))};a.queue_animate=function(b){if(b.length){var c=b.shift(),d=c.elem,e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.queue_animate(b)};"css"==c.type?a.css_animate(d,e,f,g,h,k,l,m):"attr"==c.type&&a.attr_animate(d,e,f,g,h,m)}};a.set_camera_smooth_factor=function(a){W=a};a.get_camera_smooth_factor=function(){return W}};b4w.module.camera_anim=function(a,q){function d(a,b,d,e,f){d=w.angle_wrap_0_2pi(b-d);d=Math.min(d,2*Math.PI-d);b=w.angle_wrap_0_2pi(e-b);b=Math.min(b,2*Math.PI-b);if(1E-6>Math.abs(d)||1E-6>2*Math.PI-Math.abs(d))d=0;if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;c.is_eye_camera(a)?(f[0]=b,f[1]=d):(f[0]=d,f[1]=b);return f}var c=q("camera"),b=q("controls"),g=q("print"),n=q("scenes"),B=q("time"),e=q("transform"),v=q("tsr"),w=q("util"),h=q("vec3"),l=new Float32Array(2),x=new Float32Array(2),k=new Float32Array(3),
f=new Float32Array(3),F=new Float32Array(3),u=v.create(),r=v.create(),z=v.create(),J={},D=!1,H=!1,C=!1,t=!1;a.track_to_target=function(a,d,n,p,q,r,t,u){if(c.is_eye_camera(a)){if(w.is_vector(d))var m=d;else m=k,e.get_object_center(d,!1,m);n=n||1;p=p||2;q=q||1;r=r||1;var v=e.get_translation(a,f);d=h.subtract(m,v,F);var m=c.get_camera_angles(a,l),y=c.get_camera_angles_dir(d,x),z=y[0]-m[0],A=y[1]-m[1],C=Math.abs(Math.acos(Math.cos(z)*Math.cos(A))/n),D=h.length(d)*(1-1/p),H=function(a){return 6*a*(1-a)},
I=B.get_timeline(),Q=0,J=function(){b.remove_sensor_manifold(a,"TRACK_TO_TARGET");t&&t()};n=b.create_timeline_sensor();p=b.create_elapsed_sensor();b.create_sensor_manifold(a,"TRACK_TO_TARGET",b.CT_CONTINUOUS,[n,p],null,function(d,f,g){c.is_eye_camera(d)?1==g&&(g=b.get_sensor_value(d,f,0)-I,f=b.get_sensor_value(d,f,1),g<C?(g=H(g/C),c.eye_rotate(a,g*z*f/C,g*A*f/C)):g<C+q?(Q||(c.eye_rotate(a,y[0],y[1],!0,!0),Q++),g=H(g-C/q),f=g*D*f/q,e.move_local(d,0,0,-f)):g<C+q+r?1>=Q&&(c.eye_rotate(a,y[0],y[1],!0,
!0),c.eye_set_look_at(a,v),e.move_local(d,0,0,-D),u&&u(),Q++):g<C+q+r+q?(2>=Q&&(c.eye_rotate(a,y[0],y[1],!0,!0),c.eye_set_look_at(a,v),e.move_local(d,0,0,-D),Q++),g=H(g-C-q-r/q),f=g*D*f/q,e.move_local(d,0,0,f)):(c.eye_rotate(a,y[0],y[1],!0,!0),c.eye_set_look_at(a,v),J())):J()})}else g.error("track_to_target(): Wrong camera object or camera move style")};a.auto_rotate=function(a,e,f){function h(e,f,g){if(1==g)if(g=c.get_move_style(e),g==c.MS_STATIC)k();else if(g!=c.MS_TARGET_CONTROLS&&g!=c.MS_EYE_CONTROLS||
!c.has_horizontal_rot_limits(e))q=null,f=b.get_sensor_value(e,f,0),c.rotate_camera(e,f*a,0);else{g=g==c.MS_EYE_CONTROLS?c.eye_get_horizontal_limits(e,J):c.target_get_horizontal_limits(e,J);if(null===q||g.left!=q.left||g.right!=q.right){q=q||{};q.left=g.left;q.right=g.right;r=Math.min(.2,w.angle_wrap_0_2pi(q.right-q.left)/2);g=m;var h=q,n=c.get_camera_angles(g,l)[0];g=d(g,n,h.left,h.right,x);t=a*Math.min(1,g[0]/.2,g[1]/.2)}f=b.get_sensor_value(e,f,0);g=c.get_camera_angles(e,l)[0];g=d(e,g,q.left,q.right,
x);g[1]>r&&g[0]>r?t=w.sign(t)*a:g[1]<r?t-=Math.pow(a,2)/.4*f:g[0]<r&&(t+=Math.pow(a,2)/.4*f);c.rotate_camera(e,f*t,0)}}function k(){b.remove_sensor_manifold(m,"AUTO_ROTATE");b.remove_sensor_manifold(m,"DISABLE_AUTO_ROTATE");e()}e=e||function(){};var m=n.get_active_camera();if(c.is_static_camera(m))g.error("auto_rotate(): Wrong camera move style");else{var q={},r=0,t=0;if(b.check_sensor_manifold(m,"AUTO_ROTATE"))k();else{var u=b.create_mouse_move_sensor("X"),v=b.create_mouse_move_sensor("Y"),z=b.create_mouse_click_sensor(),
A=b.create_touch_move_sensor(),B=b.create_touch_zoom_sensor(),C=b.create_elapsed_sensor();f=f?b.create_mouse_wheel_sensor():b.create_custom_sensor(0);b.create_sensor_manifold(m,"DISABLE_AUTO_ROTATE",b.CT_LEVEL,[u,v,z,A,B,f],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]||a[5]},k);b.create_sensor_manifold(m,"AUTO_ROTATE",b.CT_CONTINUOUS,[C],function(a){return a[0]},h)}}};a.is_auto_rotate=function(){var a=n.get_active_camera();return b.check_sensor_manifold(a,"AUTO_ROTATE")};a.check_auto_rotate=
function(){var a=n.get_active_camera();return c.get_move_style(a)==c.MS_STATIC?!1:!0};a.move_camera_to_point=function(a,b,d,l,n){if(c.get_move_style(a)!=c.MS_STATIC)g.error("move_camera_to_point(): wrong camera type");else if(!D)if(a)if(b){d=d||1;l=l||.01;var m=w.is_vector(a)?a:e.get_tsr(a,u),p=w.is_vector(b)?b:e.get_tsr(b,r);b=h.distance(v.get_trans_view(m),v.get_trans_view(p))/d;d=w.quat_to_dir(v.get_quat_view(m),w.AXIS_MZ,k);var q=w.quat_to_dir(v.get_quat_view(p),w.AXIS_MZ,f);d=Math.min(Math.abs(h.dot(d,
q)),1);l=1E3*Math.max(b,Math.acos(d)/l);D=!0;var t=B.animate(0,1,l,function(b){var c=v.interpolate(m,p,w.smooth_step(b),z);C?(B.clear_animation(t),D=C=!1):(e.set_tsr(a,c),1==b&&(D=!1,n&&n()))})}else g.error("move_camera_to_point(): you must specify the point object");else g.error("move_camera_to_point(): you must specify the camera object")};a.rotate_camera=function(a,b,d,e,f){if(c.get_move_style(a)==c.MS_STATIC)g.error("rotate_camera(): not supported for STATIC cameras");else if(!H)if(a)if(b||d){H=
!0;var h=0,k=0,l=b?b:d,m=B.animate(0,l,e||1E3,function(e){t?(B.clear_animation(m),H=t=!1):(h-=e,k-=e,d&&b?c.rotate_camera(a,h,k):d?c.rotate_camera(a,0,k):b&&c.rotate_camera(a,h,0),k=h=e,e==l&&(H=!1,f&&f()))})}else g.error("rotate_camera(): you must specify the rotation angle");else g.error("rotate_camera(): you must specify the camera object")};a.stop_cam_moving=function(){C=!0};a.stop_cam_rotating=function(){t=!0};a.is_moving=function(){return D};a.is_rotating=function(){return H}};b4w.module.gp_conf=function(a,q){function d(){p.length=0;for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)a[b]&&p.push(a[b]);return p}function c(a){var b=f.get(a+"_gmpd_stngs","b4w");if(b){var b=JSON.parse(b),c;for(c in b)k.set_gamepad_key(a,c,b[c])}else c=JSON.stringify(u),f.set(a+"_gmpd_stngs",c,"b4w")}function b(a){R=!0;var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),
e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),l=document.createElement("div"),m=document.createElement("div"),n=document.createElement("div"),p=document.createElement("div"),q=document.createElement("div"),t=document.createElement("div"),u=document.createElement("div"),w=document.createElement("div"),x=document.createElement("div"),E=document.createElement("div"),z=document.createElement("div"),A=document.createElement("div"),
B=document.createElement("div"),D=document.createElement("div"),G=document.createElement("div");C=b;b.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>')+
"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;";c.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>')+
"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;";d.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;";e.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;";f.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;";g.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;";h.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;";l.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;";m.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;";n.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;";p.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;top: 51px;position: absolute;";q.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;";t.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;";u.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;";w.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;";x.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>')+
"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;";E.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;";z.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;";A.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;";B.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>')+
"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;";D.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;";G.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;";b.appendChild(D);b.appendChild(G);c.appendChild(d);c.appendChild(e);c.appendChild(f);c.appendChild(g);b.appendChild(c);h.appendChild(l);h.appendChild(m);h.appendChild(n);h.appendChild(p);b.appendChild(h);b.appendChild(q);b.appendChild(t);b.appendChild(u);b.appendChild(w);b.appendChild(x);b.appendChild(E);b.appendChild(z);a.appendChild(b);b.appendChild(A);b.appendChild(B);Q.length=0;r.length=0;y.length=0;Y.length=0;Q.push(n,
m,p,l,x,E,A,z,u,w,q,t,d,f,g,e,B);r.push('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>',
'<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>');
y.push(q,q,t,t);Y.push(D,G);for(a=0;a<Q.length;a++)Q[a].setAttribute("id","pad_btn_"+a),Q[a].setAttribute("data-colorstate","B"),Q[a].setAttribute("data-key",a),Q[a].setAttribute("data-svgid",a);D.setAttribute("id","pad_left_axis");D.setAttribute("data-colorstate","GR");D.setAttribute("data-key",k.GMPD_AXIS_0);D.setAttribute("data-svgid",r.length);G.setAttribute("id","pad_right_axis");G.setAttribute("data-colorstate","GR");G.setAttribute("data-key",k.GMPD_AXIS_2);G.setAttribute("data-svgid",r.length+
1);r.push('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>',
'<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>');
v(Q,F);v(Y,"#e6e6e6")}function g(a){return[x.create_gamepad_btn_sensor(k.GMPD_BUTTON_0,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_1,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_2,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_3,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_4,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_5,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_6,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_7,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_8,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_9,
a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_10,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_11,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_12,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_13,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_14,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_15,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_16,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_17,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_18,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_19,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_20,
a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_21,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_22,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_23,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_24,a),x.create_gamepad_btn_sensor(k.GMPD_BUTTON_25,a)]}function n(a){return[x.create_gamepad_axis_sensor(k.GMPD_AXIS_0,a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_1,a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_2,a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_3,a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_4,a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_5,
a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_6,a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_7,a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_8,a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_9,a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_10,a),x.create_gamepad_axis_sensor(k.GMPD_AXIS_11,a)]}function B(a,b){var c=document.createElement("input");c.style.cssText="display: inline-block;position = relative;";c.setAttribute("type","radio");c.setAttribute("name","choice");var d=document.createElement("label");d.textContent=
b;d.style.cssText="position = relative;display: inline-block;color: white;";a.appendChild(c);a.appendChild(d);return c}function e(a){H.removeChild(C);C=null;switch(a){case "PAD":A.checked=!0;b(H);break;case "WHEEL":m.checked=!0;var c=H;R=!1;var d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),l=document.createElement("div"),n=document.createElement("div"),p=document.createElement("div"),
q=document.createElement("div"),t=document.createElement("div"),u=document.createElement("div"),w=document.createElement("div"),x=document.createElement("div"),z=document.createElement("div"),E=document.createElement("div"),B=document.createElement("div"),D=document.createElement("div"),G=document.createElement("div"),I=document.createElement("div"),J=document.createElement("div"),qa=document.createElement("div"),fa=document.createElement("div"),va=document.createElement("div"),M=document.createElement("div");
a=document.createElement("div");var ua=document.createElement("div"),na=document.createElement("div"),xa=document.createElement("div"),N=document.createElement("div"),wa=document.createElement("div");C=d;var ma="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>')+
"');width: 19px;height: 19px;background-size: 100% 100%;";d.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>')+
"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;";e.style.cssText=ma+"top: 132px;left: 331px;";f.style.cssText=ma+"top: 122px;left: 315px;";g.style.cssText=ma+"top: 122px;left: 347px;";h.style.cssText=ma+"top: 113px;left: 331px;";l.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+
btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;";n.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;";p.style.cssText=ma+"top: 107px;left: 141px;";q.style.cssText=ma+"top: 107px;left: 90px;";t.style.cssText=ma+"top: 185px;left: 321px;";u.style.cssText=ma+"top: 185px;left: 340px;";w.style.cssText=ma+"top: 179px;left: 358px;";x.style.cssText=ma+"top: 178px;left: 303px;";z.style.cssText=ma+"top: 210px;left: 299px;";E.style.cssText=ma+"top: 279px;left: 299px;";B.style.cssText=ma+"top: 210px;left: 321px;";D.style.cssText=ma+
"top: 279px;left: 321px;";G.style.cssText=ma+"top: 210px;left: 344px;";I.style.cssText=ma+"top: 278px;left: 344px;";J.style.cssText=ma+"top: 124px;left: 147px;";qa.style.cssText=ma+"top: 138px;left: 133px;";fa.style.cssText=ma+"top: 124px;left: 82px;";va.style.cssText=ma+"top: 138px;left: 96px;";M.style.cssText=ma+"top: 278px;left: 367px;";ma="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>')+
"');width: 19px;height: 46px;background-size: 100% 100%;";a.style.cssText=ma+"top: 291px;left: 50px;";ua.style.cssText=ma+"top: 291px;left: 111px;";na.style.cssText=ma+"top: 291px;left: 171px;";xa.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>')+
"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;";N.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>')+
"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;";wa.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>')+
"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;";c.appendChild(d);d.appendChild(a);d.appendChild(ua);d.appendChild(na);d.appendChild(xa);d.appendChild(N);d.appendChild(wa);d.appendChild(e);d.appendChild(f);d.appendChild(g);d.appendChild(h);d.appendChild(l);d.appendChild(n);d.appendChild(p);d.appendChild(q);d.appendChild(t);d.appendChild(u);d.appendChild(w);d.appendChild(x);d.appendChild(z);d.appendChild(E);d.appendChild(B);d.appendChild(D);d.appendChild(G);d.appendChild(I);
d.appendChild(J);d.appendChild(qa);d.appendChild(fa);d.appendChild(va);d.appendChild(M);Q.length=0;r.length=0;y.length=0;Y.length=0;Q.push(e,f,g,h,l,n,p,q,t,u,w,x,z,E,B,D,G,I,J,qa,fa,va,M);r.push('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>');
Y.push(xa,a,na,ua,N,wa);for(c=0;c<Q.length;c++)Q[c].setAttribute("id","wheel_btn_"+c),Q[c].setAttribute("data-colorstate","B"),Q[c].setAttribute("data-key",c),Q[c].setAttribute("data-svgid",c);for(c=0;c<Y.length;c++)Q[c].setAttribute("id","wheel_axis_"+c),Q[c].setAttribute("data-colorstate","GR");xa.setAttribute("data-key",k.GMPD_AXIS_0);xa.setAttribute("data-svgid",r.length);a.setAttribute("data-key",k.GMPD_AXIS_1);a.setAttribute("data-svgid",r.length+1);na.setAttribute("data-key",k.GMPD_AXIS_2);
na.setAttribute("data-svgid",r.length+2);ua.setAttribute("data-key",k.GMPD_AXIS_3);ua.setAttribute("data-svgid",r.length+3);N.setAttribute("data-key",k.GMPD_AXIS_4);N.setAttribute("data-svgid",r.length+4);wa.setAttribute("data-key",k.GMPD_AXIS_5);wa.setAttribute("data-svgid",r.length+5);r.push('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>');
v(Q,F);v(Y,"#e6e6e6")}}function v(a,b){function c(a){a=a.target;if(!(0>z||"G"==a.getAttribute("data-colorstate")))if(D){if("R"==a.getAttribute("data-colorstate")&&(J=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",D=0),"B"==a.getAttribute("data-colorstate")||"GR"==a.getAttribute("data-colorstate")){var c=parseFloat(J.getAttribute("data-svgid"));J.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(r[c])+"')";J.setAttribute("data-colorstate",
a.getAttribute("data-colorstate"));J=a;c=parseFloat(a.getAttribute("data-svgid"));a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(r[c].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R")}}else{var c=parseFloat(a.getAttribute("data-svgid")),d="B"==a.getAttribute("data-colorstate")?1:2;D=d;a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(r[c].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R");document.getElementById("action_label").textContent=
1==d?"Now press the button on the device":"Now move the axis on the device";J=a}}for(var d=0;d<a.length;d++)k.add_click_listener(a[d],c)}function w(a){var b=document.createElement("label");b.style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;";b.textContent=a;return b}function h(){var a=window.innerWidth,b=window.innerHeight;H.style.zoom=750>=
b&&400<b||750>=a&&400<a?"0.5":400>=a||400>=b?"0.3":"1"}var l=q("container"),x=q("controls"),k=q("input"),f=q("storage"),F=RegExp("#5276cf","g"),u={};u[k.GMPD_BUTTON_12]=k.GMPD_BUTTON_12;u[k.GMPD_BUTTON_13]=k.GMPD_BUTTON_13;u[k.GMPD_BUTTON_15]=k.GMPD_BUTTON_15;u[k.GMPD_BUTTON_14]=k.GMPD_BUTTON_14;u[k.GMPD_BUTTON_3]=k.GMPD_BUTTON_3;u[k.GMPD_BUTTON_0]=k.GMPD_BUTTON_0;u[k.GMPD_BUTTON_1]=k.GMPD_BUTTON_1;u[k.GMPD_BUTTON_2]=k.GMPD_BUTTON_2;u[k.GMPD_BUTTON_5]=k.GMPD_BUTTON_5;u[k.GMPD_BUTTON_7]=k.GMPD_BUTTON_7;
u[k.GMPD_BUTTON_4]=k.GMPD_BUTTON_4;u[k.GMPD_BUTTON_6]=k.GMPD_BUTTON_6;u[k.GMPD_BUTTON_8]=k.GMPD_BUTTON_8;u[k.GMPD_BUTTON_9]=k.GMPD_BUTTON_9;u[k.GMPD_BUTTON_10]=k.GMPD_BUTTON_10;u[k.GMPD_BUTTON_11]=k.GMPD_BUTTON_11;u[k.GMPD_BUTTON_16]=k.GMPD_BUTTON_16;var r=[],z=-1,J=null,D=0,H=null,C=null,t=null,m=null,A=null,I=null,p=[],Q=[],y=[],Y=[],R=!0,G={};G[k.GMPD_AXIS_0]=-2;G[k.GMPD_AXIS_1]=-2;G[k.GMPD_AXIS_2]=-2;G[k.GMPD_AXIS_3]=-2;G[k.GMPD_AXIS_4]=-2;G[k.GMPD_AXIS_5]=-2;G[k.GMPD_AXIS_6]=-2;G[k.GMPD_AXIS_7]=
-2;G[k.GMPD_AXIS_8]=-2;G[k.GMPD_AXIS_9]=-2;G[k.GMPD_AXIS_10]=-2;G[k.GMPD_AXIS_11]=-2;a.show=function(){var a=document.createElement("div");H=a;a.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);";
l.insert_to_container(a,"LAST");b(a);var p=document.createElement("div");p.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var q=document.createElement("div");q.innerHTML="Select a device";q.style.cssText="color: #fff;display: inline-block;";p.appendChild(q);for(q=0;4>q;q++){var u=g(q),v=function(){return!0},
C=function(a,b){if(b==z)for(var c=0;c<Q.length;c++){var d=Q[c],e=x.get_sensor_value(a,b,c),g=c;if(D)e=k.get_pressed_gmpd_btn(z),0<=e&&J&&1==D&&(d=J.getAttribute("data-key"),k.set_gamepad_key(z,d,e),g=f.get(z+"_gmpd_stngs","b4w")||"{}",g=JSON.parse(g),g[d]=e,f.set(z+"_gmpd_stngs",JSON.stringify(g),"b4w"),J=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",D=0);else{if(e&&"B"==d.getAttribute("data-colorstate")){var h=r[g];d.style.backgroundImage=
"url('data:image/svg+xml;base64,"+btoa(h.replace(F,"#00ff00"))+"')";d.setAttribute("data-colorstate","G")}e||"B"==d.getAttribute("data-colorstate")||(h=r[g],d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(h)+"')",d.setAttribute("data-colorstate","B"))}}};x.create_sensor_manifold(null,q,x.CT_CONTINUOUS,u,v,C)}0<d().length&&(z=0);var X=[],q=document.createElement("div");q.style.cssText="margin-top: 20px;";for(u=0;4>u;u++)C=w(u),u==z&&(C.style.backgroundColor="green",t=C),c(u),q.appendChild(C),
C.setAttribute("data-device_type","PAD"),X.push(C),k.add_click_listener(C,function(a){var b=d();a=a.target;for(var f=0;f<b.length;f++)X[f]==a&&(z=f,t=a,c(z),e(a.getAttribute("data-device_type")))});p.appendChild(q);I=document.createElement("label");I.style.cssText="position: relative;display: block;color: white;";p.appendChild(I);q=document.createElement("div");q.style.cssText="margin-top: 20px;";u=B(q,"Pad");C=B(q,"Wheel");u.setAttribute("checked","true");u.onchange=function(){e("PAD");t&&t.setAttribute("data-device_type",
"PAD")};C.onchange=function(){e("WHEEL");t&&t.setAttribute("data-device_type","WHEEL")};u.setAttribute("id","test");A=u;m=C;u=document.createElement("label");u.style.cssText+="color: #fff;display: block;";q.appendChild(u);u.textContent="Click on the buttons & arrows to setup your controller";u.setAttribute("id","action_label");p.appendChild(q);a.appendChild(p);a=x.create_elapsed_sensor();x.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",x.CT_CONTINUOUS,[a],v,function(){var a=d(),b=a.length;-1==
z&&a.length&&(z=a[0].index,t=X[z]);for(var c=0;c<X.length;c++)c<b?(X[c].textContent=a[c].index,X[c]==t?(X[c].style.backgroundColor="green",I.textContent="Selected device: "+a[c].index+". Data: "+a[c].id):X[c].style.backgroundColor="blue"):X[c].style.backgroundColor="black";b||(z=-1,I.textContent="")});for(q=0;4>q;q++)u=n(q),C=function(a,b){if(b=="AXES"+z){for(var c=0;c<y.length;c+=2){var d=y[c],e=a,f=b,g=c,h=20*x.get_sensor_value(e,f,g),e=20*x.get_sensor_value(e,f,g+1);d.style.transform="translate3d("+
h+"px, "+e+"px, 0px) rotate(0rad)"}if(R)for(c=0;12>c;c+=2){if(e=a,f=b,d=c,!(d+1>2*Y.length)){h=x.get_sensor_value(e,f,d);e=x.get_sensor_value(e,f,d+1);if(-2<G[d]){var l=h-G[d],m=e-G[d+1],f=Y[Math.floor(d/2)],g=f.getAttribute("data-svgid");D?2==D&&(l=k.get_moved_gmpd_axis(z),0<=l&&(l%2&&l--,D=0,f.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(r[g])+"')",f=parseFloat(J.getAttribute("data-key")),k.set_gamepad_key(z,f,l),k.set_gamepad_key(z,f+1,l+1),J=null,document.getElementById("action_label").textContent=
"Click on the buttons & arrows to setup your controller")):f.style.backgroundImage=l||m?"url('data:image/svg+xml;base64,"+btoa(r[g].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(r[g])+"')"}G[d]=h;G[d+1]=e}}else for(c=0;12>c;c++)(d=c,d>=Y.length)||(h=x.get_sensor_value(a,b,d),-2<G[d]&&((g=h-G[d],e=Y[d],f=e.getAttribute("data-svgid"),D)?2==D&&(g=k.get_moved_gmpd_axis(z),0<=g&&(D=0,e.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(r[f])+"')",e=parseFloat(J.getAttribute("data-key")),
k.set_gamepad_key(z,e,g),J=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller")):e.style.backgroundImage=g?"url('data:image/svg+xml;base64,"+btoa(r[f].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(r[f])+"')"),G[d]=h)}},x.create_sensor_manifold(null,"AXES"+q,x.CT_CONTINUOUS,u,function(){return!0},C);h();window.addEventListener("resize",h)};a.hide=function(){D=0;z=-1;A=m=J=t=null;y.length=0;Q.length=0;Y.length=
0;l.get_container().removeChild(H);H=null;x.remove_sensor_manifold(null,"UPDATE_GAMEPAD_DATA");for(var a=0;4>a;a++)x.remove_sensor_manifold(null,a),x.remove_sensor_manifold(null,"AXES"+a);window.removeEventListener("resize",h)};a.update=function(){for(var a=0;4>a;a++)c(a)}};b4w.module.gyroscope=function(a,q){function d(a){var d=b.create_gyro_angles_sensor(),g=b.create_gyro_quat_sensor(),q=!0;b.create_sensor_manifold(a,"CAMERA_ROTATE_GYRO",b.CT_CONTINUOUS,[d,g],null,function(a,d,g){if(0<g)if(c.is_eye_camera(a))d=b.get_sensor_payload(a,d,1),g=e.transformQuat(B.AXIS_MY,d,h),c.set_vertical_axis(a,g),n.set_rotation_v(a,d);else{w=b.get_sensor_payload(a,d,0);q&&(v[0]=w[0],v[1]=w[1],v[2]=w[2],q=!1);g=d=0;window.orientation||(d=w[1]-v[1],g=w[0]-v[0],w[1]>x&&w[1]<l&&(g=0));if(180==
window.orientation){d=w[1]-v[1];0>w[1]&&(d=-d);g=v[0]-w[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;w[1]>-l&&w[1]<-x&&(g=0)}if(-90==window.orientation){d=w[0]-v[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;g=v[1]-w[1];if(w[0]>k||w[0]<f)g=0}if(90==window.orientation){d=v[0]-w[0];if(d>Math.PI/2||d<-Math.PI/2)d=0;g=w[1]-v[1];if(w[0]>k||w[0]<f)g=0}c.rotate_camera(a,g,d);v[0]=w[0];v[1]=w[1];v[2]=w[2]}})}var c=q("camera"),b=q("controls"),g=q("scenes"),n=q("transform"),B=q("util"),e=q("vec3"),v=new Float32Array(3),w=new Float32Array(3),
h=e.create(),l=B.deg_to_rad(110),x=B.deg_to_rad(70),k=B.deg_to_rad(70),f=-B.deg_to_rad(70);a.enable_camera_rotation=function(){var a=g.get_active_camera();d(a)};a.disable_camera_rotation=function(){var a=g.get_active_camera();b.remove_sensor_manifold(a,"CAMERA_ROTATE_GYRO")}};b4w.module.hmd_conf=function(a,q){function d(){if(!x.can_use_device(x.DEVICE_HMD))return!1;var a=x.get_device_by_type_element(x.DEVICE_HMD),a=x.get_value_param(a,x.HMD_WEBVR_TYPE);return a&(x.HMD_NON_WEBVR|x.HMD_WEBVR_MOBILE|x.HMD_WEBVR_DESKTOP)&&!(a&x.HMD_WEBVR1)}function c(a){a=a.target.value;var b=t[a],c;for(c in H)if(c in b){var d=document.getElementById(c+"_slider");d&&(d.disabled="custom"!==a,d.value=b[c]);if(d=document.getElementById(c+"_number"))d.disabled="custom"!==a,d.value=b[c];H[c]=b[c]}}
function b(){l.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING");n();e();u&&(u=!1,h.get_container().removeChild(r),document.head.removeChild(z),z=J=r=null)}function g(){n(!0);e();for(var a in H){var b=document.getElementById(a+"_slider");b&&(b.value=H[a]);if(b=document.getElementById(a+"_number"))b.value=H[a]}}function n(a){var b=Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio,c=Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio,d=0,e=0,g=0,h;a:{h=
A;var l=navigator.userAgent||navigator.vendor||window.opera;if(1==h.format&&h.devices&&h.devices.length)for(var m=0;m<h.devices.length;m++){var n=h.devices[m];if(n.rules&&("ios"==n.type&&C||"android"==n.type)){for(var q=!1,r=0;r<n.rules.length;r++){var t=n.rules[r];if(t.ua&&0<=l.indexOf(t.ua)||!t.ua&&t.res&&t.res[0]&&t.res[1]&&Math.min(b,c)==Math.min(t.res[0],t.res[1])&&Math.max(b,c)==Math.max(t.res[0],t.res[1])){q=!0;break}}if(q){h=m;break a}}}else k.error("DPDB isn't correct.");h=-1}-1!=h&&(g=A.devices[h],
e=g.dpi[1]||g.dpi,d=Math.round(25.4*b/(g.dpi[0]||g.dpi)),e=Math.round(25.4*c/e),g=Math.round(g.bw));b=f.get("hmd_conf","b4w");b=JSON.parse(b?b:"{}");a?(H.first_distortion=.34,H.second_distortion=.55,H.bevel_size=g||4,H.screen_width=d||110,H.screen_height=e||65,H.screen_lense=50,H.ipd=64,H.baseline=32):(H.first_distortion="first_distortion"in b?parseFloat(b.first_distortion):.34,H.second_distortion="second_distortion"in b?parseFloat(b.second_distortion):.55,H.bevel_size="bevel_size"in b?parseFloat(b.bevel_size):
g||4,H.screen_width="screen_width"in b?parseFloat(b.screen_width):d||110,H.screen_height="screen_height"in b?parseFloat(b.screen_height):e||65,H.screen_lense="screen_lense"in b?parseFloat(b.screen_lense):50,H.ipd="ipd"in b?parseFloat(b.ipd):64,H.baseline="baseline"in b?parseFloat(b.baseline):32);D=!0}function B(){f.set("hmd_conf",JSON.stringify(H),"b4w");b()}function e(){if(D){var a=x.get_device_by_type_element(x.DEVICE_HMD);a&&(x.set_config(a,x.HMD_DISTORTION,[H.first_distortion,H.second_distortion]),
x.get_value_param(a,x.HMD_WEBVR_TYPE)&(x.HMD_NON_WEBVR|x.HMD_WEBVR_MOBILE)&&(x.set_config(a,x.HMD_BEVEL_SIZE,.001*H.bevel_size),x.set_config(a,x.HMD_SCREEN_WIDTH,.001*H.screen_width),x.set_config(a,x.HMD_SCREEN_HEIGHT,.001*H.screen_height),x.set_config(a,x.HMD_SCREEN_LENSE_DIST,.001*H.screen_lense),x.set_config(a,x.HMD_EYE_DISTANCE,.001*H.ipd),x.set_config(a,x.HMD_BASELINE_DIST,.001*H.baseline)));D=!1}}function v(a){var b=a.target.id.split("_"),b=b.splice(0,b.length-1).join("_");b in H&&H[b]!=a.target.value&&
(D=!0,H[b]=a.target.value,document.getElementById(b+"_slider").value=a.target.value,document.getElementById(b+"_number").value=a.target.value)}function w(a,b,c){var d=document.createElement("button");d.onclick=a;d.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 160px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;padding-left: 8px;line-height: 28px;margin-right:"+
c+";box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";d.innerHTML=b;return d}var h=q("container"),l=q("controls"),x=q("input"),k=q("print"),f=q("storage"),F=q("util"),u=!1,r=null,z=null,J=null,D=!0,H={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},C=/iPad|iPhone|iPod/.test(navigator.platform),t={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",
type:1,ipd:60,baseline:35,screen_lense:42,first_distortion:.441,second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:1,ipd:64,baseline:35,screen_lense:39,first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:0,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},m=[{label:"Tray to lens-center distance.",Cm:!0,inputs:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",Cm:!0,inputs:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",
Cm:!0,inputs:[{id:"screen_lense",max:"100",step:"1"}]},{label:"Screen height.",Cm:!0,inputs:[{id:"screen_height",max:"150",step:"1"}]},{label:"Screen width.",Cm:!0,inputs:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",Cm:!0,inputs:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",inputs:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];a.check=d;a.show=function(a){if(d()){var k=h.get_container();z=document.createElement("style");
z.innerHTML="."+a+" input[type=range]::-webkit-slider-runnable-track {width: 100%; height: 8px;cursor: pointer;background-color: #fff;border: 2px solid rgba(98, 98, 98, .2);box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);}."+a+" input[type=range]::-webkit-slider-thumb {box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);height: 30px;width: 16px;border-radius: 2px;background-color: #323232;cursor: pointer;margin-top: -13px;-webkit-appearance: none;}";document.head.appendChild(z);if(!u){u=!0;n();var q=
x.get_device_by_type_element(x.DEVICE_MOUSE,k);x.switch_prevent_default(q,!1);q=x.get_device_by_type_element(x.DEVICE_TOUCH,k);x.switch_prevent_default(q,!1);r=document.createElement("div");r.className=a;k.appendChild(r);J=document.createElement("div");r.appendChild(J);J.style.cssText="background-color: #484848;border: 2px solid rgba(150, 150, 150, 0.7);box-shadow: 0px 0px 10px 0px rgba(150, 150, 150, 0.7);position: relative;width: 524px;padding: 16px;overflow: hidden;";a=f.get("hmd_conf","b4w");
a=JSON.parse(a?a:"{}").profile||"custom";k=document.createElement("div");q=document.createElement("label");q.innerHTML="Profile: ";q.className="text_label";q.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 120px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";
k.appendChild(q);q=document.createElement("select");k.appendChild(q);q.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";var y=x.get_device_by_type_element(x.DEVICE_HMD);if(y)for(var A in t)if(0==t[A].type||x.get_value_param(y,
x.HMD_WEBVR_TYPE)&(x.HMD_NON_WEBVR|x.HMD_WEBVR_MOBILE)&&1==t[A].type){var C=document.createElement("option");C.value=A;C.text=t[A].name;q.appendChild(C)}q.value=a;F.is_ie11()?q.onchange=c:q.oninput=c;J.appendChild(k);A=x.get_device_by_type_element(x.DEVICE_HMD);for(a=0;a<m.length;a++)if(x.get_value_param(A,x.HMD_WEBVR_TYPE)&(x.HMD_NON_WEBVR|x.HMD_WEBVR_MOBILE)||!m[a].Cm){k=m[a];y=a;q=document.createElement("div");C=document.createElement("label");C.className="text_label";var D="8px";y%2&&(D="0");
C.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 100%;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";C.textContent=k.label;q.appendChild(C);q.style.cssText="margin-top: 16px;float: left;width: 240px;margin-right: "+D+";border-top: 2px solid rgba(98, 98, 98, .4);box-sizing: border-box;-webkit-box-sizing: border-box;padding-top: 8px;";
for(y=0;y<k.inputs.length;y++){C=k.inputs[y];D=document.createElement("div");D.className="row";var E=document.createElement("input");E.className="input_slider";E.style.cssText="-webkit-appearance: none;width: 192px;display: block;float: left;height: 8px;margin-bottom: 16px;margin-top: 16px;box-sizing: border-box;margin-right: 8px;margin-left: 0;";E.setAttribute("id",C.id+"_slider");E.setAttribute("type","range");E.setAttribute("min","0.00");E.setAttribute("step",C.step);E.setAttribute("value",H[C.id]);
E.setAttribute("max",C.max);D.appendChild(E);var I=document.createElement("input");I.className="input_text";I.setAttribute("id",C.id+"_number");I.setAttribute("type","number");I.setAttribute("min","0.00");I.setAttribute("step",C.step);I.setAttribute("value",H[C.id]);I.setAttribute("max",C.max);D.appendChild(I);I.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 40px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;box-sizing: border-box;line-height: 28px;margin-top: 4px;margin-right: 0;margin-left: 0;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";
F.is_ie11()?(E.onchange=v,I.onchange=v):(E.oninput=v,I.oninput=v);q.appendChild(D)}J.appendChild(q)}A=document.createElement("div");a=w(B,"SAVE","4px");k=w(b,"CANCEL","4px");q=w(g,"RESET","0px");A.className="row";A.style.cssText="padding-top: 32px;clear: both;box-sizing: border-box;-webkit-box-sizing: border-box;";A.appendChild(a);A.appendChild(k);A.appendChild(q);J.appendChild(A);A=l.create_timeline_sensor();l.create_sensor_manifold(null,"UPDATE_HMD_RENDERING",l.CT_CONTINUOUS,[A],null,e)}}};a.hide=
b;a.reset=g;a.update=function(){n();e()};var A={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},
{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,
518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},
{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},
{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],
dpi:[403.4,402.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",
rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},
{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},
{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],
dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,
bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},
{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1E3},{type:"ios",
rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1E3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1E3}]}};b4w.module.hmd=function(a,q){function d(a,d){function g(d,e,f){if(0<f&&(f=B.get_active_camera())&&c.is_eye_camera(f)&&(d=b.get_sensor_payload(d,e,1)))if(1==a){d=n.multiply(t,d,C);var g=h.transformQuat(w.AXIS_MY,d,u);c.set_vertical_axis(f,g);v.set_rotation_v(f,d)}else if(2==a||3==a){e=v.get_rotation(f,D);e=n.invert(e,D);var k=n.multiply(l,e,D);e=c.get_vertical_axis(f,u);Math.abs(e[2])<Math.PI/4?g=h.cross(e,w.AXIS_MY,r):Math.abs(e[1])<Math.PI/4&&(g=h.cross(e,w.AXIS_Z,r));h.normalize(g,g);var k=h.transformQuat(g,
k,z),m=h.dot(e,k),k=h.scaleAndAdd(k,e,-m,z);h.normalize(k,k);e=h.cross(e,g,u);g=Math.acos(w.clamp(h.dot(g,k),0,1));e=w.sign(h.dot(k,e));x+=g*e;g=n.setAxisAngle(w.AXIS_Z,-x,D);3==a?d=n.multiply(g,d,J):(e=w.quat_project(d,w.AXIS_MZ,w.AXIS_Z,w.AXIS_Y,H),e=n.invert(e,H),d=n.multiply(e,d,H),d=n.multiply(g,d,J));g=h.transformQuat(w.AXIS_MY,d,u);c.set_vertical_axis(f,g);v.set_rotation_v(f,d);n.copy(d,l)}}if(d){var m=B.get_active_camera();m&&e.request_split_screen(function(){c.is_eye_camera(m)||(k=c.is_target_camera(m),
f=c.is_hover_camera(m),F=c.is_static_camera(m),c.eye_setup(m));var a=b.create_elapsed_sensor();l=v.get_rotation(m,l);b.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",b.CT_CONTINUOUS,[a,d],null,g)})}}var c=q("camera"),b=q("controls"),g=q("input"),n=q("quat"),B=q("scenes"),e=q("screen"),v=q("transform"),w=q("util"),h=q("vec3"),l=n.create(),x=0,k=!1,f=!1,F=!1,u=h.create(),r=h.create(),z=h.create(),J=n.create(),D=n.create(),H=n.create(),C=n.create(),t=n.create(),m={pivot:h.create()};a.HMD_NONE_MOUSE_ALL_AXES=
0;a.HMD_ALL_AXES_MOUSE_NONE=1;a.HMD_ROLL_PITCH_MOUSE_YAW=2;a.HMD_ALL_AXES_MOUSE_YAW=3;a.enable_hmd=function(a){var c;if(c=g.get_device_by_type_element(g.DEVICE_HMD))c=g.get_value_param(c,g.HMD_WEBVR_TYPE)&(g.HMD_WEBVR_MOBILE|g.HMD_WEBVR_DESKTOP|g.HMD_WEBVR1)?b.create_hmd_quat_sensor():b.create_gyro_quat_sensor(),d(a,c)};a.check_browser_support=function(){return!!g.can_use_device(g.DEVICE_HMD)};a.disable_hmd=function(){if(b.check_sensor_manifold(null,"HMD_ROTATE_CAMERA")){b.remove_sensor_manifold(null,
"HMD_ROTATE_CAMERA");e.exit_split_screen();var a=B.get_active_camera();k?c.target_setup(a,m):f?c.hover_setup(a,m):F&&c.static_setup(a,m);c.set_vertical_axis(a,w.AXIS_Z);var d=v.get_rotation(a,J);v.set_rotation_v(a,d)}};a.set_rotate_quat=function(a){n.copy(a,t)};a.get_rotate_quat=function(a){n.copy(t,a);return a}};b4w.module.fps=function(a,q){function d(){}function c(a,b,c){var d=D.get_active_camera();r.eye_rotate(d,b,c);b=r.get_camera_angles_char(d,ca);J.set_character_rotation(a,b[0],b[1])}function b(a,b,c,d){if(.01<Math.abs(E[0])||.01<Math.abs(E[1]))c=z.get_sensor_value(a,b,0),b=H.smooth(E[0],0,c,.2*W),c=H.smooth(E[1],0,c,.2*W),E[0]-=b,E[1]-=c,d(a,-b*V,-c*V)}function g(a){var b=document.createElement("div");b.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);";
b.setAttribute("id","B4W_DEFAULT_BTN_1");var c=document.createElement("div");c.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);transform: rotate(180deg);transform-origin: center;";
c.setAttribute("id","B4W_DEFAULT_BTN_2");a.appendChild(b);a.appendChild(c)}function n(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)}function B(a,c){if(n(a)&&!C.detect_mobile()){var e=z.create_plock_mouse_sensor(a),f=oa?oa:z.create_plock_sensor(a);oa=f;z.create_sensor_manifold(c,"FPS_PLOCK",z.CT_CONTINUOUS,[e,f],function(a){return a[0]&&a[1]},function(a,b,c){0<c&&(b=z.get_sensor_payload(a,b,0),d(a,-b.coords[0]*V,-b.coords[1]*V))});z.create_sensor_manifold(null,
"FPS_ACTIVATE_PLOCK",z.CT_TRIGGER,[f],function(a){return a[0]},function(b,c,d){0<d?X.ew&&X.ew(a):X.$v&&X.$v(a)})}else{if(C.detect_mobile())var e=z.create_touch_move_sensor("XY",a),f=z.create_touch_click_sensor(a),g=4;else{var e=z.create_mouse_move_sensor("XY",a),f=z.create_mouse_click_sensor(a),g=2,h=D.get_active_camera(),k=z.create_elapsed_sensor(),l=z.create_gamepad_axis_sensor(m.GMPD_AXIS_2),p=z.create_gamepad_axis_sensor(m.GMPD_AXIS_3);z.create_sensor_manifold(c,"FPS_CAM_ROT",z.CT_CONTINUOUS,
[k,l,p],function(a){return.05<Math.abs(a[1])||.05<Math.abs(a[2])},function(a,b,c){if(0<c){var d=z.get_sensor_value(a,b,0);c=z.get_sensor_value(a,b,1);var e=z.get_sensor_value(a,b,2);b=2.5*d;e=.05>Math.abs(e)?0:e;d=r.get_camera_angles(h,ca);e=d[1]-e*b;c=-(.05>Math.abs(c)?0:c)*b;e=H.clamp(e,R,G);r.eye_rotate(h,c,e,!1,!0);J.set_character_rotation(a,d[0]+c+Math.PI,0)}})}var q=0,t=0;z.create_sensor_manifold(null,"FPS_DRAG_PRESS",z.CT_SHOT,[f],function(a){return a[0]},function(a,b,c){1==c&&(a=z.get_sensor_payload(a,
b,0).coords,q=a[0],t=a[1])});z.create_sensor_manifold(null,"FPS_DRAG_MOVE",z.CT_CONTINUOUS,[e,f],function(a){return a[0]&&a[1]},function(a,b,c){1==c&&(a=z.get_sensor_payload(a,b,0).coords,E[0]+=(a[0]-q)*g,E[1]+=(a[1]-t)*g,q=a[0],t=a[1])});e=z.create_elapsed_sensor();z.create_sensor_manifold(c,"FPS_SMOOTH_DRAG",z.CT_CONTINUOUS,[e],null,b,d)}}function e(a){var b=z.create_elapsed_sensor(),c=D.get_active_camera();z.create_sensor_manifold(a,"FPS_CHARECTER_VR_ROT",z.CT_CONTINUOUS,[b],null,function(a){var b=
r.get_camera_angles_char(c,ca)[0];J.set_character_rotation(a,b,0)})}function v(){var a=y.check_browser_support()&&!C.detect_mobile(),b=m.get_device_by_type_element(m.DEVICE_HMD);b&&(a=a&&m.get_value_param(b,m.HMD_WEBVR_TYPE)&m.HMD_WEBVR1);return a}function w(a,b,c,d){function e(a){a=0<a?1:a;var d=n+p;p=-(0>a?-1:a);a=q+r;var e=n+p;J.set_character_move_dir(b,a,e);c&&c(a,e);k(a,e);v&&d!=e&&v(a,e)}function h(a){a=0<a?1:a;var d=q+r;r=-(0>a?-1:a);a=q+r;var e=n+p;J.set_character_move_dir(b,a,e);c&&c(a,e);
k(a,e);v&&d!=a&&v(a,e)}function k(a,b){var c=l.em.id;a||b?0==c&&(0<t?f(l,2):f(l,1)):f(l,0)}C.detect_mobile()&&g(a.parentElement?a.parentElement:a);var l=F(b),n=0,p=0,q=0,r=0,t=-1,v=d.move_dir_cd;a=d.jJ;var w=d.NP,y=d.cO,x=d.YN,z=d.SP,A=d.rM;u(1,d.sM,function(a){var d=q+r;q=a;a=q+r;var e=n+p;J.set_character_move_dir(b,a,e);c&&c(a,e);k(a,e);v&&d!=a&&v(a,e)});u(1,a,h);u(1,w,e);u(1,y,function(a){var d=n+p;n=a;a=q+r;var e=n+p;J.set_character_move_dir(b,a,e);c&&c(a,e);k(a,e);v&&d!=e&&v(a,e)});u(1,x,function(a){0<
a&&J.character_jump(b)});u(3,[m.GMPD_AXIS_0],e);u(3,[m.GMPD_AXIS_1],h);u(1,z,function(a){t=a;q+r+n+p?(0<a?f(l,2):f(l,1),v&&v(q+r,n+p)):f(l,0)});u(1,A,function(a){0<a&&(a=ba.em.id,1==a||0==a?f(l,3):f(l,1))})}function h(){ba||(ba={V:[],em:null,lock:!1,VC:null});return ba}function l(a,b,c,d){a.V.push({id:b,$u:c,JA:d,IA:null,tv:null})}function x(a){for(var b=[],c=0;c<a.V;c++){var d=a.V[c].id;if(0<=b.indexOf(d))return!1;b.push(d)}for(c=0;c<a.V;c++)for(var d=a.V[c],e=0;e<d.$u.length;e++)if(0>b.indexOf(d.$u[e]))return!1;
return!0}function k(a,b){for(var c=null,d=0;d<a.V.length;d++)if(a.V[d].id==b){c=a.V[d];break}return c}function f(a,b){a.VC=b;if(!a.lock){var c=a.em,d=c.id;if(0<=c.$u.indexOf(b)){var e=!0;c.IA&&(e=c.IA(d,b));e&&(a.em=k(a,b),c.JA&&c.JA(d,b),c.tv&&c.tv(d,b))}}}function F(a){function b(b,c){switch(c){case 0:case 1:J.set_character_move_type(a,J.CM_WALK);break;case 2:J.set_character_move_type(a,J.CM_RUN);break;case 3:J.set_character_move_type(a,J.CM_FLY);break;case 4:J.set_character_move_type(a,J.CM_CLIMB)}}
var c=h();l(c,0,[1,3,2,4],b);l(c,1,[2,3,4,0],b);l(c,2,[1,3,4,0],b);l(c,3,[1],b);l(c,4,[1,2,0],b);x(c);c.em=k(c,0);return ba}function u(a,b,c){if(b.length){for(var d=[],e=0;e<b.length;e++)if("number"==typeof b[e])300>b[e]?d.push(z.create_keyboard_sensor(b[e])):326>b[e]?d.push(z.create_gamepad_btn_sensor(b[e],ha)):d.push(z.create_gamepad_axis_sensor(b[e]));else if("string"==typeof b[e]){var f=document.getElementById(b[e]);f?d.push(z.create_touch_click_sensor(f)):Y.error("Couldn't find element with "+
b[e]+" ID.")}b=function(){return!1};e=z.CT_SHOT;f=function(){};switch(a){case 1:e=z.CT_TRIGGER;b=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d){0<d?c(1):c(0)};break;case 2:e=z.CT_TRIGGER;b=function(a){for(var b=0;b<a.length;b++)if(a[b])return!0;return!1};f=function(a,b,d){0>d?c(1):c(0)};break;case 3:e=z.CT_CONTINUOUS,b=function(a){for(var b=0;b<a.length;b++)if(.05<Math.abs(a[b]))return!0;return!1},f=function(a,b,d,e){if(0<d)for(d=0;d<e;d++){var f=z.get_sensor_value(a,
b,d);if(.05<Math.abs(f)){c(f);break}}else c(0)}}z.create_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+K.toString(),e,d,b,f,d.length);K++}}var r=q("camera"),z=q("controls"),J=q("physics"),D=q("scenes"),H=q("util"),C=q("main"),t=q("container"),m=q("input"),A=q("screen"),I=q("transform"),p=q("constraints"),Q=q("vec3"),y=q("hmd"),Y=q("__print"),R=(-Math.PI+.1)/2,G=(Math.PI-.1)/2,E=new Float32Array(2),W=1,V=4E-4,K=0,ba=null,oa=null,X={ew:null,$v:null},ha=0,Z=4,ca=new Float32Array(2),da=new Float32Array(3),
L=new Float32Array(3);a.CS_STAY=0;a.CS_WALK=1;a.CS_RUN=2;a.CS_FLY=3;a.CS_CLIMB=4;a.AT_PRESSED=1;a.AT_RELEASED=2;a.AT_CONTINUOUS=3;a.bind_action=u;a.enable_fps_controls=function(a){a=a||{lock_camera:!0};var b=a.character||D.get_first_character();if(b){var f=a.element||t.get_canvas(),g=a.motion_cb||null;ha=a.gamepad_id||0;var h=a.forward_sens||[z.KEY_W,m.GMPD_BUTTON_12],k=a.backward_sens||[z.KEY_S,m.GMPD_BUTTON_13],l=a.right_sens||[z.KEY_D,m.GMPD_BUTTON_15],n=a.left_sens||[z.KEY_A,m.GMPD_BUTTON_14],
q=a.jump_sens||[z.KEY_SPACE,m.GMPD_BUTTON_1],u=a.PU||[z.KEY_SHIFT,m.GMPD_BUTTON_7],x=a.fly_sens||[];C.detect_mobile()&&(h.push("B4W_DEFAULT_BTN_1"),k.push("B4W_DEFAULT_BTN_2"));h={sM:h,jJ:k,NP:l,cO:n,YN:q,SP:u,rM:x,move_dir_cd:a.move_dir_cd||null};d=a.rotation_cb||c;k=a.lock_camera||!1;a=D.get_active_camera();k&&(k=I.get_translation(a,da),l=I.get_translation(b,L),Q.subtract(k,l,k),p.append_stiff_trans(a,b,k));a=r.get_camera_angles_char(a,ca);J.set_character_rotation(b,a[0],a[1]);v()?(y.enable_hmd(y.HMD_ALL_AXES_MOUSE_NONE),
m.add_click_listener(f,A.request_fullscreen_hmd),e(b)):B(f,b);w(f,b,g,h)}};a.disable_fps_controls=function(a,b){a=a||D.get_first_character();b=b||t.get_container();if(a){for(var c=0;c<K;c++)z.remove_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+c.toString());c=a;n(b)&&!C.detect_mobile()&&(z.remove_sensor_manifold(c,"FPS_PLOCK"),z.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"));c=a;if(!n(b)||C.detect_mobile())z.remove_sensor_manifold(c,"FPS_CAM_ROT"),z.remove_sensor_manifold(c,"FPS_DRAG_PRESS"),
z.remove_sensor_manifold(c,"FPS_DRAG_MOVE"),z.remove_sensor_manifold(c,"FPS_SMOOTH_DRAG");c=a;v()&&z.remove_sensor_manifold(c,"FPS_CHARECTER_VR_ROT");c=b;if(C.detect_mobile()){var d=document.getElementById("B4W_DEFAULT_BTN_1"),e=document.getElementById("B4W_DEFAULT_BTN_2");d&&c.removeChild(d);e&&c.removeChild(e)}}};a.set_character_state_changing_cb=function(a,b){k(ba,a).tv=b};a.set_cam_smooth_factor=function(a){z.set_plock_smooth_factor(a);W=a};a.set_cam_sensitivity=function(a){V=a/2E5};a.set_plock_enable_cb=
function(a){X.ew=a};a.set_plock_disable_cb=function(a){X.$v=a};a.get_character_state=function(){return ba.em.id};a.add_new_state=function(){return Z++};a.add_state_to_state_machine=function(a,b,c){var d=h();l(d,a,b,c);x(d)||Y.error("Incorrect state machine.")};a.state_machine_switch_state=function(a){var b=h();f(b,a)};a.lock_character_state_machine=function(){h().lock=!0};a.unlock_character_state_machine=function(){h().lock=!1};a.is_state_machine_locked=function(){return h().lock};a.get_last_state=
function(){return h().VC};a.set_rotation_cb=function(a){a?d=a:d=c};a.CD_NONE=0;a.CD_FORWARD=1;a.CD_BACKWARD=2;a.CD_RIGHT=3;a.CD_LEFT=4};b4w.module.mixer=function(a,q){function d(){r=u.length=0;z=c();J=new Float32Array(z.length);D=new Float32Array(z.length);var a=k.get_speaker_objects();if(a.length){u.push(b());for(var d=0;d<a.length;d++)u.push(n(a[d]));u.sort(function(a,b){return"MASTER"==a.id?-1:"MASTER"==b.id?1:"COMPRESSOR"==a.id?-1:"COMPRESSOR"==b.id?1:a.id.toUpperCase()<b.id.toUpperCase()?-1:a.id.toUpperCase()>b.id.toUpperCase()?1:0})}}function c(){for(var a=new Float32Array(100),b=0,c=0;100>c;c++)a[c]=20*Math.pow(1E3,b),b+=1/
99;return a}function b(){var a=g("MASTER"),b=k.get_compressor_params();b&&(a.X.push(["THRESHOLD",b.threshold,-100,0,100,!1]),a.X.push(["KNEE",b.knee,0,40,40,!1]),a.X.push(["RATIO",b.ratio,1,20,20,!1]),a.X.push(["ATTACK",b.attack,0,1,1E3,!1]),a.X.push(["RELEASE",b.release,0,1,1E3,!1]));a.X.push(["VOLUME",k.get_volume(null),0,1,50,!1]);a.mute=k.is_muted(null)?1:0;a.Xf=-1;return a}function g(a){return{id:a,X:[],kk:0,mute:-1,Xf:-1,Yb:null}}function n(a){var b=g(l.get_object_name(a));b.mute=k.is_muted(a)?
1:0;b.Xf=0;b.Yb=a;return b}function B(a){if(a.Yb){a.X.length=0;var b=k.get_positional_params(a.Yb);b&&(a.X.push(["DIST_REF",b.dist_ref,0,1E3,1E4,!1]),a.X.push(["ATTENUATION",b.attenuation,0,50,1E3,!1]),a.X.push(["DIST_MAX",b.dist_max,0,1E4,1E4,!1]));if(b=k.get_filter_params(a.Yb))a.X.push(["EQ_FREQ",b.freq,20,2E4,100,!0]),a.X.push(["EQ_Q",b.Q,0,10,100,!1]),a.X.push(["EQ_GAIN",b.gain,-70,30,100,!1]);a.X.push(["VOLUME",k.get_volume(a.Yb),0,1,50,!1]);f.clamp(a.kk,0,a.X.length-1)}}function e(a){for(var b=
0;b<u.length;b++){var c=u[b];if(c!=a&&1==c.Xf)return!0}return!1}function v(a){for(var b=0;b<u.length;b++){var c=u[b];c!=a&&0==c.mute&&0==c.Xf&&k.mute(c.Yb,!1)}}function w(){if(!u.length)return[0,-1];var a=8*Math.floor(r/8),b=a+7,a=f.clamp(a,0,u.length-1),b=f.clamp(b,0,u.length-1);return[a,b]}var h=q("controls"),l=q("scenes"),x=q("screen"),k=q("sfx"),f=q("__util"),F="SWITCH_STRIP SWITCH_STRIP_HOLD SWITCH_PARAM INC_DEC INC_DEC_HOLD MUTE_SOLO".split(" "),u=[],r=0,z=null,J=null,D=null;a.enable_mixer_controls=
function(){function a(a,b,c){if(1==c){var d=h.get_sensor_value(a,b,0)?-1:1,e=u[r];if(e)switch(c=e.X[e.kk],c[1]=c[5]?c[1]*Math.pow(c[3]/c[2],d/c[4]):c[1]+(c[3]-c[2])/c[4]*d,c[1]=f.clamp(c[1],c[2],c[3]),c[0]){case "VOLUME":"MASTER"!=e.id?k.set_volume(e.Yb,c[1]):k.set_volume(null,c[1]);break;case "DIST_REF":d=k.get_positional_params(e.Yb);d.dist_ref=c[1];k.set_positional_params(e.Yb,d);break;case "ATTENUATION":d=k.get_positional_params(e.Yb);d.attenuation=c[1];k.set_positional_params(e.Yb,d);break;case "DIST_MAX":d=
k.get_positional_params(e.Yb);d.dist_max=c[1];k.set_positional_params(e.Yb,d);break;case "EQ_FREQ":d=k.get_filter_params(e.Yb);d.freq=c[1];k.set_filter_params(e.Yb,d);break;case "EQ_Q":d=k.get_filter_params(e.Yb);d.Q=c[1];k.set_filter_params(e.Yb,d);break;case "EQ_GAIN":d=k.get_filter_params(e.Yb);d.gain=c[1];k.set_filter_params(e.Yb,d);break;case "THRESHOLD":e=k.get_compressor_params();e.threshold=c[1];k.set_compressor_params(e);break;case "KNEE":e=k.get_compressor_params();e.knee=c[1];k.set_compressor_params(e);
break;case "RATIO":e=k.get_compressor_params();e.ratio=c[1];k.set_compressor_params(e);break;case "ATTACK":e=k.get_compressor_params();e.attack=c[1];k.set_compressor_params(e);break;case "RELEASE":e=k.get_compressor_params();e.release=c[1];k.set_compressor_params(e);break;default:f.D("Unknown strip param")}"INC_DEC"==b?h.reset_timer_sensor(a,b,2,.35):h.reset_timer_sensor(a,b,2,.05)}else h.reset_timer_sensor(a,b,2,10)}function b(a,b,c){if(1==c){c=h.get_sensor_value(a,b,0)?-1:1;if(u.length){1==c&&r<
u.length-1?r++:-1==c&&0<r&&r--;c=w();for(var d=c[0];d<=c[1];d++)B(u[d])}"SWITCH_STRIP"==b?h.reset_timer_sensor(a,b,2,.15+.3):h.reset_timer_sensor(a,b,2,.15)}else h.reset_timer_sensor(a,b,2,10)}d();var c=h.create_keyboard_sensor(h.KEY_NUM4),g=h.create_keyboard_sensor(h.KEY_NUM6),l=h.create_keyboard_sensor(h.KEY_NUM8),n=h.create_keyboard_sensor(h.KEY_NUM2),p=h.create_keyboard_sensor(h.KEY_ADD),q=h.create_keyboard_sensor(h.KEY_SUB),y=h.create_keyboard_sensor(h.KEY_NUM7),F=h.create_keyboard_sensor(h.KEY_NUM9),
R=h.create_timer_sensor(.15,!0),G=h.create_timer_sensor(.05,!0),c=[c,g,R];h.create_sensor_manifold(null,"SWITCH_STRIP",h.CT_TRIGGER,c,function(a){return a[0]||a[1]},b);h.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",h.CT_SHOT,c,function(a){return(a[0]||a[1])&&a[2]},b);h.create_sensor_manifold(null,"SWITCH_PARAM",h.CT_SHOT,[l,n],function(a){return a[0]||a[1]},function(a,b){var c=h.get_sensor_value(a,b,0)?-1:1,d=u[r];d&&(1==c&&d.kk<d.X.length-1?d.kk++:-1==c&&0<d.kk&&d.kk--)});l=[q,p,G];h.create_sensor_manifold(null,
"INC_DEC",h.CT_TRIGGER,l,function(a){return a[0]||a[1]},a);h.create_sensor_manifold(null,"INC_DEC_HOLD",h.CT_SHOT,l,function(a){return(a[0]||a[1])&&a[2]},a);h.create_sensor_manifold(null,"MUTE_SOLO",h.CT_SHOT,[y,F],function(a){return a[0]||a[1]},function(a,b){if(h.get_sensor_value(a,b,0)){var c=u[r];c&&0<=c.mute&&("MASTER"!=c.id?0==c.mute?(c.mute=1,k.mute(c.Yb,!0),1==c.Xf&&(c.Xf=0,e(c)||v(c))):(c.mute=0,e(c)||k.mute(c.Yb,!1)):0==c.mute?(c.mute=1,k.mute(null,!0)):(c.mute=0,k.mute(null,!1)))}else if((c=
u[r])&&0<=c.Xf)if(0==c.Xf){c.Xf=1;k.mute(c.Yb,!1);1==c.mute&&(c.mute=0);for(var d=0;d<u.length;d++){var f=u[d];f!=c&&0==f.mute&&0==f.Xf&&k.mute(f.Yb,!0)}}else c.Xf=0,e(c)?k.mute(c.Yb,!0):v(c)});y=h.create_elapsed_sensor();h.create_sensor_manifold(null,"MIXER_DRAW",h.CT_CONTINUOUS,[y],null,function(){if(u[r])for(var a=w(),b=a[0];b<=a[1];b++){var c=u[b];x.draw_mixer_strip(c.id,b==r,b%8,c.X,c.kk,c.mute,c.Xf);if(c.Yb&&k.get_filter_params(c.Yb)){k.get_filter_freq_response(c.Yb,z,J,D);for(c=0;c<J.length;c++)J[c]=
20*Math.log(J[c])/Math.LN10;x.plot_array("EQ",b%8,J,20,2E4,-10,10)}}});y=h.create_timer_sensor(1,!0);h.create_sensor_manifold(null,"MIXER_UPDATE",h.CT_TRIGGER,[y],null,function(){for(var a=w(),b=a[0];b<=a[1];b++)B(u[b])})};a.disable_mixer_controls=function(){for(var a=0;F.length;a++)h.remove_sensor_manifold(null,F[a])}};b4w.module.npc_ai=function(a,q){function d(a,b){var c=b.destination,d=b.ev,f=J;x.get_translation(b.collider,f);var g=0,h=f[2];c[2]=h;switch(b.type){case A:if(b.random&&b.Oj){c[0]=(12*Math.random()-6)*b.speed+d[0];c[1]=-(12*Math.random()-6)*b.speed+d[1];var l=t,d=D,n=b.speed,q=b.rot_speed;x.get_rotation(b.collider,l);k.transformQuat(u.AXIS_MY,l,d);d[2]=0;k.normalize(d,d);l=.5*n/Math.sin(q/2);f=k.dist(c,f);f<2*l&&k.scaleAndAdd(c,d,2*l-f,c);b.Oj=!1}b.Hw&&(g=b.Hw-h,f=b.speed*a,g>f?g=f:g<-f&&(g=-f));b.Ri=
g;break;case I:case p:b.Cn?g=b.Cn:b.Ri&&(g=b.Ri,b.type==p&&(g*=a)),b.random&&b.Oj&&(b.type==p?(b.speed=Math.random()+.1,f=b.fD-b.hD):f=b.max_height-b.min_height,c[0]=10*Math.random()-5+d[0],c[1]=10*Math.random()-5+d[1],c[2]=h-(Math.random()*f-.5*f),b.Oj=!1)}g&&(c[2]=h+g);var c=z,f=J,l=D,g=m,q=b.rig,d=b.collider,h=b.destination,r=b.speed,v=b.actions,y=e.get_current_anim_name(q);if(!e.is_play(q)||!v.idle||-1==v.idle.indexOf(y)){x.get_translation(d,c);var n=h[0]-c[0],F=h[1]-c[1],n=Math.sqrt(n*n+F*F);
if(n>2*r*a)b.state=20,u.horizontal_direction(h,c,l),v=b.rig,e.is_animated(v)&&(q=b.speed,r=e.get_frame(v),v=e.get_anim_length(v),q=v/24*(1-r/v)*q,.9>n/q&&k.scaleAndAdd(h,l,q-n,h)),n=t,q=H,x.get_rotation(b.collider,n),k.transformQuat(u.AXIS_MY,n,f),q[0]=f[0],q[1]=f[1],q[2]=0,k.normalize(q,q),r=k.dot(q,l),v=a/(Math.abs(Math.acos(r))/Math.PI)*b.rot_speed*b.hy,w.rotationTo(q,l,g),w.rotationTo(u.AXIS_MY,q,n),1<=Math.abs(r)?w.copy(n,g):(w.multiply(g,n,g),w.slerp(n,g,Math.min(v,1),g)),l=a,b.type!=I&&(l=
Math.max(l,1/60),n=C,q=t,w.setAxisAngle(u.AXIS_X,-Math.asin(-f[2]),q),w.setAxisAngle(u.AXIS_X,-Math.atan(b.Ri/(b.speed*l)),n),w.slerp(q,n,l,n),w.multiply(g,n,g)),x.set_rotation_v(d,g),f=D,d=H,u.quat_to_dir(g,u.AXIS_MY,f),k.scale(f,b.speed*a,d),k.add(d,c,d),d[2]=b.type!=A?(h[2]-c[2])*a*.1+c[2]:h[2],x.set_translation_v(b.collider,d);else if(b.type==A)v.move?y&&-1!=v.move.indexOf(y)&&e.is_play(q)?b.state=20:(b.state=10,b.Oj=!0):(b.state=10,b.Oj=!0);else if(b.type==p||b.type==I)b.Oj=!0;if(B(b)&&(c=b.rig,
!e.is_play(c))){g=null;switch(b.state){case 10:g=b.actions;g=g.idle?u.random_from_array(g.idle):null;break;case 20:g=e.get_current_anim_name(b.rig),f=h=b.actions,f.move_blends&&-1==f.move_blends.indexOf(g)&&f.move&&-1!=f.move.indexOf(g)&&.33<Math.random()?(h=b.actions,g=h.move_blends[h.move.indexOf(g)]):(f=b.actions,f.move&&(-1!=f.move.indexOf(g)||!f.move_blends&&!f.move_start||!f.move_start&&!g||f.move_blends&&-1!=f.move_blends.indexOf(g)||f.move_start&&-1!=f.move_start.indexOf(g))?(h=b.actions,
h.move_blends?(f=h.move_blends.indexOf(g),-1!=f?(g=f+1,g=g<h.move.length?g:0,g=h.move[g]):g=-1!=h.move.indexOf(g)?g:u.random_from_array(h.move)):g=u.random_from_array(h.move)):(f=b.actions,g=f.move_start&&-1==f.move_start.indexOf(g)&&f.move&&-1==f.move.indexOf(g)?u.random_from_array(h.move_start):null))}g&&(e.apply(c,g),e.set_behavior(c,e.AB_FINISH_RESET),e.set_frame(c,0),e.play(c))}}}function c(a,b,c,d){if(d)if(1==c)switch(d.type){case I:a:{for(c=0;3>c;c++){var e=v.get_sensor_payload(a,b,c).If;if(e){b=
e;break a}}b=void 0}b=100*b;d.Ri=b<d.min_height?10:b>d.max_height?-10:0;break;case A:a=v.get_sensor_payload(a,b,0);d.Hw=a.rh[2];break;case p:a=v.get_sensor_payload(a,b,0),"CLOSE_GROUND"==b?(d.Ri=100*a.If-1,d.Ri=.1>d.Ri?.05:0):"CLOSE_WATER"==b&&(d.Cn=100*a.If,d.Cn=d.Cn<d.hD?-.02:d.Cn>d.fD?.02:0)}else d.Ri=0}function b(){for(var a=0;a<r.length;a++){var b=r[a];g(b);n(b);e.get_current_anim_name(b.rig)&&e.play(b.rig)}}function g(a){var b=k.create(),d=a.collider;switch(a.type){case I:var e=v.create_ray_sensor(d,
b,[0,0,-100],"TERRAIN",!0,!0),f=v.create_ray_sensor(d,b,[0,0,-100],"STONE",!0,!0),b=v.create_ray_sensor(d,b,[0,0,-100],"WATER",!0,!0),e=[e,f,b];v.create_sensor_manifold(d,"CLOSE_GROUND",v.CT_CONTINUOUS,e,function(a){return a[0]||a[1]||a[2]},c,a);break;case A:e=v.create_ray_sensor(d,[0,0,1],[0,0,-99],"TERRAIN",!0,!0);e=[e];v.create_sensor_manifold(d,"CLOSE_GROUND",v.CT_CONTINUOUS,e,null,c,a);break;case p:e=v.create_ray_sensor(d,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),b=v.create_ray_sensor(d,b,[0,0,100],
"WATER",!0,!0),e=[e],v.create_sensor_manifold(d,"CLOSE_WATER",v.CT_CONTINUOUS,[b],null,c,a),v.create_sensor_manifold(d,"CLOSE_GROUND",v.CT_CONTINUOUS,e,null,c,a)}}function n(a){var b=a.collider;if(a.type==A){var c=v.create_collision_sensor(b,"CONSTRUCTION",!1);v.create_sensor_manifold(b,"CONSTRUCTION_COLL",v.CT_CONTINUOUS,[c],null,function(b,c,d){1==d?(k.copy(a.ev,a.destination),a.hy=4):a.hy=1})}}function B(a){var b=a.rig;if(!e.is_play(b))return!0;b=e.get_current_anim_name(b);if(!b)return!0;var c=
a.actions;switch(a.state){case 10:if(!c.idle)return!1;break;case 20:if(!c.move||-1!=c.move.indexOf(b)||c.move_start&&-1!=c.move_start.indexOf(b)||c.move_blends&&-1!=c.move_blends.indexOf(b))return!1;break;default:return!1}return!0}var e=q("animation"),v=q("controls"),w=q("quat"),h=q("scenes"),l=q("time"),x=q("transform"),k=q("vec3"),f=q("physics"),F=q("print"),u=q("util"),r=[],z=new Float32Array(3),J=new Float32Array(3),D=new Float32Array(3),H=new Float32Array(3),C=new Float32Array(4),t=new Float32Array(4),
m=new Float32Array(4),A=a.NT_WALKING=10,I=a.NT_FLYING=20,p=a.NT_SWIMMING=30;a.new_event_track=function(a){var b={obj:null,rig:null,collider:null,empty:null,type:A,state:10,actions:{},ev:new Float32Array(3),destination:new Float32Array(3),path:[],start:[],ended:[],Xr:[],delay:[],random:!0,Oj:!0,Hw:0,Ri:0,Cn:0,hy:1,speed:1,rot_speed:.1,max_height:0,min_height:0,fD:0,hD:0};if("object"!=typeof a.obj)F.error("Can't create event track. Wrong object.");else if("object"!=typeof a.rig)F.error("Can't create event track. Wrong rig object.");
else if("object"==typeof a.collider&&f.has_physics(a.collider)){b.obj=a.obj;b.collider=a.collider;b.rig=a.rig;x.get_translation(a.collider,b.ev);"object"==typeof a.actions&&(b.actions=a.actions);"boolean"==typeof a.random&&(b.random=a.random);"number"==typeof a.type&&(b.type=a.type);"number"==typeof a.speed&&(b.speed=a.speed);"number"==typeof a.rot_speed&&(b.rot_speed=a.rot_speed);"number"==typeof a.max_height&&(b.max_height=a.max_height);"number"==typeof a.min_height&&(b.min_height=a.min_height);
if(!b.random){for(var c=0;c<a.path.length;c++)b.start[c]=-1,b.ended[c]=!1,b.Xr[c]=!1;b.path=a.path;b.delay=a.delay}a=a.actions;var c=e.get_current_anim_name(b.rig),d;for(d in a)for(var g=a[d],h=0;h<g.length;h++)e.apply(b.rig,g[h]);c&&e.apply(b.rig,c);r.push(b)}else F.error("Can't create event track. Wrong collider object.")};a.enable_animation=function(){if(r.length){b();var a=v.create_elapsed_sensor();v.create_sensor_manifold(r[0].collider,"ELAPSED",v.CT_CONTINUOUS,[a],function(a){return a[0]},function(a,
b,c){if(1==c)for(a=v.get_sensor_value(a,b,0),b=0;b<r.length;b++){c=r[b];var e=a;if(h.is_visible(c.obj))if(c.random)d(e,c);else{for(var f=l.get_timeline(),g=0;g<c.path.length;g++)if(!c.ended[g]){c.Xr[g]||(c.Xr[g]=!0,c.destination[0]=c.path[g][0],c.destination[1]=c.path[g][1],c.destination[2]=c.path[g][2],c.start[g]=f+c.delay[g]);if(f<c.start[g])break;d(e,c);c.ended[g]=c.Oj;break}a:{for(e=0;e<c.path.length;e++)if(0==c.ended[e]){e=!1;break a}e=!0}if(e)for(e=0;e<c.path.length;e++)c.Xr[e]=!1,c.ended[e]=
!1}}})}};a.disable_animation=function(){if(!(0>=r.length))for(var a=0;a<r.length;a++){var b=r[a];v.check_sensor_manifolds(b.collider)&&v.remove_sensor_manifold(b.collider);e.is_play(b.rig)&&e.stop(b.rig)}}};b4w.module.mouse=function(a,q){function d(){1==m&&(m=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);l.remove_sensor_manifold(f.get_active_camera(),"SMOOTH_PL")}function c(a){2==m&&(m=0);a.removeEventListener("mousedown",g,!1);a.removeEventListener("mouseup",n,!1);a.removeEventListener("mousemove",b,!1);l.remove_sensor_manifold(f.get_active_camera(),"SMOOTH_DRAG")}function b(a){if(C()){if(I)var b=h.client_to_element_coords(a.clientX,
a.clientY,a.target,H);else b=H,b[0]=a.clientX,b[1]=a.clientY;D[0]+=2*(b[0]-z);D[1]+=2*(b[1]-J);z=b[0];J=b[1]}a.preventDefault()}function g(a){if(I)var c=h.client_to_element_coords(a.clientX,a.clientY,a.target,H);else c=H,c[0]=a.clientX,c[1]=a.clientY;z=c[0];J=c[1];a.currentTarget.addEventListener("mousemove",b,!1);a.preventDefault()}function n(a){a.currentTarget.removeEventListener("mousemove",b,!1);a.preventDefault()}function B(a,b,c,d){if(.01<Math.abs(D[0])||.01<Math.abs(D[1]))b=l.get_sensor_value(a,
b,0),a=F.smooth(D[0],0,b,.1*r),b=F.smooth(D[1],0,b,.1*r),D[0]-=a,D[1]-=b,d(4E-4*-a,4E-4*-b)}function e(a,b){var c=f.get_first_character(),d=f.get_active_camera();w.eye_rotate(d,a,b);c&&(d=w.get_camera_angles_char(d,H),x.set_character_rotation(c,d[0],d[1]))}function v(a){A?(a=h.client_to_canvas_coords(a.clientX,a.clientY,H),a=f.pick_object(a[0],a[1])):a=f.pick_object(a.clientX,a.clientY);a?(f.outlining_is_enabled(a)&&f.set_outline_intensity(a,1),f.outlining_is_enabled(t)&&a!=t&&f.set_outline_intensity(t,
0)):f.outlining_is_enabled(t)&&f.set_outline_intensity(t,0);t=a}var w=q("camera"),h=q("container"),l=q("controls"),x=q("physics"),k=q("print"),f=q("scenes"),F=q("util"),u=q("main"),r=1,z=0,J=0,D=new Float32Array(2),H=new Float32Array(2),C=null,t=null,m=0,A=!1,I=!1;a.request_pointerlock=function(a,b,d,g,h,n){function p(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){c(a);a.addEventListener("mousemove",g,!1);var e=f.get_active_camera();
if(!l.check_sensor_manifold(e,"SMOOTH_PL")){var h=l.create_elapsed_sensor();l.create_sensor_manifold(e,"SMOOTH_PL",l.CT_CONTINUOUS,[h],null,B,n)}b()}else a.removeEventListener("mousemove",g,!1),m=0,document.removeEventListener("pointerlockchange",p,!1),document.removeEventListener("webkitpointerlockchange",p,!1),document.removeEventListener("mozpointerlockchange",p,!1),d()}if(1!=m){m=1;b=b||function(){};d=d||function(){};n=n||e;h=h||function(){return!0};g=g||function(a){if(h()){if("number"==typeof a.movementX){var b=
a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;D[0]+=b;D[1]+=a}};document.addEventListener("pointerlockchange",p,!1);document.addEventListener("webkitpointerlockchange",p,!1);document.addEventListener("mozpointerlockchange",p,!1);var q=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof q?q.apply(a):k.error("Pointer lock is not available")}};
a.exit_pointerlock=d;a.check_pointerlock=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)?!0:!1};a.request_mouse_drag=function(a,b,c,h){2!=m&&(m=2,d(),C=b||function(){return!0},c=c||e,I=!!h,a.addEventListener("mousedown",g,!1),a.addEventListener("mouseup",n,!1),a=f.get_active_camera(),l.check_sensor_manifold(a,"SMOOTH_DRAG")||(b=l.create_elapsed_sensor(),l.create_sensor_manifold(a,"SMOOTH_DRAG",l.CT_CONTINUOUS,[b],null,B,c)))};a.exit_mouse_drag=
c;a.enable_mouse_hover_outline=function(a){A=!!a;u.detect_mobile()||h.get_canvas().addEventListener("mousemove",v)};a.disable_mouse_hover_outline=function(){u.detect_mobile()||(h.get_canvas().removeEventListener("mousemove",v),t&&f.set_outline_intensity(t,0))};a.get_coords_x=function(a,b,c){b=b?a.targetTouches:a.touches;return c?"clientX"in a&&"clientY"in a?h.client_to_canvas_coords(a.clientX,a.clientY,H)[0]:b&&b[0]&&"clientX"in b[0]&&"clientY"in b[0]?h.client_to_canvas_coords(b[0].clientX,b[0].clientY,
H)[0]:-1:"clientX"in a?a.clientX:b&&b[0]&&"clientX"in b[0]?b[0].clientX:-1};a.get_coords_y=function(a,b,c){b=b?a.targetTouches:a.touches;return c?"clientX"in a&&"clientY"in a?h.client_to_canvas_coords(a.clientX,a.clientY,H)[1]:b&&b[0]&&"clientX"in b[0]&&"clientY"in b[0]?h.client_to_canvas_coords(b[0].clientX,b[0].clientY,H)[1]:-1:"clientY"in a?a.clientY:b&&b[0]&&"clientY"in b[0]?b[0].clientY:-1};a.set_plock_smooth_factor=function(a){r=a};a.get_plock_smooth_factor=function(){return r}};b4w.module.preloader=function(a,q){var d=q("container"),c,b,g,n,B,e,v,w,h=null;a.create_preloader=function(a){var e="#484848",h="#5276cf",f="rgba(150, 150, 150, 0.7)",l="#fff",q;for(q in a)switch(q){case "container_color":e=a.container_color;break;case "bar_color":h=a.bar_color;break;case "frame_color":f=a.frame_color;break;case "font_color":l=a.font_color}a=document.createElement("div");q=a.cloneNode(!1);var r=a.cloneNode(!1),v=a.cloneNode(!1),w=d.get_container();r.appendChild(q);r.appendChild(v);
a.appendChild(r);w.appendChild(a);a.style.cssText="background-color: "+e+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";r.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;box-shadow: 0px 0px 10px 0px "+f+";border: 2px solid "+f+";";q.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+h+";height: 100%;";v.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;font-weight: bold;text-shadow: 0px 0px 6px "+
f+";color: "+l+";";c=q;b=v;g=a;n="DEFAULT"};a.create_simple_preloader=function(a){var d=null,e=null,f="#bf9221",l="#000",q;for(q in a)switch(q){case "canvas_container_id":d=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "bg_color":l=a.bg_color;break;case "bar_color":f=a.bar_color}a=document.createElement("div");q=document.createElement("div");a.id="simple_preloader_container";var r=document.createElement("div"),v=document.createElement("div"),e=document.getElementById(e);
h=document.getElementById(d);a.style.cssText="z-index: 4;background-color: "+l+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";q.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";r.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+f+";border-radius: 0px;";v.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
q.appendChild(r);q.appendChild(v);a.appendChild(q);document.body.appendChild(a);n="SIMPLE";g=a;c=r;b=v;B=e};a.create_rotation_preloader=function(a){var c=null,d=null,f="rgba(0,0,0,0)",l="",q="",r="rgba(0,0,0,0)",v;for(v in a)switch(v){case "canvas_container_id":c=a.canvas_container_id;break;case "background_container_id":d=a.background_container_id;break;case "frame_bg_color":f=a.frame_bg_color;break;case "bg_color":r=a.bg_color;break;case "frame_class":l=a.frame_class;break;case "anim_elem_class":q=
a.anim_elem_class}a=document.createElement("div");v=document.createElement("div");var w=document.createElement("div"),D=document.createElement("div"),d=document.getElementById(d);h=document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+r+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";v.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+f+";";w.style.cssText=
"position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";D.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";w.className=q;v.appendChild(w);v.className=l;v.appendChild(D);a.appendChild(v);h.appendChild(a);n="ROTATION";g=a;e=w;b=D;B=d};a.create_advanced_preloader=function(a){var d=a.preloader_width,d=d/(d-a.img_width),e=
document.getElementById(a.preloader_bar_id),f=document.getElementById(a.fill_band_id),l=document.getElementById(a.preloader_caption_id),q=document.getElementById(a.preloader_container_id),r=document.getElementById(a.background_container_id);h=document.getElementById(a.canvas_container_id);n="ADVANCED";c=e;v=f;w=d;b=l;g=q;B=r};a.update_preloader=function(a){b.innerHTML=a+"%";"SIMPLE"==n?c.style.width=a+"%":"ADVANCED"==n?(c.style.width=a/w+"%",v.style.width=100-a+"%"):"ROTATION"==n?e.style.transform=
"rotate("+a+"deg)":"DEFAULT"==n&&(c.style.width=a+"%");100==a&&(g.parentNode.removeChild(g),B&&B.parentNode.removeChild(B))}};b4w.module.storage=function(a,q){function d(a){return g[a?a:b]?JSON.parse(g[a?a:b]):{}}var c=q("__print"),b="b4w",g=null;a.init=function(a){a?"b4w"!==a?b=a:c.error("b4w prefix denied"):c.warn("Prefix should be a string. Last declared storage prefix will be used.")};a.set=function(a,c,e){var n=d(e);n[a]=String(c);g[e?e:b]=JSON.stringify(n)};a.cleanup=function(a){delete g[a?a:b]};a.get=function(a,b){var c=d(b);return c[a]?c[a]:""};a.debug=function(a){c.log(d(a?a:b))};try{g=window.localStorage;try{g.tmp=
null,delete g.tmp}catch(n){c.warn("localStorage quota is limited. Disabling localStorage"),g=null}}catch(n){c.warn("Applying chrome localStorage bug workaround"),g=null}g||(c.warn("localStorage is not available, initializing temporary storage"),g={})};b4w.module.screenshooter=function(a,q){var d=q("screen"),c=q("print");a.shot=function(a,g){c.Ze("shot","screen.shot");d.shot(a,g)}};
//# sourceMappingURL=/deploy/apps/common/b4w.min.js.map